// @bun
var RE=Object.create;var{getPrototypeOf:CE,defineProperty:mH,getOwnPropertyNames:IE}=Object;var bE=Object.prototype.hasOwnProperty;var yH=(J,W,X)=>{X=J!=null?RE(CE(J)):{};let G=W||!J||!J.__esModule?mH(X,"default",{value:J,enumerable:!0}):X;for(let Y of IE(J))if(!bE.call(G,Y))mH(G,Y,{get:()=>J[Y],enumerable:!0});return G};var M6=(J,W)=>()=>(W||J((W={exports:{}}).exports,W),W.exports);var s0=(J,W)=>{for(var X in W)mH(J,X,{get:W[X],enumerable:!0,configurable:!0,set:(G)=>W[X]=()=>G})};var D=(J,W)=>()=>(J&&(W=J(J=0)),W);var z4=import.meta.require;function T0(J){return typeof J>"u"||J===void 0}function h6(J){return typeof J==="string"}function k8(J){return typeof J==="number"}function fJ(J){return typeof J==="boolean"}function VW(J){return J===null}function F1(J){return J instanceof Date}function DW(J){return typeof J==="bigint"}function d$(J){return typeof Buffer<"u"&&Buffer.isBuffer(J)}function f6(J){return typeof J==="function"}function s6(J){return typeof J==="object"&&J!==null}function n$(J){if(!s6(J)||xE(J)!=="[object Object]")return!1;if(Object.getPrototypeOf(J)===null)return!0;let W=J;while(Object.getPrototypeOf(W)!==null)W=Object.getPrototypeOf(W);return Object.getPrototypeOf(J)===W}function Tv(J){return J[J.length-1]}function U(J){return Object.freeze(J)}function VG(J){if(l4(J))return J;else return[J]}function l4(J){return Array.isArray(J)}function q0(J){return J}function r$(J,W){if(l4(J)&&l4(W))return kE(J,W);else if(s6(J)&&s6(W))return hE(J,W);return J===W}function kE(J,W){if(J.length!==W.length)return!1;for(let X=0;X<J.length;++X)if(!r$(J[X],W[X]))return!1;return!0}function hE(J,W){if(d$(J)&&d$(W))return fE(J,W);else if(F1(J)&&F1(W))return gE(J,W);return mE(J,W)}function fE(J,W){return Buffer.compare(J,W)===0}function gE(J,W){return J.getTime()===W.getTime()}function mE(J,W){let X=Object.keys(J),G=Object.keys(W);if(X.length!==G.length)return!1;for(let Y of X)if(!r$(J[Y],W[Y]))return!1;return!0}function xE(J){if(J==null)return J===void 0?"[object Undefined]":"[object Null]";return yE.call(J)}var yE;var C=D(()=>{yE=Object.prototype.toString});var q6;var FX=D(()=>{C();q6=U({is(J){return J.kind==="AlterTableNode"},create(J){return U({kind:"AlterTableNode",table:J})},cloneWithTableProps(J,W){return U({...J,...W})},cloneWithColumnAlteration(J,W){return U({...J,columnAlterations:J.columnAlterations?[...J.columnAlterations,W]:[W]})}})});var X6;var e6=D(()=>{C();X6=U({is(J){return J.kind==="IdentifierNode"},create(J){return U({kind:"IdentifierNode",name:J})}})});var h8;var i$=D(()=>{C();e6();h8=U({is(J){return J.kind==="CreateIndexNode"},create(J){return U({kind:"CreateIndexNode",name:X6.create(J)})},cloneWith(J,W){return U({...J,...W})},cloneWithColumns(J,W){return U({...J,columns:[...J.columns||[],...W]})}})});var a$;var t$=D(()=>{C();e6();a$=U({is(J){return J.kind==="CreateSchemaNode"},create(J,W){return U({kind:"CreateSchemaNode",schema:X6.create(J),...W})},cloneWith(J,W){return U({...J,...W})}})});var qv,N0;var N1=D(()=>{C();qv=["preserve rows","delete rows","drop"],N0=U({is(J){return J.kind==="CreateTableNode"},create(J){return U({kind:"CreateTableNode",table:J,columns:U([])})},cloneWithColumn(J,W){return U({...J,columns:U([...J.columns,W])})},cloneWithConstraint(J,W){return U({...J,constraints:J.constraints?U([...J.constraints,W]):U([W])})},cloneWithFrontModifier(J,W){return U({...J,frontModifiers:J.frontModifiers?U([...J.frontModifiers,W]):U([W])})},cloneWithEndModifier(J,W){return U({...J,endModifiers:J.endModifiers?U([...J.endModifiers,W]):U([W])})},cloneWith(J,W){return U({...J,...W})}})});var U0;var gJ=D(()=>{C();e6();U0=U({is(J){return J.kind==="SchemableIdentifierNode"},create(J){return U({kind:"SchemableIdentifierNode",identifier:X6.create(J)})},createWithSchema(J,W){return U({kind:"SchemableIdentifierNode",schema:X6.create(J),identifier:X6.create(W)})}})});var vW;var DG=D(()=>{C();gJ();vW=U({is(J){return J.kind==="DropIndexNode"},create(J,W){return U({kind:"DropIndexNode",name:U0.create(J),...W})},cloneWith(J,W){return U({...J,...W})}})});var vG;var o$=D(()=>{C();e6();vG=U({is(J){return J.kind==="DropSchemaNode"},create(J,W){return U({kind:"DropSchemaNode",schema:X6.create(J),...W})},cloneWith(J,W){return U({...J,...W})}})});var MG;var s$=D(()=>{C();MG=U({is(J){return J.kind==="DropTableNode"},create(J,W){return U({kind:"DropTableNode",table:J,...W})},cloneWith(J,W){return U({...J,...W})}})});var c4;var f8=D(()=>{C();c4=U({is(J){return J.kind==="AliasNode"},create(J,W){return U({kind:"AliasNode",node:J,alias:W})}})});var e0;var U1=D(()=>{C();gJ();e0=U({is(J){return J.kind==="TableNode"},create(J){return U({kind:"TableNode",table:U0.create(J)})},createWithSchema(J,W){return U({kind:"TableNode",table:U0.createWithSchema(J,W)})}})});function X4(J){return s6(J)&&f6(J.toOperationNode)}var m0=D(()=>{C()});function e$(J){return s6(J)&&"expressionType"in J&&X4(J)}function Bv(J){return s6(J)&&"expression"in J&&h6(J.alias)&&X4(J)}var J5=D(()=>{m0();C()});var HJ;var xH=D(()=>{C();HJ=U({is(J){return J.kind==="SelectModifierNode"},create(J,W){return U({kind:"SelectModifierNode",modifier:J,of:W})},createWithExpression(J){return U({kind:"SelectModifierNode",rawModifier:J})}})});var y0;var MW=D(()=>{C();y0=U({is(J){return J.kind==="AndNode"},create(J,W){return U({kind:"AndNode",left:J,right:W})}})});var g8;var NX=D(()=>{C();g8=U({is(J){return J.kind==="OrNode"},create(J,W){return U({kind:"OrNode",left:J,right:W})}})});var W5;var uH=D(()=>{C();MW();NX();W5=U({is(J){return J.kind==="OnNode"},create(J){return U({kind:"OnNode",on:J})},cloneWithOperation(J,W,X){return U({...J,on:W==="And"?y0.create(J.on,X):g8.create(J.on,X)})}})});var m8;var Q1=D(()=>{C();uH();m8=U({is(J){return J.kind==="JoinNode"},create(J,W){return U({kind:"JoinNode",joinType:J,table:W,on:void 0})},createWithOn(J,W,X){return U({kind:"JoinNode",joinType:J,table:W,on:W5.create(X)})},cloneWithOn(J,W){return U({...J,on:J.on?W5.cloneWithOperation(J.on,"And",W):W5.create(W)})}})});var mJ;var OG=D(()=>{C();mJ=U({is(J){return J.kind==="BinaryOperationNode"},create(J,W,X){return U({kind:"BinaryOperationNode",leftOperand:J,operator:W,rightOperand:X})}})});function lH(J){return h6(J)&&Av.includes(J)}var uE,lE,Av,cE,pE,dE,Ev,Q0;var yJ=D(()=>{C();uE=["=","==","!=","<>",">",">=","<","<=","in","not in","is","is not","like","not like","match","ilike","not ilike","@>","<@","^@","&&","?","?&","?|","!<","!>","<=>","!~","~","~*","!~*","@@","@@@","!!","<->","regexp","is distinct from","is not distinct from"],lE=["+","-","*","/","%","^","&","|","#","<<",">>"],Av=["->","->>"],cE=[...uE,...lE,"&&","||"],pE=["exists","not exists"],dE=["not","-",...pE],Ev=[...cE,...Av,...dE,"between","between symmetric"],Q0=U({is(J){return J.kind==="OperatorNode"},create(J){return U({kind:"OperatorNode",operator:J})}})});var S6;var L0=D(()=>{C();e6();S6=U({is(J){return J.kind==="ColumnNode"},create(J){return U({kind:"ColumnNode",column:X6.create(J)})}})});var L1;var PG=D(()=>{C();L1=U({is(J){return J.kind==="SelectAllNode"},create(){return U({kind:"SelectAllNode"})}})});var V1;var X5=D(()=>{PG();C();V1=U({is(J){return J.kind==="ReferenceNode"},create(J,W){return U({kind:"ReferenceNode",table:W,column:J})},createSelectAll(J){return U({kind:"ReferenceNode",table:J,column:L1.create()})}})});class cH{#J;get dynamicReference(){return this.#J}get refType(){return}constructor(J){this.#J=J}toOperationNode(){return pH(this.#J)}}function Y5(J){return s6(J)&&X4(J)&&h6(J.dynamicReference)}var jG=D(()=>{m0();W0();C()});var y8;var G5=D(()=>{C();y8=U({is(J){return J.kind==="OrderByItemNode"},create(J,W){return U({kind:"OrderByItemNode",orderBy:J,direction:W})},cloneWith(J,W){return U({...J,...W})}})});var B6;var _8=D(()=>{C();B6=U({is(J){return J.kind==="RawNode"},create(J,W){return U({kind:"RawNode",sqlFragments:U(J),parameters:U(W)})},createWithSql(J){return B6.create([J],[])},createWithChild(J){return B6.create(["",""],[J])},createWithChildren(J){return B6.create(Array(J.length+1).fill(""),J)}})});var Rv;var dH=D(()=>{C();e6();Rv={is(J){return J.kind==="CollateNode"},create(J){return U({kind:"CollateNode",collation:X6.create(J)})}}});class OW{#J;constructor(J){this.#J=U(J)}desc(){return new OW({node:y8.cloneWith(this.#J.node,{direction:B6.createWithSql("desc")})})}asc(){return new OW({node:y8.cloneWith(this.#J.node,{direction:B6.createWithSql("asc")})})}nullsLast(){return new OW({node:y8.cloneWith(this.#J.node,{nulls:"last"})})}nullsFirst(){return new OW({node:y8.cloneWith(this.#J.node,{nulls:"first"})})}collate(J){return new OW({node:y8.cloneWith(this.#J.node,{collation:Rv.create(J)})})}toOperationNode(){return this.#J.node}}var nH=D(()=>{dH();G5();_8();C()});function x8(J){if(Cv.has(J))return;Cv.add(J),console.log(J)}var Cv;var D1=D(()=>{Cv=new Set});function iH(J){return J==="asc"||J==="desc"}function W8(J){if(J.length===2)return[rH(J[0],J[1])];if(J.length===1){let[W]=J;if(Array.isArray(W))return x8("orderBy(array) is deprecated, use multiple orderBy calls instead."),W.map((X)=>rH(X));return[rH(W)]}throw Error(`Invalid number of arguments at order by! expected 1-2, received ${J.length}`)}function rH(J,W){let X=nE(J);if(y8.is(X)){if(W)throw Error("Cannot specify direction twice!");return X}return Iv(X,W)}function nE(J){if(xJ(J))return x0(J);if(Y5(J))return J.toOperationNode();let[W,X]=J.split(" ");if(X)return x8("`orderBy('column asc')` is deprecated. Use `orderBy('column', 'asc')` instead."),Iv(J8(W),X);return J8(J)}function Iv(J,W){if(typeof W==="string"){if(!iH(W))throw Error(`Invalid order by direction: ${W}`);return y8.create(J,B6.createWithSql(W))}if(e$(W))return x8("`orderBy(..., expr)` is deprecated. Use `orderBy(..., 'asc')` or `orderBy(..., (ob) => ...)` instead."),y8.create(J,W.toOperationNode());let X=y8.create(J);if(!W)return X;return W(new OW({node:X})).toOperationNode()}var UX=D(()=>{jG();J5();G5();_8();nH();D1();u8();W0()});var v1;var $5=D(()=>{C();v1=U({is(J){return J.kind==="JSONReferenceNode"},create(J,W){return U({kind:"JSONReferenceNode",reference:J,traversal:W})},cloneWithTraversal(J,W){return U({...J,traversal:W})}})});var K5;var w5=D(()=>{C();K5=U({is(J){return J.kind==="JSONOperatorChainNode"},create(J){return U({kind:"JSONOperatorChainNode",operator:J,values:U([])})},cloneWithValue(J,W){return U({...J,values:U([...J.values,W])})}})});var PW;var _G=D(()=>{C();PW=U({is(J){return J.kind==="JSONPathNode"},create(J){return U({kind:"JSONPathNode",inOperator:J,pathLegs:U([])})},cloneWithLeg(J,W){return U({...J,pathLegs:U([...J.pathLegs,W])})}})});function pH(J){if(h6(J))return J8(J);return J.toOperationNode()}function uJ(J){if(l4(J))return J.map((W)=>X0(W));else return[X0(J)]}function X0(J){if(xJ(J))return x0(J);return pH(J)}function bv(J,W){let X=J8(J);if(lH(W))return v1.create(X,K5.create(Q0.create(W)));let G=W.slice(0,-1);if(lH(G))return v1.create(X,PW.create(Q0.create(G)));throw Error(`Invalid JSON operator: ${W}`)}function J8(J){if(!J.includes("."))return V1.create(S6.create(J));let X=J.split(".").map(tH);if(X.length===3)return rE(X);if(X.length===2)return iE(X);throw Error(`invalid column reference ${J}`)}function kv(J){if(J.includes(" as ")){let[X,G]=J.split(" as ").map(tH);return c4.create(J8(X),X6.create(G))}else return J8(J)}function aH(J){return S6.create(J)}function M1(J){if(J.includes(" ")){let[X,G]=J.split(" ").map(tH);if(!iH(G))throw Error(`invalid order direction "${G}" next to "${X}"`);return W8([X,G])[0]}else return aH(J)}function rE(J){let[W,X,G]=J;return V1.create(S6.create(G),e0.createWithSchema(W,X))}function iE(J){let[W,X]=J;return V1.create(S6.create(X),e0.create(W))}function tH(J){return J.trim()}var W0=D(()=>{f8();L0();X5();U1();C();u8();e6();UX();yJ();$5();w5();_G()});var O1;var SG=D(()=>{C();O1=U({is(J){return J.kind==="PrimitiveValueListNode"},create(J){return U({kind:"PrimitiveValueListNode",values:U([...J])})}})});var l8;var jW=D(()=>{C();l8=U({is(J){return J.kind==="ValueListNode"},create(J){return U({kind:"ValueListNode",values:U(J)})}})});var E4;var c8=D(()=>{C();E4=U({is(J){return J.kind==="ValueNode"},create(J){return U({kind:"ValueNode",value:J})},createImmediate(J){return U({kind:"ValueNode",value:J,immediate:!0})}})});function hv(J){if(l4(J))return aE(J);return i6(J)}function i6(J){if(xJ(J))return x0(J);return E4.create(J)}function H5(J){return k8(J)||fJ(J)||VW(J)}function TG(J){if(!H5(J))throw Error(`unsafe immediate value ${JSON.stringify(J)}`);return E4.createImmediate(J)}function aE(J){if(J.some(xJ))return l8.create(J.map((W)=>i6(W)));return O1.create(J)}var ZJ=D(()=>{SG();jW();c8();C();u8()});var X8;var P1=D(()=>{C();X8=U({is(J){return J.kind==="ParensNode"},create(J){return U({kind:"ParensNode",node:J})}})});function J4(J){if(J.length===3)return Z5(J[0],J[1],J[2]);else if(J.length===1)return i6(J[0]);throw Error(`invalid arguments: ${JSON.stringify(J)}`)}function Z5(J,W,X){if(tE(W)&&gv(X))return mJ.create(X0(J),oH(W),E4.createImmediate(X));return mJ.create(X0(J),oH(W),hv(X))}function p4(J,W,X){return mJ.create(X0(J),oH(W),X0(X))}function sH(J,W){return j1(Object.entries(J).filter(([,X])=>!T0(X)).map(([X,G])=>Z5(X,gv(G)?"is":"=",G)),W)}function j1(J,W,X=!0){let G=W==="and"?y0.create:g8.create;if(J.length===0)return mJ.create(E4.createImmediate(1),Q0.create("="),E4.createImmediate(W==="and"?1:0));let Y=fv(J[0]);for(let $=1;$<J.length;++$)Y=G(Y,fv(J[$]));if(J.length>1&&X)return X8.create(Y);return Y}function tE(J){return J==="is"||J==="is not"}function gv(J){return VW(J)||fJ(J)}function oH(J){if(h6(J)&&Ev.includes(J))return Q0.create(J);if(X4(J))return J.toOperationNode();throw Error(`invalid operator ${JSON.stringify(J)}`)}function fv(J){return X4(J)?J.toOperationNode():J}var Y8=D(()=>{OG();C();m0();yJ();W0();ZJ();c8();MW();P1();NX()});var lJ;var qG=D(()=>{C();lJ=U({is(J){return J.kind==="OrderByNode"},create(J){return U({kind:"OrderByNode",items:U([...J])})},cloneWithItems(J,W){return U({...J,items:U([...J.items,...W])})}})});var eH;var JZ=D(()=>{C();eH=U({is(J){return J.kind==="PartitionByNode"},create(J){return U({kind:"PartitionByNode",items:U(J)})},cloneWithItems(J,W){return U({...J,items:U([...J.items,...W])})}})});var BG;var z5=D(()=>{C();qG();JZ();BG=U({is(J){return J.kind==="OverNode"},create(){return U({kind:"OverNode"})},cloneWithOrderByItems(J,W){return U({...J,orderBy:J.orderBy?lJ.cloneWithItems(J.orderBy,W):lJ.create(W)})},cloneWithPartitionByItems(J,W){return U({...J,partitionBy:J.partitionBy?eH.cloneWithItems(J.partitionBy,W):eH.create(W)})}})});var QX;var AG=D(()=>{C();QX=U({is(J){return J.kind==="FromNode"},create(J){return U({kind:"FromNode",froms:U(J)})},cloneWithFroms(J,W){return U({...J,froms:U([...J.froms,...W])})}})});var WZ;var XZ=D(()=>{C();WZ=U({is(J){return J.kind==="GroupByNode"},create(J){return U({kind:"GroupByNode",items:U(J)})},cloneWithItems(J,W){return U({...J,items:U([...J.items,...W])})}})});var YZ;var GZ=D(()=>{C();MW();NX();YZ=U({is(J){return J.kind==="HavingNode"},create(J){return U({kind:"HavingNode",having:J})},cloneWithOperation(J,W,X){return U({...J,having:W==="And"?y0.create(J.having,X):g8.create(J.having,X)})}})});var S4;var LX=D(()=>{C();S4=U({is(J){return J.kind==="InsertQueryNode"},create(J,W,X){return U({kind:"InsertQueryNode",into:J,...W&&{with:W},replace:X})},createWithoutInto(){return U({kind:"InsertQueryNode"})},cloneWith(J,W){return U({...J,...W})}})});var F5;var N5=D(()=>{C();F5=U({is(J){return J.kind==="ListNode"},create(J){return U({kind:"ListNode",items:U(J)})}})});var zJ;var _1=D(()=>{C();AG();N5();zJ=U({is(J){return J.kind==="UpdateQueryNode"},create(J,W){return U({kind:"UpdateQueryNode",table:J.length===1?J[0]:F5.create(J),...W&&{with:W}})},createWithoutTable(){return U({kind:"UpdateQueryNode"})},cloneWithFromItems(J,W){return U({...J,from:J.from?QX.cloneWithFroms(J.from,W):QX.create(W)})},cloneWithUpdates(J,W){return U({...J,updates:J.updates?U([...J.updates,...W]):W})},cloneWithLimit(J,W){return U({...J,limit:W})}})});var $Z;var KZ=D(()=>{C();$Z=U({is(J){return J.kind==="UsingNode"},create(J){return U({kind:"UsingNode",tables:U(J)})},cloneWithTables(J,W){return U({...J,tables:U([...J.tables,...W])})}})});var _W;var EG=D(()=>{C();AG();KZ();S8();_W=U({is(J){return J.kind==="DeleteQueryNode"},create(J,W){return U({kind:"DeleteQueryNode",from:QX.create(J),...W&&{with:W}})},cloneWithOrderByItems:(J,W)=>a.cloneWithOrderByItems(J,W),cloneWithoutOrderBy:(J)=>a.cloneWithoutOrderBy(J),cloneWithLimit(J,W){return U({...J,limit:W})},cloneWithoutLimit(J){return U({...J,limit:void 0})},cloneWithUsing(J,W){return U({...J,using:J.using!==void 0?$Z.cloneWithTables(J.using,W):$Z.create(W)})}})});var Y0;var RG=D(()=>{C();MW();NX();Y0=U({is(J){return J.kind==="WhereNode"},create(J){return U({kind:"WhereNode",where:J})},cloneWithOperation(J,W,X){return U({...J,where:W==="And"?y0.create(J.where,X):g8.create(J.where,X)})}})});var wZ;var HZ=D(()=>{C();wZ=U({is(J){return J.kind==="ReturningNode"},create(J){return U({kind:"ReturningNode",selections:U(J)})},cloneWithSelections(J,W){return U({...J,selections:J.selections?U([...J.selections,...W]):U(W)})}})});var mv;var ZZ=D(()=>{C();mv=U({is(J){return J.kind==="ExplainNode"},create(J,W){return U({kind:"ExplainNode",format:J,options:W})}})});var T8;var VX=D(()=>{C();T8=U({is(J){return J.kind==="WhenNode"},create(J){return U({kind:"WhenNode",condition:J})},cloneWithResult(J,W){return U({...J,result:W})}})});var G8;var CG=D(()=>{C();VX();G8=U({is(J){return J.kind==="MergeQueryNode"},create(J,W){return U({kind:"MergeQueryNode",into:J,...W&&{with:W}})},cloneWithUsing(J,W){return U({...J,using:W})},cloneWithWhen(J,W){return U({...J,whens:J.whens?U([...J.whens,W]):U([W])})},cloneWithThen(J,W){return U({...J,whens:J.whens?U([...J.whens.slice(0,-1),T8.cloneWithResult(J.whens[J.whens.length-1],W)]):void 0})}})});var zZ;var FZ=D(()=>{C();zZ=U({is(J){return J.kind==="OutputNode"},create(J){return U({kind:"OutputNode",selections:U(J)})},cloneWithSelections(J,W){return U({...J,selections:J.selections?U([...J.selections,...W]):U(W)})}})});var a;var S8=D(()=>{LX();SW();_1();EG();RG();C();HZ();ZZ();CG();FZ();qG();a=U({is(J){return T6.is(J)||S4.is(J)||zJ.is(J)||_W.is(J)||G8.is(J)},cloneWithEndModifier(J,W){return U({...J,endModifiers:J.endModifiers?U([...J.endModifiers,W]):U([W])})},cloneWithWhere(J,W){return U({...J,where:J.where?Y0.cloneWithOperation(J.where,"And",W):Y0.create(W)})},cloneWithJoin(J,W){return U({...J,joins:J.joins?U([...J.joins,W]):U([W])})},cloneWithReturning(J,W){return U({...J,returning:J.returning?wZ.cloneWithSelections(J.returning,W):wZ.create(W)})},cloneWithoutReturning(J){return U({...J,returning:void 0})},cloneWithoutWhere(J){return U({...J,where:void 0})},cloneWithExplain(J,W,X){return U({...J,explain:mv.create(W,X?.toOperationNode())})},cloneWithTop(J,W){return U({...J,top:W})},cloneWithOutput(J,W){return U({...J,output:J.output?zZ.cloneWithSelections(J.output,W):zZ.create(W)})},cloneWithOrderByItems(J,W){return U({...J,orderBy:J.orderBy?lJ.cloneWithItems(J.orderBy,W):lJ.create(W)})},cloneWithoutOrderBy(J){return U({...J,orderBy:void 0})}})});var T6;var SW=D(()=>{C();AG();XZ();GZ();S8();T6=U({is(J){return J.kind==="SelectQueryNode"},create(J){return U({kind:"SelectQueryNode",...J&&{with:J}})},createFrom(J,W){return U({kind:"SelectQueryNode",from:QX.create(J),...W&&{with:W}})},cloneWithSelections(J,W){return U({...J,selections:J.selections?U([...J.selections,...W]):U(W)})},cloneWithDistinctOn(J,W){return U({...J,distinctOn:J.distinctOn?U([...J.distinctOn,...W]):U(W)})},cloneWithFrontModifier(J,W){return U({...J,frontModifiers:J.frontModifiers?U([...J.frontModifiers,W]):U([W])})},cloneWithOrderByItems:(J,W)=>a.cloneWithOrderByItems(J,W),cloneWithGroupByItems(J,W){return U({...J,groupBy:J.groupBy?WZ.cloneWithItems(J.groupBy,W):WZ.create(W)})},cloneWithLimit(J,W){return U({...J,limit:W})},cloneWithOffset(J,W){return U({...J,offset:W})},cloneWithFetch(J,W){return U({...J,fetch:W})},cloneWithHaving(J,W){return U({...J,having:J.having?YZ.cloneWithOperation(J.having,"And",W):YZ.create(W)})},cloneWithSetOperations(J,W){return U({...J,setOperations:J.setOperations?U([...J.setOperations,...W]):U([...W])})},cloneWithoutSelections(J){return U({...J,selections:[]})},cloneWithoutLimit(J){return U({...J,limit:void 0})},cloneWithoutOffset(J){return U({...J,offset:void 0})},cloneWithoutOrderBy:(J)=>a.cloneWithoutOrderBy(J),cloneWithoutGroupBy(J){return U({...J,groupBy:void 0})}})});class S1{#J;constructor(J){this.#J=U(J)}on(...J){return new S1({...this.#J,joinNode:m8.cloneWithOn(this.#J.joinNode,J4(J))})}onRef(J,W,X){return new S1({...this.#J,joinNode:m8.cloneWithOn(this.#J.joinNode,p4(J,W,X))})}onTrue(){return new S1({...this.#J,joinNode:m8.cloneWithOn(this.#J.joinNode,B6.createWithSql("true"))})}$call(J){return J(this)}toOperationNode(){return this.#J.joinNode}}var NZ=D(()=>{Q1();_8();Y8();C()});var yv;var UZ=D(()=>{C();yv=U({is(J){return J.kind==="PartitionByItemNode"},create(J){return U({kind:"PartitionByItemNode",partitionBy:J})}})});function xv(J){return uJ(J).map(yv.create)}var uv=D(()=>{UZ();W0()});class T1{#J;constructor(J){this.#J=U(J)}orderBy(...J){return new T1({overNode:BG.cloneWithOrderByItems(this.#J.overNode,W8(J))})}clearOrderBy(){return new T1({overNode:a.cloneWithoutOrderBy(this.#J.overNode)})}partitionBy(J){return new T1({overNode:BG.cloneWithPartitionByItems(this.#J.overNode,xv(J))})}$call(J){return J(this)}toOperationNode(){return this.#J.overNode}}var lv=D(()=>{z5();S8();UX();uv();C()});var q1;var QZ=D(()=>{C();X5();PG();q1=U({is(J){return J.kind==="SelectionNode"},create(J){return U({kind:"SelectionNode",selection:J})},createSelectAll(){return U({kind:"SelectionNode",selection:L1.create()})},createSelectAllFromTable(J){return U({kind:"SelectionNode",selection:V1.createSelectAll(J)})}})});function g4(J){if(f6(J))return g4(J(q8()));else if(l4(J))return J.map((W)=>cv(W));else return[cv(J)]}function cv(J){if(h6(J))return q1.create(kv(J));else if(Y5(J))return q1.create(J.toOperationNode());else return q1.create(U5(J))}function d4(J){if(!J)return[q1.createSelectAll()];else if(Array.isArray(J))return J.map(pv);else return[pv(J)]}function pv(J){if(h6(J))return q1.createSelectAllFromTable(A6(J));throw Error(`invalid value selectAll expression: ${JSON.stringify(J)}`)}var TW=D(()=>{C();QZ();W0();jG();u8();G0();qW()});var dv;var LZ=D(()=>{C();dv=U({is(J){return J.kind==="ValuesNode"},create(J){return U({kind:"ValuesNode",values:U(J)})}})});var nv;var VZ=D(()=>{C();nv=U({is(J){return J.kind==="DefaultInsertValueNode"},create(){return U({kind:"DefaultInsertValueNode"})}})});function Q5(J){let W=f6(J)?J(q8()):J,X=l4(W)?W:U([W]);return oE(X)}function oE(J){let W=sE(J);return[U([...W.keys()].map(S6.create)),dv.create(J.map((X)=>eE(X,W)))]}function sE(J){let W=new Map;for(let X of J){let G=Object.keys(X);for(let Y of G)if(!W.has(Y)&&X[Y]!==void 0)W.set(Y,W.size)}return W}function eE(J,W){let X=Object.keys(J),G=Array.from({length:W.size}),Y=!1,$=X.length;for(let w of X){let H=W.get(w);if(T0(H)){$--;continue}let Z=J[w];if(T0(Z)||xJ(Z))Y=!0;G[H]=Z}if($<W.size||Y){let w=nv.create();return l8.create(G.map((H)=>T0(H)?w:i6(H)))}return O1.create(G)}var DZ=D(()=>{L0();SG();jW();C();ZJ();LZ();u8();VZ();qW()});var vZ;var MZ=D(()=>{C();vZ=U({is(J){return J.kind==="ColumnUpdateNode"},create(J,W){return U({kind:"ColumnUpdateNode",column:J,value:W})}})});function rv(...J){if(J.length===2)return[vZ.create(X0(J[0]),i6(J[1]))];return IG(J[0])}function IG(J){let W=f6(J)?J(q8()):J;return Object.entries(W).filter(([X,G])=>G!==void 0).map(([X,G])=>{return vZ.create(S6.create(X),i6(G))})}var L5=D(()=>{L0();MZ();qW();C();ZJ();W0()});var iv;var OZ=D(()=>{C();iv=U({is(J){return J.kind==="OnDuplicateKeyNode"},create(J){return U({kind:"OnDuplicateKeyNode",updates:J})}})});class PZ{insertId;numInsertedOrUpdatedRows;constructor(J,W){this.insertId=J,this.numInsertedOrUpdatedRows=W}}function FJ(J){return Object.prototype.hasOwnProperty.call(J,"prototype")}var p8;var DX=D(()=>{p8=class p8 extends Error{node;constructor(J){super("no result");this.node=J}}});var B0;var V5=D(()=>{C();RG();B0=U({is(J){return J.kind==="OnConflictNode"},create(){return U({kind:"OnConflictNode"})},cloneWith(J,W){return U({...J,...W})},cloneWithIndexWhere(J,W){return U({...J,indexWhere:J.indexWhere?Y0.cloneWithOperation(J.indexWhere,"And",W):Y0.create(W)})},cloneWithIndexOrWhere(J,W){return U({...J,indexWhere:J.indexWhere?Y0.cloneWithOperation(J.indexWhere,"Or",W):Y0.create(W)})},cloneWithUpdateWhere(J,W){return U({...J,updateWhere:J.updateWhere?Y0.cloneWithOperation(J.updateWhere,"And",W):Y0.create(W)})},cloneWithUpdateOrWhere(J,W){return U({...J,updateWhere:J.updateWhere?Y0.cloneWithOperation(J.updateWhere,"Or",W):Y0.create(W)})},cloneWithoutIndexWhere(J){return U({...J,indexWhere:void 0})},cloneWithoutUpdateWhere(J){return U({...J,updateWhere:void 0})}})});class NJ{#J;constructor(J){this.#J=U(J)}column(J){let W=S6.create(J);return new NJ({...this.#J,onConflictNode:B0.cloneWith(this.#J.onConflictNode,{columns:this.#J.onConflictNode.columns?U([...this.#J.onConflictNode.columns,W]):U([W])})})}columns(J){let W=J.map(S6.create);return new NJ({...this.#J,onConflictNode:B0.cloneWith(this.#J.onConflictNode,{columns:this.#J.onConflictNode.columns?U([...this.#J.onConflictNode.columns,...W]):U(W)})})}constraint(J){return new NJ({...this.#J,onConflictNode:B0.cloneWith(this.#J.onConflictNode,{constraint:X6.create(J)})})}expression(J){return new NJ({...this.#J,onConflictNode:B0.cloneWith(this.#J.onConflictNode,{indexExpression:J.toOperationNode()})})}where(...J){return new NJ({...this.#J,onConflictNode:B0.cloneWithIndexWhere(this.#J.onConflictNode,J4(J))})}whereRef(J,W,X){return new NJ({...this.#J,onConflictNode:B0.cloneWithIndexWhere(this.#J.onConflictNode,p4(J,W,X))})}clearWhere(){return new NJ({...this.#J,onConflictNode:B0.cloneWithoutIndexWhere(this.#J.onConflictNode)})}doNothing(){return new av({...this.#J,onConflictNode:B0.cloneWith(this.#J.onConflictNode,{doNothing:!0})})}doUpdateSet(J){return new bG({...this.#J,onConflictNode:B0.cloneWith(this.#J.onConflictNode,{updates:IG(J)})})}$call(J){return J(this)}}class av{#J;constructor(J){this.#J=U(J)}toOperationNode(){return this.#J.onConflictNode}}class bG{#J;constructor(J){this.#J=U(J)}where(...J){return new bG({...this.#J,onConflictNode:B0.cloneWithUpdateWhere(this.#J.onConflictNode,J4(J))})}whereRef(J,W,X){return new bG({...this.#J,onConflictNode:B0.cloneWithUpdateWhere(this.#J.onConflictNode,p4(J,W,X))})}clearWhere(){return new bG({...this.#J,onConflictNode:B0.cloneWithoutUpdateWhere(this.#J.onConflictNode)})}$call(J){return J(this)}toOperationNode(){return this.#J.onConflictNode}}var jZ=D(()=>{L0();e6();V5();Y8();L5();C()});var tv;var _Z=D(()=>{C();tv=U({is(J){return J.kind==="TopNode"},create(J,W){return U({kind:"TopNode",expression:J,modifiers:W})}})});function d8(J,W){if(!k8(J)&&!DW(J))throw Error(`Invalid top expression: ${J}`);if(!T0(W)&&!JR(W))throw Error(`Invalid top modifiers: ${W}`);return tv.create(J,W)}function JR(J){return J==="percent"||J==="with ties"||J==="percent with ties"}var B1=D(()=>{_Z();C()});var vX;var SZ=D(()=>{C();vX=U({is(J){return J.kind==="OrActionNode"},create(J){return U({kind:"OrActionNode",action:J})}})});class a6{#J;constructor(J){this.#J=U(J)}values(J){let[W,X]=Q5(J);return new a6({...this.#J,queryNode:S4.cloneWith(this.#J.queryNode,{columns:W,values:X})})}columns(J){return new a6({...this.#J,queryNode:S4.cloneWith(this.#J.queryNode,{columns:U(J.map(S6.create))})})}expression(J){return new a6({...this.#J,queryNode:S4.cloneWith(this.#J.queryNode,{values:x0(J)})})}defaultValues(){return new a6({...this.#J,queryNode:S4.cloneWith(this.#J.queryNode,{defaultValues:!0})})}modifyEnd(J){return new a6({...this.#J,queryNode:a.cloneWithEndModifier(this.#J.queryNode,J.toOperationNode())})}ignore(){return new a6({...this.#J,queryNode:S4.cloneWith(this.#J.queryNode,{orAction:vX.create("ignore")})})}orIgnore(){return new a6({...this.#J,queryNode:S4.cloneWith(this.#J.queryNode,{orAction:vX.create("ignore")})})}orAbort(){return new a6({...this.#J,queryNode:S4.cloneWith(this.#J.queryNode,{orAction:vX.create("abort")})})}orFail(){return new a6({...this.#J,queryNode:S4.cloneWith(this.#J.queryNode,{orAction:vX.create("fail")})})}orReplace(){return new a6({...this.#J,queryNode:S4.cloneWith(this.#J.queryNode,{orAction:vX.create("replace")})})}orRollback(){return new a6({...this.#J,queryNode:S4.cloneWith(this.#J.queryNode,{orAction:vX.create("rollback")})})}top(J,W){return new a6({...this.#J,queryNode:a.cloneWithTop(this.#J.queryNode,d8(J,W))})}onConflict(J){return new a6({...this.#J,queryNode:S4.cloneWith(this.#J.queryNode,{onConflict:J(new NJ({onConflictNode:B0.create()})).toOperationNode()})})}onDuplicateKeyUpdate(J){return new a6({...this.#J,queryNode:S4.cloneWith(this.#J.queryNode,{onDuplicateKey:iv.create(IG(J))})})}returning(J){return new a6({...this.#J,queryNode:a.cloneWithReturning(this.#J.queryNode,g4(J))})}returningAll(){return new a6({...this.#J,queryNode:a.cloneWithReturning(this.#J.queryNode,d4())})}output(J){return new a6({...this.#J,queryNode:a.cloneWithOutput(this.#J.queryNode,g4(J))})}outputAll(J){return new a6({...this.#J,queryNode:a.cloneWithOutput(this.#J.queryNode,d4(J))})}clearReturning(){return new a6({...this.#J,queryNode:a.cloneWithoutReturning(this.#J.queryNode)})}$call(J){return J(this)}$if(J,W){if(J)return W(this);return new a6({...this.#J})}$castTo(){return new a6(this.#J)}$narrowType(){return new a6(this.#J)}$assertType(){return new a6(this.#J)}withPlugin(J){return new a6({...this.#J,executor:this.#J.executor.withPlugin(J)})}toOperationNode(){return this.#J.executor.transformQuery(this.#J.queryNode,this.#J.queryId)}compile(){return this.#J.executor.compileQuery(this.toOperationNode(),this.#J.queryId)}async execute(){let J=this.compile(),W=await this.#J.executor.executeQuery(J),{adapter:X}=this.#J.executor,G=J.query;if(G.returning&&X.supportsReturning||G.output&&X.supportsOutput)return W.rows;return[new PZ(W.insertId,W.numAffectedRows??BigInt(0))]}async executeTakeFirst(){let[J]=await this.execute();return J}async executeTakeFirstOrThrow(J=p8){let W=await this.executeTakeFirst();if(W===void 0)throw FJ(J)?new J(this.toOperationNode()):J(this.toOperationNode());return W}async*stream(J=100){let W=this.compile(),X=this.#J.executor.stream(W,J);for await(let G of X)yield*G.rows}async explain(J,W){return await new a6({...this.#J,queryNode:a.cloneWithExplain(this.#J.queryNode,J,W)}).execute()}}var TZ=D(()=>{TW();DZ();LX();S8();L5();C();OZ();DX();u8();L0();jZ();V5();B1();SZ()});class qZ{numDeletedRows;constructor(J){this.numDeletedRows=J}}var A1;var kG=D(()=>{C();A1=U({is(J){return J.kind==="LimitNode"},create(J){return U({kind:"LimitNode",limit:J})}})});class Q4{#J;constructor(J){this.#J=U(J)}where(...J){return new Q4({...this.#J,queryNode:a.cloneWithWhere(this.#J.queryNode,J4(J))})}whereRef(J,W,X){return new Q4({...this.#J,queryNode:a.cloneWithWhere(this.#J.queryNode,p4(J,W,X))})}clearWhere(){return new Q4({...this.#J,queryNode:a.cloneWithoutWhere(this.#J.queryNode)})}top(J,W){return new Q4({...this.#J,queryNode:a.cloneWithTop(this.#J.queryNode,d8(J,W))})}using(J){return new Q4({...this.#J,queryNode:_W.cloneWithUsing(this.#J.queryNode,n8(J))})}innerJoin(...J){return this.#W("InnerJoin",J)}leftJoin(...J){return this.#W("LeftJoin",J)}rightJoin(...J){return this.#W("RightJoin",J)}fullJoin(...J){return this.#W("FullJoin",J)}#W(J,W){return new Q4({...this.#J,queryNode:a.cloneWithJoin(this.#J.queryNode,BW(J,W))})}returning(J){return new Q4({...this.#J,queryNode:a.cloneWithReturning(this.#J.queryNode,g4(J))})}returningAll(J){return new Q4({...this.#J,queryNode:a.cloneWithReturning(this.#J.queryNode,d4(J))})}output(J){return new Q4({...this.#J,queryNode:a.cloneWithOutput(this.#J.queryNode,g4(J))})}outputAll(J){return new Q4({...this.#J,queryNode:a.cloneWithOutput(this.#J.queryNode,d4(J))})}clearReturning(){return new Q4({...this.#J,queryNode:a.cloneWithoutReturning(this.#J.queryNode)})}clearLimit(){return new Q4({...this.#J,queryNode:_W.cloneWithoutLimit(this.#J.queryNode)})}orderBy(...J){return new Q4({...this.#J,queryNode:a.cloneWithOrderByItems(this.#J.queryNode,W8(J))})}clearOrderBy(){return new Q4({...this.#J,queryNode:a.cloneWithoutOrderBy(this.#J.queryNode)})}limit(J){return new Q4({...this.#J,queryNode:_W.cloneWithLimit(this.#J.queryNode,A1.create(i6(J)))})}modifyEnd(J){return new Q4({...this.#J,queryNode:a.cloneWithEndModifier(this.#J.queryNode,J.toOperationNode())})}$call(J){return J(this)}$if(J,W){if(J)return W(this);return new Q4({...this.#J})}$castTo(){return new Q4(this.#J)}$narrowType(){return new Q4(this.#J)}$assertType(){return new Q4(this.#J)}withPlugin(J){return new Q4({...this.#J,executor:this.#J.executor.withPlugin(J)})}toOperationNode(){return this.#J.executor.transformQuery(this.#J.queryNode,this.#J.queryId)}compile(){return this.#J.executor.compileQuery(this.toOperationNode(),this.#J.queryId)}async execute(){let J=this.compile(),W=await this.#J.executor.executeQuery(J),{adapter:X}=this.#J.executor,G=J.query;if(G.returning&&X.supportsReturning||G.output&&X.supportsOutput)return W.rows;return[new qZ(W.numAffectedRows??BigInt(0))]}async executeTakeFirst(){let[J]=await this.execute();return J}async executeTakeFirstOrThrow(J=p8){let W=await this.executeTakeFirst();if(W===void 0)throw FJ(J)?new J(this.toOperationNode()):J(this.toOperationNode());return W}async*stream(J=100){let W=this.compile(),X=this.#J.executor.stream(W,J);for await(let G of X)yield*G.rows}async explain(J,W){return await new Q4({...this.#J,queryNode:a.cloneWithExplain(this.#J.queryNode,J,W)}).execute()}}var BZ=D(()=>{hG();G0();TW();S8();C();DX();EG();kG();UX();Y8();ZJ();B1()});class AZ{numUpdatedRows;numChangedRows;constructor(J,W){this.numUpdatedRows=J,this.numChangedRows=W}}class Y4{#J;constructor(J){this.#J=U(J)}where(...J){return new Y4({...this.#J,queryNode:a.cloneWithWhere(this.#J.queryNode,J4(J))})}whereRef(J,W,X){return new Y4({...this.#J,queryNode:a.cloneWithWhere(this.#J.queryNode,p4(J,W,X))})}clearWhere(){return new Y4({...this.#J,queryNode:a.cloneWithoutWhere(this.#J.queryNode)})}top(J,W){return new Y4({...this.#J,queryNode:a.cloneWithTop(this.#J.queryNode,d8(J,W))})}from(J){return new Y4({...this.#J,queryNode:zJ.cloneWithFromItems(this.#J.queryNode,n8(J))})}innerJoin(...J){return this.#W("InnerJoin",J)}leftJoin(...J){return this.#W("LeftJoin",J)}rightJoin(...J){return this.#W("RightJoin",J)}fullJoin(...J){return this.#W("FullJoin",J)}#W(J,W){return new Y4({...this.#J,queryNode:a.cloneWithJoin(this.#J.queryNode,BW(J,W))})}orderBy(...J){return new Y4({...this.#J,queryNode:a.cloneWithOrderByItems(this.#J.queryNode,W8(J))})}clearOrderBy(){return new Y4({...this.#J,queryNode:a.cloneWithoutOrderBy(this.#J.queryNode)})}limit(J){return new Y4({...this.#J,queryNode:zJ.cloneWithLimit(this.#J.queryNode,A1.create(i6(J)))})}set(...J){return new Y4({...this.#J,queryNode:zJ.cloneWithUpdates(this.#J.queryNode,rv(...J))})}returning(J){return new Y4({...this.#J,queryNode:a.cloneWithReturning(this.#J.queryNode,g4(J))})}returningAll(J){return new Y4({...this.#J,queryNode:a.cloneWithReturning(this.#J.queryNode,d4(J))})}output(J){return new Y4({...this.#J,queryNode:a.cloneWithOutput(this.#J.queryNode,g4(J))})}outputAll(J){return new Y4({...this.#J,queryNode:a.cloneWithOutput(this.#J.queryNode,d4(J))})}modifyEnd(J){return new Y4({...this.#J,queryNode:a.cloneWithEndModifier(this.#J.queryNode,J.toOperationNode())})}clearReturning(){return new Y4({...this.#J,queryNode:a.cloneWithoutReturning(this.#J.queryNode)})}$call(J){return J(this)}$if(J,W){if(J)return W(this);return new Y4({...this.#J})}$castTo(){return new Y4(this.#J)}$narrowType(){return new Y4(this.#J)}$assertType(){return new Y4(this.#J)}withPlugin(J){return new Y4({...this.#J,executor:this.#J.executor.withPlugin(J)})}toOperationNode(){return this.#J.executor.transformQuery(this.#J.queryNode,this.#J.queryId)}compile(){return this.#J.executor.compileQuery(this.toOperationNode(),this.#J.queryId)}async execute(){let J=this.compile(),W=await this.#J.executor.executeQuery(J),{adapter:X}=this.#J.executor,G=J.query;if(G.returning&&X.supportsReturning||G.output&&X.supportsOutput)return W.rows;return[new AZ(W.numAffectedRows??BigInt(0),W.numChangedRows)]}async executeTakeFirst(){let[J]=await this.execute();return J}async executeTakeFirstOrThrow(J=p8){let W=await this.executeTakeFirst();if(W===void 0)throw FJ(J)?new J(this.toOperationNode()):J(this.toOperationNode());return W}async*stream(J=100){let W=this.compile(),X=this.#J.executor.stream(W,J);for await(let G of X)yield*G.rows}async explain(J,W){return await new Y4({...this.#J,queryNode:a.cloneWithExplain(this.#J.queryNode,J,W)}).execute()}}var D5=D(()=>{hG();G0();TW();S8();_1();L5();C();DX();Y8();ZJ();kG();B1();UX()});var EZ;var RZ=D(()=>{C();L0();U1();EZ=U({is(J){return J.kind==="CommonTableExpressionNameNode"},create(J,W){return U({kind:"CommonTableExpressionNameNode",table:e0.create(J),columns:W?U(W.map(S6.create)):void 0})}})});var E1;var v5=D(()=>{C();E1=U({is(J){return J.kind==="CommonTableExpressionNode"},create(J,W){return U({kind:"CommonTableExpressionNode",name:J,expression:W})},cloneWith(J,W){return U({...J,...W})}})});class fG{#J;constructor(J){this.#J=U(J)}materialized(){return new fG({...this.#J,node:E1.cloneWith(this.#J.node,{materialized:!0})})}notMaterialized(){return new fG({...this.#J,node:E1.cloneWith(this.#J.node,{materialized:!1})})}toOperationNode(){return this.#J.node}}var ov=D(()=>{v5();C()});function CZ(J,W){let X=W(JM()).toOperationNode();if(f6(J))return J(WR(X)).toOperationNode();return E1.create(sv(J),X)}function WR(J){return(W)=>{return new fG({node:E1.create(sv(W),J)})}}function sv(J){if(J.includes("(")){let W=J.split(/[\(\)]/),X=W[0],G=W[1].split(",").map((Y)=>Y.trim());return EZ.create(X,G)}else return EZ.create(J)}var ev=D(()=>{RZ();M5();C();ov();v5()});var gG;var IZ=D(()=>{C();gG=U({is(J){return J.kind==="WithNode"},create(J,W){return U({kind:"WithNode",expressions:U([J]),...W})},cloneWithExpression(J,W){return U({...J,expressions:U([...J.expressions,W])})}})});function O5(J){let W="";for(let X=0;X<J;++X)W+=XR();return W}function XR(){return WM[~~(Math.random()*WM.length)]}var WM;var bZ=D(()=>{WM=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"]});function w6(){return new XM}class XM{#J;get queryId(){if(this.#J===void 0)this.#J=O5(8);return this.#J}}var B8=D(()=>{bZ()});function n(J){return J}class r8{nodeStack=[];#J=U({AliasNode:this.transformAlias.bind(this),ColumnNode:this.transformColumn.bind(this),IdentifierNode:this.transformIdentifier.bind(this),SchemableIdentifierNode:this.transformSchemableIdentifier.bind(this),RawNode:this.transformRaw.bind(this),ReferenceNode:this.transformReference.bind(this),SelectQueryNode:this.transformSelectQuery.bind(this),SelectionNode:this.transformSelection.bind(this),TableNode:this.transformTable.bind(this),FromNode:this.transformFrom.bind(this),SelectAllNode:this.transformSelectAll.bind(this),AndNode:this.transformAnd.bind(this),OrNode:this.transformOr.bind(this),ValueNode:this.transformValue.bind(this),ValueListNode:this.transformValueList.bind(this),PrimitiveValueListNode:this.transformPrimitiveValueList.bind(this),ParensNode:this.transformParens.bind(this),JoinNode:this.transformJoin.bind(this),OperatorNode:this.transformOperator.bind(this),WhereNode:this.transformWhere.bind(this),InsertQueryNode:this.transformInsertQuery.bind(this),DeleteQueryNode:this.transformDeleteQuery.bind(this),ReturningNode:this.transformReturning.bind(this),CreateTableNode:this.transformCreateTable.bind(this),AddColumnNode:this.transformAddColumn.bind(this),ColumnDefinitionNode:this.transformColumnDefinition.bind(this),DropTableNode:this.transformDropTable.bind(this),DataTypeNode:this.transformDataType.bind(this),OrderByNode:this.transformOrderBy.bind(this),OrderByItemNode:this.transformOrderByItem.bind(this),GroupByNode:this.transformGroupBy.bind(this),GroupByItemNode:this.transformGroupByItem.bind(this),UpdateQueryNode:this.transformUpdateQuery.bind(this),ColumnUpdateNode:this.transformColumnUpdate.bind(this),LimitNode:this.transformLimit.bind(this),OffsetNode:this.transformOffset.bind(this),OnConflictNode:this.transformOnConflict.bind(this),OnDuplicateKeyNode:this.transformOnDuplicateKey.bind(this),CreateIndexNode:this.transformCreateIndex.bind(this),DropIndexNode:this.transformDropIndex.bind(this),ListNode:this.transformList.bind(this),PrimaryKeyConstraintNode:this.transformPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.transformUniqueConstraint.bind(this),ReferencesNode:this.transformReferences.bind(this),CheckConstraintNode:this.transformCheckConstraint.bind(this),WithNode:this.transformWith.bind(this),CommonTableExpressionNode:this.transformCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.transformCommonTableExpressionName.bind(this),HavingNode:this.transformHaving.bind(this),CreateSchemaNode:this.transformCreateSchema.bind(this),DropSchemaNode:this.transformDropSchema.bind(this),AlterTableNode:this.transformAlterTable.bind(this),DropColumnNode:this.transformDropColumn.bind(this),RenameColumnNode:this.transformRenameColumn.bind(this),AlterColumnNode:this.transformAlterColumn.bind(this),ModifyColumnNode:this.transformModifyColumn.bind(this),AddConstraintNode:this.transformAddConstraint.bind(this),DropConstraintNode:this.transformDropConstraint.bind(this),RenameConstraintNode:this.transformRenameConstraint.bind(this),ForeignKeyConstraintNode:this.transformForeignKeyConstraint.bind(this),CreateViewNode:this.transformCreateView.bind(this),RefreshMaterializedViewNode:this.transformRefreshMaterializedView.bind(this),DropViewNode:this.transformDropView.bind(this),GeneratedNode:this.transformGenerated.bind(this),DefaultValueNode:this.transformDefaultValue.bind(this),OnNode:this.transformOn.bind(this),ValuesNode:this.transformValues.bind(this),SelectModifierNode:this.transformSelectModifier.bind(this),CreateTypeNode:this.transformCreateType.bind(this),DropTypeNode:this.transformDropType.bind(this),ExplainNode:this.transformExplain.bind(this),DefaultInsertValueNode:this.transformDefaultInsertValue.bind(this),AggregateFunctionNode:this.transformAggregateFunction.bind(this),OverNode:this.transformOver.bind(this),PartitionByNode:this.transformPartitionBy.bind(this),PartitionByItemNode:this.transformPartitionByItem.bind(this),SetOperationNode:this.transformSetOperation.bind(this),BinaryOperationNode:this.transformBinaryOperation.bind(this),UnaryOperationNode:this.transformUnaryOperation.bind(this),UsingNode:this.transformUsing.bind(this),FunctionNode:this.transformFunction.bind(this),CaseNode:this.transformCase.bind(this),WhenNode:this.transformWhen.bind(this),JSONReferenceNode:this.transformJSONReference.bind(this),JSONPathNode:this.transformJSONPath.bind(this),JSONPathLegNode:this.transformJSONPathLeg.bind(this),JSONOperatorChainNode:this.transformJSONOperatorChain.bind(this),TupleNode:this.transformTuple.bind(this),MergeQueryNode:this.transformMergeQuery.bind(this),MatchedNode:this.transformMatched.bind(this),AddIndexNode:this.transformAddIndex.bind(this),CastNode:this.transformCast.bind(this),FetchNode:this.transformFetch.bind(this),TopNode:this.transformTop.bind(this),OutputNode:this.transformOutput.bind(this),OrActionNode:this.transformOrAction.bind(this),CollateNode:this.transformCollate.bind(this)});transformNode(J,W){if(!J)return J;this.nodeStack.push(J);let X=this.transformNodeImpl(J,W);return this.nodeStack.pop(),U(X)}transformNodeImpl(J,W){return this.#J[J.kind](J,W)}transformNodeList(J,W){if(!J)return J;return U(J.map((X)=>this.transformNode(X,W)))}transformSelectQuery(J,W){return n({kind:"SelectQueryNode",from:this.transformNode(J.from,W),selections:this.transformNodeList(J.selections,W),distinctOn:this.transformNodeList(J.distinctOn,W),joins:this.transformNodeList(J.joins,W),groupBy:this.transformNode(J.groupBy,W),orderBy:this.transformNode(J.orderBy,W),where:this.transformNode(J.where,W),frontModifiers:this.transformNodeList(J.frontModifiers,W),endModifiers:this.transformNodeList(J.endModifiers,W),limit:this.transformNode(J.limit,W),offset:this.transformNode(J.offset,W),with:this.transformNode(J.with,W),having:this.transformNode(J.having,W),explain:this.transformNode(J.explain,W),setOperations:this.transformNodeList(J.setOperations,W),fetch:this.transformNode(J.fetch,W),top:this.transformNode(J.top,W)})}transformSelection(J,W){return n({kind:"SelectionNode",selection:this.transformNode(J.selection,W)})}transformColumn(J,W){return n({kind:"ColumnNode",column:this.transformNode(J.column,W)})}transformAlias(J,W){return n({kind:"AliasNode",node:this.transformNode(J.node,W),alias:this.transformNode(J.alias,W)})}transformTable(J,W){return n({kind:"TableNode",table:this.transformNode(J.table,W)})}transformFrom(J,W){return n({kind:"FromNode",froms:this.transformNodeList(J.froms,W)})}transformReference(J,W){return n({kind:"ReferenceNode",column:this.transformNode(J.column,W),table:this.transformNode(J.table,W)})}transformAnd(J,W){return n({kind:"AndNode",left:this.transformNode(J.left,W),right:this.transformNode(J.right,W)})}transformOr(J,W){return n({kind:"OrNode",left:this.transformNode(J.left,W),right:this.transformNode(J.right,W)})}transformValueList(J,W){return n({kind:"ValueListNode",values:this.transformNodeList(J.values,W)})}transformParens(J,W){return n({kind:"ParensNode",node:this.transformNode(J.node,W)})}transformJoin(J,W){return n({kind:"JoinNode",joinType:J.joinType,table:this.transformNode(J.table,W),on:this.transformNode(J.on,W)})}transformRaw(J,W){return n({kind:"RawNode",sqlFragments:U([...J.sqlFragments]),parameters:this.transformNodeList(J.parameters,W)})}transformWhere(J,W){return n({kind:"WhereNode",where:this.transformNode(J.where,W)})}transformInsertQuery(J,W){return n({kind:"InsertQueryNode",into:this.transformNode(J.into,W),columns:this.transformNodeList(J.columns,W),values:this.transformNode(J.values,W),returning:this.transformNode(J.returning,W),onConflict:this.transformNode(J.onConflict,W),onDuplicateKey:this.transformNode(J.onDuplicateKey,W),endModifiers:this.transformNodeList(J.endModifiers,W),with:this.transformNode(J.with,W),ignore:J.ignore,orAction:this.transformNode(J.orAction,W),replace:J.replace,explain:this.transformNode(J.explain,W),defaultValues:J.defaultValues,top:this.transformNode(J.top,W),output:this.transformNode(J.output,W)})}transformValues(J,W){return n({kind:"ValuesNode",values:this.transformNodeList(J.values,W)})}transformDeleteQuery(J,W){return n({kind:"DeleteQueryNode",from:this.transformNode(J.from,W),using:this.transformNode(J.using,W),joins:this.transformNodeList(J.joins,W),where:this.transformNode(J.where,W),returning:this.transformNode(J.returning,W),endModifiers:this.transformNodeList(J.endModifiers,W),with:this.transformNode(J.with,W),orderBy:this.transformNode(J.orderBy,W),limit:this.transformNode(J.limit,W),explain:this.transformNode(J.explain,W),top:this.transformNode(J.top,W),output:this.transformNode(J.output,W)})}transformReturning(J,W){return n({kind:"ReturningNode",selections:this.transformNodeList(J.selections,W)})}transformCreateTable(J,W){return n({kind:"CreateTableNode",table:this.transformNode(J.table,W),columns:this.transformNodeList(J.columns,W),constraints:this.transformNodeList(J.constraints,W),temporary:J.temporary,ifNotExists:J.ifNotExists,onCommit:J.onCommit,frontModifiers:this.transformNodeList(J.frontModifiers,W),endModifiers:this.transformNodeList(J.endModifiers,W),selectQuery:this.transformNode(J.selectQuery,W)})}transformColumnDefinition(J,W){return n({kind:"ColumnDefinitionNode",column:this.transformNode(J.column,W),dataType:this.transformNode(J.dataType,W),references:this.transformNode(J.references,W),primaryKey:J.primaryKey,autoIncrement:J.autoIncrement,unique:J.unique,notNull:J.notNull,unsigned:J.unsigned,defaultTo:this.transformNode(J.defaultTo,W),check:this.transformNode(J.check,W),generated:this.transformNode(J.generated,W),frontModifiers:this.transformNodeList(J.frontModifiers,W),endModifiers:this.transformNodeList(J.endModifiers,W),nullsNotDistinct:J.nullsNotDistinct,identity:J.identity,ifNotExists:J.ifNotExists})}transformAddColumn(J,W){return n({kind:"AddColumnNode",column:this.transformNode(J.column,W)})}transformDropTable(J,W){return n({kind:"DropTableNode",table:this.transformNode(J.table,W),ifExists:J.ifExists,cascade:J.cascade})}transformOrderBy(J,W){return n({kind:"OrderByNode",items:this.transformNodeList(J.items,W)})}transformOrderByItem(J,W){return n({kind:"OrderByItemNode",orderBy:this.transformNode(J.orderBy,W),direction:this.transformNode(J.direction,W),collation:this.transformNode(J.collation,W),nulls:J.nulls})}transformGroupBy(J,W){return n({kind:"GroupByNode",items:this.transformNodeList(J.items,W)})}transformGroupByItem(J,W){return n({kind:"GroupByItemNode",groupBy:this.transformNode(J.groupBy,W)})}transformUpdateQuery(J,W){return n({kind:"UpdateQueryNode",table:this.transformNode(J.table,W),from:this.transformNode(J.from,W),joins:this.transformNodeList(J.joins,W),where:this.transformNode(J.where,W),updates:this.transformNodeList(J.updates,W),returning:this.transformNode(J.returning,W),endModifiers:this.transformNodeList(J.endModifiers,W),with:this.transformNode(J.with,W),explain:this.transformNode(J.explain,W),limit:this.transformNode(J.limit,W),top:this.transformNode(J.top,W),output:this.transformNode(J.output,W),orderBy:this.transformNode(J.orderBy,W)})}transformColumnUpdate(J,W){return n({kind:"ColumnUpdateNode",column:this.transformNode(J.column,W),value:this.transformNode(J.value,W)})}transformLimit(J,W){return n({kind:"LimitNode",limit:this.transformNode(J.limit,W)})}transformOffset(J,W){return n({kind:"OffsetNode",offset:this.transformNode(J.offset,W)})}transformOnConflict(J,W){return n({kind:"OnConflictNode",columns:this.transformNodeList(J.columns,W),constraint:this.transformNode(J.constraint,W),indexExpression:this.transformNode(J.indexExpression,W),indexWhere:this.transformNode(J.indexWhere,W),updates:this.transformNodeList(J.updates,W),updateWhere:this.transformNode(J.updateWhere,W),doNothing:J.doNothing})}transformOnDuplicateKey(J,W){return n({kind:"OnDuplicateKeyNode",updates:this.transformNodeList(J.updates,W)})}transformCreateIndex(J,W){return n({kind:"CreateIndexNode",name:this.transformNode(J.name,W),table:this.transformNode(J.table,W),columns:this.transformNodeList(J.columns,W),unique:J.unique,using:this.transformNode(J.using,W),ifNotExists:J.ifNotExists,where:this.transformNode(J.where,W),nullsNotDistinct:J.nullsNotDistinct})}transformList(J,W){return n({kind:"ListNode",items:this.transformNodeList(J.items,W)})}transformDropIndex(J,W){return n({kind:"DropIndexNode",name:this.transformNode(J.name,W),table:this.transformNode(J.table,W),ifExists:J.ifExists,cascade:J.cascade})}transformPrimaryKeyConstraint(J,W){return n({kind:"PrimaryKeyConstraintNode",columns:this.transformNodeList(J.columns,W),name:this.transformNode(J.name,W),deferrable:J.deferrable,initiallyDeferred:J.initiallyDeferred})}transformUniqueConstraint(J,W){return n({kind:"UniqueConstraintNode",columns:this.transformNodeList(J.columns,W),name:this.transformNode(J.name,W),nullsNotDistinct:J.nullsNotDistinct,deferrable:J.deferrable,initiallyDeferred:J.initiallyDeferred})}transformForeignKeyConstraint(J,W){return n({kind:"ForeignKeyConstraintNode",columns:this.transformNodeList(J.columns,W),references:this.transformNode(J.references,W),name:this.transformNode(J.name,W),onDelete:J.onDelete,onUpdate:J.onUpdate,deferrable:J.deferrable,initiallyDeferred:J.initiallyDeferred})}transformSetOperation(J,W){return n({kind:"SetOperationNode",operator:J.operator,expression:this.transformNode(J.expression,W),all:J.all})}transformReferences(J,W){return n({kind:"ReferencesNode",table:this.transformNode(J.table,W),columns:this.transformNodeList(J.columns,W),onDelete:J.onDelete,onUpdate:J.onUpdate})}transformCheckConstraint(J,W){return n({kind:"CheckConstraintNode",expression:this.transformNode(J.expression,W),name:this.transformNode(J.name,W)})}transformWith(J,W){return n({kind:"WithNode",expressions:this.transformNodeList(J.expressions,W),recursive:J.recursive})}transformCommonTableExpression(J,W){return n({kind:"CommonTableExpressionNode",name:this.transformNode(J.name,W),materialized:J.materialized,expression:this.transformNode(J.expression,W)})}transformCommonTableExpressionName(J,W){return n({kind:"CommonTableExpressionNameNode",table:this.transformNode(J.table,W),columns:this.transformNodeList(J.columns,W)})}transformHaving(J,W){return n({kind:"HavingNode",having:this.transformNode(J.having,W)})}transformCreateSchema(J,W){return n({kind:"CreateSchemaNode",schema:this.transformNode(J.schema,W),ifNotExists:J.ifNotExists})}transformDropSchema(J,W){return n({kind:"DropSchemaNode",schema:this.transformNode(J.schema,W),ifExists:J.ifExists,cascade:J.cascade})}transformAlterTable(J,W){return n({kind:"AlterTableNode",table:this.transformNode(J.table,W),renameTo:this.transformNode(J.renameTo,W),setSchema:this.transformNode(J.setSchema,W),columnAlterations:this.transformNodeList(J.columnAlterations,W),addConstraint:this.transformNode(J.addConstraint,W),dropConstraint:this.transformNode(J.dropConstraint,W),renameConstraint:this.transformNode(J.renameConstraint,W),addIndex:this.transformNode(J.addIndex,W),dropIndex:this.transformNode(J.dropIndex,W)})}transformDropColumn(J,W){return n({kind:"DropColumnNode",column:this.transformNode(J.column,W)})}transformRenameColumn(J,W){return n({kind:"RenameColumnNode",column:this.transformNode(J.column,W),renameTo:this.transformNode(J.renameTo,W)})}transformAlterColumn(J,W){return n({kind:"AlterColumnNode",column:this.transformNode(J.column,W),dataType:this.transformNode(J.dataType,W),dataTypeExpression:this.transformNode(J.dataTypeExpression,W),setDefault:this.transformNode(J.setDefault,W),dropDefault:J.dropDefault,setNotNull:J.setNotNull,dropNotNull:J.dropNotNull})}transformModifyColumn(J,W){return n({kind:"ModifyColumnNode",column:this.transformNode(J.column,W)})}transformAddConstraint(J,W){return n({kind:"AddConstraintNode",constraint:this.transformNode(J.constraint,W)})}transformDropConstraint(J,W){return n({kind:"DropConstraintNode",constraintName:this.transformNode(J.constraintName,W),ifExists:J.ifExists,modifier:J.modifier})}transformRenameConstraint(J,W){return n({kind:"RenameConstraintNode",oldName:this.transformNode(J.oldName,W),newName:this.transformNode(J.newName,W)})}transformCreateView(J,W){return n({kind:"CreateViewNode",name:this.transformNode(J.name,W),temporary:J.temporary,orReplace:J.orReplace,ifNotExists:J.ifNotExists,materialized:J.materialized,columns:this.transformNodeList(J.columns,W),as:this.transformNode(J.as,W)})}transformRefreshMaterializedView(J,W){return n({kind:"RefreshMaterializedViewNode",name:this.transformNode(J.name,W),concurrently:J.concurrently,withNoData:J.withNoData})}transformDropView(J,W){return n({kind:"DropViewNode",name:this.transformNode(J.name,W),ifExists:J.ifExists,materialized:J.materialized,cascade:J.cascade})}transformGenerated(J,W){return n({kind:"GeneratedNode",byDefault:J.byDefault,always:J.always,identity:J.identity,stored:J.stored,expression:this.transformNode(J.expression,W)})}transformDefaultValue(J,W){return n({kind:"DefaultValueNode",defaultValue:this.transformNode(J.defaultValue,W)})}transformOn(J,W){return n({kind:"OnNode",on:this.transformNode(J.on,W)})}transformSelectModifier(J,W){return n({kind:"SelectModifierNode",modifier:J.modifier,rawModifier:this.transformNode(J.rawModifier,W),of:this.transformNodeList(J.of,W)})}transformCreateType(J,W){return n({kind:"CreateTypeNode",name:this.transformNode(J.name,W),enum:this.transformNode(J.enum,W)})}transformDropType(J,W){return n({kind:"DropTypeNode",name:this.transformNode(J.name,W),ifExists:J.ifExists})}transformExplain(J,W){return n({kind:"ExplainNode",format:J.format,options:this.transformNode(J.options,W)})}transformSchemableIdentifier(J,W){return n({kind:"SchemableIdentifierNode",schema:this.transformNode(J.schema,W),identifier:this.transformNode(J.identifier,W)})}transformAggregateFunction(J,W){return n({kind:"AggregateFunctionNode",func:J.func,aggregated:this.transformNodeList(J.aggregated,W),distinct:J.distinct,orderBy:this.transformNode(J.orderBy,W),withinGroup:this.transformNode(J.withinGroup,W),filter:this.transformNode(J.filter,W),over:this.transformNode(J.over,W)})}transformOver(J,W){return n({kind:"OverNode",orderBy:this.transformNode(J.orderBy,W),partitionBy:this.transformNode(J.partitionBy,W)})}transformPartitionBy(J,W){return n({kind:"PartitionByNode",items:this.transformNodeList(J.items,W)})}transformPartitionByItem(J,W){return n({kind:"PartitionByItemNode",partitionBy:this.transformNode(J.partitionBy,W)})}transformBinaryOperation(J,W){return n({kind:"BinaryOperationNode",leftOperand:this.transformNode(J.leftOperand,W),operator:this.transformNode(J.operator,W),rightOperand:this.transformNode(J.rightOperand,W)})}transformUnaryOperation(J,W){return n({kind:"UnaryOperationNode",operator:this.transformNode(J.operator,W),operand:this.transformNode(J.operand,W)})}transformUsing(J,W){return n({kind:"UsingNode",tables:this.transformNodeList(J.tables,W)})}transformFunction(J,W){return n({kind:"FunctionNode",func:J.func,arguments:this.transformNodeList(J.arguments,W)})}transformCase(J,W){return n({kind:"CaseNode",value:this.transformNode(J.value,W),when:this.transformNodeList(J.when,W),else:this.transformNode(J.else,W),isStatement:J.isStatement})}transformWhen(J,W){return n({kind:"WhenNode",condition:this.transformNode(J.condition,W),result:this.transformNode(J.result,W)})}transformJSONReference(J,W){return n({kind:"JSONReferenceNode",reference:this.transformNode(J.reference,W),traversal:this.transformNode(J.traversal,W)})}transformJSONPath(J,W){return n({kind:"JSONPathNode",inOperator:this.transformNode(J.inOperator,W),pathLegs:this.transformNodeList(J.pathLegs,W)})}transformJSONPathLeg(J,W){return n({kind:"JSONPathLegNode",type:J.type,value:J.value})}transformJSONOperatorChain(J,W){return n({kind:"JSONOperatorChainNode",operator:this.transformNode(J.operator,W),values:this.transformNodeList(J.values,W)})}transformTuple(J,W){return n({kind:"TupleNode",values:this.transformNodeList(J.values,W)})}transformMergeQuery(J,W){return n({kind:"MergeQueryNode",into:this.transformNode(J.into,W),using:this.transformNode(J.using,W),whens:this.transformNodeList(J.whens,W),with:this.transformNode(J.with,W),top:this.transformNode(J.top,W),endModifiers:this.transformNodeList(J.endModifiers,W),output:this.transformNode(J.output,W),returning:this.transformNode(J.returning,W)})}transformMatched(J,W){return n({kind:"MatchedNode",not:J.not,bySource:J.bySource})}transformAddIndex(J,W){return n({kind:"AddIndexNode",name:this.transformNode(J.name,W),columns:this.transformNodeList(J.columns,W),unique:J.unique,using:this.transformNode(J.using,W),ifNotExists:J.ifNotExists})}transformCast(J,W){return n({kind:"CastNode",expression:this.transformNode(J.expression,W),dataType:this.transformNode(J.dataType,W)})}transformFetch(J,W){return n({kind:"FetchNode",rowCount:this.transformNode(J.rowCount,W),modifier:J.modifier})}transformTop(J,W){return n({kind:"TopNode",expression:J.expression,modifiers:J.modifiers})}transformOutput(J,W){return n({kind:"OutputNode",selections:this.transformNodeList(J.selections,W)})}transformDataType(J,W){return J}transformSelectAll(J,W){return J}transformIdentifier(J,W){return J}transformValue(J,W){return J}transformPrimitiveValueList(J,W){return J}transformOperator(J,W){return J}transformDefaultInsertValue(J,W){return J}transformOrAction(J,W){return J}transformCollate(J,W){return J}}var MX=D(()=>{C()});var YR,GR,kZ;var YM=D(()=>{f8();e6();Q1();N5();MX();gJ();U1();C();YR=U({AlterTableNode:!0,CreateIndexNode:!0,CreateSchemaNode:!0,CreateTableNode:!0,CreateTypeNode:!0,CreateViewNode:!0,RefreshMaterializedViewNode:!0,DeleteQueryNode:!0,DropIndexNode:!0,DropSchemaNode:!0,DropTableNode:!0,DropTypeNode:!0,DropViewNode:!0,InsertQueryNode:!0,RawNode:!0,SelectQueryNode:!0,UpdateQueryNode:!0,MergeQueryNode:!0}),GR={json_agg:!0,to_json:!0};kZ=class kZ extends r8{#J;#W=new Set;#X=new Set;constructor(J){super();this.#J=J}transformNodeImpl(J,W){if(!this.#G(J))return super.transformNodeImpl(J,W);let X=this.#K(J);for(let $ of X)this.#X.add($);let G=this.#w(J);for(let $ of G)this.#W.add($);let Y=super.transformNodeImpl(J,W);for(let $ of G)this.#W.delete($);for(let $ of X)this.#X.delete($);return Y}transformSchemableIdentifier(J,W){let X=super.transformSchemableIdentifier(J,W);if(X.schema||!this.#W.has(J.identifier.name))return X;return{...X,schema:X6.create(this.#J)}}transformReferences(J,W){let X=super.transformReferences(J,W);if(X.table.table.schema)return X;return{...X,table:e0.createWithSchema(this.#J,X.table.table.identifier.name)}}transformAggregateFunction(J,W){return{...super.transformAggregateFunction({...J,aggregated:[]},W),aggregated:this.#Y(J,W,"aggregated")}}transformFunction(J,W){return{...super.transformFunction({...J,arguments:[]},W),arguments:this.#Y(J,W,"arguments")}}#Y(J,W,X){return GR[J.func]?J[X].map((G)=>!e0.is(G)||G.table.schema?this.transformNode(G,W):{...G,table:this.transformIdentifier(G.table.identifier,W)}):this.transformNodeList(J[X],W)}#G(J){return J.kind in YR}#w(J){let W=new Set;if("name"in J&&J.name&&U0.is(J.name))this.#H(J.name,W);if("from"in J&&J.from)for(let X of J.from.froms)this.#$(X,W);if("into"in J&&J.into)this.#$(J.into,W);if("table"in J&&J.table)this.#$(J.table,W);if("joins"in J&&J.joins)for(let X of J.joins)this.#$(X.table,W);if("using"in J&&J.using)if(m8.is(J.using))this.#$(J.using.table,W);else this.#$(J.using,W);return W}#K(J){let W=new Set;if("with"in J&&J.with)this.#Z(J.with,W);return W}#$(J,W){if(e0.is(J))this.#H(J.table,W);else if(c4.is(J)&&e0.is(J.node))this.#H(J.node.table,W);else if(F5.is(J))for(let X of J.items)this.#$(X,W)}#H(J,W){let X=J.identifier.name;if(!this.#W.has(X)&&!this.#X.has(X))W.add(X)}#Z(J,W){for(let X of J.expressions){let G=X.name.table.table.identifier.name;if(!this.#X.has(G))W.add(G)}}}});class $8{#J;constructor(J){this.#J=new kZ(J)}transformQuery(J){return this.#J.transformNode(J.node,J.queryId)}async transformResult(J){return J.result}}var OX=D(()=>{YM()});var GM;var hZ=D(()=>{C();GM=U({is(J){return J.kind==="MatchedNode"},create(J,W=!1){return U({kind:"MatchedNode",not:J,bySource:W})}})});function fZ(J,W,X){return T8.create(j1([GM.create(!J.isMatched,J.bySource),...W&&W.length>0?[W.length===3&&X?p4(W[0],W[1],W[2]):J4(W)]:[]],"and",!1))}function R1(J){if(h6(J))return B6.create([J],[]);if(X4(J))return J.toOperationNode();return J}var $M=D(()=>{hZ();m0();_8();VX();C();Y8()});class AW{#J;#W;#X;constructor(){this.#J=new Promise((J,W)=>{this.#X=W,this.#W=J})}get promise(){return this.#J}resolve=(J)=>{if(this.#W)this.#W(J)};reject=(J)=>{if(this.#X)this.#X(J)}}async function P5(J){let W=new AW,X=new AW;return J.provideConnection(async(G)=>{return W.resolve(G),await X.promise}).catch((G)=>W.reject(G)),U({connection:await W.promise,release:X.resolve})}var gZ=D(()=>{C()});class mG{#J;constructor(J=$R){this.#J=J}get plugins(){return this.#J}transformQuery(J,W){for(let X of this.#J){let G=X.transformQuery({node:J,queryId:W});if(G.kind===J.kind)J=G;else throw Error(["KyselyPlugin.transformQuery must return a node","of the same kind that was given to it.",`The plugin was given a ${J.kind}`,`but it returned a ${G.kind}`].join(" "))}return J}async executeQuery(J){return await this.provideConnection(async(W)=>{let X=await W.executeQuery(J);if("numUpdatedOrDeletedRows"in X)x8("kysely:warning: outdated driver/plugin detected! `QueryResult.numUpdatedOrDeletedRows` has been replaced with `QueryResult.numAffectedRows`.");return await this.#W(X,J.queryId)})}async*stream(J,W){let{connection:X,release:G}=await P5(this);try{for await(let Y of X.streamQuery(J,W))yield await this.#W(Y,J.queryId)}finally{G()}}async#W(J,W){for(let X of this.#J)J=await X.transformResult({result:J,queryId:W});return J}}var $R;var mZ=D(()=>{C();gZ();D1();$R=U([])});var C1,EW;var I1=D(()=>{mZ();C1=class C1 extends mG{get adapter(){throw Error("this query cannot be compiled to SQL")}compileQuery(){throw Error("this query cannot be compiled to SQL")}provideConnection(){throw Error("this query cannot be executed")}withConnectionProvider(){throw Error("this query cannot have a connection provider")}withPlugin(J){return new C1([...this.plugins,J])}withPlugins(J){return new C1([...this.plugins,...J])}withPluginAtFront(J){return new C1([J,...this.plugins])}withoutPlugins(){return new C1([])}};EW=new C1});class yZ{numChangedRows;constructor(J){this.numChangedRows=J}}class cJ{#J;constructor(J){this.#J=U(J)}modifyEnd(J){return new cJ({...this.#J,queryNode:a.cloneWithEndModifier(this.#J.queryNode,J.toOperationNode())})}top(J,W){return new cJ({...this.#J,queryNode:a.cloneWithTop(this.#J.queryNode,d8(J,W))})}using(...J){return new u0({...this.#J,queryNode:G8.cloneWithUsing(this.#J.queryNode,BW("Using",J))})}returning(J){return new cJ({...this.#J,queryNode:a.cloneWithReturning(this.#J.queryNode,g4(J))})}returningAll(J){return new cJ({...this.#J,queryNode:a.cloneWithReturning(this.#J.queryNode,d4(J))})}output(J){return new cJ({...this.#J,queryNode:a.cloneWithOutput(this.#J.queryNode,g4(J))})}outputAll(J){return new cJ({...this.#J,queryNode:a.cloneWithOutput(this.#J.queryNode,d4(J))})}}class u0{#J;constructor(J){this.#J=U(J)}modifyEnd(J){return new u0({...this.#J,queryNode:a.cloneWithEndModifier(this.#J.queryNode,J.toOperationNode())})}top(J,W){return new u0({...this.#J,queryNode:a.cloneWithTop(this.#J.queryNode,d8(J,W))})}whenMatched(){return this.#W([])}whenMatchedAnd(...J){return this.#W(J)}whenMatchedAndRef(J,W,X){return this.#W([J,W,X],!0)}#W(J,W){return new xZ({...this.#J,queryNode:G8.cloneWithWhen(this.#J.queryNode,fZ({isMatched:!0},J,W))})}whenNotMatched(){return this.#X([])}whenNotMatchedAnd(...J){return this.#X(J)}whenNotMatchedAndRef(J,W,X){return this.#X([J,W,X],!0)}whenNotMatchedBySource(){return this.#X([],!1,!0)}whenNotMatchedBySourceAnd(...J){return this.#X(J,!1,!0)}whenNotMatchedBySourceAndRef(J,W,X){return this.#X([J,W,X],!0,!0)}returning(J){return new u0({...this.#J,queryNode:a.cloneWithReturning(this.#J.queryNode,g4(J))})}returningAll(J){return new u0({...this.#J,queryNode:a.cloneWithReturning(this.#J.queryNode,d4(J))})}output(J){return new u0({...this.#J,queryNode:a.cloneWithOutput(this.#J.queryNode,g4(J))})}outputAll(J){return new u0({...this.#J,queryNode:a.cloneWithOutput(this.#J.queryNode,d4(J))})}#X(J,W=!1,X=!1){let G={...this.#J,queryNode:G8.cloneWithWhen(this.#J.queryNode,fZ({isMatched:!1,bySource:X},J,W))};return new(X?xZ:KM)(G)}$call(J){return J(this)}$if(J,W){if(J)return W(this);return new u0({...this.#J})}toOperationNode(){return this.#J.executor.transformQuery(this.#J.queryNode,this.#J.queryId)}compile(){return this.#J.executor.compileQuery(this.toOperationNode(),this.#J.queryId)}async execute(){let J=this.compile(),W=await this.#J.executor.executeQuery(J),{adapter:X}=this.#J.executor,G=J.query;if(G.returning&&X.supportsReturning||G.output&&X.supportsOutput)return W.rows;return[new yZ(W.numAffectedRows)]}async executeTakeFirst(){let[J]=await this.execute();return J}async executeTakeFirstOrThrow(J=p8){let W=await this.executeTakeFirst();if(W===void 0)throw FJ(J)?new J(this.toOperationNode()):J(this.toOperationNode());return W}}class xZ{#J;constructor(J){this.#J=U(J)}thenDelete(){return new u0({...this.#J,queryNode:G8.cloneWithThen(this.#J.queryNode,R1("delete"))})}thenDoNothing(){return new u0({...this.#J,queryNode:G8.cloneWithThen(this.#J.queryNode,R1("do nothing"))})}thenUpdate(J){return new u0({...this.#J,queryNode:G8.cloneWithThen(this.#J.queryNode,R1(J(new Y4({queryId:this.#J.queryId,executor:EW,queryNode:zJ.createWithoutTable()}))))})}thenUpdateSet(...J){return this.thenUpdate((W)=>W.set(...J))}}class KM{#J;constructor(J){this.#J=U(J)}thenDoNothing(){return new u0({...this.#J,queryNode:G8.cloneWithThen(this.#J.queryNode,R1("do nothing"))})}thenInsertValues(J){let[W,X]=Q5(J);return new u0({...this.#J,queryNode:G8.cloneWithThen(this.#J.queryNode,R1(S4.cloneWith(S4.createWithoutInto(),{columns:W,values:X})))})}}var uZ=D(()=>{LX();CG();S8();_1();DZ();hG();$M();TW();B1();I1();C();DX();D5()});class UJ{#J;constructor(J){this.#J=U(J)}selectFrom(J){return b1({queryId:w6(),executor:this.#J.executor,queryNode:T6.createFrom(n8(J),this.#J.withNode)})}selectNoFrom(J){return b1({queryId:w6(),executor:this.#J.executor,queryNode:T6.cloneWithSelections(T6.create(this.#J.withNode),g4(J))})}insertInto(J){return new a6({queryId:w6(),executor:this.#J.executor,queryNode:S4.create(A6(J),this.#J.withNode)})}replaceInto(J){return new a6({queryId:w6(),executor:this.#J.executor,queryNode:S4.create(A6(J),this.#J.withNode,!0)})}deleteFrom(J){return new Q4({queryId:w6(),executor:this.#J.executor,queryNode:_W.create(n8(J),this.#J.withNode)})}updateTable(J){return new Y4({queryId:w6(),executor:this.#J.executor,queryNode:zJ.create(n8(J),this.#J.withNode)})}mergeInto(J){return new cJ({queryId:w6(),executor:this.#J.executor,queryNode:G8.create(lZ(J),this.#J.withNode)})}with(J,W){let X=CZ(J,W);return new UJ({...this.#J,withNode:this.#J.withNode?gG.cloneWithExpression(this.#J.withNode,X):gG.create(X)})}withRecursive(J,W){let X=CZ(J,W);return new UJ({...this.#J,withNode:this.#J.withNode?gG.cloneWithExpression(this.#J.withNode,X):gG.create(X,{recursive:!0})})}withPlugin(J){return new UJ({...this.#J,executor:this.#J.executor.withPlugin(J)})}withoutPlugins(){return new UJ({...this.#J,executor:this.#J.executor.withoutPlugins()})}withSchema(J){return new UJ({...this.#J,executor:this.#J.executor.withPluginAtFront(new $8(J))})}}var j5=D(()=>{yG();TZ();BZ();D5();EG();LX();SW();_1();G0();ev();IZ();B8();OX();C();TW();uZ();CG()});function JM(){return new UJ({executor:EW})}function wM(J,W){return new S1({joinNode:m8.create(J,PX(W))})}function HM(){return new T1({overNode:BG.create()})}var M5=D(()=>{Q1();z5();SW();NZ();lv();yG();j5();I1();B8();G0()});function BW(J,W){if(W.length===3)return wR(J,W[0],W[1],W[2]);else if(W.length===2)return KR(J,W[0],W[1]);else if(W.length===1)return HR(J,W[0]);else throw Error("not implemented")}function KR(J,W,X){return X(wM(J,W)).toOperationNode()}function wR(J,W,X,G){return m8.createWithOn(J,PX(W),p4(X,"=",G))}function HR(J,W){return m8.create(J,PX(W))}var hG=D(()=>{Q1();Y8();M5();G0()});var ZM;var cZ=D(()=>{C();ZM=U({is(J){return J.kind==="OffsetNode"},create(J){return U({kind:"OffsetNode",offset:J})}})});var zM;var pZ=D(()=>{C();zM=U({is(J){return J.kind==="GroupByItemNode"},create(J){return U({kind:"GroupByItemNode",groupBy:J})}})});function FM(J){return J=f6(J)?J(q8()):J,uJ(J).map(zM.create)}var NM=D(()=>{pZ();qW();C();W0()});var _5;var S5=D(()=>{C();_5=U({is(J){return J.kind==="SetOperationNode"},create(J,W,X){return U({kind:"SetOperationNode",operator:J,expression:W,all:X})}})});function jX(J,W,X){if(f6(W))W=W(T5());if(!l4(W))W=[W];return W.map((G)=>_5.create(J,x0(G),X))}var UM=D(()=>{qW();S5();C();u8()});class g6{#J;constructor(J){this.#J=J}get expressionType(){return}as(J){return new A5(this,J)}or(...J){return new q5(g8.create(this.#J,J4(J)))}and(...J){return new B5(y0.create(this.#J,J4(J)))}$castTo(){return new g6(this.#J)}$notNull(){return new g6(this.#J)}toOperationNode(){return this.#J}}class A5{#J;#W;constructor(J,W){this.#J=J,this.#W=W}get expression(){return this.#J}get alias(){return this.#W}toOperationNode(){return c4.create(this.#J.toOperationNode(),X4(this.#W)?this.#W.toOperationNode():X6.create(this.#W))}}class q5{#J;constructor(J){this.#J=J}get expressionType(){return}as(J){return new A5(this,J)}or(...J){return new q5(g8.create(this.#J,J4(J)))}$castTo(){return new q5(this.#J)}toOperationNode(){return X8.create(this.#J)}}class B5{#J;constructor(J){this.#J=J}get expressionType(){return}as(J){return new A5(this,J)}and(...J){return new B5(y0.create(this.#J,J4(J)))}$castTo(){return new B5(this.#J)}toOperationNode(){return X8.create(this.#J)}}var k1=D(()=>{f8();MW();e6();m0();NX();P1();Y8()});var QM;var dZ=D(()=>{c8();QM={is(J){return J.kind==="FetchNode"},create(J,W){return{kind:"FetchNode",rowCount:E4.create(J),modifier:W}}}});function LM(J,W){if(!k8(J)&&!DW(J))throw Error(`Invalid fetch row count: ${J}`);if(!ZR(W))throw Error(`Invalid fetch modifier: ${W}`);return QM.create(J,W)}function ZR(J){return J==="only"||J==="with ties"}var VM=D(()=>{dZ();C()});class L6{#J;constructor(J){this.#J=U(J)}get expressionType(){return}get isSelectQueryBuilder(){return!0}where(...J){return new L6({...this.#J,queryNode:a.cloneWithWhere(this.#J.queryNode,J4(J))})}whereRef(J,W,X){return new L6({...this.#J,queryNode:a.cloneWithWhere(this.#J.queryNode,p4(J,W,X))})}having(...J){return new L6({...this.#J,queryNode:T6.cloneWithHaving(this.#J.queryNode,J4(J))})}havingRef(J,W,X){return new L6({...this.#J,queryNode:T6.cloneWithHaving(this.#J.queryNode,p4(J,W,X))})}select(J){return new L6({...this.#J,queryNode:T6.cloneWithSelections(this.#J.queryNode,g4(J))})}distinctOn(J){return new L6({...this.#J,queryNode:T6.cloneWithDistinctOn(this.#J.queryNode,uJ(J))})}modifyFront(J){return new L6({...this.#J,queryNode:T6.cloneWithFrontModifier(this.#J.queryNode,HJ.createWithExpression(J.toOperationNode()))})}modifyEnd(J){return new L6({...this.#J,queryNode:a.cloneWithEndModifier(this.#J.queryNode,HJ.createWithExpression(J.toOperationNode()))})}distinct(){return new L6({...this.#J,queryNode:T6.cloneWithFrontModifier(this.#J.queryNode,HJ.create("Distinct"))})}forUpdate(J){return new L6({...this.#J,queryNode:a.cloneWithEndModifier(this.#J.queryNode,HJ.create("ForUpdate",J?VG(J).map(A6):void 0))})}forShare(J){return new L6({...this.#J,queryNode:a.cloneWithEndModifier(this.#J.queryNode,HJ.create("ForShare",J?VG(J).map(A6):void 0))})}forKeyShare(J){return new L6({...this.#J,queryNode:a.cloneWithEndModifier(this.#J.queryNode,HJ.create("ForKeyShare",J?VG(J).map(A6):void 0))})}forNoKeyUpdate(J){return new L6({...this.#J,queryNode:a.cloneWithEndModifier(this.#J.queryNode,HJ.create("ForNoKeyUpdate",J?VG(J).map(A6):void 0))})}skipLocked(){return new L6({...this.#J,queryNode:a.cloneWithEndModifier(this.#J.queryNode,HJ.create("SkipLocked"))})}noWait(){return new L6({...this.#J,queryNode:a.cloneWithEndModifier(this.#J.queryNode,HJ.create("NoWait"))})}selectAll(J){return new L6({...this.#J,queryNode:T6.cloneWithSelections(this.#J.queryNode,d4(J))})}innerJoin(...J){return this.#W("InnerJoin",J)}leftJoin(...J){return this.#W("LeftJoin",J)}rightJoin(...J){return this.#W("RightJoin",J)}fullJoin(...J){return this.#W("FullJoin",J)}crossJoin(...J){return this.#W("CrossJoin",J)}innerJoinLateral(...J){return this.#W("LateralInnerJoin",J)}leftJoinLateral(...J){return this.#W("LateralLeftJoin",J)}crossJoinLateral(...J){return this.#W("LateralCrossJoin",J)}crossApply(...J){return this.#W("CrossApply",J)}outerApply(...J){return this.#W("OuterApply",J)}#W(J,W){return new L6({...this.#J,queryNode:a.cloneWithJoin(this.#J.queryNode,BW(J,W))})}orderBy(...J){return new L6({...this.#J,queryNode:a.cloneWithOrderByItems(this.#J.queryNode,W8(J))})}groupBy(J){return new L6({...this.#J,queryNode:T6.cloneWithGroupByItems(this.#J.queryNode,FM(J))})}limit(J){return new L6({...this.#J,queryNode:T6.cloneWithLimit(this.#J.queryNode,A1.create(i6(J)))})}offset(J){return new L6({...this.#J,queryNode:T6.cloneWithOffset(this.#J.queryNode,ZM.create(i6(J)))})}fetch(J,W="only"){return new L6({...this.#J,queryNode:T6.cloneWithFetch(this.#J.queryNode,LM(J,W))})}top(J,W){return new L6({...this.#J,queryNode:a.cloneWithTop(this.#J.queryNode,d8(J,W))})}union(J){return new L6({...this.#J,queryNode:T6.cloneWithSetOperations(this.#J.queryNode,jX("union",J,!1))})}unionAll(J){return new L6({...this.#J,queryNode:T6.cloneWithSetOperations(this.#J.queryNode,jX("union",J,!0))})}intersect(J){return new L6({...this.#J,queryNode:T6.cloneWithSetOperations(this.#J.queryNode,jX("intersect",J,!1))})}intersectAll(J){return new L6({...this.#J,queryNode:T6.cloneWithSetOperations(this.#J.queryNode,jX("intersect",J,!0))})}except(J){return new L6({...this.#J,queryNode:T6.cloneWithSetOperations(this.#J.queryNode,jX("except",J,!1))})}exceptAll(J){return new L6({...this.#J,queryNode:T6.cloneWithSetOperations(this.#J.queryNode,jX("except",J,!0))})}as(J){return new DM(this,J)}clearSelect(){return new L6({...this.#J,queryNode:T6.cloneWithoutSelections(this.#J.queryNode)})}clearWhere(){return new L6({...this.#J,queryNode:a.cloneWithoutWhere(this.#J.queryNode)})}clearLimit(){return new L6({...this.#J,queryNode:T6.cloneWithoutLimit(this.#J.queryNode)})}clearOffset(){return new L6({...this.#J,queryNode:T6.cloneWithoutOffset(this.#J.queryNode)})}clearOrderBy(){return new L6({...this.#J,queryNode:a.cloneWithoutOrderBy(this.#J.queryNode)})}clearGroupBy(){return new L6({...this.#J,queryNode:T6.cloneWithoutGroupBy(this.#J.queryNode)})}$call(J){return J(this)}$if(J,W){if(J)return W(this);return new L6({...this.#J})}$castTo(){return new L6(this.#J)}$narrowType(){return new L6(this.#J)}$assertType(){return new L6(this.#J)}$asTuple(){return new g6(this.toOperationNode())}$asScalar(){return new g6(this.toOperationNode())}withPlugin(J){return new L6({...this.#J,executor:this.#J.executor.withPlugin(J)})}toOperationNode(){return this.#J.executor.transformQuery(this.#J.queryNode,this.#J.queryId)}compile(){return this.#J.executor.compileQuery(this.toOperationNode(),this.#J.queryId)}async execute(){let J=this.compile();return(await this.#J.executor.executeQuery(J)).rows}async executeTakeFirst(){let[J]=await this.execute();return J}async executeTakeFirstOrThrow(J=p8){let W=await this.executeTakeFirst();if(W===void 0)throw FJ(J)?new J(this.toOperationNode()):J(this.toOperationNode());return W}async*stream(J=100){let W=this.compile(),X=this.#J.executor.stream(W,J);for await(let G of X)yield*G.rows}async explain(J,W){return await new L6({...this.#J,queryNode:a.cloneWithExplain(this.#J.queryNode,J,W)}).execute()}}function b1(J){return new L6(J)}class DM{#J;#W;constructor(J,W){this.#J=J,this.#W=W}get expression(){return this.#J}get alias(){return this.#W}get isAliasedSelectQueryBuilder(){return!0}toOperationNode(){return c4.create(this.#J.toOperationNode(),X6.create(this.#W))}}var yG=D(()=>{f8();xH();hG();G0();TW();W0();SW();S8();UX();kG();cZ();C();NM();DX();e6();UM();Y8();k1();ZJ();VM();B1()});var QJ;var E5=D(()=>{C();RG();qG();QJ=U({is(J){return J.kind==="AggregateFunctionNode"},create(J,W=[]){return U({kind:"AggregateFunctionNode",func:J,aggregated:W})},cloneWithDistinct(J){return U({...J,distinct:!0})},cloneWithOrderBy(J,W,X=!1){let G=X?"withinGroup":"orderBy";return U({...J,[G]:J[G]?lJ.cloneWithItems(J[G],W):lJ.create(W)})},cloneWithFilter(J,W){return U({...J,filter:J.filter?Y0.cloneWithOperation(J.filter,"And",W):Y0.create(W)})},cloneWithOrFilter(J,W){return U({...J,filter:J.filter?Y0.cloneWithOperation(J.filter,"Or",W):Y0.create(W)})},cloneWithOver(J,W){return U({...J,over:W})}})});var nZ;var rZ=D(()=>{C();nZ=U({is(J){return J.kind==="FunctionNode"},create(J,W){return U({kind:"FunctionNode",func:J,arguments:W})}})});class l0{#J;constructor(J){this.#J=U(J)}get expressionType(){return}as(J){return new vM(this,J)}distinct(){return new l0({...this.#J,aggregateFunctionNode:QJ.cloneWithDistinct(this.#J.aggregateFunctionNode)})}orderBy(...J){return new l0({...this.#J,aggregateFunctionNode:a.cloneWithOrderByItems(this.#J.aggregateFunctionNode,W8(J))})}clearOrderBy(){return new l0({...this.#J,aggregateFunctionNode:a.cloneWithoutOrderBy(this.#J.aggregateFunctionNode)})}withinGroupOrderBy(...J){return new l0({...this.#J,aggregateFunctionNode:QJ.cloneWithOrderBy(this.#J.aggregateFunctionNode,W8(J),!0)})}filterWhere(...J){return new l0({...this.#J,aggregateFunctionNode:QJ.cloneWithFilter(this.#J.aggregateFunctionNode,J4(J))})}filterWhereRef(J,W,X){return new l0({...this.#J,aggregateFunctionNode:QJ.cloneWithFilter(this.#J.aggregateFunctionNode,p4(J,W,X))})}over(J){let W=HM();return new l0({...this.#J,aggregateFunctionNode:QJ.cloneWithOver(this.#J.aggregateFunctionNode,(J?J(W):W).toOperationNode())})}$call(J){return J(this)}$castTo(){return new l0(this.#J)}$notNull(){return new l0(this.#J)}toOperationNode(){return this.#J.aggregateFunctionNode}}class vM{#J;#W;constructor(J,W){this.#J=J,this.#W=W}get expression(){return this.#J}get alias(){return this.#W}toOperationNode(){return c4.create(this.#J.toOperationNode(),X6.create(this.#W))}}var iZ=D(()=>{C();E5();f8();e6();M5();Y8();UX();S8()});function R5(){let J=(X,G)=>{return new g6(nZ.create(X,uJ(G??[])))},W=(X,G)=>{return new l0({aggregateFunctionNode:QJ.create(X,G?uJ(G):void 0)})};return Object.assign(J,{agg:W,avg(X){return W("avg",[X])},coalesce(...X){return J("coalesce",X)},count(X){return W("count",[X])},countAll(X){return new l0({aggregateFunctionNode:QJ.create("count",d4(X))})},max(X){return W("max",[X])},min(X){return W("min",[X])},sum(X){return W("sum",[X])},any(X){return J("any",[X])},jsonAgg(X){return new l0({aggregateFunctionNode:QJ.create("json_agg",[h6(X)?A6(X):X.toOperationNode()])})},toJson(X){return new g6(nZ.create("to_json",[h6(X)?A6(X):X.toOperationNode()]))}})}var C5=D(()=>{k1();E5();rZ();W0();TW();iZ();C();G0()});var MM;var aZ=D(()=>{C();MM=U({is(J){return J.kind==="UnaryOperationNode"},create(J,W){return U({kind:"UnaryOperationNode",operator:J,operand:W})}})});function OM(J,W){return MM.create(Q0.create(J),X0(W))}var PM=D(()=>{yJ();aZ();W0()});var K8;var xG=D(()=>{C();VX();K8=U({is(J){return J.kind==="CaseNode"},create(J){return U({kind:"CaseNode",value:J})},cloneWithWhen(J,W){return U({...J,when:U(J.when?[...J.when,W]:[W])})},cloneWithThen(J,W){return U({...J,when:J.when?U([...J.when.slice(0,-1),T8.cloneWithResult(J.when[J.when.length-1],W)]):void 0})},cloneWith(J,W){return U({...J,...W})}})});class uG{#J;constructor(J){this.#J=U(J)}when(...J){return new tZ({...this.#J,node:K8.cloneWithWhen(this.#J.node,T8.create(J4(J)))})}}class tZ{#J;constructor(J){this.#J=U(J)}then(J){return new jM({...this.#J,node:K8.cloneWithThen(this.#J.node,H5(J)?TG(J):i6(J))})}}class jM{#J;constructor(J){this.#J=U(J)}when(...J){return new tZ({...this.#J,node:K8.cloneWithWhen(this.#J.node,T8.create(J4(J)))})}else(J){return new _M({...this.#J,node:K8.cloneWith(this.#J.node,{else:H5(J)?TG(J):i6(J)})})}end(){return new g6(K8.cloneWith(this.#J.node,{isStatement:!1}))}endCase(){return new g6(K8.cloneWith(this.#J.node,{isStatement:!0}))}}class _M{#J;constructor(J){this.#J=U(J)}end(){return new g6(K8.cloneWith(this.#J.node,{isStatement:!1}))}endCase(){return new g6(K8.cloneWith(this.#J.node,{isStatement:!0}))}}var I5=D(()=>{k1();C();xG();VX();Y8();ZJ()});var oZ;var sZ=D(()=>{C();oZ=U({is(J){return J.kind==="JSONPathLegNode"},create(J,W){return U({kind:"JSONPathLegNode",type:J,value:W})}})});class cG{#J;constructor(J){this.#J=J}at(J){return this.#W("ArrayLocation",J)}key(J){return this.#W("Member",J)}#W(J,W){if(v1.is(this.#J))return new lG(v1.cloneWithTraversal(this.#J,PW.is(this.#J.traversal)?PW.cloneWithLeg(this.#J.traversal,oZ.create(J,W)):K5.cloneWithValue(this.#J.traversal,E4.createImmediate(W))));return new lG(PW.cloneWithLeg(this.#J,oZ.create(J,W)))}}class SM{#J;#W;constructor(J,W){this.#J=J,this.#W=W}get expression(){return this.#J}get alias(){return this.#W}toOperationNode(){return c4.create(this.#J.toOperationNode(),X4(this.#W)?this.#W.toOperationNode():X6.create(this.#W))}}var lG;var eZ=D(()=>{f8();e6();w5();sZ();_G();$5();m0();c8();lG=class lG extends cG{#J;constructor(J){super(J);this.#J=J}get expressionType(){return}as(J){return new SM(this,J)}$castTo(){return new lG(this.#J)}$notNull(){return new lG(this.#J)}toOperationNode(){return this.#J}}});var J3;var W3=D(()=>{C();J3=U({is(J){return J.kind==="TupleNode"},create(J){return U({kind:"TupleNode",values:U(J)})}})});function TM(J){if(zR.includes(J))return!0;if(FR.some((W)=>W.test(J)))return!0;return!1}var zR,FR,X3;var b5=D(()=>{C();zR=["varchar","char","text","integer","int2","int4","int8","smallint","bigint","boolean","real","double precision","float4","float8","decimal","numeric","binary","bytea","date","datetime","time","timetz","timestamp","timestamptz","serial","bigserial","uuid","json","jsonb","blob","varbinary","int4range","int4multirange","int8range","int8multirange","numrange","nummultirange","tsrange","tsmultirange","tstzrange","tstzmultirange","daterange","datemultirange"],FR=[/^varchar\(\d+\)$/,/^char\(\d+\)$/,/^decimal\(\d+, \d+\)$/,/^numeric\(\d+, \d+\)$/,/^binary\(\d+\)$/,/^datetime\(\d+\)$/,/^time\(\d+\)$/,/^timetz\(\d+\)$/,/^timestamp\(\d+\)$/,/^timestamptz\(\d+\)$/,/^varbinary\(\d+\)$/],X3=U({is(J){return J.kind==="DataTypeNode"},create(J){return U({kind:"DataTypeNode",dataType:J})}})});function i8(J){if(X4(J))return J.toOperationNode();if(TM(J))return X3.create(J);throw Error(`invalid column data type ${JSON.stringify(J)}`)}var pG=D(()=>{b5();m0()});var Y3;var k5=D(()=>{C();Y3=U({is(J){return J.kind==="CastNode"},create(J,W){return U({kind:"CastNode",expression:J,dataType:W})}})});function T5(J=EW){function W(Y,$,K){return new g6(Z5(Y,$,K))}function X(Y,$){return new g6(OM(Y,$))}let G=Object.assign(W,{fn:void 0,eb:void 0,selectFrom(Y){return b1({queryId:w6(),executor:J,queryNode:T6.createFrom(n8(Y))})},case(Y){return new uG({node:K8.create(T0(Y)?void 0:X0(Y))})},ref(Y,$){if(T0($))return new g6(J8(Y));return new cG(bv(Y,$))},jsonPath(){return new cG(PW.create())},table(Y){return new g6(A6(Y))},val(Y){return new g6(i6(Y))},refTuple(...Y){return new g6(J3.create(Y.map(X0)))},tuple(...Y){return new g6(J3.create(Y.map(i6)))},lit(Y){return new g6(TG(Y))},unary:X,not(Y){return X("not",Y)},exists(Y){return X("exists",Y)},neg(Y){return X("-",Y)},between(Y,$,K){return new g6(mJ.create(X0(Y),Q0.create("between"),y0.create(i6($),i6(K))))},betweenSymmetric(Y,$,K){return new g6(mJ.create(X0(Y),Q0.create("between symmetric"),y0.create(i6($),i6(K))))},and(Y){if(l4(Y))return new g6(j1(Y,"and"));return new g6(sH(Y,"and"))},or(Y){if(l4(Y))return new g6(j1(Y,"or"));return new g6(sH(Y,"or"))},parens(...Y){let $=J4(Y);if(X8.is($))return new g6($);else return new g6(X8.create($))},cast(Y,$){return new g6(Y3.create(X0(Y),i8($)))},withSchema(Y){return T5(J.withPluginAtFront(new $8(Y)))}});return G.fn=R5(),G.eb=G,G}function q8(J){return T5()}var qW=D(()=>{yG();SW();G0();OX();B8();C5();W0();Y8();P1();k1();yJ();PM();ZJ();I1();I5();xG();C();eZ();OG();MW();W3();_G();pG();k5()});function x0(J){if(X4(J))return J.toOperationNode();else if(f6(J))return J(q8()).toOperationNode();throw Error(`invalid expression: ${JSON.stringify(J)}`)}function U5(J){if(X4(J))return J.toOperationNode();else if(f6(J))return J(q8()).toOperationNode();throw Error(`invalid aliased expression: ${JSON.stringify(J)}`)}function xJ(J){return e$(J)||Bv(J)||f6(J)}var u8=D(()=>{J5();m0();qW();C()});class G3{#J;get table(){return this.#J}constructor(J){this.#J=J}as(J){return new qM(this.#J,J)}}class qM{#J;#W;get table(){return this.#J}get alias(){return this.#W}constructor(J,W){this.#J=J,this.#W=W}toOperationNode(){return c4.create(A6(this.#J),X6.create(this.#W))}}function BM(J){return s6(J)&&X4(J)&&h6(J.table)&&h6(J.alias)}var h5=D(()=>{f8();e6();m0();G0();C()});function n8(J){if(l4(J))return J.map((W)=>PX(W));else return[PX(J)]}function PX(J){if(h6(J))return lZ(J);else if(BM(J))return J.toOperationNode();else return U5(J)}function lZ(J){if(J.includes(" as ")){let[X,G]=J.split(" as ").map(AM);return c4.create(A6(X),X6.create(G))}else return A6(J)}function A6(J){if(J.includes(".")){let[X,G]=J.split(".").map(AM);return e0.createWithSchema(X,G)}else return e0.create(J)}function AM(J){return J.trim()}var G0=D(()=>{C();f8();U1();u8();e6();h5()});var $3;var K3=D(()=>{C();$3=U({is(J){return J.kind==="AddColumnNode"},create(J){return U({kind:"AddColumnNode",column:J})}})});var G4;var dG=D(()=>{C();L0();G4=U({is(J){return J.kind==="ColumnDefinitionNode"},create(J,W){return U({kind:"ColumnDefinitionNode",column:S6.create(J),dataType:W})},cloneWithFrontModifier(J,W){return U({...J,frontModifiers:J.frontModifiers?U([...J.frontModifiers,W]):[W]})},cloneWithEndModifier(J,W){return U({...J,endModifiers:J.endModifiers?U([...J.endModifiers,W]):[W]})},cloneWith(J,W){return U({...J,...W})}})});var w3;var H3=D(()=>{C();L0();w3=U({is(J){return J.kind==="DropColumnNode"},create(J){return U({kind:"DropColumnNode",column:S6.create(J)})}})});var Z3;var z3=D(()=>{C();L0();Z3=U({is(J){return J.kind==="RenameColumnNode"},create(J,W){return U({kind:"RenameColumnNode",column:S6.create(J),renameTo:S6.create(W)})}})});var h1;var nG=D(()=>{C();e6();h1=U({is(J){return J.kind==="CheckConstraintNode"},create(J,W){return U({kind:"CheckConstraintNode",expression:J,name:W?X6.create(W):void 0})}})});var EM,f1;var rG=D(()=>{C();EM=["no action","restrict","cascade","set null","set default"],f1=U({is(J){return J.kind==="ReferencesNode"},create(J,W){return U({kind:"ReferencesNode",table:J,columns:U([...W])})},cloneWithOnDelete(J,W){return U({...J,onDelete:W})},cloneWithOnUpdate(J,W){return U({...J,onUpdate:W})}})});function f5(J){return X4(J)?J.toOperationNode():E4.createImmediate(J)}var F3=D(()=>{m0();c8()});var iG;var N3=D(()=>{C();iG=U({is(J){return J.kind==="GeneratedNode"},create(J){return U({kind:"GeneratedNode",...J})},createWithExpression(J){return U({kind:"GeneratedNode",always:!0,expression:J})},cloneWith(J,W){return U({...J,...W})}})});var RM;var U3=D(()=>{C();RM=U({is(J){return J.kind==="DefaultValueNode"},create(J){return U({kind:"DefaultValueNode",defaultValue:J})}})});function g1(J){if(EM.includes(J))return J;throw Error(`invalid OnModifyForeignAction ${J}`)}var Q3=D(()=>{rG()});class $4{#J;constructor(J){this.#J=J}autoIncrement(){return new $4(G4.cloneWith(this.#J,{autoIncrement:!0}))}identity(){return new $4(G4.cloneWith(this.#J,{identity:!0}))}primaryKey(){return new $4(G4.cloneWith(this.#J,{primaryKey:!0}))}references(J){let W=J8(J);if(!W.table||L1.is(W.column))throw Error(`invalid call references('${J}'). The reference must have format table.column or schema.table.column`);return new $4(G4.cloneWith(this.#J,{references:f1.create(W.table,[W.column])}))}onDelete(J){if(!this.#J.references)throw Error("on delete constraint can only be added for foreign keys");return new $4(G4.cloneWith(this.#J,{references:f1.cloneWithOnDelete(this.#J.references,g1(J))}))}onUpdate(J){if(!this.#J.references)throw Error("on update constraint can only be added for foreign keys");return new $4(G4.cloneWith(this.#J,{references:f1.cloneWithOnUpdate(this.#J.references,g1(J))}))}unique(){return new $4(G4.cloneWith(this.#J,{unique:!0}))}notNull(){return new $4(G4.cloneWith(this.#J,{notNull:!0}))}unsigned(){return new $4(G4.cloneWith(this.#J,{unsigned:!0}))}defaultTo(J){return new $4(G4.cloneWith(this.#J,{defaultTo:RM.create(f5(J))}))}check(J){return new $4(G4.cloneWith(this.#J,{check:h1.create(J.toOperationNode())}))}generatedAlwaysAs(J){return new $4(G4.cloneWith(this.#J,{generated:iG.createWithExpression(J.toOperationNode())}))}generatedAlwaysAsIdentity(){return new $4(G4.cloneWith(this.#J,{generated:iG.create({identity:!0,always:!0})}))}generatedByDefaultAsIdentity(){return new $4(G4.cloneWith(this.#J,{generated:iG.create({identity:!0,byDefault:!0})}))}stored(){if(!this.#J.generated)throw Error("stored() can only be called after generatedAlwaysAs");return new $4(G4.cloneWith(this.#J,{generated:iG.cloneWith(this.#J.generated,{stored:!0})}))}modifyFront(J){return new $4(G4.cloneWithFrontModifier(this.#J,J.toOperationNode()))}nullsNotDistinct(){return new $4(G4.cloneWith(this.#J,{nullsNotDistinct:!0}))}ifNotExists(){return new $4(G4.cloneWith(this.#J,{ifNotExists:!0}))}modifyEnd(J){return new $4(G4.cloneWithEndModifier(this.#J,J.toOperationNode()))}$call(J){return J(this)}toOperationNode(){return this.#J}}var g5=D(()=>{nG();rG();PG();W0();dG();F3();N3();U3();Q3()});var L3;var V3=D(()=>{C();L3=U({is(J){return J.kind==="ModifyColumnNode"},create(J){return U({kind:"ModifyColumnNode",column:J})}})});var a8;var aG=D(()=>{C();e6();rG();a8=U({is(J){return J.kind==="ForeignKeyConstraintNode"},create(J,W,X,G){return U({kind:"ForeignKeyConstraintNode",columns:J,references:f1.create(W,X),name:G?X6.create(G):void 0})},cloneWith(J,W){return U({...J,...W})}})});class t8{#J;constructor(J){this.#J=J}onDelete(J){return new t8(a8.cloneWith(this.#J,{onDelete:g1(J)}))}onUpdate(J){return new t8(a8.cloneWith(this.#J,{onUpdate:g1(J)}))}deferrable(){return new t8(a8.cloneWith(this.#J,{deferrable:!0}))}notDeferrable(){return new t8(a8.cloneWith(this.#J,{deferrable:!1}))}initiallyDeferred(){return new t8(a8.cloneWith(this.#J,{initiallyDeferred:!0}))}initiallyImmediate(){return new t8(a8.cloneWith(this.#J,{initiallyDeferred:!1}))}$call(J){return J(this)}toOperationNode(){return this.#J}}var m5=D(()=>{aG();Q3()});var m1;var y5=D(()=>{C();m1=U({is(J){return J.kind==="AddConstraintNode"},create(J){return U({kind:"AddConstraintNode",constraint:J})}})});var LJ;var tG=D(()=>{C();L0();e6();LJ=U({is(J){return J.kind==="UniqueConstraintNode"},create(J,W,X){return U({kind:"UniqueConstraintNode",columns:U(J.map(S6.create)),name:W?X6.create(W):void 0,nullsNotDistinct:X})},cloneWith(J,W){return U({...J,...W})}})});var y1;var x5=D(()=>{C();e6();y1=U({is(J){return J.kind==="DropConstraintNode"},create(J){return U({kind:"DropConstraintNode",constraintName:X6.create(J)})},cloneWith(J,W){return U({...J,...W})}})});var x1;var D3=D(()=>{C();L0();x1=U({is(J){return J.kind==="AlterColumnNode"},create(J,W,X){return U({kind:"AlterColumnNode",column:S6.create(J),[W]:X})}})});class u5{#J;constructor(J){this.#J=J}setDataType(J){return new u1(x1.create(this.#J,"dataType",i8(J)))}setDefault(J){return new u1(x1.create(this.#J,"setDefault",f5(J)))}dropDefault(){return new u1(x1.create(this.#J,"dropDefault",!0))}setNotNull(){return new u1(x1.create(this.#J,"setNotNull",!0))}dropNotNull(){return new u1(x1.create(this.#J,"dropNotNull",!0))}$call(J){return J(this)}}class u1{#J;constructor(J){this.#J=J}toOperationNode(){return this.#J}}var v3=D(()=>{D3();pG();F3()});class RW{#J;constructor(J){this.#J=U(J)}toOperationNode(){return this.#J.executor.transformQuery(this.#J.node,this.#J.queryId)}compile(){return this.#J.executor.compileQuery(this.toOperationNode(),this.#J.queryId)}async execute(){await this.#J.executor.executeQuery(this.compile())}}var CM=D(()=>{C()});class pJ{#J;constructor(J){this.#J=U(J)}onDelete(J){return new pJ({...this.#J,constraintBuilder:this.#J.constraintBuilder.onDelete(J)})}onUpdate(J){return new pJ({...this.#J,constraintBuilder:this.#J.constraintBuilder.onUpdate(J)})}deferrable(){return new pJ({...this.#J,constraintBuilder:this.#J.constraintBuilder.deferrable()})}notDeferrable(){return new pJ({...this.#J,constraintBuilder:this.#J.constraintBuilder.notDeferrable()})}initiallyDeferred(){return new pJ({...this.#J,constraintBuilder:this.#J.constraintBuilder.initiallyDeferred()})}initiallyImmediate(){return new pJ({...this.#J,constraintBuilder:this.#J.constraintBuilder.initiallyImmediate()})}$call(J){return J(this)}toOperationNode(){return this.#J.executor.transformQuery(q6.cloneWithTableProps(this.#J.node,{addConstraint:m1.create(this.#J.constraintBuilder.toOperationNode())}),this.#J.queryId)}compile(){return this.#J.executor.compileQuery(this.toOperationNode(),this.#J.queryId)}async execute(){await this.#J.executor.executeQuery(this.compile())}}var IM=D(()=>{y5();FX();C()});class _X{#J;constructor(J){this.#J=U(J)}ifExists(){return new _X({...this.#J,node:q6.cloneWithTableProps(this.#J.node,{dropConstraint:y1.cloneWith(this.#J.node.dropConstraint,{ifExists:!0})})})}cascade(){return new _X({...this.#J,node:q6.cloneWithTableProps(this.#J.node,{dropConstraint:y1.cloneWith(this.#J.node.dropConstraint,{modifier:"cascade"})})})}restrict(){return new _X({...this.#J,node:q6.cloneWithTableProps(this.#J.node,{dropConstraint:y1.cloneWith(this.#J.node.dropConstraint,{modifier:"restrict"})})})}$call(J){return J(this)}toOperationNode(){return this.#J.executor.transformQuery(this.#J.node,this.#J.queryId)}compile(){return this.#J.executor.compileQuery(this.toOperationNode(),this.#J.queryId)}async execute(){await this.#J.executor.executeQuery(this.compile())}}var bM=D(()=>{FX();x5();C()});var dJ;var oG=D(()=>{C();L0();e6();dJ=U({is(J){return J.kind==="PrimaryKeyConstraintNode"},create(J,W){return U({kind:"PrimaryKeyConstraintNode",columns:U(J.map(S6.create)),name:W?X6.create(W):void 0})},cloneWith(J,W){return U({...J,...W})}})});var CW;var l5=D(()=>{C();e6();CW=U({is(J){return J.kind==="AddIndexNode"},create(J){return U({kind:"AddIndexNode",name:X6.create(J)})},cloneWith(J,W){return U({...J,...W})},cloneWithColumns(J,W){return U({...J,columns:[...J.columns||[],...W]})}})});class IW{#J;constructor(J){this.#J=U(J)}unique(){return new IW({...this.#J,node:q6.cloneWithTableProps(this.#J.node,{addIndex:CW.cloneWith(this.#J.node.addIndex,{unique:!0})})})}column(J){return new IW({...this.#J,node:q6.cloneWithTableProps(this.#J.node,{addIndex:CW.cloneWithColumns(this.#J.node.addIndex,[M1(J)])})})}columns(J){return new IW({...this.#J,node:q6.cloneWithTableProps(this.#J.node,{addIndex:CW.cloneWithColumns(this.#J.node.addIndex,J.map(M1))})})}expression(J){return new IW({...this.#J,node:q6.cloneWithTableProps(this.#J.node,{addIndex:CW.cloneWithColumns(this.#J.node.addIndex,[J.toOperationNode()])})})}using(J){return new IW({...this.#J,node:q6.cloneWithTableProps(this.#J.node,{addIndex:CW.cloneWith(this.#J.node.addIndex,{using:B6.createWithSql(J)})})})}$call(J){return J(this)}toOperationNode(){return this.#J.executor.transformQuery(this.#J.node,this.#J.queryId)}compile(){return this.#J.executor.compileQuery(this.toOperationNode(),this.#J.queryId)}async execute(){await this.#J.executor.executeQuery(this.compile())}}var kM=D(()=>{l5();FX();_8();W0();C()});class VJ{#J;constructor(J){this.#J=J}nullsNotDistinct(){return new VJ(LJ.cloneWith(this.#J,{nullsNotDistinct:!0}))}deferrable(){return new VJ(LJ.cloneWith(this.#J,{deferrable:!0}))}notDeferrable(){return new VJ(LJ.cloneWith(this.#J,{deferrable:!1}))}initiallyDeferred(){return new VJ(LJ.cloneWith(this.#J,{initiallyDeferred:!0}))}initiallyImmediate(){return new VJ(LJ.cloneWith(this.#J,{initiallyDeferred:!1}))}$call(J){return J(this)}toOperationNode(){return this.#J}}var M3=D(()=>{tG()});class nJ{#J;constructor(J){this.#J=J}deferrable(){return new nJ(dJ.cloneWith(this.#J,{deferrable:!0}))}notDeferrable(){return new nJ(dJ.cloneWith(this.#J,{deferrable:!1}))}initiallyDeferred(){return new nJ(dJ.cloneWith(this.#J,{initiallyDeferred:!0}))}initiallyImmediate(){return new nJ(dJ.cloneWith(this.#J,{initiallyDeferred:!1}))}$call(J){return J(this)}toOperationNode(){return this.#J}}var O3=D(()=>{oG()});class sG{#J;constructor(J){this.#J=J}$call(J){return J(this)}toOperationNode(){return this.#J}}var hM;var P3=D(()=>{C();e6();hM=U({is(J){return J.kind==="RenameConstraintNode"},create(J,W){return U({kind:"RenameConstraintNode",oldName:X6.create(J),newName:X6.create(W)})}})});class j3{#J;constructor(J){this.#J=U(J)}renameTo(J){return new RW({...this.#J,node:q6.cloneWithTableProps(this.#J.node,{renameTo:A6(J)})})}setSchema(J){return new RW({...this.#J,node:q6.cloneWithTableProps(this.#J.node,{setSchema:X6.create(J)})})}alterColumn(J,W){let X=W(new u5(J));return new o8({...this.#J,node:q6.cloneWithColumnAlteration(this.#J.node,X.toOperationNode())})}dropColumn(J){return new o8({...this.#J,node:q6.cloneWithColumnAlteration(this.#J.node,w3.create(J))})}renameColumn(J,W){return new o8({...this.#J,node:q6.cloneWithColumnAlteration(this.#J.node,Z3.create(J,W))})}addColumn(J,W,X=q0){let G=X(new $4(G4.create(J,i8(W))));return new o8({...this.#J,node:q6.cloneWithColumnAlteration(this.#J.node,$3.create(G.toOperationNode()))})}modifyColumn(J,W,X=q0){let G=X(new $4(G4.create(J,i8(W))));return new o8({...this.#J,node:q6.cloneWithColumnAlteration(this.#J.node,L3.create(G.toOperationNode()))})}addUniqueConstraint(J,W,X=q0){let G=X(new VJ(LJ.create(W,J)));return new RW({...this.#J,node:q6.cloneWithTableProps(this.#J.node,{addConstraint:m1.create(G.toOperationNode())})})}addCheckConstraint(J,W,X=q0){let G=X(new sG(h1.create(W.toOperationNode(),J)));return new RW({...this.#J,node:q6.cloneWithTableProps(this.#J.node,{addConstraint:m1.create(G.toOperationNode())})})}addForeignKeyConstraint(J,W,X,G,Y=q0){let $=Y(new t8(a8.create(W.map(S6.create),A6(X),G.map(S6.create),J)));return new pJ({...this.#J,constraintBuilder:$})}addPrimaryKeyConstraint(J,W,X=q0){let G=X(new nJ(dJ.create(W,J)));return new RW({...this.#J,node:q6.cloneWithTableProps(this.#J.node,{addConstraint:m1.create(G.toOperationNode())})})}dropConstraint(J){return new _X({...this.#J,node:q6.cloneWithTableProps(this.#J.node,{dropConstraint:y1.create(J)})})}renameConstraint(J,W){return new _X({...this.#J,node:q6.cloneWithTableProps(this.#J.node,{renameConstraint:hM.create(J,W)})})}addIndex(J){return new IW({...this.#J,node:q6.cloneWithTableProps(this.#J.node,{addIndex:CW.create(J)})})}dropIndex(J){return new RW({...this.#J,node:q6.cloneWithTableProps(this.#J.node,{dropIndex:vW.create(J)})})}$call(J){return J(this)}}class o8{#J;constructor(J){this.#J=U(J)}alterColumn(J,W){let X=W(new u5(J));return new o8({...this.#J,node:q6.cloneWithColumnAlteration(this.#J.node,X.toOperationNode())})}dropColumn(J){return new o8({...this.#J,node:q6.cloneWithColumnAlteration(this.#J.node,w3.create(J))})}renameColumn(J,W){return new o8({...this.#J,node:q6.cloneWithColumnAlteration(this.#J.node,Z3.create(J,W))})}addColumn(J,W,X=q0){let G=X(new $4(G4.create(J,i8(W))));return new o8({...this.#J,node:q6.cloneWithColumnAlteration(this.#J.node,$3.create(G.toOperationNode()))})}modifyColumn(J,W,X=q0){let G=X(new $4(G4.create(J,i8(W))));return new o8({...this.#J,node:q6.cloneWithColumnAlteration(this.#J.node,L3.create(G.toOperationNode()))})}toOperationNode(){return this.#J.executor.transformQuery(this.#J.node,this.#J.queryId)}compile(){return this.#J.executor.compileQuery(this.toOperationNode(),this.#J.queryId)}async execute(){await this.#J.executor.executeQuery(this.compile())}}var _3=D(()=>{K3();FX();dG();H3();e6();z3();C();g5();V3();pG();m5();y5();tG();nG();aG();L0();G0();x5();v3();CM();IM();bM();oG();DG();l5();kM();M3();O3();P3()});var eG;var S3=D(()=>{MX();jW();c8();eG=class eG extends r8{transformPrimitiveValueList(J){return l8.create(J.values.map(E4.createImmediate))}transformValue(J){return E4.createImmediate(J.value)}}});class A8{#J;constructor(J){this.#J=U(J)}ifNotExists(){return new A8({...this.#J,node:h8.cloneWith(this.#J.node,{ifNotExists:!0})})}unique(){return new A8({...this.#J,node:h8.cloneWith(this.#J.node,{unique:!0})})}nullsNotDistinct(){return new A8({...this.#J,node:h8.cloneWith(this.#J.node,{nullsNotDistinct:!0})})}on(J){return new A8({...this.#J,node:h8.cloneWith(this.#J.node,{table:A6(J)})})}column(J){return new A8({...this.#J,node:h8.cloneWithColumns(this.#J.node,[M1(J)])})}columns(J){return new A8({...this.#J,node:h8.cloneWithColumns(this.#J.node,J.map(M1))})}expression(J){return new A8({...this.#J,node:h8.cloneWithColumns(this.#J.node,[J.toOperationNode()])})}using(J){return new A8({...this.#J,node:h8.cloneWith(this.#J.node,{using:B6.createWithSql(J)})})}where(...J){let W=new eG;return new A8({...this.#J,node:a.cloneWithWhere(this.#J.node,W.transformNode(J4(J),this.#J.queryId))})}$call(J){return J(this)}toOperationNode(){return this.#J.executor.transformQuery(this.#J.node,this.#J.queryId)}compile(){return this.#J.executor.compileQuery(this.toOperationNode(),this.#J.queryId)}async execute(){await this.#J.executor.executeQuery(this.compile())}}var T3=D(()=>{i$();_8();W0();G0();C();Y8();S8();S3()});class c5{#J;constructor(J){this.#J=U(J)}ifNotExists(){return new c5({...this.#J,node:a$.cloneWith(this.#J.node,{ifNotExists:!0})})}$call(J){return J(this)}toOperationNode(){return this.#J.executor.transformQuery(this.#J.node,this.#J.queryId)}compile(){return this.#J.executor.compileQuery(this.toOperationNode(),this.#J.queryId)}async execute(){await this.#J.executor.executeQuery(this.compile())}}var q3=D(()=>{t$();C()});function fM(J){if(qv.includes(J))return J;throw Error(`invalid OnCommitAction ${J}`)}var gM=D(()=>{N1()});class c0{#J;constructor(J){this.#J=U(J)}temporary(){return new c0({...this.#J,node:N0.cloneWith(this.#J.node,{temporary:!0})})}onCommit(J){return new c0({...this.#J,node:N0.cloneWith(this.#J.node,{onCommit:fM(J)})})}ifNotExists(){return new c0({...this.#J,node:N0.cloneWith(this.#J.node,{ifNotExists:!0})})}addColumn(J,W,X=q0){let G=X(new $4(G4.create(J,i8(W))));return new c0({...this.#J,node:N0.cloneWithColumn(this.#J.node,G.toOperationNode())})}addPrimaryKeyConstraint(J,W,X=q0){let G=X(new nJ(dJ.create(W,J)));return new c0({...this.#J,node:N0.cloneWithConstraint(this.#J.node,G.toOperationNode())})}addUniqueConstraint(J,W,X=q0){let G=X(new VJ(LJ.create(W,J)));return new c0({...this.#J,node:N0.cloneWithConstraint(this.#J.node,G.toOperationNode())})}addCheckConstraint(J,W,X=q0){let G=X(new sG(h1.create(W.toOperationNode(),J)));return new c0({...this.#J,node:N0.cloneWithConstraint(this.#J.node,G.toOperationNode())})}addForeignKeyConstraint(J,W,X,G,Y=q0){let $=Y(new t8(a8.create(W.map(S6.create),A6(X),G.map(S6.create),J)));return new c0({...this.#J,node:N0.cloneWithConstraint(this.#J.node,$.toOperationNode())})}modifyFront(J){return new c0({...this.#J,node:N0.cloneWithFrontModifier(this.#J.node,J.toOperationNode())})}modifyEnd(J){return new c0({...this.#J,node:N0.cloneWithEndModifier(this.#J.node,J.toOperationNode())})}as(J){return new c0({...this.#J,node:N0.cloneWith(this.#J.node,{selectQuery:x0(J)})})}$call(J){return J(this)}toOperationNode(){return this.#J.executor.transformQuery(this.#J.node,this.#J.queryId)}compile(){return this.#J.executor.compileQuery(this.toOperationNode(),this.#J.queryId)}async execute(){await this.#J.executor.executeQuery(this.compile())}}var B3=D(()=>{dG();N1();g5();C();aG();L0();m5();pG();oG();tG();nG();G0();gM();M3();u8();O3()});class l1{#J;constructor(J){this.#J=U(J)}on(J){return new l1({...this.#J,node:vW.cloneWith(this.#J.node,{table:A6(J)})})}ifExists(){return new l1({...this.#J,node:vW.cloneWith(this.#J.node,{ifExists:!0})})}cascade(){return new l1({...this.#J,node:vW.cloneWith(this.#J.node,{cascade:!0})})}$call(J){return J(this)}toOperationNode(){return this.#J.executor.transformQuery(this.#J.node,this.#J.queryId)}compile(){return this.#J.executor.compileQuery(this.toOperationNode(),this.#J.queryId)}async execute(){await this.#J.executor.executeQuery(this.compile())}}var A3=D(()=>{DG();G0();C()});class J9{#J;constructor(J){this.#J=U(J)}ifExists(){return new J9({...this.#J,node:vG.cloneWith(this.#J.node,{ifExists:!0})})}cascade(){return new J9({...this.#J,node:vG.cloneWith(this.#J.node,{cascade:!0})})}$call(J){return J(this)}toOperationNode(){return this.#J.executor.transformQuery(this.#J.node,this.#J.queryId)}compile(){return this.#J.executor.compileQuery(this.toOperationNode(),this.#J.queryId)}async execute(){await this.#J.executor.executeQuery(this.compile())}}var E3=D(()=>{o$();C()});class W9{#J;constructor(J){this.#J=U(J)}ifExists(){return new W9({...this.#J,node:MG.cloneWith(this.#J.node,{ifExists:!0})})}cascade(){return new W9({...this.#J,node:MG.cloneWith(this.#J.node,{cascade:!0})})}$call(J){return J(this)}toOperationNode(){return this.#J.executor.transformQuery(this.#J.node,this.#J.queryId)}compile(){return this.#J.executor.compileQuery(this.toOperationNode(),this.#J.queryId)}async execute(){await this.#J.executor.executeQuery(this.compile())}}var R3=D(()=>{s$();C()});var s8;var X9=D(()=>{C();gJ();s8=U({is(J){return J.kind==="CreateViewNode"},create(J){return U({kind:"CreateViewNode",name:U0.create(J)})},cloneWith(J,W){return U({...J,...W})}})});class C3{#J=new eG;transformQuery(J){return this.#J.transformNode(J.node,J.queryId)}transformResult(J){return Promise.resolve(J.result)}}var mM=D(()=>{S3()});class rJ{#J;constructor(J){this.#J=U(J)}temporary(){return new rJ({...this.#J,node:s8.cloneWith(this.#J.node,{temporary:!0})})}materialized(){return new rJ({...this.#J,node:s8.cloneWith(this.#J.node,{materialized:!0})})}ifNotExists(){return new rJ({...this.#J,node:s8.cloneWith(this.#J.node,{ifNotExists:!0})})}orReplace(){return new rJ({...this.#J,node:s8.cloneWith(this.#J.node,{orReplace:!0})})}columns(J){return new rJ({...this.#J,node:s8.cloneWith(this.#J.node,{columns:J.map(aH)})})}as(J){let W=J.withPlugin(new C3).toOperationNode();return new rJ({...this.#J,node:s8.cloneWith(this.#J.node,{as:W})})}$call(J){return J(this)}toOperationNode(){return this.#J.executor.transformQuery(this.#J.node,this.#J.queryId)}compile(){return this.#J.executor.compileQuery(this.toOperationNode(),this.#J.queryId)}async execute(){await this.#J.executor.executeQuery(this.compile())}}var I3=D(()=>{C();X9();W0();mM()});var c1;var p5=D(()=>{C();gJ();c1=U({is(J){return J.kind==="DropViewNode"},create(J){return U({kind:"DropViewNode",name:U0.create(J)})},cloneWith(J,W){return U({...J,...W})}})});class p1{#J;constructor(J){this.#J=U(J)}materialized(){return new p1({...this.#J,node:c1.cloneWith(this.#J.node,{materialized:!0})})}ifExists(){return new p1({...this.#J,node:c1.cloneWith(this.#J.node,{ifExists:!0})})}cascade(){return new p1({...this.#J,node:c1.cloneWith(this.#J.node,{cascade:!0})})}$call(J){return J(this)}toOperationNode(){return this.#J.executor.transformQuery(this.#J.node,this.#J.queryId)}compile(){return this.#J.executor.compileQuery(this.toOperationNode(),this.#J.queryId)}async execute(){await this.#J.executor.executeQuery(this.compile())}}var b3=D(()=>{C();p5()});var d5;var n5=D(()=>{C();jW();c8();d5=U({is(J){return J.kind==="CreateTypeNode"},create(J){return U({kind:"CreateTypeNode",name:J})},cloneWithEnum(J,W){return U({...J,enum:l8.create(W.map(E4.createImmediate))})}})});class r5{#J;constructor(J){this.#J=U(J)}toOperationNode(){return this.#J.executor.transformQuery(this.#J.node,this.#J.queryId)}asEnum(J){return new r5({...this.#J,node:d5.cloneWithEnum(this.#J.node,J)})}$call(J){return J(this)}compile(){return this.#J.executor.compileQuery(this.toOperationNode(),this.#J.queryId)}async execute(){await this.#J.executor.executeQuery(this.compile())}}var k3=D(()=>{C();n5()});var i5;var a5=D(()=>{C();i5=U({is(J){return J.kind==="DropTypeNode"},create(J){return U({kind:"DropTypeNode",name:J})},cloneWith(J,W){return U({...J,...W})}})});class t5{#J;constructor(J){this.#J=U(J)}ifExists(){return new t5({...this.#J,node:i5.cloneWith(this.#J.node,{ifExists:!0})})}$call(J){return J(this)}toOperationNode(){return this.#J.executor.transformQuery(this.#J.node,this.#J.queryId)}compile(){return this.#J.executor.compileQuery(this.toOperationNode(),this.#J.queryId)}async execute(){await this.#J.executor.executeQuery(this.compile())}}var h3=D(()=>{a5();C()});function f3(J){if(J.includes(".")){let X=J.split(".").map(NR);if(X.length===2)return U0.createWithSchema(X[0],X[1]);else throw Error(`invalid schemable identifier ${J}`)}else return U0.create(J)}function NR(J){return J.trim()}var yM=D(()=>{gJ()});var d1;var o5=D(()=>{C();gJ();d1=U({is(J){return J.kind==="RefreshMaterializedViewNode"},create(J){return U({kind:"RefreshMaterializedViewNode",name:U0.create(J)})},cloneWith(J,W){return U({...J,...W})}})});class n1{#J;constructor(J){this.#J=U(J)}concurrently(){return new n1({...this.#J,node:d1.cloneWith(this.#J.node,{concurrently:!0,withNoData:!1})})}withData(){return new n1({...this.#J,node:d1.cloneWith(this.#J.node,{withNoData:!1})})}withNoData(){return new n1({...this.#J,node:d1.cloneWith(this.#J.node,{withNoData:!0,concurrently:!1})})}$call(J){return J(this)}toOperationNode(){return this.#J.executor.transformQuery(this.#J.node,this.#J.queryId)}compile(){return this.#J.executor.compileQuery(this.toOperationNode(),this.#J.queryId)}async execute(){await this.#J.executor.executeQuery(this.compile())}}var g3=D(()=>{C();o5()});class r1{#J;constructor(J){this.#J=J}createTable(J){return new c0({queryId:w6(),executor:this.#J,node:N0.create(A6(J))})}dropTable(J){return new W9({queryId:w6(),executor:this.#J,node:MG.create(A6(J))})}createIndex(J){return new A8({queryId:w6(),executor:this.#J,node:h8.create(J)})}dropIndex(J){return new l1({queryId:w6(),executor:this.#J,node:vW.create(J)})}createSchema(J){return new c5({queryId:w6(),executor:this.#J,node:a$.create(J)})}dropSchema(J){return new J9({queryId:w6(),executor:this.#J,node:vG.create(J)})}alterTable(J){return new j3({queryId:w6(),executor:this.#J,node:q6.create(A6(J))})}createView(J){return new rJ({queryId:w6(),executor:this.#J,node:s8.create(J)})}refreshMaterializedView(J){return new n1({queryId:w6(),executor:this.#J,node:d1.create(J)})}dropView(J){return new p1({queryId:w6(),executor:this.#J,node:c1.create(J)})}createType(J){return new r5({queryId:w6(),executor:this.#J,node:d5.create(f3(J))})}dropType(J){return new t5({queryId:w6(),executor:this.#J,node:i5.create(f3(J))})}withPlugin(J){return new r1(this.#J.withPlugin(J))}withoutPlugins(){return new r1(this.#J.withoutPlugins())}withSchema(J){return new r1(this.#J.withPluginAtFront(new $8(J)))}}var m3=D(()=>{FX();i$();t$();N1();DG();o$();s$();G0();_3();T3();q3();B3();A3();E3();R3();B8();OX();I3();X9();b3();p5();k3();h3();n5();a5();yM();g3();o5()});class y3{ref(J){return new cH(J)}table(J){return new G3(J)}}var x3=D(()=>{jG();h5()});class u3{#J;constructor(J){this.#J=J}async provideConnection(J){let W=await this.#J.acquireConnection();try{return await J(W)}finally{await this.#J.releaseConnection(W)}}}var bW;var l3=D(()=>{mZ();bW=class bW extends mG{#J;#W;#X;constructor(J,W,X,G=[]){super(G);this.#J=J,this.#W=W,this.#X=X}get adapter(){return this.#W}compileQuery(J,W){return this.#J.compileQuery(J,W)}provideConnection(J){return this.#X.provideConnection(J)}withPlugins(J){return new bW(this.#J,this.#W,this.#X,[...this.plugins,...J])}withPlugin(J){return new bW(this.#J,this.#W,this.#X,[...this.plugins,J])}withPluginAtFront(J){return new bW(this.#J,this.#W,this.#X,[J,...this.plugins])}withConnectionProvider(J){return new bW(this.#J,this.#W,J,[...this.plugins])}withoutPlugins(){return new bW(this.#J,this.#W,this.#X,[])}}});function s5(){if(typeof performance<"u"&&f6(performance.now))return performance.now();else return Date.now()}var xM=D(()=>{C()});class c3{#J;#W;#X;#Y;#G;#w=new WeakSet;constructor(J,W){this.#Y=!1,this.#J=J,this.#W=W}async init(){if(this.#G)throw Error("driver has already been destroyed");if(!this.#X)this.#X=this.#J.init().then(()=>{this.#Y=!0}).catch((J)=>{return this.#X=void 0,Promise.reject(J)});await this.#X}async acquireConnection(){if(this.#G)throw Error("driver has already been destroyed");if(!this.#Y)await this.init();let J=await this.#J.acquireConnection();if(!this.#w.has(J)){if(this.#K())this.#$(J);this.#w.add(J)}return J}async releaseConnection(J){await this.#J.releaseConnection(J)}beginTransaction(J,W){return this.#J.beginTransaction(J,W)}commitTransaction(J){return this.#J.commitTransaction(J)}rollbackTransaction(J){return this.#J.rollbackTransaction(J)}savepoint(J,W,X){if(this.#J.savepoint)return this.#J.savepoint(J,W,X);throw Error("The `savepoint` method is not supported by this driver")}rollbackToSavepoint(J,W,X){if(this.#J.rollbackToSavepoint)return this.#J.rollbackToSavepoint(J,W,X);throw Error("The `rollbackToSavepoint` method is not supported by this driver")}releaseSavepoint(J,W,X){if(this.#J.releaseSavepoint)return this.#J.releaseSavepoint(J,W,X);throw Error("The `releaseSavepoint` method is not supported by this driver")}async destroy(){if(!this.#X)return;if(await this.#X,!this.#G)this.#G=this.#J.destroy().catch((J)=>{return this.#G=void 0,Promise.reject(J)});await this.#G}#K(){return this.#W.isLevelEnabled("query")||this.#W.isLevelEnabled("error")}#$(J){let{executeQuery:W,streamQuery:X}=J,G=this;J.executeQuery=async(Y)=>{let $,K=s5();try{return await W.call(J,Y)}catch(w){throw $=w,await G.#H(w,Y,K),w}finally{if(!$)await G.#Z(Y,K)}},J.streamQuery=async function*(Y,$){let K,w=s5();try{for await(let H of X.call(J,Y,$))yield H}catch(H){throw K=H,await G.#H(H,Y,w),H}finally{if(!K)await G.#Z(Y,w,!0)}}}async#H(J,W,X){await this.#W.error(()=>({level:"error",error:J,query:W,queryDurationMillis:this.#F(X)}))}async#Z(J,W,X=!1){await this.#W.query(()=>({level:"query",isStream:X,query:J,queryDurationMillis:this.#F(W)}))}#F(J){return s5()-J}}var uM=D(()=>{xM()});class Y9{#J;#W;constructor(J){this.#J=J}async provideConnection(J){while(this.#W)await this.#W.catch(UR);return this.#W=this.#X(J).finally(()=>{this.#W=void 0}),this.#W}async#X(J){return await J(this.#J)}}var UR=()=>{};function p3(J){if(J.accessMode&&!QR.includes(J.accessMode))throw Error(`invalid transaction access mode ${J.accessMode}`);if(J.isolationLevel&&!LR.includes(J.isolationLevel))throw Error(`invalid transaction isolation level ${J.isolationLevel}`)}var QR,LR;var d3=D(()=>{QR=["read only","read write"],LR=["read uncommitted","read committed","repeatable read","serializable","snapshot"]});class n3{#J;#W;constructor(J){if(f6(J))this.#W=J,this.#J=U({query:!0,error:!0});else this.#W=VR,this.#J=U({query:J.includes("query"),error:J.includes("error")})}isLevelEnabled(J){return this.#J[J]}async query(J){if(this.#J.query)await this.#W(J())}async error(J){if(this.#J.error)await this.#W(J())}}function VR(J){if(J.level==="query"){let W=`kysely:query:${J.isStream?"stream:":""}`;console.log(`${W} ${J.query.sql}`),console.log(`${W} duration: ${J.queryDurationMillis.toFixed(1)}ms`)}else if(J.level==="error")if(J.error instanceof Error)console.error(`kysely:error: ${J.error.stack??J.error.message}`);else console.error(`kysely:error: ${JSON.stringify({error:J.error,query:J.query.sql,queryDurationMillis:J.queryDurationMillis})}`)}var $X6;var r3=D(()=>{C();$X6=U(["query","error"])});function lM(J){return s6(J)&&f6(J.compile)}var i3=D(()=>{C()});function DR(J){return s6(J)&&s6(J.config)&&s6(J.driver)&&s6(J.executor)&&s6(J.dialect)}class cM{#J;constructor(J){this.#J=U(J)}async execute(J){return this.#J.executor.provideConnection(async(W)=>{let X=this.#J.executor.withConnectionProvider(new Y9(W)),G=new w8({...this.#J,executor:X});return await J(G)})}}class e5{#J;constructor(J){this.#J=U(J)}setAccessMode(J){return new e5({...this.#J,accessMode:J})}setIsolationLevel(J){return new e5({...this.#J,isolationLevel:J})}async execute(J){let{isolationLevel:W,accessMode:X,...G}=this.#J,Y={isolationLevel:W,accessMode:X};return p3(Y),this.#J.executor.provideConnection(async($)=>{let K=this.#J.executor.withConnectionProvider(new Y9($)),w=new TX({...G,executor:K}),H=!1;try{await this.#J.driver.beginTransaction($,Y),H=!0;let Z=await J(w);return await this.#J.driver.commitTransaction($),Z}catch(Z){if(H)await this.#J.driver.rollbackTransaction($);throw Z}})}}class JK{#J;constructor(J){this.#J=U(J)}setAccessMode(J){return new JK({...this.#J,accessMode:J})}setIsolationLevel(J){return new JK({...this.#J,isolationLevel:J})}async execute(){let{isolationLevel:J,accessMode:W,...X}=this.#J,G={isolationLevel:J,accessMode:W};p3(G);let Y=await P5(this.#J.executor);return await this.#J.driver.beginTransaction(Y.connection,G),new iJ({...X,connection:Y,executor:this.#J.executor.withConnectionProvider(new Y9(Y.connection))})}}class i1{#J;constructor(J){this.#J=J}async execute(){return await this.#J()}}function SX(J){if(J.isCommitted)throw Error("Transaction is already committed");if(J.isRolledBack)throw Error("Transaction is already rolled back")}class kW{#J;#W;constructor(J,W){if(J instanceof kW)this.#J=J.#J;else this.#J=J;this.#W=W}get adapter(){return this.#J.adapter}get plugins(){return this.#J.plugins}transformQuery(J,W){return this.#J.transformQuery(J,W)}compileQuery(J,W){return this.#J.compileQuery(J,W)}provideConnection(J){return this.#J.provideConnection(J)}executeQuery(J){return SX(this.#W),this.#J.executeQuery(J)}stream(J,W){return SX(this.#W),this.#J.stream(J,W)}withConnectionProvider(J){return new kW(this.#J.withConnectionProvider(J),this.#W)}withPlugin(J){return new kW(this.#J.withPlugin(J),this.#W)}withPlugins(J){return new kW(this.#J.withPlugins(J),this.#W)}withPluginAtFront(J){return new kW(this.#J.withPluginAtFront(J),this.#W)}withoutPlugins(){return new kW(this.#J.withoutPlugins(),this.#W)}}var w8,TX,iJ;var pM=D(()=>{m3();x3();j5();l3();C();uM();d3();C5();r3();B8();i3();I5();xG();u8();OX();gZ();D1();Symbol.asyncDispose??=Symbol("Symbol.asyncDispose");w8=class w8 extends UJ{#J;constructor(J){let W,X;if(DR(J))W={executor:J.executor},X={...J};else{let G=J.dialect,Y=G.createDriver(),$=G.createQueryCompiler(),K=G.createAdapter(),w=new n3(J.log??[]),H=new c3(Y,w),Z=new u3(H),z=new bW($,K,Z,J.plugins??[]);W={executor:z},X={config:J,executor:z,dialect:G,driver:H}}super(W);this.#J=U(X)}get schema(){return new r1(this.#J.executor)}get dynamic(){return new y3}get introspection(){return this.#J.dialect.createIntrospector(this.withoutPlugins())}case(J){return new uG({node:K8.create(T0(J)?void 0:x0(J))})}get fn(){return R5()}transaction(){return new e5({...this.#J})}startTransaction(){return new JK({...this.#J})}connection(){return new cM({...this.#J})}withPlugin(J){return new w8({...this.#J,executor:this.#J.executor.withPlugin(J)})}withoutPlugins(){return new w8({...this.#J,executor:this.#J.executor.withoutPlugins()})}withSchema(J){return new w8({...this.#J,executor:this.#J.executor.withPluginAtFront(new $8(J))})}withTables(){return new w8({...this.#J})}async destroy(){await this.#J.driver.destroy()}get isTransaction(){return!1}getExecutor(){return this.#J.executor}executeQuery(J,W){if(W!==void 0)x8("Passing `queryId` in `db.executeQuery` is deprecated and will result in a compile-time error in the future.");let X=lM(J)?J.compile():J;return this.getExecutor().executeQuery(X)}async[Symbol.asyncDispose](){await this.destroy()}};TX=class TX extends w8{#J;constructor(J){super(J);this.#J=J}get isTransaction(){return!0}transaction(){throw Error("calling the transaction method for a Transaction is not supported")}connection(){throw Error("calling the connection method for a Transaction is not supported")}async destroy(){throw Error("calling the destroy method for a Transaction is not supported")}withPlugin(J){return new TX({...this.#J,executor:this.#J.executor.withPlugin(J)})}withoutPlugins(){return new TX({...this.#J,executor:this.#J.executor.withoutPlugins()})}withSchema(J){return new TX({...this.#J,executor:this.#J.executor.withPluginAtFront(new $8(J))})}withTables(){return new TX({...this.#J})}};iJ=class iJ extends TX{#J;#W;#X;constructor(J){let W={isCommitted:!1,isRolledBack:!1};J={...J,executor:new kW(J.executor,W)};let{connection:X,...G}=J;super(G);this.#J=U(J),this.#X=W;let Y=w6();this.#W=($)=>J.executor.compileQuery($,Y)}get isCommitted(){return this.#X.isCommitted}get isRolledBack(){return this.#X.isRolledBack}commit(){return SX(this.#X),new i1(async()=>{await this.#J.driver.commitTransaction(this.#J.connection.connection),this.#X.isCommitted=!0,this.#J.connection.release()})}rollback(){return SX(this.#X),new i1(async()=>{await this.#J.driver.rollbackTransaction(this.#J.connection.connection),this.#X.isRolledBack=!0,this.#J.connection.release()})}savepoint(J){return SX(this.#X),new i1(async()=>{return await this.#J.driver.savepoint?.(this.#J.connection.connection,J,this.#W),new iJ({...this.#J})})}rollbackToSavepoint(J){return SX(this.#X),new i1(async()=>{return await this.#J.driver.rollbackToSavepoint?.(this.#J.connection.connection,J,this.#W),new iJ({...this.#J})})}releaseSavepoint(J){return SX(this.#X),new i1(async()=>{return await this.#J.driver.releaseSavepoint?.(this.#J.connection.connection,J,this.#W),new iJ({...this.#J})})}withPlugin(J){return new iJ({...this.#J,executor:this.#J.executor.withPlugin(J)})}withoutPlugins(){return new iJ({...this.#J,executor:this.#J.executor.withoutPlugins()})}withSchema(J){return new iJ({...this.#J,executor:this.#J.executor.withPluginAtFront(new $8(J))})}withTables(){return new iJ({...this.#J})}}});var dM=()=>{};var nM=()=>{};var rM=()=>{};var iM=()=>{};var aM=()=>{};class G9{#J;constructor(J){this.#J=U(J)}get expressionType(){return}get isRawBuilder(){return!0}as(J){return new tM(this,J)}$castTo(){return new G9({...this.#J})}$notNull(){return new G9(this.#J)}withPlugin(J){return new G9({...this.#J,plugins:this.#J.plugins!==void 0?U([...this.#J.plugins,J]):U([J])})}toOperationNode(){return this.#X(this.#W())}compile(J){return this.#Y(this.#W(J))}async execute(J){let W=this.#W(J);return W.executeQuery(this.#Y(W))}#W(J){let W=J!==void 0?J.getExecutor():EW;return this.#J.plugins!==void 0?W.withPlugins(this.#J.plugins):W}#X(J){return J.transformQuery(this.#J.rawNode,this.#J.queryId)}#Y(J){return J.compileQuery(this.#X(J),this.#J.queryId)}}function aJ(J){return new G9(J)}class tM{#J;#W;constructor(J,W){this.#J=J,this.#W=W}get expression(){return this.#J}get alias(){return this.#W}get rawBuilder(){return this.#J}toOperationNode(){return c4.create(this.#J.toOperationNode(),X4(this.#W)?this.#W.toOperationNode():X6.create(this.#W))}}var a3=D(()=>{f8();C();I1();e6();m0()});function oM(J){if(X4(J))return J.toOperationNode();return i6(J)}var F6;var hW=D(()=>{e6();m0();_8();c8();W0();G0();ZJ();B8();a3();F6=Object.assign((J,...W)=>{return aJ({queryId:w6(),rawNode:B6.create(J,W?.map(oM)??[])})},{ref(J){return aJ({queryId:w6(),rawNode:B6.createWithChild(J8(J))})},val(J){return aJ({queryId:w6(),rawNode:B6.createWithChild(i6(J))})},value(J){return this.val(J)},table(J){return aJ({queryId:w6(),rawNode:B6.createWithChild(A6(J))})},id(...J){let W=Array(J.length+1).fill(".");return W[0]="",W[W.length-1]="",aJ({queryId:w6(),rawNode:B6.create(W,J.map(X6.create))})},lit(J){return aJ({queryId:w6(),rawNode:B6.createWithChild(E4.createImmediate(J))})},literal(J){return this.lit(J)},raw(J){return aJ({queryId:w6(),rawNode:B6.createWithSql(J)})},join(J,W=F6`, `){let X=Array(Math.max(2*J.length-1,0)),G=W.toOperationNode();for(let Y=0;Y<J.length;++Y)if(X[2*Y]=oM(J[Y]),Y!==J.length-1)X[2*Y+1]=G;return aJ({queryId:w6(),rawNode:B6.createWithChildren(X)})}})});var sM=()=>{};var eM=()=>{};class t3{nodeStack=[];get parentNode(){return this.nodeStack[this.nodeStack.length-2]}#J=U({AliasNode:this.visitAlias.bind(this),ColumnNode:this.visitColumn.bind(this),IdentifierNode:this.visitIdentifier.bind(this),SchemableIdentifierNode:this.visitSchemableIdentifier.bind(this),RawNode:this.visitRaw.bind(this),ReferenceNode:this.visitReference.bind(this),SelectQueryNode:this.visitSelectQuery.bind(this),SelectionNode:this.visitSelection.bind(this),TableNode:this.visitTable.bind(this),FromNode:this.visitFrom.bind(this),SelectAllNode:this.visitSelectAll.bind(this),AndNode:this.visitAnd.bind(this),OrNode:this.visitOr.bind(this),ValueNode:this.visitValue.bind(this),ValueListNode:this.visitValueList.bind(this),PrimitiveValueListNode:this.visitPrimitiveValueList.bind(this),ParensNode:this.visitParens.bind(this),JoinNode:this.visitJoin.bind(this),OperatorNode:this.visitOperator.bind(this),WhereNode:this.visitWhere.bind(this),InsertQueryNode:this.visitInsertQuery.bind(this),DeleteQueryNode:this.visitDeleteQuery.bind(this),ReturningNode:this.visitReturning.bind(this),CreateTableNode:this.visitCreateTable.bind(this),AddColumnNode:this.visitAddColumn.bind(this),ColumnDefinitionNode:this.visitColumnDefinition.bind(this),DropTableNode:this.visitDropTable.bind(this),DataTypeNode:this.visitDataType.bind(this),OrderByNode:this.visitOrderBy.bind(this),OrderByItemNode:this.visitOrderByItem.bind(this),GroupByNode:this.visitGroupBy.bind(this),GroupByItemNode:this.visitGroupByItem.bind(this),UpdateQueryNode:this.visitUpdateQuery.bind(this),ColumnUpdateNode:this.visitColumnUpdate.bind(this),LimitNode:this.visitLimit.bind(this),OffsetNode:this.visitOffset.bind(this),OnConflictNode:this.visitOnConflict.bind(this),OnDuplicateKeyNode:this.visitOnDuplicateKey.bind(this),CreateIndexNode:this.visitCreateIndex.bind(this),DropIndexNode:this.visitDropIndex.bind(this),ListNode:this.visitList.bind(this),PrimaryKeyConstraintNode:this.visitPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.visitUniqueConstraint.bind(this),ReferencesNode:this.visitReferences.bind(this),CheckConstraintNode:this.visitCheckConstraint.bind(this),WithNode:this.visitWith.bind(this),CommonTableExpressionNode:this.visitCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.visitCommonTableExpressionName.bind(this),HavingNode:this.visitHaving.bind(this),CreateSchemaNode:this.visitCreateSchema.bind(this),DropSchemaNode:this.visitDropSchema.bind(this),AlterTableNode:this.visitAlterTable.bind(this),DropColumnNode:this.visitDropColumn.bind(this),RenameColumnNode:this.visitRenameColumn.bind(this),AlterColumnNode:this.visitAlterColumn.bind(this),ModifyColumnNode:this.visitModifyColumn.bind(this),AddConstraintNode:this.visitAddConstraint.bind(this),DropConstraintNode:this.visitDropConstraint.bind(this),RenameConstraintNode:this.visitRenameConstraint.bind(this),ForeignKeyConstraintNode:this.visitForeignKeyConstraint.bind(this),CreateViewNode:this.visitCreateView.bind(this),RefreshMaterializedViewNode:this.visitRefreshMaterializedView.bind(this),DropViewNode:this.visitDropView.bind(this),GeneratedNode:this.visitGenerated.bind(this),DefaultValueNode:this.visitDefaultValue.bind(this),OnNode:this.visitOn.bind(this),ValuesNode:this.visitValues.bind(this),SelectModifierNode:this.visitSelectModifier.bind(this),CreateTypeNode:this.visitCreateType.bind(this),DropTypeNode:this.visitDropType.bind(this),ExplainNode:this.visitExplain.bind(this),DefaultInsertValueNode:this.visitDefaultInsertValue.bind(this),AggregateFunctionNode:this.visitAggregateFunction.bind(this),OverNode:this.visitOver.bind(this),PartitionByNode:this.visitPartitionBy.bind(this),PartitionByItemNode:this.visitPartitionByItem.bind(this),SetOperationNode:this.visitSetOperation.bind(this),BinaryOperationNode:this.visitBinaryOperation.bind(this),UnaryOperationNode:this.visitUnaryOperation.bind(this),UsingNode:this.visitUsing.bind(this),FunctionNode:this.visitFunction.bind(this),CaseNode:this.visitCase.bind(this),WhenNode:this.visitWhen.bind(this),JSONReferenceNode:this.visitJSONReference.bind(this),JSONPathNode:this.visitJSONPath.bind(this),JSONPathLegNode:this.visitJSONPathLeg.bind(this),JSONOperatorChainNode:this.visitJSONOperatorChain.bind(this),TupleNode:this.visitTuple.bind(this),MergeQueryNode:this.visitMergeQuery.bind(this),MatchedNode:this.visitMatched.bind(this),AddIndexNode:this.visitAddIndex.bind(this),CastNode:this.visitCast.bind(this),FetchNode:this.visitFetch.bind(this),TopNode:this.visitTop.bind(this),OutputNode:this.visitOutput.bind(this),OrActionNode:this.visitOrAction.bind(this),CollateNode:this.visitCollate.bind(this)});visitNode=(J)=>{this.nodeStack.push(J),this.#J[J.kind](J),this.nodeStack.pop()}}var o3=D(()=>{C()});var vR,H8,MR,JO,OR;var qX=D(()=>{N1();LX();o3();yJ();P1();_8();C();X9();S5();VX();D1();vR=/'/g;H8=class H8 extends t3{#J="";#W=[];get numParameters(){return this.#W.length}compileQuery(J,W){return this.#J="",this.#W=[],this.nodeStack.splice(0,this.nodeStack.length),this.visitNode(J),U({query:J,queryId:W,sql:this.getSql(),parameters:[...this.#W]})}getSql(){return this.#J}visitSelectQuery(J){let W=this.parentNode!==void 0&&!X8.is(this.parentNode)&&!S4.is(this.parentNode)&&!N0.is(this.parentNode)&&!s8.is(this.parentNode)&&!_5.is(this.parentNode);if(this.parentNode===void 0&&J.explain)this.visitNode(J.explain),this.append(" ");if(W)this.append("(");if(J.with)this.visitNode(J.with),this.append(" ");if(this.append("select"),J.distinctOn)this.append(" "),this.compileDistinctOn(J.distinctOn);if(J.frontModifiers?.length)this.append(" "),this.compileList(J.frontModifiers," ");if(J.top)this.append(" "),this.visitNode(J.top);if(J.selections)this.append(" "),this.compileList(J.selections);if(J.from)this.append(" "),this.visitNode(J.from);if(J.joins)this.append(" "),this.compileList(J.joins," ");if(J.where)this.append(" "),this.visitNode(J.where);if(J.groupBy)this.append(" "),this.visitNode(J.groupBy);if(J.having)this.append(" "),this.visitNode(J.having);if(J.setOperations)this.append(" "),this.compileList(J.setOperations," ");if(J.orderBy)this.append(" "),this.visitNode(J.orderBy);if(J.limit)this.append(" "),this.visitNode(J.limit);if(J.offset)this.append(" "),this.visitNode(J.offset);if(J.fetch)this.append(" "),this.visitNode(J.fetch);if(J.endModifiers?.length)this.append(" "),this.compileList(this.sortSelectModifiers([...J.endModifiers])," ");if(W)this.append(")")}visitFrom(J){this.append("from "),this.compileList(J.froms)}visitSelection(J){this.visitNode(J.selection)}visitColumn(J){this.visitNode(J.column)}compileDistinctOn(J){this.append("distinct on ("),this.compileList(J),this.append(")")}compileList(J,W=", "){let X=J.length-1;for(let G=0;G<=X;G++)if(this.visitNode(J[G]),G<X)this.append(W)}visitWhere(J){this.append("where "),this.visitNode(J.where)}visitHaving(J){this.append("having "),this.visitNode(J.having)}visitInsertQuery(J){let W=this.parentNode!==void 0&&!X8.is(this.parentNode)&&!B6.is(this.parentNode)&&!T8.is(this.parentNode);if(this.parentNode===void 0&&J.explain)this.visitNode(J.explain),this.append(" ");if(W)this.append("(");if(J.with)this.visitNode(J.with),this.append(" ");if(this.append(J.replace?"replace":"insert"),J.ignore)x8("`InsertQueryNode.ignore` is deprecated. Use `InsertQueryNode.orAction` instead."),this.append(" ignore");if(J.orAction)this.append(" "),this.visitNode(J.orAction);if(J.top)this.append(" "),this.visitNode(J.top);if(J.into)this.append(" into "),this.visitNode(J.into);if(J.columns)this.append(" ("),this.compileList(J.columns),this.append(")");if(J.output)this.append(" "),this.visitNode(J.output);if(J.values)this.append(" "),this.visitNode(J.values);if(J.defaultValues)this.append(" "),this.append("default values");if(J.onConflict)this.append(" "),this.visitNode(J.onConflict);if(J.onDuplicateKey)this.append(" "),this.visitNode(J.onDuplicateKey);if(J.returning)this.append(" "),this.visitNode(J.returning);if(W)this.append(")");if(J.endModifiers?.length)this.append(" "),this.compileList(J.endModifiers," ")}visitValues(J){this.append("values "),this.compileList(J.values)}visitDeleteQuery(J){let W=this.parentNode!==void 0&&!X8.is(this.parentNode)&&!B6.is(this.parentNode);if(this.parentNode===void 0&&J.explain)this.visitNode(J.explain),this.append(" ");if(W)this.append("(");if(J.with)this.visitNode(J.with),this.append(" ");if(this.append("delete "),J.top)this.visitNode(J.top),this.append(" ");if(this.visitNode(J.from),J.output)this.append(" "),this.visitNode(J.output);if(J.using)this.append(" "),this.visitNode(J.using);if(J.joins)this.append(" "),this.compileList(J.joins," ");if(J.where)this.append(" "),this.visitNode(J.where);if(J.orderBy)this.append(" "),this.visitNode(J.orderBy);if(J.limit)this.append(" "),this.visitNode(J.limit);if(J.returning)this.append(" "),this.visitNode(J.returning);if(W)this.append(")");if(J.endModifiers?.length)this.append(" "),this.compileList(J.endModifiers," ")}visitReturning(J){this.append("returning "),this.compileList(J.selections)}visitAlias(J){this.visitNode(J.node),this.append(" as "),this.visitNode(J.alias)}visitReference(J){if(J.table)this.visitNode(J.table),this.append(".");this.visitNode(J.column)}visitSelectAll(J){this.append("*")}visitIdentifier(J){this.append(this.getLeftIdentifierWrapper()),this.compileUnwrappedIdentifier(J),this.append(this.getRightIdentifierWrapper())}compileUnwrappedIdentifier(J){if(!h6(J.name))throw Error("a non-string identifier was passed to compileUnwrappedIdentifier.");this.append(this.sanitizeIdentifier(J.name))}visitAnd(J){this.visitNode(J.left),this.append(" and "),this.visitNode(J.right)}visitOr(J){this.visitNode(J.left),this.append(" or "),this.visitNode(J.right)}visitValue(J){if(J.immediate)this.appendImmediateValue(J.value);else this.appendValue(J.value)}visitValueList(J){this.append("("),this.compileList(J.values),this.append(")")}visitTuple(J){this.append("("),this.compileList(J.values),this.append(")")}visitPrimitiveValueList(J){this.append("(");let{values:W}=J;for(let X=0;X<W.length;++X)if(this.appendValue(W[X]),X!==W.length-1)this.append(", ");this.append(")")}visitParens(J){this.append("("),this.visitNode(J.node),this.append(")")}visitJoin(J){if(this.append(OR[J.joinType]),this.append(" "),this.visitNode(J.table),J.on)this.append(" "),this.visitNode(J.on)}visitOn(J){this.append("on "),this.visitNode(J.on)}visitRaw(J){let{sqlFragments:W,parameters:X}=J;for(let G=0;G<W.length;++G)if(this.append(W[G]),X.length>G)this.visitNode(X[G])}visitOperator(J){this.append(J.operator)}visitTable(J){this.visitNode(J.table)}visitSchemableIdentifier(J){if(J.schema)this.visitNode(J.schema),this.append(".");this.visitNode(J.identifier)}visitCreateTable(J){if(this.append("create "),J.frontModifiers&&J.frontModifiers.length>0)this.compileList(J.frontModifiers," "),this.append(" ");if(J.temporary)this.append("temporary ");if(this.append("table "),J.ifNotExists)this.append("if not exists ");if(this.visitNode(J.table),J.selectQuery)this.append(" as "),this.visitNode(J.selectQuery);else{if(this.append(" ("),this.compileList([...J.columns,...J.constraints??[]]),this.append(")"),J.onCommit)this.append(" on commit "),this.append(J.onCommit);if(J.endModifiers&&J.endModifiers.length>0)this.append(" "),this.compileList(J.endModifiers," ")}}visitColumnDefinition(J){if(J.ifNotExists)this.append("if not exists ");if(this.visitNode(J.column),this.append(" "),this.visitNode(J.dataType),J.unsigned)this.append(" unsigned");if(J.frontModifiers&&J.frontModifiers.length>0)this.append(" "),this.compileList(J.frontModifiers," ");if(J.generated)this.append(" "),this.visitNode(J.generated);if(J.identity)this.append(" identity");if(J.defaultTo)this.append(" "),this.visitNode(J.defaultTo);if(J.notNull)this.append(" not null");if(J.unique)this.append(" unique");if(J.nullsNotDistinct)this.append(" nulls not distinct");if(J.primaryKey)this.append(" primary key");if(J.autoIncrement)this.append(" "),this.append(this.getAutoIncrement());if(J.references)this.append(" "),this.visitNode(J.references);if(J.check)this.append(" "),this.visitNode(J.check);if(J.endModifiers&&J.endModifiers.length>0)this.append(" "),this.compileList(J.endModifiers," ")}getAutoIncrement(){return"auto_increment"}visitReferences(J){if(this.append("references "),this.visitNode(J.table),this.append(" ("),this.compileList(J.columns),this.append(")"),J.onDelete)this.append(" on delete "),this.append(J.onDelete);if(J.onUpdate)this.append(" on update "),this.append(J.onUpdate)}visitDropTable(J){if(this.append("drop table "),J.ifExists)this.append("if exists ");if(this.visitNode(J.table),J.cascade)this.append(" cascade")}visitDataType(J){this.append(J.dataType)}visitOrderBy(J){this.append("order by "),this.compileList(J.items)}visitOrderByItem(J){if(this.visitNode(J.orderBy),J.collation)this.append(" "),this.visitNode(J.collation);if(J.direction)this.append(" "),this.visitNode(J.direction);if(J.nulls)this.append(" nulls "),this.append(J.nulls)}visitGroupBy(J){this.append("group by "),this.compileList(J.items)}visitGroupByItem(J){this.visitNode(J.groupBy)}visitUpdateQuery(J){let W=this.parentNode!==void 0&&!X8.is(this.parentNode)&&!B6.is(this.parentNode)&&!T8.is(this.parentNode);if(this.parentNode===void 0&&J.explain)this.visitNode(J.explain),this.append(" ");if(W)this.append("(");if(J.with)this.visitNode(J.with),this.append(" ");if(this.append("update "),J.top)this.visitNode(J.top),this.append(" ");if(J.table)this.visitNode(J.table),this.append(" ");if(this.append("set "),J.updates)this.compileList(J.updates);if(J.output)this.append(" "),this.visitNode(J.output);if(J.from)this.append(" "),this.visitNode(J.from);if(J.joins){if(!J.from)throw Error("Joins in an update query are only supported as a part of a PostgreSQL 'update set from join' query. If you want to create a MySQL 'update join set' query, see https://kysely.dev/docs/examples/update/my-sql-joins");this.append(" "),this.compileList(J.joins," ")}if(J.where)this.append(" "),this.visitNode(J.where);if(J.orderBy)this.append(" "),this.visitNode(J.orderBy);if(J.limit)this.append(" "),this.visitNode(J.limit);if(J.returning)this.append(" "),this.visitNode(J.returning);if(W)this.append(")");if(J.endModifiers?.length)this.append(" "),this.compileList(J.endModifiers," ")}visitColumnUpdate(J){this.visitNode(J.column),this.append(" = "),this.visitNode(J.value)}visitLimit(J){this.append("limit "),this.visitNode(J.limit)}visitOffset(J){this.append("offset "),this.visitNode(J.offset)}visitOnConflict(J){if(this.append("on conflict"),J.columns)this.append(" ("),this.compileList(J.columns),this.append(")");else if(J.constraint)this.append(" on constraint "),this.visitNode(J.constraint);else if(J.indexExpression)this.append(" ("),this.visitNode(J.indexExpression),this.append(")");if(J.indexWhere)this.append(" "),this.visitNode(J.indexWhere);if(J.doNothing===!0)this.append(" do nothing");else if(J.updates){if(this.append(" do update set "),this.compileList(J.updates),J.updateWhere)this.append(" "),this.visitNode(J.updateWhere)}}visitOnDuplicateKey(J){this.append("on duplicate key update "),this.compileList(J.updates)}visitCreateIndex(J){if(this.append("create "),J.unique)this.append("unique ");if(this.append("index "),J.ifNotExists)this.append("if not exists ");if(this.visitNode(J.name),J.table)this.append(" on "),this.visitNode(J.table);if(J.using)this.append(" using "),this.visitNode(J.using);if(J.columns)this.append(" ("),this.compileList(J.columns),this.append(")");if(J.nullsNotDistinct)this.append(" nulls not distinct");if(J.where)this.append(" "),this.visitNode(J.where)}visitDropIndex(J){if(this.append("drop index "),J.ifExists)this.append("if exists ");if(this.visitNode(J.name),J.table)this.append(" on "),this.visitNode(J.table);if(J.cascade)this.append(" cascade")}visitCreateSchema(J){if(this.append("create schema "),J.ifNotExists)this.append("if not exists ");this.visitNode(J.schema)}visitDropSchema(J){if(this.append("drop schema "),J.ifExists)this.append("if exists ");if(this.visitNode(J.schema),J.cascade)this.append(" cascade")}visitPrimaryKeyConstraint(J){if(J.name)this.append("constraint "),this.visitNode(J.name),this.append(" ");this.append("primary key ("),this.compileList(J.columns),this.append(")"),this.buildDeferrable(J)}buildDeferrable(J){if(J.deferrable!==void 0)if(J.deferrable)this.append(" deferrable");else this.append(" not deferrable");if(J.initiallyDeferred!==void 0)if(J.initiallyDeferred)this.append(" initially deferred");else this.append(" initially immediate")}visitUniqueConstraint(J){if(J.name)this.append("constraint "),this.visitNode(J.name),this.append(" ");if(this.append("unique"),J.nullsNotDistinct)this.append(" nulls not distinct");this.append(" ("),this.compileList(J.columns),this.append(")"),this.buildDeferrable(J)}visitCheckConstraint(J){if(J.name)this.append("constraint "),this.visitNode(J.name),this.append(" ");this.append("check ("),this.visitNode(J.expression),this.append(")")}visitForeignKeyConstraint(J){if(J.name)this.append("constraint "),this.visitNode(J.name),this.append(" ");if(this.append("foreign key ("),this.compileList(J.columns),this.append(") "),this.visitNode(J.references),J.onDelete)this.append(" on delete "),this.append(J.onDelete);if(J.onUpdate)this.append(" on update "),this.append(J.onUpdate);this.buildDeferrable(J)}visitList(J){this.compileList(J.items)}visitWith(J){if(this.append("with "),J.recursive)this.append("recursive ");this.compileList(J.expressions)}visitCommonTableExpression(J){if(this.visitNode(J.name),this.append(" as "),fJ(J.materialized)){if(!J.materialized)this.append("not ");this.append("materialized ")}this.visitNode(J.expression)}visitCommonTableExpressionName(J){if(this.visitNode(J.table),J.columns)this.append("("),this.compileList(J.columns),this.append(")")}visitAlterTable(J){if(this.append("alter table "),this.visitNode(J.table),this.append(" "),J.renameTo)this.append("rename to "),this.visitNode(J.renameTo);if(J.setSchema)this.append("set schema "),this.visitNode(J.setSchema);if(J.addConstraint)this.visitNode(J.addConstraint);if(J.dropConstraint)this.visitNode(J.dropConstraint);if(J.renameConstraint)this.visitNode(J.renameConstraint);if(J.columnAlterations)this.compileColumnAlterations(J.columnAlterations);if(J.addIndex)this.visitNode(J.addIndex);if(J.dropIndex)this.visitNode(J.dropIndex)}visitAddColumn(J){this.append("add column "),this.visitNode(J.column)}visitRenameColumn(J){this.append("rename column "),this.visitNode(J.column),this.append(" to "),this.visitNode(J.renameTo)}visitDropColumn(J){this.append("drop column "),this.visitNode(J.column)}visitAlterColumn(J){if(this.append("alter column "),this.visitNode(J.column),this.append(" "),J.dataType){if(this.announcesNewColumnDataType())this.append("type ");if(this.visitNode(J.dataType),J.dataTypeExpression)this.append("using "),this.visitNode(J.dataTypeExpression)}if(J.setDefault)this.append("set default "),this.visitNode(J.setDefault);if(J.dropDefault)this.append("drop default");if(J.setNotNull)this.append("set not null");if(J.dropNotNull)this.append("drop not null")}visitModifyColumn(J){this.append("modify column "),this.visitNode(J.column)}visitAddConstraint(J){this.append("add "),this.visitNode(J.constraint)}visitDropConstraint(J){if(this.append("drop constraint "),J.ifExists)this.append("if exists ");if(this.visitNode(J.constraintName),J.modifier==="cascade")this.append(" cascade");else if(J.modifier==="restrict")this.append(" restrict")}visitRenameConstraint(J){this.append("rename constraint "),this.visitNode(J.oldName),this.append(" to "),this.visitNode(J.newName)}visitSetOperation(J){if(this.append(J.operator),this.append(" "),J.all)this.append("all ");this.visitNode(J.expression)}visitCreateView(J){if(this.append("create "),J.orReplace)this.append("or replace ");if(J.materialized)this.append("materialized ");if(J.temporary)this.append("temporary ");if(this.append("view "),J.ifNotExists)this.append("if not exists ");if(this.visitNode(J.name),this.append(" "),J.columns)this.append("("),this.compileList(J.columns),this.append(") ");if(J.as)this.append("as "),this.visitNode(J.as)}visitRefreshMaterializedView(J){if(this.append("refresh materialized view "),J.concurrently)this.append("concurrently ");if(this.visitNode(J.name),J.withNoData)this.append(" with no data");else this.append(" with data")}visitDropView(J){if(this.append("drop "),J.materialized)this.append("materialized ");if(this.append("view "),J.ifExists)this.append("if exists ");if(this.visitNode(J.name),J.cascade)this.append(" cascade")}visitGenerated(J){if(this.append("generated "),J.always)this.append("always ");if(J.byDefault)this.append("by default ");if(this.append("as "),J.identity)this.append("identity");if(J.expression)this.append("("),this.visitNode(J.expression),this.append(")");if(J.stored)this.append(" stored")}visitDefaultValue(J){this.append("default "),this.visitNode(J.defaultValue)}visitSelectModifier(J){if(J.rawModifier)this.visitNode(J.rawModifier);else this.append(MR[J.modifier]);if(J.of)this.append(" of "),this.compileList(J.of,", ")}visitCreateType(J){if(this.append("create type "),this.visitNode(J.name),J.enum)this.append(" as enum "),this.visitNode(J.enum)}visitDropType(J){if(this.append("drop type "),J.ifExists)this.append("if exists ");this.visitNode(J.name)}visitExplain(J){if(this.append("explain"),J.options||J.format){if(this.append(" "),this.append(this.getLeftExplainOptionsWrapper()),J.options){if(this.visitNode(J.options),J.format)this.append(this.getExplainOptionsDelimiter())}if(J.format)this.append("format"),this.append(this.getExplainOptionAssignment()),this.append(J.format);this.append(this.getRightExplainOptionsWrapper())}}visitDefaultInsertValue(J){this.append("default")}visitAggregateFunction(J){if(this.append(J.func),this.append("("),J.distinct)this.append("distinct ");if(this.compileList(J.aggregated),J.orderBy)this.append(" "),this.visitNode(J.orderBy);if(this.append(")"),J.withinGroup)this.append(" within group ("),this.visitNode(J.withinGroup),this.append(")");if(J.filter)this.append(" filter("),this.visitNode(J.filter),this.append(")");if(J.over)this.append(" "),this.visitNode(J.over)}visitOver(J){if(this.append("over("),J.partitionBy){if(this.visitNode(J.partitionBy),J.orderBy)this.append(" ")}if(J.orderBy)this.visitNode(J.orderBy);this.append(")")}visitPartitionBy(J){this.append("partition by "),this.compileList(J.items)}visitPartitionByItem(J){this.visitNode(J.partitionBy)}visitBinaryOperation(J){this.visitNode(J.leftOperand),this.append(" "),this.visitNode(J.operator),this.append(" "),this.visitNode(J.rightOperand)}visitUnaryOperation(J){if(this.visitNode(J.operator),!this.isMinusOperator(J.operator))this.append(" ");this.visitNode(J.operand)}isMinusOperator(J){return Q0.is(J)&&J.operator==="-"}visitUsing(J){this.append("using "),this.compileList(J.tables)}visitFunction(J){this.append(J.func),this.append("("),this.compileList(J.arguments),this.append(")")}visitCase(J){if(this.append("case"),J.value)this.append(" "),this.visitNode(J.value);if(J.when)this.append(" "),this.compileList(J.when," ");if(J.else)this.append(" else "),this.visitNode(J.else);if(this.append(" end"),J.isStatement)this.append(" case")}visitWhen(J){if(this.append("when "),this.visitNode(J.condition),J.result)this.append(" then "),this.visitNode(J.result)}visitJSONReference(J){this.visitNode(J.reference),this.visitNode(J.traversal)}visitJSONPath(J){if(J.inOperator)this.visitNode(J.inOperator);this.append("'$");for(let W of J.pathLegs)this.visitNode(W);this.append("'")}visitJSONPathLeg(J){let W=J.type==="ArrayLocation";if(this.append(W?"[":"."),this.append(String(J.value)),W)this.append("]")}visitJSONOperatorChain(J){for(let W=0,X=J.values.length;W<X;W++){if(W===X-1)this.visitNode(J.operator);else this.append("->");this.visitNode(J.values[W])}}visitMergeQuery(J){if(J.with)this.visitNode(J.with),this.append(" ");if(this.append("merge "),J.top)this.visitNode(J.top),this.append(" ");if(this.append("into "),this.visitNode(J.into),J.using)this.append(" "),this.visitNode(J.using);if(J.whens)this.append(" "),this.compileList(J.whens," ");if(J.returning)this.append(" "),this.visitNode(J.returning);if(J.output)this.append(" "),this.visitNode(J.output);if(J.endModifiers?.length)this.append(" "),this.compileList(J.endModifiers," ")}visitMatched(J){if(J.not)this.append("not ");if(this.append("matched"),J.bySource)this.append(" by source")}visitAddIndex(J){if(this.append("add "),J.unique)this.append("unique ");if(this.append("index "),this.visitNode(J.name),J.columns)this.append(" ("),this.compileList(J.columns),this.append(")");if(J.using)this.append(" using "),this.visitNode(J.using)}visitCast(J){this.append("cast("),this.visitNode(J.expression),this.append(" as "),this.visitNode(J.dataType),this.append(")")}visitFetch(J){this.append("fetch next "),this.visitNode(J.rowCount),this.append(` rows ${J.modifier}`)}visitOutput(J){this.append("output "),this.compileList(J.selections)}visitTop(J){if(this.append(`top(${J.expression})`),J.modifiers)this.append(` ${J.modifiers}`)}visitOrAction(J){this.append(J.action)}visitCollate(J){this.append("collate "),this.visitNode(J.collation)}append(J){this.#J+=J}appendValue(J){this.addParameter(J),this.append(this.getCurrentParameterPlaceholder())}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getCurrentParameterPlaceholder(){return"$"+this.numParameters}getLeftExplainOptionsWrapper(){return"("}getExplainOptionAssignment(){return" "}getExplainOptionsDelimiter(){return", "}getRightExplainOptionsWrapper(){return")"}sanitizeIdentifier(J){let W=this.getLeftIdentifierWrapper(),X=this.getRightIdentifierWrapper(),G="";for(let Y of J)if(G+=Y,Y===W)G+=W;else if(Y===X)G+=X;return G}sanitizeStringLiteral(J){return J.replace(vR,"''")}addParameter(J){this.#W.push(J)}appendImmediateValue(J){if(h6(J))this.appendStringLiteral(J);else if(k8(J)||fJ(J)||DW(J))this.append(J.toString());else if(VW(J))this.append("null");else if(F1(J))this.appendImmediateValue(J.toISOString());else throw Error(`invalid immediate value ${J}`)}appendStringLiteral(J){this.append("'"),this.append(this.sanitizeStringLiteral(J)),this.append("'")}sortSelectModifiers(J){return J.sort((W,X)=>W.modifier&&X.modifier?JO[W.modifier]-JO[X.modifier]:1),U(J)}compileColumnAlterations(J){this.compileList(J)}announcesNewColumnDataType(){return!0}};MR=U({ForKeyShare:"for key share",ForNoKeyUpdate:"for no key update",ForUpdate:"for update",ForShare:"for share",NoWait:"nowait",SkipLocked:"skip locked",Distinct:"distinct"}),JO=U({ForKeyShare:1,ForNoKeyUpdate:1,ForUpdate:1,ForShare:1,NoWait:2,SkipLocked:2,Distinct:0}),OR=U({InnerJoin:"inner join",LeftJoin:"left join",RightJoin:"right join",FullJoin:"full join",CrossJoin:"cross join",LateralInnerJoin:"inner join lateral",LateralLeftJoin:"left join lateral",LateralCrossJoin:"cross join lateral",OuterApply:"outer apply",CrossApply:"cross apply",Using:"using"})});var W4;var a1=D(()=>{_8();C();B8();W4=U({raw(J,W=[]){return U({sql:J,query:B6.createWithSql(J),parameters:U(W),queryId:w6()})}})});var WO=()=>{};var XO=()=>{};var YO=()=>{};var GO=()=>{};class tJ{get supportsCreateIfNotExists(){return!0}get supportsTransactionalDdl(){return!1}get supportsReturning(){return!1}get supportsOutput(){return!1}}var $O=()=>{};function E8(J,W){return B6.createWithChildren([B6.createWithSql(`${J} `),X6.create(W)])}var WK=D(()=>{e6();_8()});class s3{#J;#W=new wO;#X;#Y;constructor(J){this.#J=U({...J})}async init(){if(this.#X=f6(this.#J.database)?await this.#J.database():this.#J.database,this.#Y=new KO(this.#X),this.#J.onCreateConnection)await this.#J.onCreateConnection(this.#Y)}async acquireConnection(){return await this.#W.lock(),this.#Y}async beginTransaction(J){await J.executeQuery(W4.raw("begin"))}async commitTransaction(J){await J.executeQuery(W4.raw("commit"))}async rollbackTransaction(J){await J.executeQuery(W4.raw("rollback"))}async savepoint(J,W,X){await J.executeQuery(X(E8("savepoint",W),w6()))}async rollbackToSavepoint(J,W,X){await J.executeQuery(X(E8("rollback to",W),w6()))}async releaseSavepoint(J,W,X){await J.executeQuery(X(E8("release",W),w6()))}async releaseConnection(){this.#W.unlock()}async destroy(){this.#X?.close()}}class KO{#J;constructor(J){this.#J=J}executeQuery(J){let{sql:W,parameters:X}=J,G=this.#J.prepare(W);if(G.reader)return Promise.resolve({rows:G.all(X)});let{changes:Y,lastInsertRowid:$}=G.run(X);return Promise.resolve({numAffectedRows:Y!==void 0&&Y!==null?BigInt(Y):void 0,insertId:$!==void 0&&$!==null?BigInt($):void 0,rows:[]})}async*streamQuery(J,W){let{sql:X,parameters:G,query:Y}=J,$=this.#J.prepare(X);if(T6.is(Y)){let K=$.iterate(G);for(let w of K)yield{rows:[w]}}else throw Error("Sqlite driver only supports streaming of select queries")}}class wO{#J;#W;async lock(){while(this.#J)await this.#J;this.#J=new Promise((J)=>{this.#W=J})}unlock(){let J=this.#W;this.#J=void 0,this.#W=void 0,J?.()}}var e3=D(()=>{SW();WK();a1();C();B8()});var PR,$9;var Jz=D(()=>{qX();PR=/"/g;$9=class $9 extends H8{visitOrAction(J){this.append("or "),this.append(J.action)}getCurrentParameterPlaceholder(){return"?"}getLeftExplainOptionsWrapper(){return""}getRightExplainOptionsWrapper(){return""}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getAutoIncrement(){return"autoincrement"}sanitizeIdentifier(J){return J.replace(PR,'""')}visitDefaultInsertValue(J){this.append("null")}}});class Wz{transformQuery(J){return J.node}async transformResult(J){return J.result}}class Yz{#J;constructor(J){this.#J=U(J)}async getMigrations(){let J=await this.#z(this.#Y)?await this.#J.db.withPlugin(this.#K).selectFrom(this.#Y).select(["name","timestamp"]).$narrowType().execute():[];return(await this.#L()).map(({name:X,...G})=>{let Y=J.find(($)=>$.name===X);return{name:X,migration:G,executedAt:Y?new Date(Y.timestamp):void 0}})}async migrateToLatest(){return this.#W(()=>({direction:"Up",step:1/0}))}async migrateTo(J){return this.#W(({migrations:W,executedMigrations:X,pendingMigrations:G})=>{if(s6(J)&&J.__noMigrations__===!0)return{direction:"Down",step:1/0};if(!W.find((K)=>K.name===J))throw Error(`migration "${J}" doesn't exist`);let Y=X.indexOf(J),$=G.findIndex((K)=>K.name===J);if(Y!==-1)return{direction:"Down",step:X.length-Y-1};else if($!==-1)return{direction:"Up",step:$+1};else throw Error(`migration "${J}" isn't executed or pending`)})}async migrateUp(){return this.#W(()=>({direction:"Up",step:1}))}async migrateDown(){return this.#W(()=>({direction:"Down",step:1}))}async#W(J){try{return await this.#$(),await this.#D(J)}catch(W){if(W instanceof XK)return W.resultSet;return{error:W}}}get#X(){return this.#J.migrationTableSchema}get#Y(){return this.#J.migrationTableName??A0}get#G(){return this.#J.migrationLockTableName??p0}get#w(){return this.#J.allowUnorderedMigrations??jR}get#K(){if(this.#X)return new $8(this.#X);return new Wz}async#$(){await this.#H(),await this.#Z(),await this.#F(),await this.#V()}async#H(){if(!this.#X)return;if(!await this.#U())try{await this.#N(this.#J.db.schema.createSchema(this.#X))}catch(J){if(!await this.#U())throw J}}async#Z(){if(!await this.#z(this.#Y))try{if(this.#X)await this.#N(this.#J.db.schema.createSchema(this.#X));await this.#N(this.#J.db.schema.withPlugin(this.#K).createTable(this.#Y).addColumn("name","varchar(255)",(J)=>J.notNull().primaryKey()).addColumn("timestamp","varchar(255)",(J)=>J.notNull()))}catch(J){if(!await this.#z(this.#Y))throw J}}async#F(){if(!await this.#z(this.#G))try{await this.#N(this.#J.db.schema.withPlugin(this.#K).createTable(this.#G).addColumn("id","varchar(255)",(J)=>J.notNull().primaryKey()).addColumn("is_locked","integer",(J)=>J.notNull().defaultTo(0)))}catch(J){if(!await this.#z(this.#G))throw J}}async#V(){if(!await this.#Q())try{await this.#J.db.withPlugin(this.#K).insertInto(this.#G).values({id:Xz,is_locked:0}).execute()}catch(J){if(!await this.#Q())throw J}}async#U(){return(await this.#J.db.introspection.getSchemas()).some((W)=>W.name===this.#X)}async#z(J){let W=this.#X;return(await this.#J.db.introspection.getTables({withInternalKyselyTables:!0})).some((G)=>G.name===J&&(!W||G.schema===W))}async#Q(){return!!await this.#J.db.withPlugin(this.#K).selectFrom(this.#G).where("id","=",Xz).select("id").executeTakeFirst()}async#D(J){let W=this.#J.db.getExecutor().adapter,X=U({lockTable:this.#J.migrationLockTableName??p0,lockRowId:Xz,lockTableSchema:this.#J.migrationTableSchema}),G=async(Y)=>{try{await W.acquireMigrationLock(Y,X);let $=await this.#v(Y);if($.migrations.length===0)return{results:[]};let{direction:K,step:w}=J($);if(w<=0)return{results:[]};if(K==="Down")return await this.#_(Y,$,w);else if(K==="Up")return await this.#S(Y,$,w);return{results:[]}}finally{await W.releaseMigrationLock(Y,X)}};if(W.supportsTransactionalDdl&&!this.#J.disableTransactions)return this.#J.db.transaction().execute(G);else return this.#J.db.connection().execute(G)}async#v(J){let W=await this.#L(),X=await this.#O(J);if(this.#P(W,X),!this.#w)this.#j(W,X);let G=this.#M(W,X);return U({migrations:W,executedMigrations:X,lastMigration:Tv(X),pendingMigrations:G})}#M(J,W){return J.filter((X)=>{return!W.includes(X.name)})}async#L(){let J=await this.#J.provider.getMigrations();return Object.keys(J).sort().map((W)=>({...J[W],name:W}))}async#O(J){let W=await J.withPlugin(this.#K).selectFrom(this.#Y).select(["name","timestamp"]).$narrowType().execute(),X=this.#J.nameComparator||((G,Y)=>G.localeCompare(Y));return W.sort((G,Y)=>{if(G.timestamp===Y.timestamp)return X(G.name,Y.name);return new Date(G.timestamp).getTime()-new Date(Y.timestamp).getTime()}).map((G)=>G.name)}#P(J,W){for(let X of W)if(!J.some((G)=>G.name===X))throw Error(`corrupted migrations: previously executed migration ${X} is missing`)}#j(J,W){for(let X=0;X<W.length;++X)if(J[X].name!==W[X])throw Error(`corrupted migrations: expected previously executed migration ${W[X]} to be at index ${X} but ${J[X].name} was found in its place. New migrations must always have a name that comes alphabetically after the last executed migration.`)}async#_(J,W,X){let G=W.executedMigrations.slice().reverse().slice(0,X).map(($)=>{return W.migrations.find((K)=>K.name===$)}),Y=G.map(($)=>{return{migrationName:$.name,direction:"Down",status:"NotExecuted"}});for(let $=0;$<Y.length;++$){let K=G[$];try{if(K.down)await K.down(J),await J.withPlugin(this.#K).deleteFrom(this.#Y).where("name","=",K.name).execute(),Y[$]={migrationName:K.name,direction:"Down",status:"Success"}}catch(w){throw Y[$]={migrationName:K.name,direction:"Down",status:"Error"},new XK({error:w,results:Y})}}return{results:Y}}async#S(J,W,X){let Y=W.pendingMigrations.slice(0,X).map(($)=>{return{migrationName:$.name,direction:"Up",status:"NotExecuted"}});for(let $=0;$<Y.length;$++){let K=W.pendingMigrations[$];try{await K.up(J),await J.withPlugin(this.#K).insertInto(this.#Y).values({name:K.name,timestamp:new Date().toISOString()}).execute(),Y[$]={migrationName:K.name,direction:"Up",status:"Success"}}catch(w){throw Y[$]={migrationName:K.name,direction:"Up",status:"Error"},new XK({error:w,results:Y})}}return{results:Y}}async#N(J){if(this.#J.db.getExecutor().adapter.supportsCreateIfNotExists)J=J.ifNotExists();await J.execute()}}var A0="kysely_migration",p0="kysely_migration_lock",jR=!1,Xz="migration_lock",q16,XK;var BX=D(()=>{OX();C();q16=U({__noMigrations__:!0});XK=class XK extends Error{#J;constructor(J){super();this.#J=J}get resultSet(){return this.#J}}});class K9{#J;constructor(J){this.#J=J}async getSchemas(){return[]}async getTables(J={withInternalKyselyTables:!1}){return await this.#X(J)}async getMetadata(J){return{tables:await this.getTables(J)}}#W(J,W){let X=J.selectFrom("sqlite_master").where("type","in",["table","view"]).where("name","not like","sqlite_%").select(["name","sql","type"]).orderBy("name");if(!W.withInternalKyselyTables)X=X.where("name","!=",A0).where("name","!=",p0);return X}async#X(J){let W=await this.#W(this.#J,J).execute(),X=await this.#J.with("table_list",(Y)=>this.#W(Y,J)).selectFrom(["table_list as tl",F6`pragma_table_info(tl.name)`.as("p")]).select(["tl.name as table","p.cid","p.name","p.type","p.notnull","p.dflt_value","p.pk"]).orderBy("tl.name").orderBy("p.cid").execute(),G={};for(let Y of X)G[Y.table]??=[],G[Y.table].push(Y);return W.map(({name:Y,sql:$,type:K})=>{let w=$?.split(/[\(\),]/)?.find((Z)=>Z.toLowerCase().includes("autoincrement"))?.trimStart()?.split(/\s+/)?.[0]?.replace(/["`]/g,""),H=G[Y]??[];if(!w){let Z=H.filter((z)=>z.pk>0);if(Z.length===1&&Z[0].type.toLowerCase()==="integer")w=Z[0].name}return{name:Y,isView:K==="view",columns:H.map((Z)=>({name:Z.name,dataType:Z.type,isNullable:!Z.notnull,isAutoIncrementing:Z.name===w,hasDefaultValue:Z.dflt_value!=null,comment:void 0}))}})}}var Gz=D(()=>{BX();hW()});var w9;var $z=D(()=>{w9=class w9 extends tJ{get supportsTransactionalDdl(){return!1}get supportsReturning(){return!0}async acquireMigrationLock(J,W){}async releaseMigrationLock(J,W){}}});class YK{#J;constructor(J){this.#J=U({...J})}createDriver(){return new s3(this.#J)}createQueryCompiler(){return new $9}createAdapter(){return new w9}createIntrospector(J){return new K9(J)}}var HO=D(()=>{e3();Jz();Gz();$z();C()});var ZO=()=>{};var _R,Kz;var wz=D(()=>{qX();_R=/"/g;Kz=class Kz extends H8{sanitizeIdentifier(J){return J.replace(_R,'""')}}});class Hz{#J;constructor(J){this.#J=J}async getSchemas(){return(await this.#J.selectFrom("pg_catalog.pg_namespace").select("nspname").$castTo().execute()).map((W)=>({name:W.nspname}))}async getTables(J={withInternalKyselyTables:!1}){let W=this.#J.selectFrom("pg_catalog.pg_attribute as a").innerJoin("pg_catalog.pg_class as c","a.attrelid","c.oid").innerJoin("pg_catalog.pg_namespace as ns","c.relnamespace","ns.oid").innerJoin("pg_catalog.pg_type as typ","a.atttypid","typ.oid").innerJoin("pg_catalog.pg_namespace as dtns","typ.typnamespace","dtns.oid").select(["a.attname as column","a.attnotnull as not_null","a.atthasdef as has_default","c.relname as table","c.relkind as table_type","ns.nspname as schema","typ.typname as type","dtns.nspname as type_schema",F6`col_description(a.attrelid, a.attnum)`.as("column_description"),F6`pg_get_serial_sequence(quote_ident(ns.nspname) || '.' || quote_ident(c.relname), a.attname)`.as("auto_incrementing")]).where("c.relkind","in",["r","v","p"]).where("ns.nspname","!~","^pg_").where("ns.nspname","!=","information_schema").where("ns.nspname","!=","crdb_internal").where(F6`has_schema_privilege(ns.nspname, 'USAGE')`).where("a.attnum",">=",0).where("a.attisdropped","!=",!0).orderBy("ns.nspname").orderBy("c.relname").orderBy("a.attnum").$castTo();if(!J.withInternalKyselyTables)W=W.where("c.relname","!=",A0).where("c.relname","!=",p0);let X=await W.execute();return this.#W(X)}async getMetadata(J){return{tables:await this.getTables(J)}}#W(J){return J.reduce((W,X)=>{let G=W.find((Y)=>Y.name===X.table&&Y.schema===X.schema);if(!G)G=U({name:X.table,isView:X.table_type==="v",schema:X.schema,columns:[]}),W.push(G);return G.columns.push(U({name:X.column,dataType:X.type,dataTypeSchema:X.type_schema,isNullable:!X.not_null,isAutoIncrementing:X.auto_incrementing!==null,hasDefaultValue:X.has_default,comment:X.column_description??void 0})),W},[])}}var Zz=D(()=>{BX();C();hW()});var SR,zz;var Fz=D(()=>{hW();SR=BigInt("3853314791062309107");zz=class zz extends tJ{get supportsTransactionalDdl(){return!0}get supportsReturning(){return!0}async acquireMigrationLock(J,W){await F6`select pg_advisory_xact_lock(${F6.lit(SR)})`.execute(J)}async releaseMigrationLock(J,W){}}});function t1(J,W){if(TR(J)&&W.stack){let X=W.stack.split(`
`).slice(1).join(`
`);return J.stack+=`
${X}`,J}return J}function TR(J){return s6(J)&&h6(J.stack)}var GK=D(()=>{C()});class Nz{#J;#W=new WeakMap;#X;constructor(J){this.#J=U({...J})}async init(){this.#X=f6(this.#J.pool)?await this.#J.pool():this.#J.pool}async acquireConnection(){let J=await this.#Y(),W=this.#W.get(J);if(!W){if(W=new FO(J),this.#W.set(J,W),this.#J?.onCreateConnection)await this.#J.onCreateConnection(W)}if(this.#J?.onReserveConnection)await this.#J.onReserveConnection(W);return W}async#Y(){return new Promise((J,W)=>{this.#X.getConnection(async(X,G)=>{if(X)W(X);else J(G)})})}async beginTransaction(J,W){if(W.isolationLevel||W.accessMode){let X=[];if(W.isolationLevel)X.push(`isolation level ${W.isolationLevel}`);if(W.accessMode)X.push(W.accessMode);let G=`set transaction ${X.join(", ")}`;await J.executeQuery(W4.raw(G))}await J.executeQuery(W4.raw("begin"))}async commitTransaction(J){await J.executeQuery(W4.raw("commit"))}async rollbackTransaction(J){await J.executeQuery(W4.raw("rollback"))}async savepoint(J,W,X){await J.executeQuery(X(E8("savepoint",W),w6()))}async rollbackToSavepoint(J,W,X){await J.executeQuery(X(E8("rollback to",W),w6()))}async releaseSavepoint(J,W,X){await J.executeQuery(X(E8("release savepoint",W),w6()))}async releaseConnection(J){J[zO]()}async destroy(){return new Promise((J,W)=>{this.#X.end((X)=>{if(X)W(X);else J()})})}}function qR(J){return s6(J)&&"insertId"in J&&"affectedRows"in J}var zO,FO;var Uz=D(()=>{WK();a1();C();B8();GK();zO=Symbol();FO=class FO{#J;constructor(J){this.#J=J}async executeQuery(J){try{let W=await this.#W(J);if(qR(W)){let{insertId:X,affectedRows:G,changedRows:Y}=W;return{insertId:X!==void 0&&X!==null&&X.toString()!=="0"?BigInt(X):void 0,numAffectedRows:G!==void 0&&G!==null?BigInt(G):void 0,numChangedRows:Y!==void 0&&Y!==null?BigInt(Y):void 0,rows:[]}}else if(Array.isArray(W))return{rows:W};return{rows:[]}}catch(W){throw t1(W,Error())}}#W(J){return new Promise((W,X)=>{this.#J.query(J.sql,J.parameters,(G,Y)=>{if(G)X(G);else W(Y)})})}async*streamQuery(J,W){let X=this.#J.query(J.sql,J.parameters).stream({objectMode:!0});try{for await(let G of X)yield{rows:[G]}}catch(G){if(G&&typeof G==="object"&&"code"in G&&G.code==="ERR_STREAM_PREMATURE_CLOSE")return;throw G}}[zO](){this.#J.release()}}});var BR,Qz;var Lz=D(()=>{qX();BR=/`/g;Qz=class Qz extends H8{getCurrentParameterPlaceholder(){return"?"}getLeftExplainOptionsWrapper(){return""}getExplainOptionAssignment(){return"="}getExplainOptionsDelimiter(){return" "}getRightExplainOptionsWrapper(){return""}getLeftIdentifierWrapper(){return"`"}getRightIdentifierWrapper(){return"`"}sanitizeIdentifier(J){return J.replace(BR,"``")}visitCreateIndex(J){if(this.append("create "),J.unique)this.append("unique ");if(this.append("index "),J.ifNotExists)this.append("if not exists ");if(this.visitNode(J.name),J.using)this.append(" using "),this.visitNode(J.using);if(J.table)this.append(" on "),this.visitNode(J.table);if(J.columns)this.append(" ("),this.compileList(J.columns),this.append(")");if(J.where)this.append(" "),this.visitNode(J.where)}}});class Vz{#J;constructor(J){this.#J=J}async getSchemas(){return(await this.#J.selectFrom("information_schema.schemata").select("schema_name").$castTo().execute()).map((W)=>({name:W.SCHEMA_NAME}))}async getTables(J={withInternalKyselyTables:!1}){let W=this.#J.selectFrom("information_schema.columns as columns").innerJoin("information_schema.tables as tables",(G)=>G.onRef("columns.TABLE_CATALOG","=","tables.TABLE_CATALOG").onRef("columns.TABLE_SCHEMA","=","tables.TABLE_SCHEMA").onRef("columns.TABLE_NAME","=","tables.TABLE_NAME")).select(["columns.COLUMN_NAME","columns.COLUMN_DEFAULT","columns.TABLE_NAME","columns.TABLE_SCHEMA","tables.TABLE_TYPE","columns.IS_NULLABLE","columns.DATA_TYPE","columns.EXTRA","columns.COLUMN_COMMENT"]).where("columns.TABLE_SCHEMA","=",F6`database()`).orderBy("columns.TABLE_NAME").orderBy("columns.ORDINAL_POSITION").$castTo();if(!J.withInternalKyselyTables)W=W.where("columns.TABLE_NAME","!=",A0).where("columns.TABLE_NAME","!=",p0);let X=await W.execute();return this.#W(X)}async getMetadata(J){return{tables:await this.getTables(J)}}#W(J){return J.reduce((W,X)=>{let G=W.find((Y)=>Y.name===X.TABLE_NAME);if(!G)G=U({name:X.TABLE_NAME,isView:X.TABLE_TYPE==="VIEW",schema:X.TABLE_SCHEMA,columns:[]}),W.push(G);return G.columns.push(U({name:X.COLUMN_NAME,dataType:X.DATA_TYPE,isNullable:X.IS_NULLABLE==="YES",isAutoIncrementing:X.EXTRA.toLowerCase().includes("auto_increment"),hasDefaultValue:X.COLUMN_DEFAULT!==null,comment:X.COLUMN_COMMENT===""?void 0:X.COLUMN_COMMENT})),W},[])}}var Dz=D(()=>{BX();C();hW()});var NO="ea586330-2c93-47c8-908d-981d9d270f9d",AR=3600,vz;var Mz=D(()=>{hW();vz=class vz extends tJ{get supportsTransactionalDdl(){return!1}get supportsReturning(){return!1}async acquireMigrationLock(J,W){await F6`select get_lock(${F6.lit(NO)}, ${F6.lit(AR)})`.execute(J)}async releaseMigrationLock(J,W){await F6`select release_lock(${F6.lit(NO)})`.execute(J)}}});class $K{#J;constructor(J){this.#J=J}createDriver(){return new Nz(this.#J)}createQueryCompiler(){return new Qz}createAdapter(){return new vz}createIntrospector(J){return new Vz(J)}}var UO=D(()=>{Uz();Lz();Dz();Mz()});var QO=()=>{};class Oz{#J;#W=new WeakMap;#X;constructor(J){this.#J=U({...J})}async init(){this.#X=f6(this.#J.pool)?await this.#J.pool():this.#J.pool}async acquireConnection(){let J=await this.#X.connect(),W=this.#W.get(J);if(!W){if(W=new VO(J,{cursor:this.#J.cursor??null}),this.#W.set(J,W),this.#J.onCreateConnection)await this.#J.onCreateConnection(W)}if(this.#J.onReserveConnection)await this.#J.onReserveConnection(W);return W}async beginTransaction(J,W){if(W.isolationLevel||W.accessMode){let X="start transaction";if(W.isolationLevel)X+=` isolation level ${W.isolationLevel}`;if(W.accessMode)X+=` ${W.accessMode}`;await J.executeQuery(W4.raw(X))}else await J.executeQuery(W4.raw("begin"))}async commitTransaction(J){await J.executeQuery(W4.raw("commit"))}async rollbackTransaction(J){await J.executeQuery(W4.raw("rollback"))}async savepoint(J,W,X){await J.executeQuery(X(E8("savepoint",W),w6()))}async rollbackToSavepoint(J,W,X){await J.executeQuery(X(E8("rollback to",W),w6()))}async releaseSavepoint(J,W,X){await J.executeQuery(X(E8("release",W),w6()))}async releaseConnection(J){J[LO]()}async destroy(){if(this.#X){let J=this.#X;this.#X=void 0,await J.end()}}}var LO,VO;var Pz=D(()=>{WK();a1();C();B8();GK();LO=Symbol();VO=class VO{#J;#W;constructor(J,W){this.#J=J,this.#W=W}async executeQuery(J){try{let{command:W,rowCount:X,rows:G}=await this.#J.query(J.sql,[...J.parameters]);return{numAffectedRows:W==="INSERT"||W==="UPDATE"||W==="DELETE"||W==="MERGE"?BigInt(X):void 0,rows:G??[]}}catch(W){throw t1(W,Error())}}async*streamQuery(J,W){if(!this.#W.cursor)throw Error("'cursor' is not present in your postgres dialect config. It's required to make streaming work in postgres.");if(!Number.isInteger(W)||W<=0)throw Error("chunkSize must be a positive integer");let X=this.#J.query(new this.#W.cursor(J.sql,J.parameters.slice()));try{while(!0){let G=await X.read(W);if(G.length===0)break;yield{rows:G}}}finally{await X.close()}}[LO](){this.#J.release()}}});var DO=()=>{};class o1{#J;constructor(J){this.#J=J}createDriver(){return new Oz(this.#J)}createQueryCompiler(){return new Kz}createAdapter(){return new zz}createIntrospector(J){return new Hz(J)}}var vO=D(()=>{Pz();Zz();wz();Fz()});var jz;var _z=D(()=>{BX();hW();jz=class jz extends tJ{get supportsCreateIfNotExists(){return!1}get supportsTransactionalDdl(){return!0}get supportsOutput(){return!0}async acquireMigrationLock(J){await F6`exec sp_getapplock @DbPrincipal = ${F6.lit("dbo")}, @Resource = ${F6.lit(A0)}, @LockMode = ${F6.lit("Exclusive")}`.execute(J)}async releaseMigrationLock(){}}});var MO=()=>{};class Sz{#J;#W;constructor(J){this.#J=U({...J});let{tarn:W,tedious:X,validateConnections:G}=this.#J,{validateConnections:Y,...$}=W.options;this.#W=new W.Pool({...$,create:async()=>{let K=await X.connectionFactory();return await new _O(K,X).connect()},destroy:async(K)=>{await K[PO]()},validate:G===!1||Y===!1?void 0:(K)=>K[jO]()})}async init(){}async acquireConnection(){return await this.#W.acquire().promise}async beginTransaction(J,W){await J.beginTransaction(W)}async commitTransaction(J){await J.commitTransaction()}async rollbackTransaction(J){await J.rollbackTransaction()}async savepoint(J,W){await J.savepoint(W)}async rollbackToSavepoint(J,W){await J.rollbackTransaction(W)}async releaseConnection(J){if(this.#J.resetConnectionsOnRelease||this.#J.tedious.resetConnectionOnRelease)await J[OO]();this.#W.release(J)}async destroy(){await this.#W.destroy()}}class KK{#J;#W;#X;#Y;#G;#w;constructor(J){let{compiledQuery:W,onDone:X,streamChunkSize:G,tedious:Y}=J;if(this.#W=[],this.#X=G,this.#Y={},this.#G=Y,X)this.#Y.onDone=(K,w)=>{if(K==="chunkReady")return;if(delete this.#Y.onDone,K==="error")return X.reject(w);X.resolve({rowCount:this.#w,rows:this.#W})};this.#J=new this.#G.Request(W.sql,($,K)=>{if($)return Object.values(this.#Y).forEach((w)=>w("error",$ instanceof AggregateError?$.errors:$));this.#w=K}),this.#K(W.parameters),this.#$()}get request(){return this.#J}readChunk(){let J=this.readChunk.name;return new Promise((W,X)=>{this.#Y[J]=(G,Y)=>{if(delete this.#Y[J],G==="error")return X(Y);W(this.#W.splice(0,this.#X))},this.#J.resume()})}#K(J){for(let W=0;W<J.length;W++){let X=J[W];this.#J.addParameter(String(W+1),this.#H(X),X)}}#$(){let J=this.#X?()=>{if(this.#X<=this.#W.length)this.#J.pause(),Object.values(this.#Y).forEach((X)=>X("chunkReady"))}:()=>{},W=(X)=>{let G={};for(let Y of X)G[Y.metadata.colName]=Y.value;this.#W.push(G),J()};this.#J.on("row",W),this.#J.once("requestCompleted",()=>{Object.values(this.#Y).forEach((X)=>X("completed")),this.#J.off("row",W)})}#H(J){if(VW(J)||T0(J)||h6(J))return this.#G.TYPES.NVarChar;if(DW(J)||k8(J)&&J%1===0)if(J<-2147483648||J>2147483647)return this.#G.TYPES.BigInt;else return this.#G.TYPES.Int;if(k8(J))return this.#G.TYPES.Float;if(fJ(J))return this.#G.TYPES.Bit;if(F1(J))return this.#G.TYPES.DateTime;if(d$(J))return this.#G.TYPES.VarBinary;return this.#G.TYPES.NVarChar}}var OO,PO,jO,_O;var Tz=D(()=>{C();a1();GK();bZ();OO=Symbol(),PO=Symbol(),jO=Symbol();_O=class _O{#J;#W;#X;constructor(J,W){this.#J=J,this.#W=!1,this.#X=W}async beginTransaction(J){let{isolationLevel:W}=J;await new Promise((X,G)=>this.#J.beginTransaction((Y)=>{if(Y)G(Y);else X(void 0)},W?O5(8):void 0,W?this.#Y(W):void 0))}async commitTransaction(){await new Promise((J,W)=>this.#J.commitTransaction((X)=>{if(X)W(X);else J(void 0)}))}async connect(){let{promise:J,reject:W,resolve:X}=new AW;this.#J.connect((Y)=>{if(Y)return W(Y);X()}),this.#J.on("error",(Y)=>{if(Y instanceof Error&&"code"in Y&&Y.code==="ESOCKET")this.#W=!0;console.error(Y),W(Y)});function G(){W(Error("The connection ended without ever completing the connection"))}return this.#J.once("end",G),await J,this.#J.off("end",G),this}async executeQuery(J){try{let W=new AW,X=new KK({compiledQuery:J,tedious:this.#X,onDone:W});this.#J.execSql(X.request);let{rowCount:G,rows:Y}=await W.promise;return{numAffectedRows:G!==void 0?BigInt(G):void 0,rows:Y}}catch(W){throw t1(W,Error())}}async rollbackTransaction(J){await new Promise((W,X)=>this.#J.rollbackTransaction((G)=>{if(G)X(G);else W(void 0)},J))}async savepoint(J){await new Promise((W,X)=>this.#J.saveTransaction((G)=>{if(G)X(G);else W(void 0)},J))}async*streamQuery(J,W){if(!Number.isInteger(W)||W<=0)throw Error("chunkSize must be a positive integer");let X=new KK({compiledQuery:J,streamChunkSize:W,tedious:this.#X});this.#J.execSql(X.request);try{while(!0){let G=await X.readChunk();if(G.length===0)break;if(yield{rows:G},G.length<W)break}}finally{await this.#G(X)}}#Y(J){let{ISOLATION_LEVEL:W}=this.#X,G={"read committed":W.READ_COMMITTED,"read uncommitted":W.READ_UNCOMMITTED,"repeatable read":W.REPEATABLE_READ,serializable:W.SERIALIZABLE,snapshot:W.SNAPSHOT}[J];if(G===void 0)throw Error(`Unknown isolation level: ${J}`);return G}#G(J){return new Promise((W)=>{if(J.request.once("requestCompleted",W),!this.#J.cancel())J.request.off("requestCompleted",W),W()})}[PO](){if("closed"in this.#J&&this.#J.closed)return Promise.resolve();return new Promise((J)=>{this.#J.once("end",J),this.#J.close()})}async[OO](){await new Promise((J,W)=>{this.#J.reset((X)=>{if(X)return W(X);J()})})}async[jO](){if(this.#W||this.#w())return!1;try{let J=new AW,W=new KK({compiledQuery:W4.raw("select 1"),onDone:J,tedious:this.#X});return this.#J.execSql(W.request),await J.promise,!0}catch{return!1}}#w(){return"closed"in this.#J&&Boolean(this.#J.closed)}}});class qz{#J;constructor(J){this.#J=J}async getSchemas(){return await this.#J.selectFrom("sys.schemas").select("name").execute()}async getTables(J={withInternalKyselyTables:!1}){let W=await this.#J.selectFrom("sys.tables as tables").leftJoin("sys.schemas as table_schemas","table_schemas.schema_id","tables.schema_id").innerJoin("sys.columns as columns","columns.object_id","tables.object_id").innerJoin("sys.types as types","types.user_type_id","columns.user_type_id").leftJoin("sys.schemas as type_schemas","type_schemas.schema_id","types.schema_id").leftJoin("sys.extended_properties as comments",(G)=>G.onRef("comments.major_id","=","tables.object_id").onRef("comments.minor_id","=","columns.column_id").on("comments.name","=","MS_Description")).$if(!J.withInternalKyselyTables,(G)=>G.where("tables.name","!=",A0).where("tables.name","!=",p0)).select(["tables.name as table_name",(G)=>G.ref("tables.type").$castTo().as("table_type"),"table_schemas.name as table_schema_name","columns.default_object_id as column_default_object_id","columns.generated_always_type_desc as column_generated_always_type","columns.is_computed as column_is_computed","columns.is_identity as column_is_identity","columns.is_nullable as column_is_nullable","columns.is_rowguidcol as column_is_rowguidcol","columns.name as column_name","types.is_nullable as type_is_nullable","types.name as type_name","type_schemas.name as type_schema_name","comments.value as column_comment"]).unionAll(this.#J.selectFrom("sys.views as views").leftJoin("sys.schemas as view_schemas","view_schemas.schema_id","views.schema_id").innerJoin("sys.columns as columns","columns.object_id","views.object_id").innerJoin("sys.types as types","types.user_type_id","columns.user_type_id").leftJoin("sys.schemas as type_schemas","type_schemas.schema_id","types.schema_id").leftJoin("sys.extended_properties as comments",(G)=>G.onRef("comments.major_id","=","views.object_id").onRef("comments.minor_id","=","columns.column_id").on("comments.name","=","MS_Description")).select(["views.name as table_name","views.type as table_type","view_schemas.name as table_schema_name","columns.default_object_id as column_default_object_id","columns.generated_always_type_desc as column_generated_always_type","columns.is_computed as column_is_computed","columns.is_identity as column_is_identity","columns.is_nullable as column_is_nullable","columns.is_rowguidcol as column_is_rowguidcol","columns.name as column_name","types.is_nullable as type_is_nullable","types.name as type_name","type_schemas.name as type_schema_name","comments.value as column_comment"])).orderBy("table_schema_name").orderBy("table_name").orderBy("column_name").execute(),X={};for(let G of W){let Y=`${G.table_schema_name}.${G.table_name}`;(X[Y]=X[Y]||U({columns:[],isView:G.table_type==="V ",name:G.table_name,schema:G.table_schema_name??void 0})).columns.push(U({dataType:G.type_name,dataTypeSchema:G.type_schema_name??void 0,hasDefaultValue:G.column_default_object_id>0||G.column_generated_always_type!=="NOT_APPLICABLE"||G.column_is_identity||G.column_is_computed||G.column_is_rowguidcol,isAutoIncrementing:G.column_is_identity,isNullable:G.column_is_nullable&&G.type_is_nullable,name:G.column_name,comment:G.column_comment??void 0}))}return Object.values(X)}async getMetadata(J){return{tables:await this.getTables(J)}}}var Bz=D(()=>{BX();C()});var ER,Az;var Ez=D(()=>{qX();ER=/^[a-z0-9_]$/i;Az=class Az extends H8{getCurrentParameterPlaceholder(){return`@${this.numParameters}`}visitOffset(J){super.visitOffset(J),this.append(" rows")}compileColumnAlterations(J){let W={};for(let G of J){if(!W[G.kind])W[G.kind]=[];W[G.kind].push(G)}let X=!0;if(W.AddColumnNode)this.append("add "),this.compileList(W.AddColumnNode),X=!1;if(W.AlterColumnNode){if(!X)this.append(", ");this.compileList(W.AlterColumnNode)}if(W.DropColumnNode){if(!X)this.append(", ");this.append("drop column "),this.compileList(W.DropColumnNode)}if(W.ModifyColumnNode){if(!X)this.append(", ");this.compileList(W.ModifyColumnNode)}if(W.RenameColumnNode){if(!X)this.append(", ");this.compileList(W.RenameColumnNode)}}visitAddColumn(J){this.visitNode(J.column)}visitDropColumn(J){this.visitNode(J.column)}visitMergeQuery(J){super.visitMergeQuery(J),this.append(";")}visitCollate(J){this.append("collate ");let{name:W}=J.collation;for(let X of W)if(!ER.test(X))throw Error(`Invalid collation: ${W}`);this.append(W)}announcesNewColumnDataType(){return!1}}});class Rz{#J;constructor(J){this.#J=J}createDriver(){return new Sz(this.#J)}createQueryCompiler(){return new Az}createAdapter(){return new jz}createIntrospector(J){return new qz(J)}}var SO=D(()=>{_z();Tz();Bz();Ez()});var TO=()=>{};class Cz{#J;constructor(J){this.#J=J}async getMigrations(){let J={},W=await this.#J.fs.readdir(this.#J.migrationFolder);for(let X of W)if(X.endsWith(".js")||X.endsWith(".ts")&&!X.endsWith(".d.ts")||X.endsWith(".mjs")||X.endsWith(".mts")&&!X.endsWith(".d.mts")){let G=await import(this.#J.path.join(this.#J.migrationFolder,X)),Y=X.substring(0,X.lastIndexOf("."));if(qO(G?.default))J[Y]=G.default;else if(qO(G))J[Y]=G}return J}}function qO(J){return s6(J)&&f6(J.up)}var BO=D(()=>{C()});var AO=()=>{};var Iz;var EO=D(()=>{MX();Iz=class Iz extends r8{#J;constructor(J){super();this.#J=J}transformIdentifier(J,W){return J=super.transformIdentifier(J,W),{...J,name:this.#J(J.name)}}}});function CO({upperCase:J=!1,underscoreBeforeDigits:W=!1,underscoreBetweenUppercaseLetters:X=!1}={}){return bO((G)=>{if(G.length===0)return G;let Y=G.toUpperCase(),$=G.toLowerCase(),K=$[0];for(let w=1,H=G.length;w<H;++w){let Z=G[w],z=G[w-1],N=Y[w],F=Y[w-1],Q=$[w],V=$[w-1];if(W&&RO(Z)&&!RO(z)&&!K.endsWith("_")){K+="_"+Z;continue}if(Z===N&&N!==Q)if(X||!(z===F&&F!==V))K+="_"+Q;else K+=Q;else K+=Z}if(J)return K.toUpperCase();else return K})}function IO({upperCase:J=!1}={}){return bO((W)=>{if(W.length===0)return W;if(J&&RR(W))W=W.toLowerCase();let X=W[0];for(let G=1,Y=W.length;G<Y;++G){let $=W[G],K=W[G-1];if($!=="_")if(K==="_")X+=$.toUpperCase();else X+=$}return X})}function RR(J){for(let W=1,X=J.length;W<X;++W){let G=J[W];if(G!=="_"&&G!==G.toUpperCase())return!1}return!0}function RO(J){return J>="0"&&J<="9"}function bO(J){let W=new Map;return(X)=>{let G=W.get(X);if(!G)G=J(X),W.set(X,G);return G}}class CR{opt;#J;#W;#X;constructor(J={}){this.opt=J,this.#J=IO(J),this.#W=CO(J),this.#X=new Iz(this.snakeCase.bind(this))}transformQuery(J){return this.#X.transformNode(J.node,J.queryId)}async transformResult(J){if(J.result.rows&&Array.isArray(J.result.rows))return{...J.result,rows:J.result.rows.map((W)=>this.mapRow(W))};return J.result}mapRow(J){return Object.keys(J).reduce((W,X)=>{let G=J[X];if(Array.isArray(G))G=G.map((Y)=>kO(Y,this.opt)?this.mapRow(Y):Y);else if(kO(G,this.opt))G=this.mapRow(G);return W[this.camelCase(X)]=G,W},{})}snakeCase(J){return this.#W(J)}camelCase(J){return this.#J(J)}}function kO(J,W){return n$(J)&&!W?.maintainNestedObjectKeys}var hO=D(()=>{C();EO()});var bz;var fO=D(()=>{MX();C();bz=class bz extends r8{transformSelectQuery(J,W){return this.#J(super.transformSelectQuery(J,W))}transformUpdateQuery(J,W){return this.#J(super.transformUpdateQuery(J,W))}transformDeleteQuery(J,W){return this.#J(super.transformDeleteQuery(J,W))}#J(J){if(!J.joins||J.joins.length===0)return J;return U({...J,joins:this.#W(J.joins)})}#W(J){let W=[];for(let X=0;X<J.length;++X){let G=!1;for(let Y=0;Y<W.length;++Y)if(r$(J[X],W[Y])){G=!0;break}if(!G)W.push(J[X])}return U(W)}}});class IR{#J=new bz;transformQuery(J){return this.#J.transformNode(J.node,J.queryId)}transformResult(J){return Promise.resolve(J.result)}}var gO=D(()=>{fO()});class bR{opt;#J;constructor(J={}){this.opt=J,this.#J=J.objectStrategy||"in-place"}transformQuery(J){return J.node}async transformResult(J){return{...J.result,rows:mO(J.result.rows,this.#J)}}}function mO(J,W){let X=W==="create"?Array(J.length):J;for(let G=0;G<J.length;++G)X[G]=kz(J[G],W);return X}function kz(J,W){if(h6(J))return kR(J);if(Array.isArray(J))return mO(J,W);if(n$(J))return fR(J,W);return J}function kR(J){if(hR(J))try{return kz(JSON.parse(J),"in-place")}catch(W){}return J}function hR(J){return J.match(/^[\[\{]/)!=null}function fR(J,W){let X=W==="create"?{}:J;for(let G in J)X[G]=kz(J[G],W);return X}var yO=D(()=>{C()});var hz;var xO=D(()=>{MX();SG();yJ();jW();hz=class hz extends r8{#J;constructor(J){super();this.#J=J}transformBinaryOperation(J){if(this.#W(J))return this.#J(J);return J}#W(J){let{operator:W,rightOperand:X}=J;return(O1.is(X)||l8.is(X))&&X.values.length===0&&Q0.is(W)&&(W.operator==="in"||W.operator==="not in")}}});class gR{opt;#J;constructor(J){this.opt=J,this.#J=new hz(J.strategy)}transformQuery(J){return this.#J.transformNode(J.node,J.queryId)}async transformResult(J){return J.result}}var uO=D(()=>{xO()});var lO=D(()=>{OG();k5();b5();yJ();jW();c8();C()});var cO=()=>{};var pO=()=>{};var dO=()=>{};var nO=()=>{};var rO=()=>{};var iO=()=>{};var aO=()=>{};var oJ=D(()=>{qW();D1();B8();pM();j5();J5();k1();dM();nM();rM();iM();aM();yG();TZ();D5();BZ();DX();NZ();C5();jZ();iZ();I5();eZ();uZ();nH();a3();hW();sM();l3();I1();eM();qX();a1();m3();B3();k3();R3();h3();T3();A3();q3();E3();g5();m5();_3();I3();g3();b3();v3();x3();jG();h5();d3();WO();XO();YO();GO();$O();HO();ZO();e3();wz();Zz();Fz();UO();QO();Uz();Lz();Dz();Mz();Pz();DO();vO();Jz();Gz();$z();_z();MO();SO();Tz();Bz();Ez();qX();TO();BX();BO();AO();hO();gO();OX();yO();uO();lO();K3();y5();l5();E5();f8();D3();FX();MW();OG();xG();k5();nG();dH();dG();L0();MZ();RZ();v5();cO();i$();t$();N1();n5();X9();o5();b5();VZ();U3();EG();H3();x5();DG();o$();s$();a5();p5();ZZ();dZ();aG();AG();rZ();N3();pZ();XZ();GZ();e6();LX();Q1();w5();sZ();_G();$5();kG();N5();hZ();CG();V3();cZ();V5();OZ();uH();m0();MX();o3();pO();yJ();SZ();NX();G5();qG();FZ();z5();P1();UZ();JZ();oG();SG();S8();_8();X5();rG();z3();P3();HZ();gJ();PG();xH();SW();QZ();S5();dO();U1();_Z();W3();aZ();tG();_1();KZ();jW();c8();LZ();VX();RG();IZ();nO();i3();rO();iO();r3();aO()});var gz=M6((cR)=>{cR.parse=function(J,W){return new fz(J,W).parse()};class fz{constructor(J,W){this.source=J,this.transform=W||lR,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var J=this.source[this.position++];if(J==="\\")return{value:this.source[this.position++],escaped:!0};return{value:J,escaped:!1}}record(J){this.recorded.push(J)}newEntry(J){var W;if(this.recorded.length>0||J){if(W=this.recorded.join(""),W==="NULL"&&!J)W=null;if(W!==null)W=this.transform(W);this.entries.push(W),this.recorded=[]}}consumeDimensions(){if(this.source[0]==="[")while(!this.isEof()){var J=this.nextCharacter();if(J.value==="=")break}}parse(J){var W,X,G;this.consumeDimensions();while(!this.isEof())if(W=this.nextCharacter(),W.value==="{"&&!G){if(this.dimension++,this.dimension>1)X=new fz(this.source.substr(this.position-1),this.transform),this.entries.push(X.parse(!0)),this.position+=X.position-2}else if(W.value==="}"&&!G){if(this.dimension--,!this.dimension){if(this.newEntry(),J)return this.entries}}else if(W.value==='"'&&!W.escaped){if(G)this.newEntry(!0);G=!G}else if(W.value===","&&!G)this.newEntry();else this.record(W.value);if(this.dimension!==0)throw Error("array dimension not balanced");return this.entries}}function lR(J){return J}});var mz=M6((AK6,tO)=>{var dR=gz();tO.exports={create:function(J,W){return{parse:function(){return dR.parse(J,W)}}}}});var eO=M6((EK6,sO)=>{var nR=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,rR=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,iR=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,aR=/^-?infinity$/;sO.exports=function(W){if(aR.test(W))return Number(W.replace("i","I"));var X=nR.exec(W);if(!X)return tR(W)||null;var G=!!X[8],Y=parseInt(X[1],10);if(G)Y=oO(Y);var $=parseInt(X[2],10)-1,K=X[3],w=parseInt(X[4],10),H=parseInt(X[5],10),Z=parseInt(X[6],10),z=X[7];z=z?1000*parseFloat(z):0;var N,F=oR(W);if(F!=null){if(N=new Date(Date.UTC(Y,$,K,w,H,Z,z)),yz(Y))N.setUTCFullYear(Y);if(F!==0)N.setTime(N.getTime()-F)}else if(N=new Date(Y,$,K,w,H,Z,z),yz(Y))N.setFullYear(Y);return N};function tR(J){var W=rR.exec(J);if(!W)return;var X=parseInt(W[1],10),G=!!W[4];if(G)X=oO(X);var Y=parseInt(W[2],10)-1,$=W[3],K=new Date(X,Y,$);if(yz(X))K.setFullYear(X);return K}function oR(J){if(J.endsWith("+00"))return 0;var W=iR.exec(J.split(" ")[1]);if(!W)return;var X=W[1];if(X==="Z")return 0;var G=X==="-"?-1:1,Y=parseInt(W[2],10)*3600+parseInt(W[3]||0,10)*60+parseInt(W[4]||0,10);return Y*G*1000}function oO(J){return-(J-1)}function yz(J){return J>=0&&J<100}});var WP=M6((RK6,JP)=>{JP.exports=eR;var sR=Object.prototype.hasOwnProperty;function eR(J){for(var W=1;W<arguments.length;W++){var X=arguments[W];for(var G in X)if(sR.call(X,G))J[G]=X[G]}return J}});var GP=M6((CK6,YP)=>{var JC=WP();YP.exports=s1;function s1(J){if(!(this instanceof s1))return new s1(J);JC(this,NC(J))}var WC=["seconds","minutes","hours","days","months","years"];s1.prototype.toPostgres=function(){var J=WC.filter(this.hasOwnProperty,this);if(this.milliseconds&&J.indexOf("seconds")<0)J.push("seconds");if(J.length===0)return"0";return J.map(function(W){var X=this[W]||0;if(W==="seconds"&&this.milliseconds)X=(X+this.milliseconds/1000).toFixed(6).replace(/\.?0+$/,"");return X+" "+W},this).join(" ")};var XC={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},YC=["years","months","days"],GC=["hours","minutes","seconds"];s1.prototype.toISOString=s1.prototype.toISO=function(){var J=YC.map(X,this).join(""),W=GC.map(X,this).join("");return"P"+J+"T"+W;function X(G){var Y=this[G]||0;if(G==="seconds"&&this.milliseconds)Y=(Y+this.milliseconds/1000).toFixed(6).replace(/0+$/,"");return Y+XC[G]}};var xz="([+-]?\\d+)",$C=xz+"\\s+years?",KC=xz+"\\s+mons?",wC=xz+"\\s+days?",HC="([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?",ZC=new RegExp([$C,KC,wC,HC].map(function(J){return"("+J+")?"}).join("\\s*")),XP={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},zC=["hours","minutes","seconds","milliseconds"];function FC(J){var W=J+"000000".slice(J.length);return parseInt(W,10)/1000}function NC(J){if(!J)return{};var W=ZC.exec(J),X=W[8]==="-";return Object.keys(XP).reduce(function(G,Y){var $=XP[Y],K=W[$];if(!K)return G;if(K=Y==="milliseconds"?FC(K):parseInt(K,10),!K)return G;if(X&&~zC.indexOf(Y))K*=-1;return G[Y]=K,G},{})}});var KP=M6((IK6,$P)=>{$P.exports=function(W){if(/^\\x/.test(W))return new Buffer(W.substr(2),"hex");var X="",G=0;while(G<W.length)if(W[G]!=="\\")X+=W[G],++G;else if(/[0-7]{3}/.test(W.substr(G+1,3)))X+=String.fromCharCode(parseInt(W.substr(G+1,3),8)),G+=4;else{var Y=1;while(G+Y<W.length&&W[G+Y]==="\\")Y++;for(var $=0;$<Math.floor(Y/2);++$)X+="\\";G+=Math.floor(Y/2)*2}return new Buffer(X,"binary")}});var UP=M6((bK6,NP)=>{var H9=gz(),Z9=mz(),HK=eO(),HP=GP(),ZP=KP();function ZK(J){return function(X){if(X===null)return X;return J(X)}}function zP(J){if(J===null)return J;return J==="TRUE"||J==="t"||J==="true"||J==="y"||J==="yes"||J==="on"||J==="1"}function UC(J){if(!J)return null;return H9.parse(J,zP)}function QC(J){return parseInt(J,10)}function uz(J){if(!J)return null;return H9.parse(J,ZK(QC))}function LC(J){if(!J)return null;return H9.parse(J,ZK(function(W){return FP(W).trim()}))}var VC=function(J){if(!J)return null;var W=Z9.create(J,function(X){if(X!==null)X=dz(X);return X});return W.parse()},lz=function(J){if(!J)return null;var W=Z9.create(J,function(X){if(X!==null)X=parseFloat(X);return X});return W.parse()},R8=function(J){if(!J)return null;var W=Z9.create(J);return W.parse()},cz=function(J){if(!J)return null;var W=Z9.create(J,function(X){if(X!==null)X=HK(X);return X});return W.parse()},DC=function(J){if(!J)return null;var W=Z9.create(J,function(X){if(X!==null)X=HP(X);return X});return W.parse()},vC=function(J){if(!J)return null;return H9.parse(J,ZK(ZP))},pz=function(J){return parseInt(J,10)},FP=function(J){var W=String(J);if(/^\d+$/.test(W))return W;return J},wP=function(J){if(!J)return null;return H9.parse(J,ZK(JSON.parse))},dz=function(J){if(J[0]!=="(")return null;return J=J.substring(1,J.length-1).split(","),{x:parseFloat(J[0]),y:parseFloat(J[1])}},MC=function(J){if(J[0]!=="<"&&J[1]!=="(")return null;var W="(",X="",G=!1;for(var Y=2;Y<J.length-1;Y++){if(!G)W+=J[Y];if(J[Y]===")"){G=!0;continue}else if(!G)continue;if(J[Y]===",")continue;X+=J[Y]}var $=dz(W);return $.radius=parseFloat(X),$},OC=function(J){J(20,FP),J(21,pz),J(23,pz),J(26,pz),J(700,parseFloat),J(701,parseFloat),J(16,zP),J(1082,HK),J(1114,HK),J(1184,HK),J(600,dz),J(651,R8),J(718,MC),J(1000,UC),J(1001,vC),J(1005,uz),J(1007,uz),J(1028,uz),J(1016,LC),J(1017,VC),J(1021,lz),J(1022,lz),J(1231,lz),J(1014,R8),J(1015,R8),J(1008,R8),J(1009,R8),J(1040,R8),J(1041,R8),J(1115,cz),J(1182,cz),J(1185,cz),J(1186,HP),J(1187,DC),J(17,ZP),J(114,JSON.parse.bind(JSON)),J(3802,JSON.parse.bind(JSON)),J(199,wP),J(3807,wP),J(3907,R8),J(2951,R8),J(791,R8),J(1183,R8),J(1270,R8)};NP.exports={init:OC}});var LP=M6((kK6,QP)=>{var d0=1e6;function PC(J){var W=J.readInt32BE(0),X=J.readUInt32BE(4),G="";if(W<0)W=~W+(X===0),X=~X+1>>>0,G="-";var Y="",$,K,w,H,Z,z;{if($=W%d0,W=W/d0>>>0,K=4294967296*$+X,X=K/d0>>>0,w=""+(K-d0*X),X===0&&W===0)return G+w+Y;H="",Z=6-w.length;for(z=0;z<Z;z++)H+="0";Y=H+w+Y}{if($=W%d0,W=W/d0>>>0,K=4294967296*$+X,X=K/d0>>>0,w=""+(K-d0*X),X===0&&W===0)return G+w+Y;H="",Z=6-w.length;for(z=0;z<Z;z++)H+="0";Y=H+w+Y}{if($=W%d0,W=W/d0>>>0,K=4294967296*$+X,X=K/d0>>>0,w=""+(K-d0*X),X===0&&W===0)return G+w+Y;H="",Z=6-w.length;for(z=0;z<Z;z++)H+="0";Y=H+w+Y}return $=W%d0,K=4294967296*$+X,w=""+K%d0,G+w+Y}QP.exports=PC});var OP=M6((hK6,MP)=>{var jC=LP(),T4=function(J,W,X,G,Y){X=X||0,G=G||!1,Y=Y||function(Q,V,v){return Q*Math.pow(2,v)+V};var $=X>>3,K=function(Q){if(G)return~Q&255;return Q},w=255,H=8-X%8;if(W<H)w=255<<8-W&255,H=W;if(X)w=w>>X%8;var Z=0;if(X%8+W>=8)Z=Y(0,K(J[$])&w,H);var z=W+X>>3;for(var N=$+1;N<z;N++)Z=Y(Z,K(J[N]),8);var F=(W+X)%8;if(F>0)Z=Y(Z,K(J[z])>>8-F,F);return Z},vP=function(J,W,X){var G=Math.pow(2,X-1)-1,Y=T4(J,1),$=T4(J,X,1);if($===0)return 0;var K=1,w=function(Z,z,N){if(Z===0)Z=1;for(var F=1;F<=N;F++)if(K/=2,(z&1<<N-F)>0)Z+=K;return Z},H=T4(J,W,X+1,!1,w);if($==Math.pow(2,X+1)-1){if(H===0)return Y===0?1/0:-1/0;return NaN}return(Y===0?1:-1)*Math.pow(2,$-G)*H},_C=function(J){if(T4(J,1)==1)return-1*(T4(J,15,1,!0)+1);return T4(J,15,1)},VP=function(J){if(T4(J,1)==1)return-1*(T4(J,31,1,!0)+1);return T4(J,31,1)},SC=function(J){return vP(J,23,8)},TC=function(J){return vP(J,52,11)},qC=function(J){var W=T4(J,16,32);if(W==49152)return NaN;var X=Math.pow(1e4,T4(J,16,16)),G=0,Y=[],$=T4(J,16);for(var K=0;K<$;K++)G+=T4(J,16,64+16*K)*X,X/=1e4;var w=Math.pow(10,T4(J,16,48));return(W===0?1:-1)*Math.round(G*w)/w},DP=function(J,W){var X=T4(W,1),G=T4(W,63,1),Y=new Date((X===0?1:-1)*G/1000+946684800000);if(!J)Y.setTime(Y.getTime()+Y.getTimezoneOffset()*60000);return Y.usec=G%1000,Y.getMicroSeconds=function(){return this.usec},Y.setMicroSeconds=function($){this.usec=$},Y.getUTCMicroSeconds=function(){return this.usec},Y},z9=function(J){var W=T4(J,32),X=T4(J,32,32),G=T4(J,32,64),Y=96,$=[];for(var K=0;K<W;K++)$[K]=T4(J,32,Y),Y+=32,Y+=32;var w=function(Z){var z=T4(J,32,Y);if(Y+=32,z==4294967295)return null;var N;if(Z==23||Z==20)return N=T4(J,z*8,Y),Y+=z*8,N;else if(Z==25)return N=J.toString(this.encoding,Y>>3,(Y+=z<<3)>>3),N;else console.log("ERROR: ElementType not implemented: "+Z)},H=function(Z,z){var N=[],F;if(Z.length>1){var Q=Z.shift();for(F=0;F<Q;F++)N[F]=H(Z,z);Z.unshift(Q)}else for(F=0;F<Z[0];F++)N[F]=w(z);return N};return H($,G)},BC=function(J){return J.toString("utf8")},AC=function(J){if(J===null)return null;return T4(J,8)>0},EC=function(J){J(20,jC),J(21,_C),J(23,VP),J(26,VP),J(1700,qC),J(700,SC),J(701,TC),J(16,AC),J(1114,DP.bind(null,!1)),J(1184,DP.bind(null,!0)),J(1000,z9),J(1007,z9),J(1016,z9),J(1008,z9),J(1009,z9),J(25,BC)};MP.exports={init:EC}});var jP=M6((fK6,PP)=>{PP.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}});var N9=M6((fC)=>{var RC=UP(),CC=OP(),IC=mz(),bC=jP();fC.getTypeParser=kC;fC.setTypeParser=hC;fC.arrayParser=IC;fC.builtins=bC;var F9={text:{},binary:{}};function _P(J){return String(J)}function kC(J,W){if(W=W||"text",!F9[W])return _P;return F9[W][J]||_P}function hC(J,W,X){if(typeof W=="function")X=W,W="text";F9[W][J]=X}RC.init(function(J,W){F9.text[J]=W});CC.init(function(J,W){F9.binary[J]=W})});var U9=M6((mK6,nz)=>{nz.exports={host:"localhost",user:process.platform==="win32"?process.env.USERNAME:process.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:30000,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var e1=N9(),uC=e1.getTypeParser(20,"text"),lC=e1.getTypeParser(1016,"text");nz.exports.__defineSetter__("parseInt8",function(J){e1.setTypeParser(20,"text",J?e1.getTypeParser(23,"text"):uC),e1.setTypeParser(1016,"text",J?e1.getTypeParser(1007,"text"):lC)})});var JY=M6((yK6,qP)=>{var cC=U9(),SP=z4("util"),{isDate:pC}=SP.types||SP;function dC(J){return'"'+J.replace(/\\/g,"\\\\").replace(/"/g,"\\\"")+'"'}function TP(J){let W="{";for(let X=0;X<J.length;X++){if(X>0)W=W+",";if(J[X]===null||typeof J[X]>"u")W=W+"NULL";else if(Array.isArray(J[X]))W=W+TP(J[X]);else if(ArrayBuffer.isView(J[X])){let G=J[X];if(!(G instanceof Buffer)){let Y=Buffer.from(G.buffer,G.byteOffset,G.byteLength);if(Y.length===G.byteLength)G=Y;else G=Y.slice(G.byteOffset,G.byteOffset+G.byteLength)}W+="\\\\x"+G.toString("hex")}else W+=dC(zK(J[X]))}return W=W+"}",W}var zK=function(J,W){if(J==null)return null;if(typeof J==="object"){if(J instanceof Buffer)return J;if(ArrayBuffer.isView(J)){let X=Buffer.from(J.buffer,J.byteOffset,J.byteLength);if(X.length===J.byteLength)return X;return X.slice(J.byteOffset,J.byteOffset+J.byteLength)}if(pC(J))if(cC.parseInputDatesAsUTC)return iC(J);else return rC(J);if(Array.isArray(J))return TP(J);return nC(J,W)}return J.toString()};function nC(J,W){if(J&&typeof J.toPostgres==="function"){if(W=W||[],W.indexOf(J)!==-1)throw Error('circular reference detected while preparing "'+J+'" for query');return W.push(J),zK(J.toPostgres(zK),W)}return JSON.stringify(J)}function rC(J){let W=-J.getTimezoneOffset(),X=J.getFullYear(),G=X<1;if(G)X=Math.abs(X)+1;let Y=String(X).padStart(4,"0")+"-"+String(J.getMonth()+1).padStart(2,"0")+"-"+String(J.getDate()).padStart(2,"0")+"T"+String(J.getHours()).padStart(2,"0")+":"+String(J.getMinutes()).padStart(2,"0")+":"+String(J.getSeconds()).padStart(2,"0")+"."+String(J.getMilliseconds()).padStart(3,"0");if(W<0)Y+="-",W*=-1;else Y+="+";if(Y+=String(Math.floor(W/60)).padStart(2,"0")+":"+String(W%60).padStart(2,"0"),G)Y+=" BC";return Y}function iC(J){let W=J.getUTCFullYear(),X=W<1;if(X)W=Math.abs(W)+1;let G=String(W).padStart(4,"0")+"-"+String(J.getUTCMonth()+1).padStart(2,"0")+"-"+String(J.getUTCDate()).padStart(2,"0")+"T"+String(J.getUTCHours()).padStart(2,"0")+":"+String(J.getUTCMinutes()).padStart(2,"0")+":"+String(J.getUTCSeconds()).padStart(2,"0")+"."+String(J.getUTCMilliseconds()).padStart(3,"0");if(G+="+00:00",X)G+=" BC";return G}function aC(J,W,X){if(J=typeof J==="string"?{text:J}:J,W)if(typeof W==="function")J.callback=W;else J.values=W;if(X)J.callback=X;return J}var tC=function(J){return'"'+J.replace(/"/g,'""')+'"'},oC=function(J){let W=!1,X="'";if(J==null)return"''";if(typeof J!=="string")return"''";for(let G=0;G<J.length;G++){let Y=J[G];if(Y==="'")X+=Y+Y;else if(Y==="\\")X+=Y+Y,W=!0;else X+=Y}if(X+="'",W===!0)X=" E"+X;return X};qP.exports={prepareValue:function(W){return zK(W)},normalizeQueryConfig:aC,escapeIdentifier:tC,escapeLiteral:oC}});var AP=M6((xK6,BP)=>{var WY=z4("crypto");function rz(J){return WY.createHash("md5").update(J,"utf-8").digest("hex")}function sC(J,W,X){let G=rz(W+J);return"md5"+rz(Buffer.concat([Buffer.from(G),X]))}function eC(J){return WY.createHash("sha256").update(J).digest()}function JI(J,W){return J=J.replace(/(\D)-/,"$1"),WY.createHash(J).update(W).digest()}function WI(J,W){return WY.createHmac("sha256",J).update(W).digest()}async function XI(J,W,X){return WY.pbkdf2Sync(J,W,X,32,"sha256")}BP.exports={postgresMd5PasswordHash:sC,randomBytes:WY.randomBytes,deriveKey:XI,sha256:eC,hashByName:JI,hmacSha256:WI,md5:rz}});var IP=M6((uK6,CP)=>{var EP=z4("crypto");CP.exports={postgresMd5PasswordHash:GI,randomBytes:YI,deriveKey:HI,sha256:$I,hashByName:KI,hmacSha256:wI,md5:iz};var RP=EP.webcrypto||globalThis.crypto,AX=RP.subtle,az=new TextEncoder;function YI(J){return RP.getRandomValues(Buffer.alloc(J))}async function iz(J){try{return EP.createHash("md5").update(J,"utf-8").digest("hex")}catch(W){let X=typeof J==="string"?az.encode(J):J,G=await AX.digest("MD5",X);return Array.from(new Uint8Array(G)).map((Y)=>Y.toString(16).padStart(2,"0")).join("")}}async function GI(J,W,X){let G=await iz(W+J);return"md5"+await iz(Buffer.concat([Buffer.from(G),X]))}async function $I(J){return await AX.digest("SHA-256",J)}async function KI(J,W){return await AX.digest(J,W)}async function wI(J,W){let X=await AX.importKey("raw",J,{name:"HMAC",hash:"SHA-256"},!1,["sign"]);return await AX.sign("HMAC",X,az.encode(W))}async function HI(J,W,X){let G=await AX.importKey("raw",az.encode(J),"PBKDF2",!1,["deriveBits"]),Y={name:"PBKDF2",hash:"SHA-256",salt:W,iterations:X};return await AX.deriveBits(Y,G,256,["deriveBits"])}});var oz=M6((lK6,tz)=>{var ZI=parseInt(process.versions&&process.versions.node&&process.versions.node.split(".")[0])<15;if(ZI)tz.exports=AP();else tz.exports=IP()});var hP=M6((cK6,kP)=>{function EX(J,W){return Error("SASL channel binding: "+J+" when parsing public certificate "+W.toString("base64"))}function sz(J,W){let X=J[W++];if(X<128)return{length:X,index:W};let G=X&127;if(G>4)throw EX("bad length",J);X=0;for(let Y=0;Y<G;Y++)X=X<<8|J[W++];return{length:X,index:W}}function bP(J,W){if(J[W++]!==6)throw EX("non-OID data",J);let{length:X,index:G}=sz(J,W);W=G;let Y=W+X,$=J[W++],K=($/40>>0)+"."+$%40;while(W<Y){let w=0;while(W<Y){let H=J[W++];if(w=w<<7|H&127,H<128)break}K+="."+w}return{oid:K,index:W}}function Q9(J,W){if(J[W++]!==48)throw EX("non-sequence data",J);return sz(J,W)}function zI(J,W){if(W===void 0)W=0;W=Q9(J,W).index;let{length:X,index:G}=Q9(J,W);W=G+X,W=Q9(J,W).index;let{oid:Y,index:$}=bP(J,W);switch(Y){case"1.2.840.113549.1.1.4":return"MD5";case"1.2.840.113549.1.1.5":return"SHA-1";case"1.2.840.113549.1.1.11":return"SHA-256";case"1.2.840.113549.1.1.12":return"SHA-384";case"1.2.840.113549.1.1.13":return"SHA-512";case"1.2.840.113549.1.1.14":return"SHA-224";case"1.2.840.113549.1.1.15":return"SHA512-224";case"1.2.840.113549.1.1.16":return"SHA512-256";case"1.2.840.10045.4.1":return"SHA-1";case"1.2.840.10045.4.3.1":return"SHA-224";case"1.2.840.10045.4.3.2":return"SHA-256";case"1.2.840.10045.4.3.3":return"SHA-384";case"1.2.840.10045.4.3.4":return"SHA-512";case"1.2.840.113549.1.1.10":{if(W=$,W=Q9(J,W).index,J[W++]!==160)throw EX("non-tag data",J);W=sz(J,W).index,W=Q9(J,W).index;let{oid:K}=bP(J,W);switch(K){case"1.2.840.113549.2.5":return"MD5";case"1.3.14.3.2.26":return"SHA-1";case"2.16.840.1.101.3.4.2.1":return"SHA-256";case"2.16.840.1.101.3.4.2.2":return"SHA-384";case"2.16.840.1.101.3.4.2.3":return"SHA-512"}throw EX("unknown hash OID "+K,J)}case"1.3.101.110":case"1.3.101.112":return"SHA-512";case"1.3.101.111":case"1.3.101.113":throw EX("Ed448 certificate channel binding is not currently supported by Postgres")}throw EX("unknown OID "+Y,J)}kP.exports={signatureAlgorithmHashFromCertificate:zI}});var yP=M6((pK6,mP)=>{var fW=oz(),{signatureAlgorithmHashFromCertificate:FI}=hP();function NI(J,W){let X=["SCRAM-SHA-256"];if(W)X.unshift("SCRAM-SHA-256-PLUS");let G=X.find((K)=>J.includes(K));if(!G)throw Error("SASL: Only mechanism(s) "+X.join(" and ")+" are supported");if(G==="SCRAM-SHA-256-PLUS"&&typeof W.getPeerCertificate!=="function")throw Error("SASL: Mechanism SCRAM-SHA-256-PLUS requires a certificate");let Y=fW.randomBytes(18).toString("base64");return{mechanism:G,clientNonce:Y,response:(G==="SCRAM-SHA-256-PLUS"?"p=tls-server-end-point":W?"y":"n")+",,n=*,r="+Y,message:"SASLInitialResponse"}}async function UI(J,W,X,G){if(J.message!=="SASLInitialResponse")throw Error("SASL: Last message was not SASLInitialResponse");if(typeof W!=="string")throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if(W==="")throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a non-empty string");if(typeof X!=="string")throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let Y=VI(X);if(!Y.nonce.startsWith(J.clientNonce))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");else if(Y.nonce.length===J.clientNonce.length)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short");let $="n=*,r="+J.clientNonce,K="r="+Y.nonce+",s="+Y.salt+",i="+Y.iteration,w=G?"eSws":"biws";if(J.mechanism==="SCRAM-SHA-256-PLUS"){let S=G.getPeerCertificate().raw,T=FI(S);if(T==="MD5"||T==="SHA-1")T="SHA-256";let j=await fW.hashByName(T,S);w=Buffer.concat([Buffer.from("p=tls-server-end-point,,"),Buffer.from(j)]).toString("base64")}let H="c="+w+",r="+Y.nonce,Z=$+","+K+","+H,z=Buffer.from(Y.salt,"base64"),N=await fW.deriveKey(W,z,Y.iteration),F=await fW.hmacSha256(N,"Client Key"),Q=await fW.sha256(F),V=await fW.hmacSha256(Q,Z),v=vI(Buffer.from(F),Buffer.from(V)).toString("base64"),M=await fW.hmacSha256(N,"Server Key"),O=await fW.hmacSha256(M,Z);J.message="SASLResponse",J.serverSignature=Buffer.from(O).toString("base64"),J.response=H+",p="+v}function QI(J,W){if(J.message!=="SASLResponse")throw Error("SASL: Last message was not SASLResponse");if(typeof W!=="string")throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:X}=DI(W);if(X!==J.serverSignature)throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}function LI(J){if(typeof J!=="string")throw TypeError("SASL: text must be a string");return J.split("").map((W,X)=>J.charCodeAt(X)).every((W)=>W>=33&&W<=43||W>=45&&W<=126)}function fP(J){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(J)}function gP(J){if(typeof J!=="string")throw TypeError("SASL: attribute pairs text must be a string");return new Map(J.split(",").map((W)=>{if(!/^.=/.test(W))throw Error("SASL: Invalid attribute pair entry");let X=W[0],G=W.substring(2);return[X,G]}))}function VI(J){let W=gP(J),X=W.get("r");if(!X)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");else if(!LI(X))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters");let G=W.get("s");if(!G)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");else if(!fP(G))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64");let Y=W.get("i");if(!Y)throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");else if(!/^[1-9][0-9]*$/.test(Y))throw Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count");let $=parseInt(Y,10);return{nonce:X,salt:G,iteration:$}}function DI(J){let X=gP(J).get("v");if(!X)throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");else if(!fP(X))throw Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64");return{serverSignature:X}}function vI(J,W){if(!Buffer.isBuffer(J))throw TypeError("first argument must be a Buffer");if(!Buffer.isBuffer(W))throw TypeError("second argument must be a Buffer");if(J.length!==W.length)throw Error("Buffer lengths must match");if(J.length===0)throw Error("Buffers cannot be empty");return Buffer.from(J.map((X,G)=>J[G]^W[G]))}mP.exports={startSession:NI,continueSession:UI,finalizeSession:QI}});var NK=M6((dK6,xP)=>{var MI=N9();function FK(J){this._types=J||MI,this.text={},this.binary={}}FK.prototype.getOverrides=function(J){switch(J){case"text":return this.text;case"binary":return this.binary;default:return{}}};FK.prototype.setTypeParser=function(J,W,X){if(typeof W==="function")X=W,W="text";this.getOverrides(W)[J]=X};FK.prototype.getTypeParser=function(J,W){return W=W||"text",this.getOverrides(W)[J]||this._types.getTypeParser(J,W)};xP.exports=FK});var cP=M6((nK6,lP)=>{function XY(J,W={}){if(J.charAt(0)==="/"){let H=J.split(" ");return{host:H[0],database:H[1]}}let X={},G,Y=!1;if(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(J))J=encodeURI(J).replace(/%25(\d\d)/g,"%$1");try{try{G=new URL(J,"postgres://base")}catch(H){G=new URL(J.replace("@/","@___DUMMY___/"),"postgres://base"),Y=!0}}catch(H){H.input&&(H.input="*****REDACTED*****")}for(let H of G.searchParams.entries())X[H[0]]=H[1];if(X.user=X.user||decodeURIComponent(G.username),X.password=X.password||decodeURIComponent(G.password),G.protocol=="socket:")return X.host=decodeURI(G.pathname),X.database=G.searchParams.get("db"),X.client_encoding=G.searchParams.get("encoding"),X;let $=Y?"":G.hostname;if(!X.host)X.host=decodeURIComponent($);else if($&&/^%2f/i.test($))G.pathname=$+G.pathname;if(!X.port)X.port=G.port;let K=G.pathname.slice(1)||null;if(X.database=K?decodeURI(K):null,X.ssl==="true"||X.ssl==="1")X.ssl=!0;if(X.ssl==="0")X.ssl=!1;if(X.sslcert||X.sslkey||X.sslrootcert||X.sslmode)X.ssl={};let w=X.sslcert||X.sslkey||X.sslrootcert?z4("fs"):null;if(X.sslcert)X.ssl.cert=w.readFileSync(X.sslcert).toString();if(X.sslkey)X.ssl.key=w.readFileSync(X.sslkey).toString();if(X.sslrootcert)X.ssl.ca=w.readFileSync(X.sslrootcert).toString();if(W.useLibpqCompat&&X.uselibpqcompat)throw Error("Both useLibpqCompat and uselibpqcompat are set. Please use only one of them.");if(X.uselibpqcompat==="true"||W.useLibpqCompat)switch(X.sslmode){case"disable":{X.ssl=!1;break}case"prefer":{X.ssl.rejectUnauthorized=!1;break}case"require":{if(X.sslrootcert)X.ssl.checkServerIdentity=function(){};else X.ssl.rejectUnauthorized=!1;break}case"verify-ca":{if(!X.ssl.ca)throw Error("SECURITY WARNING: Using sslmode=verify-ca requires specifying a CA with sslrootcert. If a public CA is used, verify-ca allows connections to a server that somebody else may have registered with the CA, making you vulnerable to Man-in-the-Middle attacks. Either specify a custom CA certificate with sslrootcert parameter or use sslmode=verify-full for proper security.");X.ssl.checkServerIdentity=function(){};break}case"verify-full":break}else switch(X.sslmode){case"disable":{X.ssl=!1;break}case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":{X.ssl.rejectUnauthorized=!1;break}}return X}function OI(J){return Object.entries(J).reduce((X,[G,Y])=>{if(Y!==void 0&&Y!==null)X[G]=Y;return X},{})}function uP(J){return Object.entries(J).reduce((X,[G,Y])=>{if(G==="ssl"){let $=Y;if(typeof $==="boolean")X[G]=$;if(typeof $==="object")X[G]=OI($)}else if(Y!==void 0&&Y!==null)if(G==="port"){if(Y!==""){let $=parseInt(Y,10);if(isNaN($))throw Error(`Invalid ${G}: ${Y}`);X[G]=$}}else X[G]=Y;return X},{})}function PI(J){return uP(XY(J))}lP.exports=XY;XY.parse=XY;XY.toClientConfig=uP;XY.parseIntoClientConfig=PI});var ez=M6((rK6,rP)=>{var jI=z4("dns"),dP=U9(),pP=cP().parse,E0=function(J,W,X){if(X===void 0)X=process.env["PG"+J.toUpperCase()];else if(X===!1);else X=process.env[X];return W[J]||X||dP[J]},_I=function(){switch(process.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return dP.ssl},YY=function(J){return"'"+(""+J).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},C8=function(J,W,X){let G=W[X];if(G!==void 0&&G!==null)J.push(X+"="+YY(G))};class nP{constructor(J){if(J=typeof J==="string"?pP(J):J||{},J.connectionString)J=Object.assign({},J,pP(J.connectionString));if(this.user=E0("user",J),this.database=E0("database",J),this.database===void 0)this.database=this.user;if(this.port=parseInt(E0("port",J),10),this.host=E0("host",J),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:E0("password",J)}),this.binary=E0("binary",J),this.options=E0("options",J),this.ssl=typeof J.ssl>"u"?_I():J.ssl,typeof this.ssl==="string"){if(this.ssl==="true")this.ssl=!0}if(this.ssl==="no-verify")this.ssl={rejectUnauthorized:!1};if(this.ssl&&this.ssl.key)Object.defineProperty(this.ssl,"key",{enumerable:!1});if(this.client_encoding=E0("client_encoding",J),this.replication=E0("replication",J),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=E0("application_name",J,"PGAPPNAME"),this.fallback_application_name=E0("fallback_application_name",J,!1),this.statement_timeout=E0("statement_timeout",J,!1),this.lock_timeout=E0("lock_timeout",J,!1),this.idle_in_transaction_session_timeout=E0("idle_in_transaction_session_timeout",J,!1),this.query_timeout=E0("query_timeout",J,!1),J.connectionTimeoutMillis===void 0)this.connect_timeout=process.env.PGCONNECT_TIMEOUT||0;else this.connect_timeout=Math.floor(J.connectionTimeoutMillis/1000);if(J.keepAlive===!1)this.keepalives=0;else if(J.keepAlive===!0)this.keepalives=1;if(typeof J.keepAliveInitialDelayMillis==="number")this.keepalives_idle=Math.floor(J.keepAliveInitialDelayMillis/1000)}getLibpqConnectionString(J){let W=[];C8(W,this,"user"),C8(W,this,"password"),C8(W,this,"port"),C8(W,this,"application_name"),C8(W,this,"fallback_application_name"),C8(W,this,"connect_timeout"),C8(W,this,"options");let X=typeof this.ssl==="object"?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(C8(W,X,"sslmode"),C8(W,X,"sslca"),C8(W,X,"sslkey"),C8(W,X,"sslcert"),C8(W,X,"sslrootcert"),this.database)W.push("dbname="+YY(this.database));if(this.replication)W.push("replication="+YY(this.replication));if(this.host)W.push("host="+YY(this.host));if(this.isDomainSocket)return J(null,W.join(" "));if(this.client_encoding)W.push("client_encoding="+YY(this.client_encoding));jI.lookup(this.host,function(G,Y){if(G)return J(G,null);return W.push("hostaddr="+YY(Y)),J(null,W.join(" "))})}}rP.exports=nP});var JF=M6((iK6,tP)=>{var SI=N9(),iP=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/;class aP{constructor(J,W){if(this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=W,this.RowCtor=null,this.rowAsArray=J==="array",this.rowAsArray)this.parseRow=this._parseRowAsArray;this._prebuiltEmptyResultObject=null}addCommandComplete(J){let W;if(J.text)W=iP.exec(J.text);else W=iP.exec(J.command);if(W){if(this.command=W[1],W[3])this.oid=parseInt(W[2],10),this.rowCount=parseInt(W[3],10);else if(W[2])this.rowCount=parseInt(W[2],10)}}_parseRowAsArray(J){let W=Array(J.length);for(let X=0,G=J.length;X<G;X++){let Y=J[X];if(Y!==null)W[X]=this._parsers[X](Y);else W[X]=null}return W}parseRow(J){let W={...this._prebuiltEmptyResultObject};for(let X=0,G=J.length;X<G;X++){let Y=J[X],$=this.fields[X].name;if(Y!==null){let K=this.fields[X].format==="binary"?Buffer.from(Y):Y;W[$]=this._parsers[X](K)}else W[$]=null}return W}addRow(J){this.rows.push(J)}addFields(J){if(this.fields=J,this.fields.length)this._parsers=Array(J.length);let W={};for(let X=0;X<J.length;X++){let G=J[X];if(W[G.name]=null,this._types)this._parsers[X]=this._types.getTypeParser(G.dataTypeID,G.format||"text");else this._parsers[X]=SI.getTypeParser(G.dataTypeID,G.format||"text")}this._prebuiltEmptyResultObject={...W}}}tP.exports=aP});var Wj=M6((aK6,Jj)=>{var{EventEmitter:TI}=z4("events"),oP=JF(),sP=JY();class eP extends TI{constructor(J,W,X){super();if(J=sP.normalizeQueryConfig(J,W,X),this.text=J.text,this.values=J.values,this.rows=J.rows,this.types=J.types,this.name=J.name,this.queryMode=J.queryMode,this.binary=J.binary,this.portal=J.portal||"",this.callback=J.callback,this._rowMode=J.rowMode,process.domain&&J.callback)this.callback=process.domain.bind(J.callback);this._result=new oP(this._rowMode,this.types),this._results=this._result,this._canceledDueToError=!1}requiresPreparation(){if(this.queryMode==="extended")return!0;if(this.name)return!0;if(this.rows)return!0;if(!this.text)return!1;if(!this.values)return!1;return this.values.length>0}_checkForMultirow(){if(this._result.command){if(!Array.isArray(this._results))this._results=[this._result];this._result=new oP(this._rowMode,this._result._types),this._results.push(this._result)}}handleRowDescription(J){this._checkForMultirow(),this._result.addFields(J.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(J){let W;if(this._canceledDueToError)return;try{W=this._result.parseRow(J.fields)}catch(X){this._canceledDueToError=X;return}if(this.emit("row",W,this._result),this._accumulateRows)this._result.addRow(W)}handleCommandComplete(J,W){if(this._checkForMultirow(),this._result.addCommandComplete(J),this.rows)W.sync()}handleEmptyQuery(J){if(this.rows)J.sync()}handleError(J,W){if(this._canceledDueToError)J=this._canceledDueToError,this._canceledDueToError=!1;if(this.callback)return this.callback(J);this.emit("error",J)}handleReadyForQuery(J){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,J);if(this.callback)try{this.callback(null,this._results)}catch(W){process.nextTick(()=>{throw W})}this.emit("end",this._results)}submit(J){if(typeof this.text!=="string"&&typeof this.name!=="string")return Error("A query must have either text or a name. Supplying neither is unsupported.");let W=J.parsedStatements[this.name];if(this.text&&W&&this.text!==W)return Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);if(this.values&&!Array.isArray(this.values))return Error("Query values must be an array");if(this.requiresPreparation()){J.stream.cork&&J.stream.cork();try{this.prepare(J)}finally{J.stream.uncork&&J.stream.uncork()}}else J.query(this.text);return null}hasBeenParsed(J){return this.name&&J.parsedStatements[this.name]}handlePortalSuspended(J){this._getRows(J,this.rows)}_getRows(J,W){if(J.execute({portal:this.portal,rows:W}),!W)J.sync();else J.flush()}prepare(J){if(!this.hasBeenParsed(J))J.parse({text:this.text,name:this.name,types:this.types});try{J.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:sP.prepareValue})}catch(W){this.handleError(W,J);return}J.describe({type:"P",name:this.portal||""}),this._getRows(J,this.rows)}handleCopyInResponse(J){J.sendCopyFail("No source stream defined")}handleCopyData(J,W){}}Jj.exports=eP});var WF=M6((Vj)=>{Object.defineProperty(Vj,"__esModule",{value:!0});Vj.NoticeMessage=Vj.DataRowMessage=Vj.CommandCompleteMessage=Vj.ReadyForQueryMessage=Vj.NotificationResponseMessage=Vj.BackendKeyDataMessage=Vj.AuthenticationMD5Password=Vj.ParameterStatusMessage=Vj.ParameterDescriptionMessage=Vj.RowDescriptionMessage=Vj.Field=Vj.CopyResponse=Vj.CopyDataMessage=Vj.DatabaseError=Vj.copyDone=Vj.emptyQuery=Vj.replicationStart=Vj.portalSuspended=Vj.noData=Vj.closeComplete=Vj.bindComplete=Vj.parseComplete=void 0;Vj.parseComplete={name:"parseComplete",length:5};Vj.bindComplete={name:"bindComplete",length:5};Vj.closeComplete={name:"closeComplete",length:5};Vj.noData={name:"noData",length:5};Vj.portalSuspended={name:"portalSuspended",length:5};Vj.replicationStart={name:"replicationStart",length:4};Vj.emptyQuery={name:"emptyQuery",length:4};Vj.copyDone={name:"copyDone",length:4};class Xj extends Error{constructor(J,W,X){super(J);this.length=W,this.name=X}}Vj.DatabaseError=Xj;class Yj{constructor(J,W){this.length=J,this.chunk=W,this.name="copyData"}}Vj.CopyDataMessage=Yj;class Gj{constructor(J,W,X,G){this.length=J,this.name=W,this.binary=X,this.columnTypes=Array(G)}}Vj.CopyResponse=Gj;class $j{constructor(J,W,X,G,Y,$,K){this.name=J,this.tableID=W,this.columnID=X,this.dataTypeID=G,this.dataTypeSize=Y,this.dataTypeModifier=$,this.format=K}}Vj.Field=$j;class Kj{constructor(J,W){this.length=J,this.fieldCount=W,this.name="rowDescription",this.fields=Array(this.fieldCount)}}Vj.RowDescriptionMessage=Kj;class wj{constructor(J,W){this.length=J,this.parameterCount=W,this.name="parameterDescription",this.dataTypeIDs=Array(this.parameterCount)}}Vj.ParameterDescriptionMessage=wj;class Hj{constructor(J,W,X){this.length=J,this.parameterName=W,this.parameterValue=X,this.name="parameterStatus"}}Vj.ParameterStatusMessage=Hj;class Zj{constructor(J,W){this.length=J,this.salt=W,this.name="authenticationMD5Password"}}Vj.AuthenticationMD5Password=Zj;class zj{constructor(J,W,X){this.length=J,this.processID=W,this.secretKey=X,this.name="backendKeyData"}}Vj.BackendKeyDataMessage=zj;class Fj{constructor(J,W,X,G){this.length=J,this.processId=W,this.channel=X,this.payload=G,this.name="notification"}}Vj.NotificationResponseMessage=Fj;class Nj{constructor(J,W){this.length=J,this.status=W,this.name="readyForQuery"}}Vj.ReadyForQueryMessage=Nj;class Uj{constructor(J,W){this.length=J,this.text=W,this.name="commandComplete"}}Vj.CommandCompleteMessage=Uj;class Qj{constructor(J,W){this.length=J,this.fields=W,this.name="dataRow",this.fieldCount=W.length}}Vj.DataRowMessage=Qj;class Lj{constructor(J,W){this.length=J,this.message=W,this.name="notice"}}Vj.NoticeMessage=Lj});var Pj=M6((Mj)=>{Object.defineProperty(Mj,"__esModule",{value:!0});Mj.Writer=void 0;class vj{constructor(J=256){this.size=J,this.offset=5,this.headerPosition=0,this.buffer=Buffer.allocUnsafe(J)}ensure(J){if(this.buffer.length-this.offset<J){let X=this.buffer,G=X.length+(X.length>>1)+J;this.buffer=Buffer.allocUnsafe(G),X.copy(this.buffer)}}addInt32(J){return this.ensure(4),this.buffer[this.offset++]=J>>>24&255,this.buffer[this.offset++]=J>>>16&255,this.buffer[this.offset++]=J>>>8&255,this.buffer[this.offset++]=J>>>0&255,this}addInt16(J){return this.ensure(2),this.buffer[this.offset++]=J>>>8&255,this.buffer[this.offset++]=J>>>0&255,this}addCString(J){if(!J)this.ensure(1);else{let W=Buffer.byteLength(J);this.ensure(W+1),this.buffer.write(J,this.offset,"utf-8"),this.offset+=W}return this.buffer[this.offset++]=0,this}addString(J=""){let W=Buffer.byteLength(J);return this.ensure(W),this.buffer.write(J,this.offset),this.offset+=W,this}add(J){return this.ensure(J.length),J.copy(this.buffer,this.offset),this.offset+=J.length,this}join(J){if(J){this.buffer[this.headerPosition]=J;let W=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(W,this.headerPosition+1)}return this.buffer.slice(J?0:5,this.offset)}flush(J){let W=this.join(J);return this.offset=5,this.headerPosition=0,this.buffer=Buffer.allocUnsafe(this.size),W}}Mj.Writer=vj});var Tj=M6((_j)=>{Object.defineProperty(_j,"__esModule",{value:!0});_j.serialize=void 0;var XF=Pj(),v4=new XF.Writer,rI=(J)=>{v4.addInt16(3).addInt16(0);for(let G of Object.keys(J))v4.addCString(G).addCString(J[G]);v4.addCString("client_encoding").addCString("UTF8");let W=v4.addCString("").flush(),X=W.length+4;return new XF.Writer().addInt32(X).add(W).flush()},iI=()=>{let J=Buffer.allocUnsafe(8);return J.writeInt32BE(8,0),J.writeInt32BE(80877103,4),J},aI=(J)=>{return v4.addCString(J).flush(112)},tI=function(J,W){return v4.addCString(J).addInt32(Buffer.byteLength(W)).addString(W),v4.flush(112)},oI=function(J){return v4.addString(J).flush(112)},sI=(J)=>{return v4.addCString(J).flush(81)},jj=[],eI=(J)=>{let W=J.name||"";if(W.length>63)console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",W,W.length),console.error("This can cause conflicts and silent errors executing queries");let X=J.types||jj,G=X.length,Y=v4.addCString(W).addCString(J.text).addInt16(G);for(let $=0;$<G;$++)Y.addInt32(X[$]);return v4.flush(80)},GY=new XF.Writer,Jb=function(J,W){for(let X=0;X<J.length;X++){let G=W?W(J[X],X):J[X];if(G==null)v4.addInt16(0),GY.addInt32(-1);else if(G instanceof Buffer)v4.addInt16(1),GY.addInt32(G.length),GY.add(G);else v4.addInt16(0),GY.addInt32(Buffer.byteLength(G)),GY.addString(G)}},Wb=(J={})=>{let W=J.portal||"",X=J.statement||"",G=J.binary||!1,Y=J.values||jj,$=Y.length;return v4.addCString(W).addCString(X),v4.addInt16($),Jb(Y,J.valueMapper),v4.addInt16($),v4.add(GY.flush()),v4.addInt16(1),v4.addInt16(G?1:0),v4.flush(66)},Xb=Buffer.from([69,0,0,0,9,0,0,0,0,0]),Yb=(J)=>{if(!J||!J.portal&&!J.rows)return Xb;let W=J.portal||"",X=J.rows||0,G=Buffer.byteLength(W),Y=4+G+1+4,$=Buffer.allocUnsafe(1+Y);return $[0]=69,$.writeInt32BE(Y,1),$.write(W,5,"utf-8"),$[G+5]=0,$.writeUInt32BE(X,$.length-4),$},Gb=(J,W)=>{let X=Buffer.allocUnsafe(16);return X.writeInt32BE(16,0),X.writeInt16BE(1234,4),X.writeInt16BE(5678,6),X.writeInt32BE(J,8),X.writeInt32BE(W,12),X},YF=(J,W)=>{let G=4+Buffer.byteLength(W)+1,Y=Buffer.allocUnsafe(1+G);return Y[0]=J,Y.writeInt32BE(G,1),Y.write(W,5,"utf-8"),Y[G]=0,Y},$b=v4.addCString("P").flush(68),Kb=v4.addCString("S").flush(68),wb=(J)=>{return J.name?YF(68,`${J.type}${J.name||""}`):J.type==="P"?$b:Kb},Hb=(J)=>{let W=`${J.type}${J.name||""}`;return YF(67,W)},Zb=(J)=>{return v4.add(J).flush(100)},zb=(J)=>{return YF(102,J)},UK=(J)=>Buffer.from([J,0,0,0,4]),Fb=UK(72),Nb=UK(83),Ub=UK(88),Qb=UK(99),Lb={startup:rI,password:aI,requestSsl:iI,sendSASLInitialResponseMessage:tI,sendSCRAMClientFinalMessage:oI,query:sI,parse:eI,bind:Wb,execute:Yb,describe:wb,close:Hb,flush:()=>Fb,sync:()=>Nb,end:()=>Ub,copyData:Zb,copyDone:()=>Qb,copyFail:zb,cancel:Gb};_j.serialize=Lb});var Ej=M6((Bj)=>{Object.defineProperty(Bj,"__esModule",{value:!0});Bj.BufferReader=void 0;var Vb=Buffer.allocUnsafe(0);class qj{constructor(J=0){this.offset=J,this.buffer=Vb,this.encoding="utf-8"}setBuffer(J,W){this.offset=J,this.buffer=W}int16(){let J=this.buffer.readInt16BE(this.offset);return this.offset+=2,J}byte(){let J=this.buffer[this.offset];return this.offset++,J}int32(){let J=this.buffer.readInt32BE(this.offset);return this.offset+=4,J}uint32(){let J=this.buffer.readUInt32BE(this.offset);return this.offset+=4,J}string(J){let W=this.buffer.toString(this.encoding,this.offset,this.offset+J);return this.offset+=J,W}cstring(){let J=this.offset,W=J;while(this.buffer[W++]!==0);return this.offset=W,this.buffer.toString(this.encoding,J,W-1)}bytes(J){let W=this.buffer.slice(this.offset,this.offset+J);return this.offset+=J,W}}Bj.BufferReader=qj});var hj=M6((bj)=>{Object.defineProperty(bj,"__esModule",{value:!0});bj.Parser=void 0;var q4=WF(),Db=Ej(),GF=1,vb=4,Rj=GF+vb,Cj=Buffer.allocUnsafe(0);class Ij{constructor(J){if(this.buffer=Cj,this.bufferLength=0,this.bufferOffset=0,this.reader=new Db.BufferReader,(J===null||J===void 0?void 0:J.mode)==="binary")throw Error("Binary mode not supported yet");this.mode=(J===null||J===void 0?void 0:J.mode)||"text"}parse(J,W){this.mergeBuffer(J);let X=this.bufferOffset+this.bufferLength,G=this.bufferOffset;while(G+Rj<=X){let Y=this.buffer[G],$=this.buffer.readUInt32BE(G+GF),K=GF+$;if(K+G<=X){let w=this.handlePacket(G+Rj,Y,$,this.buffer);W(w),G+=K}else break}if(G===X)this.buffer=Cj,this.bufferLength=0,this.bufferOffset=0;else this.bufferLength=X-G,this.bufferOffset=G}mergeBuffer(J){if(this.bufferLength>0){let W=this.bufferLength+J.byteLength;if(W+this.bufferOffset>this.buffer.byteLength){let G;if(W<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)G=this.buffer;else{let Y=this.buffer.byteLength*2;while(W>=Y)Y*=2;G=Buffer.allocUnsafe(Y)}this.buffer.copy(G,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=G,this.bufferOffset=0}J.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=W}else this.buffer=J,this.bufferOffset=0,this.bufferLength=J.byteLength}handlePacket(J,W,X,G){switch(W){case 50:return q4.bindComplete;case 49:return q4.parseComplete;case 51:return q4.closeComplete;case 110:return q4.noData;case 115:return q4.portalSuspended;case 99:return q4.copyDone;case 87:return q4.replicationStart;case 73:return q4.emptyQuery;case 68:return this.parseDataRowMessage(J,X,G);case 67:return this.parseCommandCompleteMessage(J,X,G);case 90:return this.parseReadyForQueryMessage(J,X,G);case 65:return this.parseNotificationMessage(J,X,G);case 82:return this.parseAuthenticationResponse(J,X,G);case 83:return this.parseParameterStatusMessage(J,X,G);case 75:return this.parseBackendKeyData(J,X,G);case 69:return this.parseErrorMessage(J,X,G,"error");case 78:return this.parseErrorMessage(J,X,G,"notice");case 84:return this.parseRowDescriptionMessage(J,X,G);case 116:return this.parseParameterDescriptionMessage(J,X,G);case 71:return this.parseCopyInMessage(J,X,G);case 72:return this.parseCopyOutMessage(J,X,G);case 100:return this.parseCopyData(J,X,G);default:return new q4.DatabaseError("received invalid response: "+W.toString(16),X,"error")}}parseReadyForQueryMessage(J,W,X){this.reader.setBuffer(J,X);let G=this.reader.string(1);return new q4.ReadyForQueryMessage(W,G)}parseCommandCompleteMessage(J,W,X){this.reader.setBuffer(J,X);let G=this.reader.cstring();return new q4.CommandCompleteMessage(W,G)}parseCopyData(J,W,X){let G=X.slice(J,J+(W-4));return new q4.CopyDataMessage(W,G)}parseCopyInMessage(J,W,X){return this.parseCopyMessage(J,W,X,"copyInResponse")}parseCopyOutMessage(J,W,X){return this.parseCopyMessage(J,W,X,"copyOutResponse")}parseCopyMessage(J,W,X,G){this.reader.setBuffer(J,X);let Y=this.reader.byte()!==0,$=this.reader.int16(),K=new q4.CopyResponse(W,G,Y,$);for(let w=0;w<$;w++)K.columnTypes[w]=this.reader.int16();return K}parseNotificationMessage(J,W,X){this.reader.setBuffer(J,X);let G=this.reader.int32(),Y=this.reader.cstring(),$=this.reader.cstring();return new q4.NotificationResponseMessage(W,G,Y,$)}parseRowDescriptionMessage(J,W,X){this.reader.setBuffer(J,X);let G=this.reader.int16(),Y=new q4.RowDescriptionMessage(W,G);for(let $=0;$<G;$++)Y.fields[$]=this.parseField();return Y}parseField(){let J=this.reader.cstring(),W=this.reader.uint32(),X=this.reader.int16(),G=this.reader.uint32(),Y=this.reader.int16(),$=this.reader.int32(),K=this.reader.int16()===0?"text":"binary";return new q4.Field(J,W,X,G,Y,$,K)}parseParameterDescriptionMessage(J,W,X){this.reader.setBuffer(J,X);let G=this.reader.int16(),Y=new q4.ParameterDescriptionMessage(W,G);for(let $=0;$<G;$++)Y.dataTypeIDs[$]=this.reader.int32();return Y}parseDataRowMessage(J,W,X){this.reader.setBuffer(J,X);let G=this.reader.int16(),Y=Array(G);for(let $=0;$<G;$++){let K=this.reader.int32();Y[$]=K===-1?null:this.reader.string(K)}return new q4.DataRowMessage(W,Y)}parseParameterStatusMessage(J,W,X){this.reader.setBuffer(J,X);let G=this.reader.cstring(),Y=this.reader.cstring();return new q4.ParameterStatusMessage(W,G,Y)}parseBackendKeyData(J,W,X){this.reader.setBuffer(J,X);let G=this.reader.int32(),Y=this.reader.int32();return new q4.BackendKeyDataMessage(W,G,Y)}parseAuthenticationResponse(J,W,X){this.reader.setBuffer(J,X);let G=this.reader.int32(),Y={name:"authenticationOk",length:W};switch(G){case 0:break;case 3:if(Y.length===8)Y.name="authenticationCleartextPassword";break;case 5:if(Y.length===12){Y.name="authenticationMD5Password";let $=this.reader.bytes(4);return new q4.AuthenticationMD5Password(W,$)}break;case 10:{Y.name="authenticationSASL",Y.mechanisms=[];let $;do if($=this.reader.cstring(),$)Y.mechanisms.push($);while($)}break;case 11:Y.name="authenticationSASLContinue",Y.data=this.reader.string(W-8);break;case 12:Y.name="authenticationSASLFinal",Y.data=this.reader.string(W-8);break;default:throw Error("Unknown authenticationOk message type "+G)}return Y}parseErrorMessage(J,W,X,G){this.reader.setBuffer(J,X);let Y={},$=this.reader.string(1);while($!=="\x00")Y[$]=this.reader.cstring(),$=this.reader.string(1);let K=Y.M,w=G==="notice"?new q4.NoticeMessage(W,K):new q4.DatabaseError(K,W,G);return w.severity=Y.S,w.code=Y.C,w.detail=Y.D,w.hint=Y.H,w.position=Y.P,w.internalPosition=Y.p,w.internalQuery=Y.q,w.where=Y.W,w.schema=Y.s,w.table=Y.t,w.column=Y.c,w.dataType=Y.d,w.constraint=Y.n,w.file=Y.F,w.line=Y.L,w.routine=Y.R,w}}bj.Parser=Ij});var $F=M6((QK)=>{Object.defineProperty(QK,"__esModule",{value:!0});QK.DatabaseError=QK.serialize=QK.parse=void 0;var Mb=WF();Object.defineProperty(QK,"DatabaseError",{enumerable:!0,get:function(){return Mb.DatabaseError}});var Ob=Tj();Object.defineProperty(QK,"serialize",{enumerable:!0,get:function(){return Ob.serialize}});var Pb=hj();function jb(J,W){let X=new Pb.Parser;return J.on("data",(G)=>X.parse(G,W)),new Promise((G)=>J.on("end",()=>G()))}QK.parse=jb});var gj=M6((fj)=>{Object.defineProperty(fj,"__esModule",{value:!0});fj.default={}});var yj=M6((Gw6,mj)=>{var{getStream:qb,getSecureStream:Bb}=Cb();mj.exports={getStream:qb,getSecureStream:Bb};function Ab(){function J(X){return new(z4("net")).Socket}function W(X){return z4("tls").connect(X)}return{getStream:J,getSecureStream:W}}function Eb(){function J(X){let{CloudflareSocket:G}=gj();return new G(X)}function W(X){return X.socket.startTls(X),X.socket}return{getStream:J,getSecureStream:W}}function Rb(){if(typeof navigator==="object"&&navigator!==null&&typeof navigator.userAgent==="string")return navigator.userAgent==="Cloudflare-Workers";if(typeof Response==="function"){let J=new Response(null,{cf:{thing:!0}});if(typeof J.cf==="object"&&J.cf!==null&&J.cf.thing)return!0}return!1}function Cb(){if(Rb())return Eb();return Ab()}});var KF=M6(($w6,uj)=>{var Ib=z4("events").EventEmitter,{parse:bb,serialize:n4}=$F(),{getStream:kb,getSecureStream:hb}=yj(),fb=n4.flush(),gb=n4.sync(),mb=n4.end();class xj extends Ib{constructor(J){super();if(J=J||{},this.stream=J.stream||kb(J.ssl),typeof this.stream==="function")this.stream=this.stream(J);this._keepAlive=J.keepAlive,this._keepAliveInitialDelayMillis=J.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=J.ssl||!1,this._ending=!1,this._emitMessage=!1;let W=this;this.on("newListener",function(X){if(X==="message")W._emitMessage=!0})}connect(J,W){let X=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(J,W),this.stream.once("connect",function(){if(X._keepAlive)X.stream.setKeepAlive(!0,X._keepAliveInitialDelayMillis);X.emit("connect")});let G=function(Y){if(X._ending&&(Y.code==="ECONNRESET"||Y.code==="EPIPE"))return;X.emit("error",Y)};if(this.stream.on("error",G),this.stream.on("close",function(){X.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(Y){switch(Y.toString("utf8")){case"S":break;case"N":return X.stream.end(),X.emit("error",Error("The server does not support SSL connections"));default:return X.stream.end(),X.emit("error",Error("There was an error establishing an SSL connection"))}let K={socket:X.stream};if(X.ssl!==!0){if(Object.assign(K,X.ssl),"key"in X.ssl)K.key=X.ssl.key}let w=z4("net");if(w.isIP&&w.isIP(W)===0)K.servername=W;try{X.stream=hb(K)}catch(H){return X.emit("error",H)}X.attachListeners(X.stream),X.stream.on("error",G),X.emit("sslconnect")})}attachListeners(J){bb(J,(W)=>{let X=W.name==="error"?"errorMessage":W.name;if(this._emitMessage)this.emit("message",W);this.emit(X,W)})}requestSsl(){this.stream.write(n4.requestSsl())}startup(J){this.stream.write(n4.startup(J))}cancel(J,W){this._send(n4.cancel(J,W))}password(J){this._send(n4.password(J))}sendSASLInitialResponseMessage(J,W){this._send(n4.sendSASLInitialResponseMessage(J,W))}sendSCRAMClientFinalMessage(J){this._send(n4.sendSCRAMClientFinalMessage(J))}_send(J){if(!this.stream.writable)return!1;return this.stream.write(J)}query(J){this._send(n4.query(J))}parse(J){this._send(n4.parse(J))}bind(J){this._send(n4.bind(J))}execute(J){this._send(n4.execute(J))}flush(){if(this.stream.writable)this.stream.write(fb)}sync(){this._ending=!0,this._send(gb)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){if(this._ending=!0,!this._connecting||!this.stream.writable){this.stream.end();return}return this.stream.write(mb,()=>{this.stream.end()})}close(J){this._send(n4.close(J))}describe(J){this._send(n4.describe(J))}sendCopyFromChunk(J){this._send(n4.copyData(J))}endCopyFrom(){this._send(n4.copyDone())}sendCopyFail(J){this._send(n4.copyFail(J))}}uj.exports=xj});var dj=M6((Kw6,pj)=>{var{Transform:yb}=z4("stream"),{StringDecoder:xb}=z4("string_decoder"),gW=Symbol("last"),LK=Symbol("decoder");function ub(J,W,X){let G;if(this.overflow){if(G=this[LK].write(J).split(this.matcher),G.length===1)return X();G.shift(),this.overflow=!1}else this[gW]+=this[LK].write(J),G=this[gW].split(this.matcher);this[gW]=G.pop();for(let Y=0;Y<G.length;Y++)try{cj(this,this.mapper(G[Y]))}catch($){return X($)}if(this.overflow=this[gW].length>this.maxLength,this.overflow&&!this.skipOverflow){X(Error("maximum buffer reached"));return}X()}function lb(J){if(this[gW]+=this[LK].end(),this[gW])try{cj(this,this.mapper(this[gW]))}catch(W){return J(W)}J()}function cj(J,W){if(W!==void 0)J.push(W)}function lj(J){return J}function cb(J,W,X){switch(J=J||/\r?\n/,W=W||lj,X=X||{},arguments.length){case 1:if(typeof J==="function")W=J,J=/\r?\n/;else if(typeof J==="object"&&!(J instanceof RegExp)&&!J[Symbol.split])X=J,J=/\r?\n/;break;case 2:if(typeof J==="function")X=W,W=J,J=/\r?\n/;else if(typeof W==="object")X=W,W=lj}X=Object.assign({},X),X.autoDestroy=!0,X.transform=ub,X.flush=lb,X.readableObjectMode=!0;let G=new yb(X);return G[gW]="",G[LK]=new xb("utf8"),G.matcher=J,G.mapper=W,G.maxLength=X.maxLength,G.skipOverflow=X.skipOverflow||!1,G.overflow=!1,G._destroy=function(Y,$){this._writableState.errorEmitted=!1,$(Y)},G}pj.exports=cb});var ij=M6((Xk,sJ)=>{var nj=z4("path"),pb=z4("stream").Stream,db=dj(),rj=z4("util"),nb=5432,VK=process.platform==="win32",L9=process.stderr,rb=56,ib=7,ab=61440,tb=32768;function ob(J){return(J&ab)==tb}var $Y=["host","port","database","user","password"],wF=$Y.length,sb=$Y[wF-1];function HF(){var J=L9 instanceof pb&&L9.writable===!0;if(J){var W=Array.prototype.slice.call(arguments).concat(`
`);L9.write(rj.format.apply(rj,W))}}Object.defineProperty(Xk,"isWin",{get:function(){return VK},set:function(J){VK=J}});Xk.warnTo=function(J){var W=L9;return L9=J,W};Xk.getFileName=function(J){var W=J||process.env,X=W.PGPASSFILE||(VK?nj.join(W.APPDATA||"./","postgresql","pgpass.conf"):nj.join(W.HOME||"./",".pgpass"));return X};Xk.usePgPass=function(J,W){if(Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD"))return!1;if(VK)return!0;if(W=W||"<unkn>",!ob(J.mode))return HF('WARNING: password file "%s" is not a plain file',W),!1;if(J.mode&(rb|ib))return HF('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',W),!1;return!0};var eb=Xk.match=function(J,W){return $Y.slice(0,-1).reduce(function(X,G,Y){if(Y==1){if(Number(J[G]||nb)===Number(W[G]))return X&&!0}return X&&(W[G]==="*"||W[G]===J[G])},!0)};Xk.getPassword=function(J,W,X){var G,Y=W.pipe(db());function $(H){var Z=Jk(H);if(Z&&Wk(Z)&&eb(J,Z))G=Z[sb],Y.end()}var K=function(){W.destroy(),X(G)},w=function(H){W.destroy(),HF("WARNING: error on reading file: %s",H),X(void 0)};W.on("error",w),Y.on("data",$).on("end",K).on("error",w)};var Jk=Xk.parseLine=function(J){if(J.length<11||J.match(/^\s+#/))return null;var W="",X="",G=0,Y=0,$=0,K={},w=!1,H=function(z,N,F){var Q=J.substring(N,F);if(!Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE"))Q=Q.replace(/\\([:\\])/g,"$1");K[$Y[z]]=Q};for(var Z=0;Z<J.length-1;Z+=1){if(W=J.charAt(Z+1),X=J.charAt(Z),w=G==wF-1,w){H(G,Y);break}if(Z>=0&&W==":"&&X!=="\\")H(G,Y,Z+1),Y=Z+2,G+=1}return K=Object.keys(K).length===wF?K:null,K},Wk=Xk.isValidEntry=function(J){var W={0:function(K){return K.length>0},1:function(K){if(K==="*")return!0;return K=Number(K),isFinite(K)&&K>0&&K<9007199254740992&&Math.floor(K)===K},2:function(K){return K.length>0},3:function(K){return K.length>0},4:function(K){return K.length>0}};for(var X=0;X<$Y.length;X+=1){var G=W[X],Y=J[$Y[X]]||"",$=G(Y);if(!$)return!1}return!0}});var tj=M6((Fw6,ZF)=>{var zw6=z4("path"),aj=z4("fs"),DK=ij();ZF.exports=function(J,W){var X=DK.getFileName();aj.stat(X,function(G,Y){if(G||!DK.usePgPass(Y,X))return W(void 0);var $=aj.createReadStream(X);DK.getPassword(J,$,W)})};ZF.exports.warnTo=DK.warnTo});var J_=M6((Nw6,ej)=>{var wk=z4("events").EventEmitter,oj=JY(),zF=yP(),Hk=NK(),Zk=ez(),sj=Wj(),zk=U9(),Fk=KF(),Nk=oz();class FF extends wk{constructor(J){super();this.connectionParameters=new Zk(J),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;let W=J||{};if(this._Promise=W.Promise||global.Promise,this._types=new Hk(W.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=Boolean(W.enableChannelBinding),this.connection=W.connection||new Fk({stream:W.stream,ssl:this.connectionParameters.ssl,keepAlive:W.keepAlive||!1,keepAliveInitialDelayMillis:W.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=W.binary||zk.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key)Object.defineProperty(this.ssl,"key",{enumerable:!1});this._connectionTimeoutMillis=W.connectionTimeoutMillis||0}_errorAllQueries(J){let W=(X)=>{process.nextTick(()=>{X.handleError(J,this.connection)})};if(this.activeQuery)W(this.activeQuery),this.activeQuery=null;this.queryQueue.forEach(W),this.queryQueue.length=0}_connect(J){let W=this,X=this.connection;if(this._connectionCallback=J,this._connecting||this._connected){let G=Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{J(G)});return}if(this._connecting=!0,this._connectionTimeoutMillis>0){if(this.connectionTimeoutHandle=setTimeout(()=>{X._ending=!0,X.stream.destroy(Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref)this.connectionTimeoutHandle.unref()}if(this.host&&this.host.indexOf("/")===0)X.connect(this.host+"/.s.PGSQL."+this.port);else X.connect(this.port,this.host);X.on("connect",function(){if(W.ssl)X.requestSsl();else X.startup(W.getStartupConf())}),X.on("sslconnect",function(){X.startup(W.getStartupConf())}),this._attachListeners(X),X.once("end",()=>{let G=this._ending?Error("Connection terminated"):Error("Connection terminated unexpectedly");if(clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(G),this._ended=!0,!this._ending){if(this._connecting&&!this._connectionError)if(this._connectionCallback)this._connectionCallback(G);else this._handleErrorEvent(G);else if(!this._connectionError)this._handleErrorEvent(G)}process.nextTick(()=>{this.emit("end")})})}connect(J){if(J){this._connect(J);return}return new this._Promise((W,X)=>{this._connect((G)=>{if(G)X(G);else W()})})}_attachListeners(J){J.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),J.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),J.on("authenticationSASL",this._handleAuthSASL.bind(this)),J.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),J.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),J.on("backendKeyData",this._handleBackendKeyData.bind(this)),J.on("error",this._handleErrorEvent.bind(this)),J.on("errorMessage",this._handleErrorMessage.bind(this)),J.on("readyForQuery",this._handleReadyForQuery.bind(this)),J.on("notice",this._handleNotice.bind(this)),J.on("rowDescription",this._handleRowDescription.bind(this)),J.on("dataRow",this._handleDataRow.bind(this)),J.on("portalSuspended",this._handlePortalSuspended.bind(this)),J.on("emptyQuery",this._handleEmptyQuery.bind(this)),J.on("commandComplete",this._handleCommandComplete.bind(this)),J.on("parseComplete",this._handleParseComplete.bind(this)),J.on("copyInResponse",this._handleCopyInResponse.bind(this)),J.on("copyData",this._handleCopyData.bind(this)),J.on("notification",this._handleNotification.bind(this))}_checkPgPass(J){let W=this.connection;if(typeof this.password==="function")this._Promise.resolve().then(()=>this.password()).then((X)=>{if(X!==void 0){if(typeof X!=="string"){W.emit("error",TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=X}else this.connectionParameters.password=this.password=null;J()}).catch((X)=>{W.emit("error",X)});else if(this.password!==null)J();else try{tj()(this.connectionParameters,(G)=>{if(G!==void 0)this.connectionParameters.password=this.password=G;J()})}catch(X){this.emit("error",X)}}_handleAuthCleartextPassword(J){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(J){this._checkPgPass(async()=>{try{let W=await Nk.postgresMd5PasswordHash(this.user,this.password,J.salt);this.connection.password(W)}catch(W){this.emit("error",W)}})}_handleAuthSASL(J){this._checkPgPass(()=>{try{this.saslSession=zF.startSession(J.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(W){this.connection.emit("error",W)}})}async _handleAuthSASLContinue(J){try{await zF.continueSession(this.saslSession,this.password,J.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(W){this.connection.emit("error",W)}}_handleAuthSASLFinal(J){try{zF.finalizeSession(this.saslSession,J.data),this.saslSession=null}catch(W){this.connection.emit("error",W)}}_handleBackendKeyData(J){this.processID=J.processID,this.secretKey=J.secretKey}_handleReadyForQuery(J){if(this._connecting){if(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)this._connectionCallback(null,this),this._connectionCallback=null;this.emit("connect")}let{activeQuery:W}=this;if(this.activeQuery=null,this.readyForQuery=!0,W)W.handleReadyForQuery(this.connection);this._pulseQueryQueue()}_handleErrorWhileConnecting(J){if(this._connectionError)return;if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(J);this.emit("error",J)}_handleErrorEvent(J){if(this._connecting)return this._handleErrorWhileConnecting(J);this._queryable=!1,this._errorAllQueries(J),this.emit("error",J)}_handleErrorMessage(J){if(this._connecting)return this._handleErrorWhileConnecting(J);let W=this.activeQuery;if(!W){this._handleErrorEvent(J);return}this.activeQuery=null,W.handleError(J,this.connection)}_handleRowDescription(J){this.activeQuery.handleRowDescription(J)}_handleDataRow(J){this.activeQuery.handleDataRow(J)}_handlePortalSuspended(J){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(J){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(J){if(this.activeQuery==null){let W=Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(W);return}this.activeQuery.handleCommandComplete(J,this.connection)}_handleParseComplete(){if(this.activeQuery==null){let J=Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(J);return}if(this.activeQuery.name)this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text}_handleCopyInResponse(J){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(J){this.activeQuery.handleCopyData(J,this.connection)}_handleNotification(J){this.emit("notification",J)}_handleNotice(J){this.emit("notice",J)}getStartupConf(){let J=this.connectionParameters,W={user:J.user,database:J.database},X=J.application_name||J.fallback_application_name;if(X)W.application_name=X;if(J.replication)W.replication=""+J.replication;if(J.statement_timeout)W.statement_timeout=String(parseInt(J.statement_timeout,10));if(J.lock_timeout)W.lock_timeout=String(parseInt(J.lock_timeout,10));if(J.idle_in_transaction_session_timeout)W.idle_in_transaction_session_timeout=String(parseInt(J.idle_in_transaction_session_timeout,10));if(J.options)W.options=J.options;return W}cancel(J,W){if(J.activeQuery===W){let X=this.connection;if(this.host&&this.host.indexOf("/")===0)X.connect(this.host+"/.s.PGSQL."+this.port);else X.connect(this.port,this.host);X.on("connect",function(){X.cancel(J.processID,J.secretKey)})}else if(J.queryQueue.indexOf(W)!==-1)J.queryQueue.splice(J.queryQueue.indexOf(W),1)}setTypeParser(J,W,X){return this._types.setTypeParser(J,W,X)}getTypeParser(J,W){return this._types.getTypeParser(J,W)}escapeIdentifier(J){return oj.escapeIdentifier(J)}escapeLiteral(J){return oj.escapeLiteral(J)}_pulseQueryQueue(){if(this.readyForQuery===!0){if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let J=this.activeQuery.submit(this.connection);if(J)process.nextTick(()=>{this.activeQuery.handleError(J,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else if(this.hasExecuted)this.activeQuery=null,this.emit("drain")}}query(J,W,X){let G,Y,$,K,w;if(J===null||J===void 0)throw TypeError("Client was passed a null or undefined query");else if(typeof J.submit==="function"){if($=J.query_timeout||this.connectionParameters.query_timeout,Y=G=J,typeof W==="function")G.callback=G.callback||W}else if($=J.query_timeout||this.connectionParameters.query_timeout,G=new sj(J,W,X),!G.callback)Y=new this._Promise((H,Z)=>{G.callback=(z,N)=>z?Z(z):H(N)}).catch((H)=>{throw Error.captureStackTrace(H),H});if($)w=G.callback,K=setTimeout(()=>{let H=Error("Query read timeout");process.nextTick(()=>{G.handleError(H,this.connection)}),w(H),G.callback=()=>{};let Z=this.queryQueue.indexOf(G);if(Z>-1)this.queryQueue.splice(Z,1);this._pulseQueryQueue()},$),G.callback=(H,Z)=>{clearTimeout(K),w(H,Z)};if(this.binary&&!G.binary)G.binary=!0;if(G._result&&!G._result._types)G._result._types=this._types;if(!this._queryable)return process.nextTick(()=>{G.handleError(Error("Client has encountered a connection error and is not queryable"),this.connection)}),Y;if(this._ending)return process.nextTick(()=>{G.handleError(Error("Client was closed and is not queryable"),this.connection)}),Y;return this.queryQueue.push(G),this._pulseQueryQueue(),Y}ref(){this.connection.ref()}unref(){this.connection.unref()}end(J){if(this._ending=!0,!this.connection._connecting||this._ended)if(J)J();else return this._Promise.resolve();if(this.activeQuery||!this._queryable)this.connection.stream.destroy();else this.connection.end();if(J)this.connection.once("end",J);else return new this._Promise((W)=>{this.connection.once("end",W)})}}FF.Query=sj;ej.exports=FF});var K_=M6((Uw6,$_)=>{var Uk=z4("events").EventEmitter,W_=function(){},X_=(J,W)=>{let X=J.findIndex(W);return X===-1?void 0:J.splice(X,1)[0]};class Y_{constructor(J,W,X){this.client=J,this.idleListener=W,this.timeoutId=X}}class V9{constructor(J){this.callback=J}}function Qk(){throw Error("Release called on client which has already been released to the pool.")}function vK(J,W){if(W)return{callback:W,result:void 0};let X,G,Y=function(K,w){K?X(K):G(w)},$=new J(function(K,w){G=K,X=w}).catch((K)=>{throw Error.captureStackTrace(K),K});return{callback:Y,result:$}}function Lk(J,W){return function X(G){G.client=W,W.removeListener("error",X),W.on("error",()=>{J.log("additional client error after disconnection due to error",G)}),J._remove(W),J.emit("error",G,W)}}class G_ extends Uk{constructor(J,W){super();if(this.options=Object.assign({},J),J!=null&&"password"in J)Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:J.password});if(J!=null&&J.ssl&&J.ssl.key)Object.defineProperty(this.options.ssl,"key",{enumerable:!1});if(this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||W||NF().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u")this.options.idleTimeoutMillis=1e4;this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){if(this.log("pulse queue on ending"),this._idle.length)this._idle.slice().map((W)=>{this._remove(W.client)});if(!this._clients.length)this.ended=!0,this._endCallback();return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let J=this._pendingQueue.shift();if(this._idle.length){let W=this._idle.pop();clearTimeout(W.timeoutId);let X=W.client;X.ref&&X.ref();let G=W.idleListener;return this._acquireClient(X,J,G,!1)}if(!this._isFull())return this.newClient(J);throw Error("unexpected condition")}_remove(J,W){let X=X_(this._idle,(Y)=>Y.client===J);if(X!==void 0)clearTimeout(X.timeoutId);this._clients=this._clients.filter((Y)=>Y!==J);let G=this;J.end(()=>{if(G.emit("remove",J),typeof W==="function")W()})}connect(J){if(this.ending){let G=Error("Cannot use a pool after calling end on the pool");return J?J(G):this.Promise.reject(G)}let W=vK(this.Promise,J),X=W.result;if(this._isFull()||this._idle.length){if(this._idle.length)process.nextTick(()=>this._pulseQueue());if(!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new V9(W.callback)),X;let G=(K,w,H)=>{clearTimeout($),W.callback(K,w,H)},Y=new V9(G),$=setTimeout(()=>{X_(this._pendingQueue,(K)=>K.callback===G),Y.timedOut=!0,W.callback(Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);if($.unref)$.unref();return this._pendingQueue.push(Y),X}return this.newClient(new V9(W.callback)),X}newClient(J){let W=new this.Client(this.options);this._clients.push(W);let X=Lk(this,W);this.log("checking client timeout");let G,Y=!1;if(this.options.connectionTimeoutMillis)G=setTimeout(()=>{this.log("ending client due to timeout"),Y=!0,W.connection?W.connection.stream.destroy():W.end()},this.options.connectionTimeoutMillis);this.log("connecting new client"),W.connect(($)=>{if(G)clearTimeout(G);if(W.on("error",X),$){if(this.log("client failed to connect",$),this._clients=this._clients.filter((K)=>K!==W),Y)$=Error("Connection terminated due to connection timeout",{cause:$});if(this._pulseQueue(),!J.timedOut)J.callback($,void 0,W_)}else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let K=setTimeout(()=>{if(this.log("ending client due to expired lifetime"),this._expired.add(W),this._idle.findIndex((H)=>H.client===W)!==-1)this._acquireClient(W,new V9((H,Z,z)=>z()),X,!1)},this.options.maxLifetimeSeconds*1000);K.unref(),W.once("end",()=>clearTimeout(K))}return this._acquireClient(W,J,X,!0)}})}_acquireClient(J,W,X,G){if(G)this.emit("connect",J);if(this.emit("acquire",J),J.release=this._releaseOnce(J,X),J.removeListener("error",X),!W.timedOut)if(G&&this.options.verify)this.options.verify(J,(Y)=>{if(Y)return J.release(Y),W.callback(Y,void 0,W_);W.callback(void 0,J,J.release)});else W.callback(void 0,J,J.release);else if(G&&this.options.verify)this.options.verify(J,J.release);else J.release()}_releaseOnce(J,W){let X=!1;return(G)=>{if(X)Qk();X=!0,this._release(J,W,G)}}_release(J,W,X){if(J.on("error",W),J._poolUseCount=(J._poolUseCount||0)+1,this.emit("release",X,J),X||this.ending||!J._queryable||J._ending||J._poolUseCount>=this.options.maxUses){if(J._poolUseCount>=this.options.maxUses)this.log("remove expended client");return this._remove(J,this._pulseQueue.bind(this))}if(this._expired.has(J))return this.log("remove expired client"),this._expired.delete(J),this._remove(J,this._pulseQueue.bind(this));let Y;if(this.options.idleTimeoutMillis&&this._isAboveMin()){if(Y=setTimeout(()=>{this.log("remove idle client"),this._remove(J,this._pulseQueue.bind(this))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle)Y.unref()}if(this.options.allowExitOnIdle)J.unref();this._idle.push(new Y_(J,W,Y)),this._pulseQueue()}query(J,W,X){if(typeof J==="function"){let Y=vK(this.Promise,J);return setImmediate(function(){return Y.callback(Error("Passing a function as the first parameter to pool.query is not supported"))}),Y.result}if(typeof W==="function")X=W,W=void 0;let G=vK(this.Promise,X);return X=G.callback,this.connect((Y,$)=>{if(Y)return X(Y);let K=!1,w=(H)=>{if(K)return;K=!0,$.release(H),X(H)};$.once("error",w),this.log("dispatching query");try{$.query(J,W,(H,Z)=>{if(this.log("query dispatched"),$.removeListener("error",w),K)return;if(K=!0,$.release(H),H)return X(H);return X(void 0,Z)})}catch(H){return $.release(H),X(H)}}),G.result}end(J){if(this.log("ending"),this.ending){let X=Error("Called end on pool more than once");return J?J(X):this.Promise.reject(X)}this.ending=!0;let W=vK(this.Promise,J);return this._endCallback=W.callback,this._pulseQueue(),W.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((J,W)=>J+(this._expired.has(W)?1:0),0)}get totalCount(){return this._clients.length}}$_.exports=G_});var Z_=M6((Qw6,H_)=>{var w_=z4("events").EventEmitter,Vk=z4("util"),UF=JY(),KY=H_.exports=function(J,W,X){w_.call(this),J=UF.normalizeQueryConfig(J,W,X),this.text=J.text,this.values=J.values,this.name=J.name,this.queryMode=J.queryMode,this.callback=J.callback,this.state="new",this._arrayMode=J.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(G){if(G==="row")this._emitRowEvents=!0}.bind(this))};Vk.inherits(KY,w_);var Dk={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};KY.prototype.handleError=function(J){let W=this.native.pq.resultErrorFields();if(W)for(let X in W){let G=Dk[X]||X;J[G]=W[X]}if(this.callback)this.callback(J);else this.emit("error",J);this.state="error"};KY.prototype.then=function(J,W){return this._getPromise().then(J,W)};KY.prototype.catch=function(J){return this._getPromise().catch(J)};KY.prototype._getPromise=function(){if(this._promise)return this._promise;return this._promise=new Promise(function(J,W){this._once("end",J),this._once("error",W)}.bind(this)),this._promise};KY.prototype.submit=function(J){this.state="running";let W=this;this.native=J.native,J.native.arrayMode=this._arrayMode;let X=function(G,Y,$){if(J.native.arrayMode=!1,setImmediate(function(){W.emit("_done")}),G)return W.handleError(G);if(W._emitRowEvents)if($.length>1)Y.forEach((K,w)=>{K.forEach((H)=>{W.emit("row",H,$[w])})});else Y.forEach(function(K){W.emit("row",K,$)});if(W.state="end",W.emit("end",$),W.callback)W.callback(null,$)};if(process.domain)X=process.domain.bind(X);if(this.name){if(this.name.length>63)console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries");let G=(this.values||[]).map(UF.prepareValue);if(J.namedQueries[this.name]){if(this.text&&J.namedQueries[this.name]!==this.text){let Y=Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return X(Y)}return J.native.execute(this.name,G,X)}return J.native.prepare(this.name,this.text,G.length,function(Y){if(Y)return X(Y);return J.namedQueries[W.name]=W.text,W.native.execute(W.name,G,X)})}else if(this.values){if(!Array.isArray(this.values)){let Y=Error("Query values must be an array");return X(Y)}let G=this.values.map(UF.prepareValue);J.native.query(this.text,G,X)}else if(this.queryMode==="extended")J.native.query(this.text,[],X);else J.native.query(this.text,X)}});var QF=M6((Lw6,U_)=>{var z_;try{z_=(()=>{throw new Error("Cannot require module "+"pg-native");})()}catch(J){throw J}var vk=NK(),F_=z4("events").EventEmitter,Mk=z4("util"),Ok=ez(),N_=Z_(),n0=U_.exports=function(J){F_.call(this),J=J||{},this._Promise=J.Promise||global.Promise,this._types=new vk(J.types),this.native=new z_({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;let W=this.connectionParameters=new Ok(J);if(J.nativeConnectionString)W.nativeConnectionString=J.nativeConnectionString;this.user=W.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:W.password}),this.database=W.database,this.host=W.host,this.port=W.port,this.namedQueries={}};n0.Query=N_;Mk.inherits(n0,F_);n0.prototype._errorAllQueries=function(J){let W=(X)=>{process.nextTick(()=>{X.native=this.native,X.handleError(J)})};if(this._hasActiveQuery())W(this._activeQuery),this._activeQuery=null;this._queryQueue.forEach(W),this._queryQueue.length=0};n0.prototype._connect=function(J){let W=this;if(this._connecting){process.nextTick(()=>J(Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(X,G){if(W.connectionParameters.nativeConnectionString)G=W.connectionParameters.nativeConnectionString;if(X)return J(X);W.native.connect(G,function(Y){if(Y)return W.native.end(),J(Y);W._connected=!0,W.native.on("error",function($){W._queryable=!1,W._errorAllQueries($),W.emit("error",$)}),W.native.on("notification",function($){W.emit("notification",{channel:$.relname,payload:$.extra})}),W.emit("connect"),W._pulseQueryQueue(!0),J()})})};n0.prototype.connect=function(J){if(J){this._connect(J);return}return new this._Promise((W,X)=>{this._connect((G)=>{if(G)X(G);else W()})})};n0.prototype.query=function(J,W,X){let G,Y,$,K,w;if(J===null||J===void 0)throw TypeError("Client was passed a null or undefined query");else if(typeof J.submit==="function"){if($=J.query_timeout||this.connectionParameters.query_timeout,Y=G=J,typeof W==="function")J.callback=W}else if($=J.query_timeout||this.connectionParameters.query_timeout,G=new N_(J,W,X),!G.callback){let H,Z;Y=new this._Promise((z,N)=>{H=z,Z=N}).catch((z)=>{throw Error.captureStackTrace(z),z}),G.callback=(z,N)=>z?Z(z):H(N)}if($)w=G.callback,K=setTimeout(()=>{let H=Error("Query read timeout");process.nextTick(()=>{G.handleError(H,this.connection)}),w(H),G.callback=()=>{};let Z=this._queryQueue.indexOf(G);if(Z>-1)this._queryQueue.splice(Z,1);this._pulseQueryQueue()},$),G.callback=(H,Z)=>{clearTimeout(K),w(H,Z)};if(!this._queryable)return G.native=this.native,process.nextTick(()=>{G.handleError(Error("Client has encountered a connection error and is not queryable"))}),Y;if(this._ending)return G.native=this.native,process.nextTick(()=>{G.handleError(Error("Client was closed and is not queryable"))}),Y;return this._queryQueue.push(G),this._pulseQueryQueue(),Y};n0.prototype.end=function(J){let W=this;if(this._ending=!0,!this._connected)this.once("connect",this.end.bind(this,J));let X;if(!J)X=new this._Promise(function(G,Y){J=($)=>$?Y($):G()});return this.native.end(function(){W._errorAllQueries(Error("Connection terminated")),process.nextTick(()=>{if(W.emit("end"),J)J()})}),X};n0.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};n0.prototype._pulseQueryQueue=function(J){if(!this._connected)return;if(this._hasActiveQuery())return;let W=this._queryQueue.shift();if(!W){if(!J)this.emit("drain");return}this._activeQuery=W,W.submit(this);let X=this;W.once("_done",function(){X._pulseQueryQueue()})};n0.prototype.cancel=function(J){if(this._activeQuery===J)this.native.cancel(function(){});else if(this._queryQueue.indexOf(J)!==-1)this._queryQueue.splice(this._queryQueue.indexOf(J),1)};n0.prototype.ref=function(){};n0.prototype.unref=function(){};n0.prototype.setTypeParser=function(J,W,X){return this._types.setTypeParser(J,W,X)};n0.prototype.getTypeParser=function(J,W){return this._types.getTypeParser(J,W)}});var NF=M6((Vw6,D9)=>{var Pk=J_(),jk=U9(),_k=KF(),Sk=JF(),Tk=JY(),qk=K_(),Bk=NK(),{DatabaseError:Ak}=$F(),{escapeIdentifier:Ek,escapeLiteral:Rk}=JY(),Ck=(J)=>{return class extends qk{constructor(X){super(X,J)}}},LF=function(J){this.defaults=jk,this.Client=J,this.Query=this.Client.Query,this.Pool=Ck(this.Client),this._pools=[],this.Connection=_k,this.types=N9(),this.DatabaseError=Ak,this.TypeOverrides=Bk,this.escapeIdentifier=Ek,this.escapeLiteral=Rk,this.Result=Sk,this.utils=Tk};if(typeof process.env.NODE_PG_FORCE_NATIVE<"u")D9.exports=new LF(QF());else D9.exports=new LF(Pk),Object.defineProperty(D9.exports,"native",{configurable:!0,enumerable:!1,get(){let J=null;try{J=new LF(QF())}catch(W){if(W.code!=="MODULE_NOT_FOUND")throw W}return Object.defineProperty(D9.exports,"native",{value:J}),J}})});var v_={};s0(v_,{BunSqliteDialect:()=>ck});var gk=class{get supportsCreateIfNotExists(){return!0}get supportsTransactionalDdl(){return!1}get supportsReturning(){return!0}async acquireMigrationLock(){}async releaseMigrationLock(){}get supportsOutput(){return!0}},mk=class{#J;#W=new xk;#X;#Y;constructor(J){this.#J={...J}}async init(){if(this.#X=this.#J.database,this.#Y=new yk(this.#X),this.#J.onCreateConnection)await this.#J.onCreateConnection(this.#Y)}async acquireConnection(){return await this.#W.lock(),this.#Y}async beginTransaction(J){await J.executeQuery(W4.raw("begin"))}async commitTransaction(J){await J.executeQuery(W4.raw("commit"))}async rollbackTransaction(J){await J.executeQuery(W4.raw("rollback"))}async releaseConnection(){this.#W.unlock()}async destroy(){this.#X?.close()}},yk=class{#J;constructor(J){this.#J=J}executeQuery(J){let{sql:W,parameters:X}=J,G=this.#J.prepare(W);return Promise.resolve({rows:G.all(X)})}async*streamQuery(){throw Error("Streaming query is not supported by SQLite driver.")}},xk=class{#J;#W;async lock(){while(this.#J)await this.#J;this.#J=new Promise((J)=>{this.#W=J})}unlock(){let J=this.#W;this.#J=void 0,this.#W=void 0,J?.()}},uk=class{#J;constructor(J){this.#J=J}async getSchemas(){return[]}async getTables(J={withInternalKyselyTables:!1}){let W=this.#J.selectFrom("sqlite_schema").where("type","=","table").where("name","not like","sqlite_%").select("name").$castTo();if(!J.withInternalKyselyTables)W=W.where("name","!=",A0).where("name","!=",p0);let X=await W.execute();return Promise.all(X.map(({name:G})=>this.#W(G)))}async getMetadata(J){return{tables:await this.getTables(J)}}async#W(J){let W=this.#J,X=(await W.selectFrom("sqlite_master").where("name","=",J).select("sql").$castTo().execute())[0]?.sql?.split(/[\(\),]/)?.find((G)=>G.toLowerCase().includes("autoincrement"))?.split(/\s+/)?.[0]?.replace(/["`]/g,"");return{name:J,columns:(await W.selectFrom(F6`pragma_table_info(${J})`.as("table_info")).select(["name","type","notnull","dflt_value"]).execute()).map((G)=>({name:G.name,dataType:G.type,isNullable:!G.notnull,isAutoIncrementing:G.name===X,hasDefaultValue:G.dflt_value!=null})),isView:!0}}},lk,ck=class{#J;constructor(J){this.#J={...J}}createDriver(){return new mk(this.#J)}createQueryCompiler(){return new lk}createAdapter(){return new gk}createIntrospector(J){return new uk(J)}};var M_=D(()=>{oJ();lk=class extends H8{getCurrentParameterPlaceholder(){return"?"}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getAutoIncrement(){return"autoincrement"}}});var O_={};s0(O_,{NodeSqliteDialect:()=>tk});var pk=class{get supportsCreateIfNotExists(){return!0}get supportsTransactionalDdl(){return!1}get supportsReturning(){return!0}async acquireMigrationLock(){}async releaseMigrationLock(){}get supportsOutput(){return!0}},dk=class{#J;#W=new rk;#X;#Y;constructor(J){this.#J={...J}}async init(){if(this.#X=this.#J.database,this.#Y=new nk(this.#X),this.#J.onCreateConnection)await this.#J.onCreateConnection(this.#Y)}async acquireConnection(){return await this.#W.lock(),this.#Y}async beginTransaction(J){await J.executeQuery(W4.raw("begin"))}async commitTransaction(J){await J.executeQuery(W4.raw("commit"))}async rollbackTransaction(J){await J.executeQuery(W4.raw("rollback"))}async releaseConnection(){this.#W.unlock()}async destroy(){this.#X?.close()}},nk=class{#J;constructor(J){this.#J=J}executeQuery(J){let{sql:W,parameters:X}=J,G=this.#J.prepare(W).all(...X);return Promise.resolve({rows:G})}async*streamQuery(){throw Error("Streaming query is not supported by SQLite driver.")}},rk=class{#J;#W;async lock(){while(this.#J)await this.#J;this.#J=new Promise((J)=>{this.#W=J})}unlock(){let J=this.#W;this.#J=void 0,this.#W=void 0,J?.()}},ik=class{#J;constructor(J){this.#J=J}async getSchemas(){return[]}async getTables(J={withInternalKyselyTables:!1}){let W=this.#J.selectFrom("sqlite_schema").where("type","=","table").where("name","not like","sqlite_%").select("name").$castTo();if(!J.withInternalKyselyTables)W=W.where("name","!=",A0).where("name","!=",p0);let X=await W.execute();return Promise.all(X.map(({name:G})=>this.#W(G)))}async getMetadata(J){return{tables:await this.getTables(J)}}async#W(J){let W=this.#J,X=(await W.selectFrom("sqlite_master").where("name","=",J).select("sql").$castTo().execute())[0]?.sql?.split(/[\(\),]/)?.find((G)=>G.toLowerCase().includes("autoincrement"))?.split(/\s+/)?.[0]?.replace(/["`]/g,"");return{name:J,columns:(await W.selectFrom(F6`pragma_table_info(${J})`.as("table_info")).select(["name","type","notnull","dflt_value"]).execute()).map((G)=>({name:G.name,dataType:G.type,isNullable:!G.notnull,isAutoIncrementing:G.name===X,hasDefaultValue:G.dflt_value!=null})),isView:!0}}},ak,tk=class{#J;constructor(J){this.#J={...J}}createDriver(){return new dk(this.#J)}createQueryCompiler(){return new ak}createAdapter(){return new pk}createIntrospector(J){return new ik(J)}};var P_=D(()=>{oJ();ak=class extends H8{getCurrentParameterPlaceholder(){return"?"}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getAutoIncrement(){return"autoincrement"}}});function wY(J){if(!J)return null;if("dialect"in J)return wY(J.dialect);if("createDriver"in J){if(J instanceof YK)return"sqlite";if(J instanceof $K)return"mysql";if(J instanceof o1)return"postgres";if(J instanceof Rz)return"mssql"}if("aggregate"in J)return"sqlite";if("getConnection"in J)return"mysql";if("connect"in J)return"postgres";if("fileControl"in J)return"sqlite";if("open"in J&&"close"in J&&"prepare"in J)return"sqlite";return null}var MK=async(J)=>{let W=J.database;if(!W)return{kysely:null,databaseType:null,transaction:void 0};if("db"in W)return{kysely:W.db,databaseType:W.type,transaction:W.transaction};if("dialect"in W)return{kysely:new w8({dialect:W.dialect}),databaseType:W.type,transaction:W.transaction};let X=void 0,G=wY(W);if("createDriver"in W)X=W;if("aggregate"in W&&!("createSession"in W))X=new YK({database:W});if("getConnection"in W)X=new $K(W);if("connect"in W)X=new o1({pool:W});if("fileControl"in W){let{BunSqliteDialect:Y}=await Promise.resolve().then(() => (M_(),v_));X=new Y({database:W})}if("createSession"in W&&typeof window>"u"){let Y=void 0;try{({DatabaseSync:Y}=await import("node:sqlite"))}catch($){if($!==null&&typeof $==="object"&&"code"in $&&$.code!=="ERR_UNKNOWN_BUILTIN_MODULE")throw $}if(Y&&W instanceof Y){let{NodeSqliteDialect:$}=await Promise.resolve().then(() => (P_(),O_));X=new $({database:W})}}return{kysely:X?new w8({dialect:X}):null,databaseType:G,transaction:void 0}};var RX=D(()=>{oJ()});function p6(J){return J}var v9=()=>{};var o,W6;var DF=D(()=>{v9();o=p6({USER_NOT_FOUND:"User not found",FAILED_TO_CREATE_USER:"Failed to create user",FAILED_TO_CREATE_SESSION:"Failed to create session",FAILED_TO_UPDATE_USER:"Failed to update user",FAILED_TO_GET_SESSION:"Failed to get session",INVALID_PASSWORD:"Invalid password",INVALID_EMAIL:"Invalid email",INVALID_EMAIL_OR_PASSWORD:"Invalid email or password",SOCIAL_ACCOUNT_ALREADY_LINKED:"Social account already linked",PROVIDER_NOT_FOUND:"Provider not found",INVALID_TOKEN:"Invalid token",ID_TOKEN_NOT_SUPPORTED:"id_token not supported",FAILED_TO_GET_USER_INFO:"Failed to get user info",USER_EMAIL_NOT_FOUND:"User email not found",EMAIL_NOT_VERIFIED:"Email not verified",PASSWORD_TOO_SHORT:"Password too short",PASSWORD_TOO_LONG:"Password too long",USER_ALREADY_EXISTS:"User already exists.",USER_ALREADY_EXISTS_USE_ANOTHER_EMAIL:"User already exists. Use another email.",EMAIL_CAN_NOT_BE_UPDATED:"Email can not be updated",CREDENTIAL_ACCOUNT_NOT_FOUND:"Credential account not found",SESSION_EXPIRED:"Session expired. Re-authenticate to perform this action.",FAILED_TO_UNLINK_LAST_ACCOUNT:"You can't unlink your last account",ACCOUNT_NOT_FOUND:"Account not found",USER_ALREADY_HAS_PASSWORD:"User already has a password. Provide that to delete the account."}),W6=class extends Error{constructor(J,W){super(J);this.name="BetterAuthError",this.message=J,this.cause=W,this.stack=""}}});var R4=D(()=>{v9();DF()});var Z8=(J)=>{let W=(J.plugins??[]).reduce((Z,z)=>{let N=z.schema;if(!N)return Z;for(let[F,Q]of Object.entries(N))Z[F]={fields:{...Z[F]?.fields,...Q.fields},modelName:Q.modelName||F};return Z},{}),X=J.rateLimit?.storage==="database",G={rateLimit:{modelName:J.rateLimit?.modelName||"rateLimit",fields:{key:{type:"string",fieldName:J.rateLimit?.fields?.key||"key"},count:{type:"number",fieldName:J.rateLimit?.fields?.count||"count"},lastRequest:{type:"number",bigint:!0,fieldName:J.rateLimit?.fields?.lastRequest||"lastRequest"}}}},{user:Y,session:$,account:K,...w}=W,H={session:{modelName:J.session?.modelName||"session",fields:{expiresAt:{type:"date",required:!0,fieldName:J.session?.fields?.expiresAt||"expiresAt"},token:{type:"string",required:!0,fieldName:J.session?.fields?.token||"token",unique:!0},createdAt:{type:"date",required:!0,fieldName:J.session?.fields?.createdAt||"createdAt",defaultValue:()=>new Date},updatedAt:{type:"date",required:!0,fieldName:J.session?.fields?.updatedAt||"updatedAt",onUpdate:()=>new Date},ipAddress:{type:"string",required:!1,fieldName:J.session?.fields?.ipAddress||"ipAddress"},userAgent:{type:"string",required:!1,fieldName:J.session?.fields?.userAgent||"userAgent"},userId:{type:"string",fieldName:J.session?.fields?.userId||"userId",references:{model:J.user?.modelName||"user",field:"id",onDelete:"cascade"},required:!0,index:!0},...$?.fields,...J.session?.additionalFields},order:2}};return{user:{modelName:J.user?.modelName||"user",fields:{name:{type:"string",required:!0,fieldName:J.user?.fields?.name||"name",sortable:!0},email:{type:"string",unique:!0,required:!0,fieldName:J.user?.fields?.email||"email",sortable:!0},emailVerified:{type:"boolean",defaultValue:!1,required:!0,fieldName:J.user?.fields?.emailVerified||"emailVerified",input:!1},image:{type:"string",required:!1,fieldName:J.user?.fields?.image||"image"},createdAt:{type:"date",defaultValue:()=>new Date,required:!0,fieldName:J.user?.fields?.createdAt||"createdAt"},updatedAt:{type:"date",defaultValue:()=>new Date,onUpdate:()=>new Date,required:!0,fieldName:J.user?.fields?.updatedAt||"updatedAt"},...Y?.fields,...J.user?.additionalFields},order:1},...!J.secondaryStorage||J.session?.storeSessionInDatabase?H:{},account:{modelName:J.account?.modelName||"account",fields:{accountId:{type:"string",required:!0,fieldName:J.account?.fields?.accountId||"accountId"},providerId:{type:"string",required:!0,fieldName:J.account?.fields?.providerId||"providerId"},userId:{type:"string",references:{model:J.user?.modelName||"user",field:"id",onDelete:"cascade"},required:!0,fieldName:J.account?.fields?.userId||"userId",index:!0},accessToken:{type:"string",required:!1,fieldName:J.account?.fields?.accessToken||"accessToken"},refreshToken:{type:"string",required:!1,fieldName:J.account?.fields?.refreshToken||"refreshToken"},idToken:{type:"string",required:!1,fieldName:J.account?.fields?.idToken||"idToken"},accessTokenExpiresAt:{type:"date",required:!1,fieldName:J.account?.fields?.accessTokenExpiresAt||"accessTokenExpiresAt"},refreshTokenExpiresAt:{type:"date",required:!1,fieldName:J.account?.fields?.refreshTokenExpiresAt||"refreshTokenExpiresAt"},scope:{type:"string",required:!1,fieldName:J.account?.fields?.scope||"scope"},password:{type:"string",required:!1,fieldName:J.account?.fields?.password||"password"},createdAt:{type:"date",required:!0,fieldName:J.account?.fields?.createdAt||"createdAt",defaultValue:()=>new Date},updatedAt:{type:"date",required:!0,fieldName:J.account?.fields?.updatedAt||"updatedAt",onUpdate:()=>new Date},...K?.fields,...J.account?.additionalFields},order:3},verification:{modelName:J.verification?.modelName||"verification",fields:{identifier:{type:"string",required:!0,fieldName:J.verification?.fields?.identifier||"identifier",index:!0},value:{type:"string",required:!0,fieldName:J.verification?.fields?.value||"value"},expiresAt:{type:"date",required:!0,fieldName:J.verification?.fields?.expiresAt||"expiresAt"},createdAt:{type:"date",required:!0,defaultValue:()=>new Date,fieldName:J.verification?.fields?.createdAt||"createdAt"},updatedAt:{type:"date",required:!0,defaultValue:()=>new Date,onUpdate:()=>new Date,fieldName:J.verification?.fields?.updatedAt||"updatedAt"}},order:4},...w,...X?G:{}}},CX=({usePlural:J,schema:W})=>{return(G)=>{if(J&&G.charAt(G.length-1)==="s"){let $=G.slice(0,-1),K=W[$]?$:void 0;if(!K)K=Object.entries(W).find(([w,H])=>H.modelName===$)?.[0];if(K)return K}let Y=W[G]?G:void 0;if(!Y)Y=Object.entries(W).find(([$,K])=>K.modelName===G)?.[0];if(!Y)throw new W6(`Model "${G}" not found in schema`);return Y}},OK=({schema:J,usePlural:W})=>{let X=CX({schema:J,usePlural:W});return({field:Y,model:$})=>{if(Y==="id"||Y==="_id")return"id";let K=X($),w=J[K]?.fields[Y];if(!w){let H=Object.entries(J[K].fields).find(([Z,z])=>z.fieldName===Y);if(H)w=H[1],Y=H[0]}if(!w)throw new W6(`Field ${Y} not found in model ${K}`);return Y}},PK=({schema:J,usePlural:W})=>{let X=CX({schema:J,usePlural:W}),G=OK({schema:J,usePlural:W});function Y({model:$,field:K}){let w=X($),H=G({model:w,field:K});return J[w]?.fields[H]?.fieldName||H}return Y},jK=({usePlural:J,schema:W})=>{let X=CX({schema:W,usePlural:J});return(Y)=>{let $=X(Y);if(W&&W[$]&&W[$].modelName!==Y)return J?`${W[$].modelName}s`:W[$].modelName;return J?`${Y}s`:Y}};var DJ=D(()=>{R4()});function _K(J){return J?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"}function j_(J,W,X){let G="",Y=0,$=0;for(let K of J){Y=Y<<8|K,$+=8;while($>=6)$-=6,G+=W[Y>>$&63]}if($>0)G+=W[Y<<6-$&63];if(X){let K=(4-G.length%4)%4;G+="=".repeat(K)}return G}function __(J,W){let X=new Map;for(let K=0;K<W.length;K++)X.set(W[K],K);let G=[],Y=0,$=0;for(let K of J){if(K==="=")break;let w=X.get(K);if(w===void 0)throw Error(`Invalid Base64 character: ${K}`);if(Y=Y<<6|w,$+=6,$>=8)$-=8,G.push(Y>>$&255)}return Uint8Array.from(G)}var C4,$0;var R0=D(()=>{C4={encode(J,W={}){let X=_K(!1),G=typeof J==="string"?new TextEncoder().encode(J):new Uint8Array(J);return j_(G,X,W.padding??!0)},decode(J){if(typeof J!=="string")J=new TextDecoder().decode(J);let W=J.includes("-")||J.includes("_"),X=_K(W);return __(J,X)}},$0={encode(J,W={}){let X=_K(!0),G=typeof J==="string"?new TextEncoder().encode(J):new Uint8Array(J);return j_(G,X,W.padding??!0)},decode(J){let W=J.includes("-")||J.includes("_"),X=_K(W);return __(J,X)}}});function z8(){let J=typeof globalThis<"u"&&globalThis.crypto;if(J&&typeof J.subtle==="object"&&J.subtle!=null)return J.subtle;throw Error("crypto.subtle must be defined")}var IX=()=>{};function C0(J,W){return{digest:async(X)=>{let Y=typeof X==="string"?new TextEncoder().encode(X):X,$=await z8().digest(J,Y);if(W==="hex")return Array.from(new Uint8Array($)).map((H)=>H.toString(16).padStart(2,"0")).join("");if(W==="base64"||W==="base64url"||W==="base64urlnopad"){if(W.includes("url"))return $0.encode($,{padding:W!=="base64urlnopad"});return C4.encode($)}return $}}}var eJ=D(()=>{R0();IX()});function ok(J){return J instanceof Uint8Array||ArrayBuffer.isView(J)&&J.constructor.name==="Uint8Array"}function SK(J){if(typeof J!=="boolean")throw Error(`boolean expected, not ${J}`)}function M9(J){if(!Number.isSafeInteger(J)||J<0)throw Error("positive integer expected, got "+J)}function B4(J,W,X=""){let G=ok(J),Y=J?.length,$=W!==void 0;if(!G||$&&Y!==W){let K=X&&`"${X}" `,w=$?` of length ${W}`:"",H=G?`length=${Y}`:`type=${typeof J}`;throw Error(K+"expected Uint8Array"+w+", got "+H)}return J}function vF(J,W=!0){if(J.destroyed)throw Error("Hash instance has been destroyed");if(W&&J.finished)throw Error("Hash#digest() has already been called")}function T_(J,W){B4(J,void 0,"output");let X=W.outputLen;if(J.length<X)throw Error("digestInto() expects output buffer of length at least "+X)}function WW(J){return new Uint32Array(J.buffer,J.byteOffset,Math.floor(J.byteLength/4))}function XW(...J){for(let W=0;W<J.length;W++)J[W].fill(0)}function sk(J){return new DataView(J.buffer,J.byteOffset,J.byteLength)}function MF(J){if(B4(J),q_)return J.toHex();let W="";for(let X=0;X<J.length;X++)W+=Jh[J[X]];return W}function S_(J){if(J>=JW._0&&J<=JW._9)return J-JW._0;if(J>=JW.A&&J<=JW.F)return J-(JW.A-10);if(J>=JW.a&&J<=JW.f)return J-(JW.a-10);return}function B_(J){if(typeof J!=="string")throw Error("hex string expected, got "+typeof J);if(q_)return Uint8Array.fromHex(J);let W=J.length,X=W/2;if(W%2)throw Error("hex string expected, got unpadded hex of length "+W);let G=new Uint8Array(X);for(let Y=0,$=0;Y<X;Y++,$+=2){let K=S_(J.charCodeAt($)),w=S_(J.charCodeAt($+1));if(K===void 0||w===void 0){let H=J[$]+J[$+1];throw Error('hex string expected, got non-hex character "'+H+'" at index '+$)}G[Y]=K*16+w}return G}function A_(J){if(typeof J!=="string")throw Error("string expected");return new Uint8Array(new TextEncoder().encode(J))}function E_(...J){let W=0;for(let G=0;G<J.length;G++){let Y=J[G];B4(Y),W+=Y.length}let X=new Uint8Array(W);for(let G=0,Y=0;G<J.length;G++){let $=J[G];X.set($,Y),Y+=$.length}return X}function R_(J,W){if(W==null||typeof W!=="object")throw Error("options must be defined");return Object.assign(J,W)}function C_(J,W){if(J.length!==W.length)return!1;let X=0;for(let G=0;G<J.length;G++)X|=J[G]^W[G];return X===0}function PF(J,W,X=!0){if(W===void 0)return new Uint8Array(J);if(W.length!==J)throw Error('"output" expected Uint8Array of length '+J+", got: "+W.length);if(X&&!Wh(W))throw Error("invalid output, must be aligned");return W}function I_(J,W,X){SK(X);let G=new Uint8Array(16),Y=sk(G);return Y.setBigUint64(0,BigInt(W),X),Y.setBigUint64(8,BigInt(J),X),G}function Wh(J){return J.byteOffset%4===0}function HY(J){return Uint8Array.from(J)}function b_(J=32){let W=typeof globalThis==="object"?globalThis.crypto:null;if(typeof W?.getRandomValues!=="function")throw Error("crypto.getRandomValues must be defined");return W.getRandomValues(new Uint8Array(J))}function jF(J,W=b_){let{nonceLength:X}=J;M9(X);let G=(Y,$)=>{let K=E_(Y,$);return $.fill(0),K};return(Y,...$)=>({encrypt(K){B4(K);let w=W(X),H=J(Y,w,...$).encrypt(K);if(H instanceof Promise)return H.then((Z)=>G(w,Z));return G(w,H)},decrypt(K){B4(K);let w=K.subarray(0,X),H=K.subarray(X);return J(Y,w,...$).decrypt(H)}})}var ek,q_,Jh,JW,OF=(J,W)=>{function X(G,...Y){if(B4(G,void 0,"key"),!ek)throw Error("Non little-endian hardware is not yet supported");if(J.nonceLength!==void 0){let z=Y[0];B4(z,J.varSizeNonce?void 0:J.nonceLength,"nonce")}let $=J.tagLength;if($&&Y[1]!==void 0)B4(Y[1],void 0,"AAD");let K=W(G,...Y),w=(z,N)=>{if(N!==void 0){if(z!==2)throw Error("cipher output not supported");B4(N,void 0,"output")}},H=!1;return{encrypt(z,N){if(H)throw Error("cannot encrypt() twice with same key + nonce");return H=!0,B4(z),w(K.encrypt.length,N),K.encrypt(z,N)},decrypt(z,N){if(B4(z),$&&z.length<$)throw Error('"ciphertext" expected length bigger than tagLength='+$);return w(K.decrypt.length,N),K.decrypt(z,N)}}}return Object.assign(X,J),X};var O9=D(()=>{/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */ek=(()=>new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68)(),q_=(()=>typeof Uint8Array.from([]).toHex==="function"&&typeof Uint8Array.fromHex==="function")(),Jh=Array.from({length:256},(J,W)=>W.toString(16).padStart(2,"0"));JW={_0:48,_9:57,A:65,F:70,a:97,f:102}});function e(J,W){return J<<W|J>>>32-W}function _F(J){return J.byteOffset%4===0}function wh(J,W,X,G,Y,$,K,w){let H=Y.length,Z=new Uint8Array(TK),z=WW(Z),N=_F(Y)&&_F($),F=N?WW(Y):k_,Q=N?WW($):k_;for(let V=0;V<H;K++){if(J(W,X,G,z,K,w),K>=f_)throw Error("arx: counter overflow");let v=Math.min(TK,H-V);if(N&&v===TK){let M=V/4;if(V%4!==0)throw Error("arx: invalid block position");for(let O=0,S;O<Kh;O++)S=M+O,Q[S]=F[S]^z[O];V+=TK;continue}for(let M=0,O;M<v;M++)O=V+M,$[O]=Y[O]^Z[M];V+=v}}function SF(J,W){let{allowShortKeys:X,extendNonceFn:G,counterLength:Y,counterRight:$,rounds:K}=R_({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},W);if(typeof J!=="function")throw Error("core must be a function");return M9(Y),M9(K),SK($),SK(X),(w,H,Z,z,N=0)=>{B4(w,void 0,"key"),B4(H,void 0,"nonce"),B4(Z,void 0,"data");let F=Z.length;if(z===void 0)z=new Uint8Array(F);if(B4(z,void 0,"output"),M9(N),N<0||N>=f_)throw Error("arx: counter overflow");if(z.length<F)throw Error(`arx: output (${z.length}) is shorter than data (${F})`);let Q=[],V=w.length,v,M;if(V===32)Q.push(v=HY(w)),M=$h;else if(V===16&&X)v=new Uint8Array(32),v.set(w),v.set(w,16),M=Gh,Q.push(v);else throw B4(w,32,"arx key"),Error("invalid key size");if(!_F(H))Q.push(H=HY(H));let O=WW(v);if(G){if(H.length!==24)throw Error("arx: extended nonce must be 24 bytes");G(M,O,WW(H.subarray(0,16)),O),H=H.subarray(16)}let S=16-Y;if(S!==H.length)throw Error(`arx: nonce must be ${S} or 16 bytes`);if(S!==12){let j=new Uint8Array(12);j.set(H,$?0:12-H.length),H=j,Q.push(H)}let T=WW(H);return wh(J,M,O,T,Z,z,N,K),XW(...Q),z}}var h_=(J)=>Uint8Array.from(J.split(""),(W)=>W.charCodeAt(0)),Xh,Yh,Gh,$h,TK=64,Kh=16,f_=4294967295,k_;var g_=D(()=>{O9();Xh=h_("expand 16-byte k"),Yh=h_("expand 32-byte k"),Gh=WW(Xh),$h=WW(Yh);k_=Uint32Array.of()});function K0(J,W){return J[W++]&255|(J[W++]&255)<<8}class m_{blockLen=16;outputLen=16;buffer=new Uint8Array(16);r=new Uint16Array(10);h=new Uint16Array(10);pad=new Uint16Array(8);pos=0;finished=!1;constructor(J){J=HY(B4(J,32,"key"));let W=K0(J,0),X=K0(J,2),G=K0(J,4),Y=K0(J,6),$=K0(J,8),K=K0(J,10),w=K0(J,12),H=K0(J,14);this.r[0]=W&8191,this.r[1]=(W>>>13|X<<3)&8191,this.r[2]=(X>>>10|G<<6)&7939,this.r[3]=(G>>>7|Y<<9)&8191,this.r[4]=(Y>>>4|$<<12)&255,this.r[5]=$>>>1&8190,this.r[6]=($>>>14|K<<2)&8191,this.r[7]=(K>>>11|w<<5)&8065,this.r[8]=(w>>>8|H<<8)&8191,this.r[9]=H>>>5&127;for(let Z=0;Z<8;Z++)this.pad[Z]=K0(J,16+2*Z)}process(J,W,X=!1){let G=X?0:2048,{h:Y,r:$}=this,K=$[0],w=$[1],H=$[2],Z=$[3],z=$[4],N=$[5],F=$[6],Q=$[7],V=$[8],v=$[9],M=K0(J,W+0),O=K0(J,W+2),S=K0(J,W+4),T=K0(J,W+6),j=K0(J,W+8),q=K0(J,W+10),_=K0(J,W+12),B=K0(J,W+14),A=Y[0]+(M&8191),E=Y[1]+((M>>>13|O<<3)&8191),R=Y[2]+((O>>>10|S<<6)&8191),g=Y[3]+((S>>>7|T<<9)&8191),u=Y[4]+((T>>>4|j<<12)&8191),b=Y[5]+(j>>>1&8191),f=Y[6]+((j>>>14|q<<2)&8191),m=Y[7]+((q>>>11|_<<5)&8191),c=Y[8]+((_>>>8|B<<8)&8191),l=Y[9]+(B>>>5|G),i=0,t=i+A*K+E*(5*v)+R*(5*V)+g*(5*Q)+u*(5*F);i=t>>>13,t&=8191,t+=b*(5*N)+f*(5*z)+m*(5*Z)+c*(5*H)+l*(5*w),i+=t>>>13,t&=8191;let $6=i+A*w+E*K+R*(5*v)+g*(5*V)+u*(5*Q);i=$6>>>13,$6&=8191,$6+=b*(5*F)+f*(5*N)+m*(5*z)+c*(5*Z)+l*(5*H),i+=$6>>>13,$6&=8191;let D6=i+A*H+E*w+R*K+g*(5*v)+u*(5*V);i=D6>>>13,D6&=8191,D6+=b*(5*Q)+f*(5*F)+m*(5*N)+c*(5*z)+l*(5*Z),i+=D6>>>13,D6&=8191;let K6=i+A*Z+E*H+R*w+g*K+u*(5*v);i=K6>>>13,K6&=8191,K6+=b*(5*V)+f*(5*Q)+m*(5*F)+c*(5*N)+l*(5*z),i+=K6>>>13,K6&=8191;let u4=i+A*z+E*Z+R*H+g*w+u*K;i=u4>>>13,u4&=8191,u4+=b*(5*v)+f*(5*V)+m*(5*Q)+c*(5*F)+l*(5*N),i+=u4>>>13,u4&=8191;let zX=i+A*N+E*z+R*Z+g*H+u*w;i=zX>>>13,zX&=8191,zX+=b*K+f*(5*v)+m*(5*V)+c*(5*Q)+l*(5*F),i+=zX>>>13,zX&=8191;let LW=i+A*F+E*N+R*z+g*Z+u*H;i=LW>>>13,LW&=8191,LW+=b*w+f*K+m*(5*v)+c*(5*V)+l*(5*Q),i+=LW>>>13,LW&=8191;let H1=i+A*Q+E*F+R*N+g*z+u*Z;i=H1>>>13,H1&=8191,H1+=b*H+f*w+m*K+c*(5*v)+l*(5*V),i+=H1>>>13,H1&=8191;let Z1=i+A*V+E*Q+R*F+g*N+u*z;i=Z1>>>13,Z1&=8191,Z1+=b*Z+f*H+m*w+c*K+l*(5*v),i+=Z1>>>13,Z1&=8191;let z1=i+A*v+E*V+R*Q+g*F+u*N;i=z1>>>13,z1&=8191,z1+=b*z+f*Z+m*H+c*w+l*K,i+=z1>>>13,z1&=8191,i=(i<<2)+i|0,i=i+t|0,t=i&8191,i=i>>>13,$6+=i,Y[0]=t,Y[1]=$6,Y[2]=D6,Y[3]=K6,Y[4]=u4,Y[5]=zX,Y[6]=LW,Y[7]=H1,Y[8]=Z1,Y[9]=z1}finalize(){let{h:J,pad:W}=this,X=new Uint16Array(10),G=J[1]>>>13;J[1]&=8191;for(let K=2;K<10;K++)J[K]+=G,G=J[K]>>>13,J[K]&=8191;J[0]+=G*5,G=J[0]>>>13,J[0]&=8191,J[1]+=G,G=J[1]>>>13,J[1]&=8191,J[2]+=G,X[0]=J[0]+5,G=X[0]>>>13,X[0]&=8191;for(let K=1;K<10;K++)X[K]=J[K]+G,G=X[K]>>>13,X[K]&=8191;X[9]-=8192;let Y=(G^1)-1;for(let K=0;K<10;K++)X[K]&=Y;Y=~Y;for(let K=0;K<10;K++)J[K]=J[K]&Y|X[K];J[0]=(J[0]|J[1]<<13)&65535,J[1]=(J[1]>>>3|J[2]<<10)&65535,J[2]=(J[2]>>>6|J[3]<<7)&65535,J[3]=(J[3]>>>9|J[4]<<4)&65535,J[4]=(J[4]>>>12|J[5]<<1|J[6]<<14)&65535,J[5]=(J[6]>>>2|J[7]<<11)&65535,J[6]=(J[7]>>>5|J[8]<<8)&65535,J[7]=(J[8]>>>8|J[9]<<5)&65535;let $=J[0]+W[0];J[0]=$&65535;for(let K=1;K<8;K++)$=(J[K]+W[K]|0)+($>>>16)|0,J[K]=$&65535;XW(X)}update(J){vF(this),B4(J),J=HY(J);let{buffer:W,blockLen:X}=this,G=J.length;for(let Y=0;Y<G;){let $=Math.min(X-this.pos,G-Y);if($===X){for(;X<=G-Y;Y+=X)this.process(J,Y);continue}if(W.set(J.subarray(Y,Y+$),this.pos),this.pos+=$,Y+=$,this.pos===X)this.process(W,0,!1),this.pos=0}return this}destroy(){XW(this.h,this.r,this.buffer,this.pad)}digestInto(J){vF(this),T_(J,this),this.finished=!0;let{buffer:W,h:X}=this,{pos:G}=this;if(G){W[G++]=1;for(;G<16;G++)W[G]=0;this.process(W,0,!0)}this.finalize();let Y=0;for(let $=0;$<8;$++)J[Y++]=X[$]>>>0,J[Y++]=X[$]>>>8;return J}digest(){let{buffer:J,outputLen:W}=this;this.digestInto(J);let X=J.slice(0,W);return this.destroy(),X}}function Hh(J){let W=(G,Y)=>J(Y).update(G).digest(),X=J(new Uint8Array(32));return W.outputLen=X.outputLen,W.blockLen=X.blockLen,W.create=(G)=>J(G),W}var y_;var x_=D(()=>{O9();y_=(()=>Hh((J)=>new m_(J)))()});function c_(J,W,X,G,Y,$=20){let K=J[0],w=J[1],H=J[2],Z=J[3],z=W[0],N=W[1],F=W[2],Q=W[3],V=W[4],v=W[5],M=W[6],O=W[7],S=Y,T=X[0],j=X[1],q=X[2],_=K,B=w,A=H,E=Z,R=z,g=N,u=F,b=Q,f=V,m=v,c=M,l=O,i=S,t=T,$6=j,D6=q;for(let u4=0;u4<$;u4+=2)_=_+R|0,i=e(i^_,16),f=f+i|0,R=e(R^f,12),_=_+R|0,i=e(i^_,8),f=f+i|0,R=e(R^f,7),B=B+g|0,t=e(t^B,16),m=m+t|0,g=e(g^m,12),B=B+g|0,t=e(t^B,8),m=m+t|0,g=e(g^m,7),A=A+u|0,$6=e($6^A,16),c=c+$6|0,u=e(u^c,12),A=A+u|0,$6=e($6^A,8),c=c+$6|0,u=e(u^c,7),E=E+b|0,D6=e(D6^E,16),l=l+D6|0,b=e(b^l,12),E=E+b|0,D6=e(D6^E,8),l=l+D6|0,b=e(b^l,7),_=_+g|0,D6=e(D6^_,16),c=c+D6|0,g=e(g^c,12),_=_+g|0,D6=e(D6^_,8),c=c+D6|0,g=e(g^c,7),B=B+u|0,i=e(i^B,16),l=l+i|0,u=e(u^l,12),B=B+u|0,i=e(i^B,8),l=l+i|0,u=e(u^l,7),A=A+b|0,t=e(t^A,16),f=f+t|0,b=e(b^f,12),A=A+b|0,t=e(t^A,8),f=f+t|0,b=e(b^f,7),E=E+R|0,$6=e($6^E,16),m=m+$6|0,R=e(R^m,12),E=E+R|0,$6=e($6^E,8),m=m+$6|0,R=e(R^m,7);let K6=0;G[K6++]=K+_|0,G[K6++]=w+B|0,G[K6++]=H+A|0,G[K6++]=Z+E|0,G[K6++]=z+R|0,G[K6++]=N+g|0,G[K6++]=F+u|0,G[K6++]=Q+b|0,G[K6++]=V+f|0,G[K6++]=v+m|0,G[K6++]=M+c|0,G[K6++]=O+l|0,G[K6++]=S+i|0,G[K6++]=T+t|0,G[K6++]=j+$6|0,G[K6++]=q+D6|0}function Zh(J,W,X,G){let Y=J[0],$=J[1],K=J[2],w=J[3],H=W[0],Z=W[1],z=W[2],N=W[3],F=W[4],Q=W[5],V=W[6],v=W[7],M=X[0],O=X[1],S=X[2],T=X[3];for(let q=0;q<20;q+=2)Y=Y+H|0,M=e(M^Y,16),F=F+M|0,H=e(H^F,12),Y=Y+H|0,M=e(M^Y,8),F=F+M|0,H=e(H^F,7),$=$+Z|0,O=e(O^$,16),Q=Q+O|0,Z=e(Z^Q,12),$=$+Z|0,O=e(O^$,8),Q=Q+O|0,Z=e(Z^Q,7),K=K+z|0,S=e(S^K,16),V=V+S|0,z=e(z^V,12),K=K+z|0,S=e(S^K,8),V=V+S|0,z=e(z^V,7),w=w+N|0,T=e(T^w,16),v=v+T|0,N=e(N^v,12),w=w+N|0,T=e(T^w,8),v=v+T|0,N=e(N^v,7),Y=Y+Z|0,T=e(T^Y,16),V=V+T|0,Z=e(Z^V,12),Y=Y+Z|0,T=e(T^Y,8),V=V+T|0,Z=e(Z^V,7),$=$+z|0,M=e(M^$,16),v=v+M|0,z=e(z^v,12),$=$+z|0,M=e(M^$,8),v=v+M|0,z=e(z^v,7),K=K+N|0,O=e(O^K,16),F=F+O|0,N=e(N^F,12),K=K+N|0,O=e(O^K,8),F=F+O|0,N=e(N^F,7),w=w+H|0,S=e(S^w,16),Q=Q+S|0,H=e(H^Q,12),w=w+H|0,S=e(S^w,8),Q=Q+S|0,H=e(H^Q,7);let j=0;G[j++]=Y,G[j++]=$,G[j++]=K,G[j++]=w,G[j++]=M,G[j++]=O,G[j++]=S,G[j++]=T}function l_(J,W,X,G,Y){if(Y!==void 0)B4(Y,void 0,"AAD");let $=J(W,X,Uh),K=I_(G.length,Y?Y.length:0,!0),w=y_.create($);if(Y)u_(w,Y);u_(w,G),w.update(K);let H=w.digest();return XW($,K),H}var zh,Fh,Nh,u_=(J,W)=>{J.update(W);let X=W.length%16;if(X)J.update(Nh.subarray(X))},Uh,p_=(J)=>(W,X,G)=>{return{encrypt($,K){let w=$.length;K=PF(w+16,K,!1),K.set($);let H=K.subarray(0,-16);J(W,X,H,H,1);let Z=l_(J,W,X,H,G);return K.set(Z,w),XW(Z),K},decrypt($,K){K=PF($.length-16,K,!1);let w=$.subarray(0,-16),H=$.subarray(-16),Z=l_(J,W,X,w,G);if(!C_(H,Z))throw Error("invalid tag");return K.set($.subarray(0,-16)),J(W,X,K,K,1),XW(Z),K}}},j76,TF;var d_=D(()=>{g_();x_();O9();zh=SF(c_,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Fh=SF(c_,{counterRight:!1,counterLength:8,extendNonceFn:Zh,allowShortKeys:!1}),Nh=new Uint8Array(16),Uh=new Uint8Array(32);j76=OF({blockSize:64,nonceLength:12,tagLength:16},p_(zh)),TF=OF({blockSize:64,nonceLength:24,tagLength:16},p_(Fh))});var ZY;var qK=D(()=>{ZY={encode:(J)=>{if(typeof J==="string")J=new TextEncoder().encode(J);if(J.byteLength===0)return"";let W=new Uint8Array(J),X="";for(let G of W)X+=G.toString(16).padStart(2,"0");return X},decode:(J)=>{if(!J)return"";if(typeof J==="string"){if(J.length%2!==0)throw Error("Invalid hexadecimal string");if(!new RegExp("^[0123456789abcdef]+$").test(J))throw Error("Invalid hexadecimal string");let W=new Uint8Array(J.length/2);for(let X=0;X<J.length;X+=2)W[X/2]=parseInt(J.slice(X,X+2),16);return new TextDecoder().decode(W)}return new TextDecoder().decode(J)}}});function Qh(J){return J instanceof Uint8Array||ArrayBuffer.isView(J)&&J.constructor.name==="Uint8Array"}function I0(J,W=""){if(!Number.isSafeInteger(J)||J<0){let X=W&&`"${W}" `;throw Error(`${X}expected integer >= 0, got ${J}`)}}function GW(J,W,X=""){let G=Qh(J),Y=J?.length,$=W!==void 0;if(!G||$&&Y!==W){let K=X&&`"${X}" `,w=$?` of length ${W}`:"",H=G?`length=${Y}`:`type=${typeof J}`;throw Error(K+"expected Uint8Array"+w+", got "+H)}return J}function bX(J){if(typeof J!=="function"||typeof J.create!=="function")throw Error("Hash must wrapped by utils.createHasher");I0(J.outputLen),I0(J.blockLen)}function zY(J,W=!0){if(J.destroyed)throw Error("Hash instance has been destroyed");if(W&&J.finished)throw Error("Hash#digest() has already been called")}function r_(J,W){GW(J,void 0,"digestInto() output");let X=W.outputLen;if(J.length<X)throw Error('"digestInto() output" expected to be of length >='+X)}function BK(J){return new Uint32Array(J.buffer,J.byteOffset,Math.floor(J.byteLength/4))}function b0(...J){for(let W=0;W<J.length;W++)J[W].fill(0)}function FY(J){return new DataView(J.buffer,J.byteOffset,J.byteLength)}function e8(J,W){return J<<32-W|J>>>W}function C6(J,W){return J<<W|J>>>32-W>>>0}function Vh(J){return J<<24&4278190080|J<<8&16711680|J>>>8&65280|J>>>24&255}function Dh(J){for(let W=0;W<J.length;W++)J[W]=Vh(J[W]);return J}function n_(J){if(J>=YW._0&&J<=YW._9)return J-YW._0;if(J>=YW.A&&J<=YW.F)return J-(YW.A-10);if(J>=YW.a&&J<=YW.f)return J-(YW.a-10);return}function i_(J){if(typeof J!=="string")throw Error("hex string expected, got "+typeof J);if(vh)return Uint8Array.fromHex(J);let W=J.length,X=W/2;if(W%2)throw Error("hex string expected, got unpadded hex of length "+W);let G=new Uint8Array(X);for(let Y=0,$=0;Y<X;Y++,$+=2){let K=n_(J.charCodeAt($)),w=n_(J.charCodeAt($+1));if(K===void 0||w===void 0){let H=J[$]+J[$+1];throw Error('hex string expected, got non-hex character "'+H+'" at index '+$)}G[Y]=K*16+w}return G}async function AK(J,W,X){let G=Date.now();for(let Y=0;Y<J;Y++){X(Y);let $=Date.now()-G;if($>=0&&$<W)continue;await Mh(),G+=$}}function Oh(J){if(typeof J!=="string")throw Error("string expected");return new Uint8Array(new TextEncoder().encode(J))}function BF(J,W=""){if(typeof J==="string")return Oh(J);return GW(J,void 0,W)}function EK(J,W){if(W!==void 0&&{}.toString.call(W)!=="[object Object]")throw Error("options must be object or undefined");return Object.assign(J,W)}function a_(J,W={}){let X=(Y,$)=>J($).update(Y).digest(),G=J(void 0);return X.outputLen=G.outputLen,X.blockLen=G.blockLen,X.create=(Y)=>J(Y),Object.assign(X,W),Object.freeze(X)}var Lh,qF,vh,YW,Mh=async()=>{},t_=(J)=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,J])});var mW=D(()=>{/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */Lh=(()=>new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68)();qF=Lh?(J)=>J:Dh,vh=(()=>typeof Uint8Array.from([]).toHex==="function"&&typeof Uint8Array.fromHex==="function")(),YW={_0:48,_9:57,A:65,F:70,a:97,f:102}});class AF{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(J,W){if(bX(J),GW(W,void 0,"key"),this.iHash=J.create(),typeof this.iHash.update!=="function")throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let X=this.blockLen,G=new Uint8Array(X);G.set(W.length>X?J.create().update(W).digest():W);for(let Y=0;Y<G.length;Y++)G[Y]^=54;this.iHash.update(G),this.oHash=J.create();for(let Y=0;Y<G.length;Y++)G[Y]^=106;this.oHash.update(G),b0(G)}update(J){return zY(this),this.iHash.update(J),this}digestInto(J){zY(this),GW(J,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(J),this.oHash.update(J),this.oHash.digestInto(J),this.destroy()}digest(){let J=new Uint8Array(this.oHash.outputLen);return this.digestInto(J),J}_cloneInto(J){J||=Object.create(Object.getPrototypeOf(this),{});let{oHash:W,iHash:X,finished:G,destroyed:Y,blockLen:$,outputLen:K}=this;return J=J,J.finished=G,J.destroyed=Y,J.blockLen=$,J.outputLen=K,J.oHash=W._cloneInto(J.oHash),J.iHash=X._cloneInto(J.iHash),J}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}var NY=(J,W,X)=>new AF(J,W).update(X).digest();var EF=D(()=>{mW();NY.create=(J,W)=>new AF(J,W)});function Ph(J,W,X,G){bX(J);let Y=EK({dkLen:32,asyncTick:10},G),{c:$,dkLen:K,asyncTick:w}=Y;if(I0($,"c"),I0(K,"dkLen"),I0(w,"asyncTick"),$<1)throw Error("iterations (c) must be >= 1");let H=BF(W,"password"),Z=BF(X,"salt"),z=new Uint8Array(K),N=NY.create(J,H),F=N._cloneInto().update(Z);return{c:$,dkLen:K,asyncTick:w,DK:z,PRF:N,PRFSalt:F}}function jh(J,W,X,G,Y){if(J.destroy(),W.destroy(),G)G.destroy();return b0(Y),X}function RF(J,W,X,G){let{c:Y,dkLen:$,DK:K,PRF:w,PRFSalt:H}=Ph(J,W,X,G),Z,z=new Uint8Array(4),N=FY(z),F=new Uint8Array(w.outputLen);for(let Q=1,V=0;V<$;Q++,V+=w.outputLen){let v=K.subarray(V,V+w.outputLen);N.setInt32(0,Q,!1),(Z=H._cloneInto(Z)).update(z).digestInto(F),v.set(F.subarray(0,v.length));for(let M=1;M<Y;M++){w._cloneInto(Z).update(F).digestInto(F);for(let O=0;O<v.length;O++)v[O]^=F[O]}}return jh(w,H,K,Z,F)}var o_=D(()=>{EF();mW()});function s_(J,W,X){return J&W^~J&X}function e_(J,W,X){return J&W^J&X^W&X}class RK{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(J,W,X,G){this.blockLen=J,this.outputLen=W,this.padOffset=X,this.isLE=G,this.buffer=new Uint8Array(J),this.view=FY(this.buffer)}update(J){zY(this),GW(J);let{view:W,buffer:X,blockLen:G}=this,Y=J.length;for(let $=0;$<Y;){let K=Math.min(G-this.pos,Y-$);if(K===G){let w=FY(J);for(;G<=Y-$;$+=G)this.process(w,$);continue}if(X.set(J.subarray($,$+K),this.pos),this.pos+=K,$+=K,this.pos===G)this.process(W,0),this.pos=0}return this.length+=J.length,this.roundClean(),this}digestInto(J){zY(this),r_(J,this),this.finished=!0;let{buffer:W,view:X,blockLen:G,isLE:Y}=this,{pos:$}=this;if(W[$++]=128,b0(this.buffer.subarray($)),this.padOffset>G-$)this.process(X,0),$=0;for(let z=$;z<G;z++)W[z]=0;X.setBigUint64(G-8,BigInt(this.length*8),Y),this.process(X,0);let K=FY(J),w=this.outputLen;if(w%4)throw Error("_sha2: outputLen must be aligned to 32bit");let H=w/4,Z=this.get();if(H>Z.length)throw Error("_sha2: outputLen bigger than state");for(let z=0;z<H;z++)K.setUint32(4*z,Z[z],Y)}digest(){let{buffer:J,outputLen:W}=this;this.digestInto(J);let X=J.slice(0,W);return this.destroy(),X}_cloneInto(J){J||=new this.constructor,J.set(...this.get());let{blockLen:W,buffer:X,length:G,finished:Y,destroyed:$,pos:K}=this;if(J.destroyed=$,J.finished=Y,J.length=G,J.pos=K,G%W)J.buffer.set(X);return J}clone(){return this._cloneInto()}}var $W,KW,w0,H0;var JS=D(()=>{mW();$W=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),KW=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),w0=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),H0=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209])});function _h(J,W=!1){if(W)return{h:Number(J&CK),l:Number(J>>WS&CK)};return{h:Number(J>>WS&CK)|0,l:Number(J&CK)|0}}function XS(J,W=!1){let X=J.length,G=new Uint32Array(X),Y=new Uint32Array(X);for(let $=0;$<X;$++){let{h:K,l:w}=_h(J[$],W);[G[$],Y[$]]=[K,w]}return[G,Y]}function vJ(J,W,X,G){let Y=(W>>>0)+(G>>>0);return{h:J+X+(Y/4294967296|0)|0,l:Y|0}}var CK,WS,CF=(J,W,X)=>J>>>X,IF=(J,W,X)=>J<<32-X|W>>>X,kX=(J,W,X)=>J>>>X|W<<32-X,hX=(J,W,X)=>J<<32-X|W>>>X,P9=(J,W,X)=>J<<64-X|W>>>X-32,j9=(J,W,X)=>J>>>X-32|W<<64-X,YS=(J,W,X)=>(J>>>0)+(W>>>0)+(X>>>0),GS=(J,W,X,G)=>W+X+G+(J/4294967296|0)|0,$S=(J,W,X,G)=>(J>>>0)+(W>>>0)+(X>>>0)+(G>>>0),KS=(J,W,X,G,Y)=>W+X+G+Y+(J/4294967296|0)|0,wS=(J,W,X,G,Y)=>(J>>>0)+(W>>>0)+(X>>>0)+(G>>>0)+(Y>>>0),HS=(J,W,X,G,Y,$)=>W+X+G+Y+$+(J/4294967296|0)|0;var ZS=D(()=>{CK=BigInt(4294967295),WS=BigInt(32)});var Th,yW,bF,zS,qh,FS,Bh,Ah,xW,uW,_9,Eh,Rh,V0,D0,Ch,Ih,UY;var kF=D(()=>{JS();ZS();mW();Th=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),yW=new Uint32Array(64);bF=class bF extends RK{constructor(J){super(64,J,8,!1)}get(){let{A:J,B:W,C:X,D:G,E:Y,F:$,G:K,H:w}=this;return[J,W,X,G,Y,$,K,w]}set(J,W,X,G,Y,$,K,w){this.A=J|0,this.B=W|0,this.C=X|0,this.D=G|0,this.E=Y|0,this.F=$|0,this.G=K|0,this.H=w|0}process(J,W){for(let z=0;z<16;z++,W+=4)yW[z]=J.getUint32(W,!1);for(let z=16;z<64;z++){let N=yW[z-15],F=yW[z-2],Q=e8(N,7)^e8(N,18)^N>>>3,V=e8(F,17)^e8(F,19)^F>>>10;yW[z]=V+yW[z-7]+Q+yW[z-16]|0}let{A:X,B:G,C:Y,D:$,E:K,F:w,G:H,H:Z}=this;for(let z=0;z<64;z++){let N=e8(K,6)^e8(K,11)^e8(K,25),F=Z+N+s_(K,w,H)+Th[z]+yW[z]|0,V=(e8(X,2)^e8(X,13)^e8(X,22))+e_(X,G,Y)|0;Z=H,H=w,w=K,K=$+F|0,$=Y,Y=G,G=X,X=F+V|0}X=X+this.A|0,G=G+this.B|0,Y=Y+this.C|0,$=$+this.D|0,K=K+this.E|0,w=w+this.F|0,H=H+this.G|0,Z=Z+this.H|0,this.set(X,G,Y,$,K,w,H,Z)}roundClean(){b0(yW)}destroy(){this.set(0,0,0,0,0,0,0,0),b0(this.buffer)}};zS=class zS extends bF{A=$W[0]|0;B=$W[1]|0;C=$W[2]|0;D=$W[3]|0;E=$W[4]|0;F=$W[5]|0;G=$W[6]|0;H=$W[7]|0;constructor(){super(32)}};qh=class qh extends bF{A=KW[0]|0;B=KW[1]|0;C=KW[2]|0;D=KW[3]|0;E=KW[4]|0;F=KW[5]|0;G=KW[6]|0;H=KW[7]|0;constructor(){super(28)}};FS=(()=>XS(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((J)=>BigInt(J))))(),Bh=(()=>FS[0])(),Ah=(()=>FS[1])(),xW=new Uint32Array(80),uW=new Uint32Array(80);_9=class _9 extends RK{constructor(J){super(128,J,16,!1)}get(){let{Ah:J,Al:W,Bh:X,Bl:G,Ch:Y,Cl:$,Dh:K,Dl:w,Eh:H,El:Z,Fh:z,Fl:N,Gh:F,Gl:Q,Hh:V,Hl:v}=this;return[J,W,X,G,Y,$,K,w,H,Z,z,N,F,Q,V,v]}set(J,W,X,G,Y,$,K,w,H,Z,z,N,F,Q,V,v){this.Ah=J|0,this.Al=W|0,this.Bh=X|0,this.Bl=G|0,this.Ch=Y|0,this.Cl=$|0,this.Dh=K|0,this.Dl=w|0,this.Eh=H|0,this.El=Z|0,this.Fh=z|0,this.Fl=N|0,this.Gh=F|0,this.Gl=Q|0,this.Hh=V|0,this.Hl=v|0}process(J,W){for(let S=0;S<16;S++,W+=4)xW[S]=J.getUint32(W),uW[S]=J.getUint32(W+=4);for(let S=16;S<80;S++){let T=xW[S-15]|0,j=uW[S-15]|0,q=kX(T,j,1)^kX(T,j,8)^CF(T,j,7),_=hX(T,j,1)^hX(T,j,8)^IF(T,j,7),B=xW[S-2]|0,A=uW[S-2]|0,E=kX(B,A,19)^P9(B,A,61)^CF(B,A,6),R=hX(B,A,19)^j9(B,A,61)^IF(B,A,6),g=$S(_,R,uW[S-7],uW[S-16]),u=KS(g,q,E,xW[S-7],xW[S-16]);xW[S]=u|0,uW[S]=g|0}let{Ah:X,Al:G,Bh:Y,Bl:$,Ch:K,Cl:w,Dh:H,Dl:Z,Eh:z,El:N,Fh:F,Fl:Q,Gh:V,Gl:v,Hh:M,Hl:O}=this;for(let S=0;S<80;S++){let T=kX(z,N,14)^kX(z,N,18)^P9(z,N,41),j=hX(z,N,14)^hX(z,N,18)^j9(z,N,41),q=z&F^~z&V,_=N&Q^~N&v,B=wS(O,j,_,Ah[S],uW[S]),A=HS(B,M,T,q,Bh[S],xW[S]),E=B|0,R=kX(X,G,28)^P9(X,G,34)^P9(X,G,39),g=hX(X,G,28)^j9(X,G,34)^j9(X,G,39),u=X&Y^X&K^Y&K,b=G&$^G&w^$&w;M=V|0,O=v|0,V=F|0,v=Q|0,F=z|0,Q=N|0,{h:z,l:N}=vJ(H|0,Z|0,A|0,E|0),H=K|0,Z=w|0,K=Y|0,w=$|0,Y=X|0,$=G|0;let f=YS(E,g,b);X=GS(f,A,R,u),G=f|0}({h:X,l:G}=vJ(this.Ah|0,this.Al|0,X|0,G|0)),{h:Y,l:$}=vJ(this.Bh|0,this.Bl|0,Y|0,$|0),{h:K,l:w}=vJ(this.Ch|0,this.Cl|0,K|0,w|0),{h:H,l:Z}=vJ(this.Dh|0,this.Dl|0,H|0,Z|0),{h:z,l:N}=vJ(this.Eh|0,this.El|0,z|0,N|0),{h:F,l:Q}=vJ(this.Fh|0,this.Fl|0,F|0,Q|0),{h:V,l:v}=vJ(this.Gh|0,this.Gl|0,V|0,v|0),{h:M,l:O}=vJ(this.Hh|0,this.Hl|0,M|0,O|0),this.set(X,G,Y,$,K,w,H,Z,z,N,F,Q,V,v,M,O)}roundClean(){b0(xW,uW)}destroy(){b0(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};Eh=class Eh extends _9{Ah=H0[0]|0;Al=H0[1]|0;Bh=H0[2]|0;Bl=H0[3]|0;Ch=H0[4]|0;Cl=H0[5]|0;Dh=H0[6]|0;Dl=H0[7]|0;Eh=H0[8]|0;El=H0[9]|0;Fh=H0[10]|0;Fl=H0[11]|0;Gh=H0[12]|0;Gl=H0[13]|0;Hh=H0[14]|0;Hl=H0[15]|0;constructor(){super(64)}};Rh=class Rh extends _9{Ah=w0[0]|0;Al=w0[1]|0;Bh=w0[2]|0;Bl=w0[3]|0;Ch=w0[4]|0;Cl=w0[5]|0;Dh=w0[6]|0;Dl=w0[7]|0;Eh=w0[8]|0;El=w0[9]|0;Fh=w0[10]|0;Fl=w0[11]|0;Gh=w0[12]|0;Gl=w0[13]|0;Hh=w0[14]|0;Hl=w0[15]|0;constructor(){super(48)}};V0=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),D0=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);Ch=class Ch extends _9{Ah=V0[0]|0;Al=V0[1]|0;Bh=V0[2]|0;Bl=V0[3]|0;Ch=V0[4]|0;Cl=V0[5]|0;Dh=V0[6]|0;Dl=V0[7]|0;Eh=V0[8]|0;El=V0[9]|0;Fh=V0[10]|0;Fl=V0[11]|0;Gh=V0[12]|0;Gl=V0[13]|0;Hh=V0[14]|0;Hl=V0[15]|0;constructor(){super(28)}};Ih=class Ih extends _9{Ah=D0[0]|0;Al=D0[1]|0;Bh=D0[2]|0;Bl=D0[3]|0;Ch=D0[4]|0;Cl=D0[5]|0;Dh=D0[6]|0;Dl=D0[7]|0;Eh=D0[8]|0;El=D0[9]|0;Fh=D0[10]|0;Fl=D0[11]|0;Gh=D0[12]|0;Gl=D0[13]|0;Hh=D0[14]|0;Hl=D0[15]|0;constructor(){super(32)}};UY=a_(()=>new zS,t_(1))});function NS(J,W,X,G,Y,$){let K=J[W++]^X[G++],w=J[W++]^X[G++],H=J[W++]^X[G++],Z=J[W++]^X[G++],z=J[W++]^X[G++],N=J[W++]^X[G++],F=J[W++]^X[G++],Q=J[W++]^X[G++],V=J[W++]^X[G++],v=J[W++]^X[G++],M=J[W++]^X[G++],O=J[W++]^X[G++],S=J[W++]^X[G++],T=J[W++]^X[G++],j=J[W++]^X[G++],q=J[W++]^X[G++],_=K,B=w,A=H,E=Z,R=z,g=N,u=F,b=Q,f=V,m=v,c=M,l=O,i=S,t=T,$6=j,D6=q;for(let K6=0;K6<8;K6+=2)R^=C6(_+i|0,7),f^=C6(R+_|0,9),i^=C6(f+R|0,13),_^=C6(i+f|0,18),m^=C6(g+B|0,7),t^=C6(m+g|0,9),B^=C6(t+m|0,13),g^=C6(B+t|0,18),$6^=C6(c+u|0,7),A^=C6($6+c|0,9),u^=C6(A+$6|0,13),c^=C6(u+A|0,18),E^=C6(D6+l|0,7),b^=C6(E+D6|0,9),l^=C6(b+E|0,13),D6^=C6(l+b|0,18),B^=C6(_+E|0,7),A^=C6(B+_|0,9),E^=C6(A+B|0,13),_^=C6(E+A|0,18),u^=C6(g+R|0,7),b^=C6(u+g|0,9),R^=C6(b+u|0,13),g^=C6(R+b|0,18),l^=C6(c+m|0,7),f^=C6(l+c|0,9),m^=C6(f+l|0,13),c^=C6(m+f|0,18),i^=C6(D6+$6|0,7),t^=C6(i+D6|0,9),$6^=C6(t+i|0,13),D6^=C6($6+t|0,18);Y[$++]=K+_|0,Y[$++]=w+B|0,Y[$++]=H+A|0,Y[$++]=Z+E|0,Y[$++]=z+R|0,Y[$++]=N+g|0,Y[$++]=F+u|0,Y[$++]=Q+b|0,Y[$++]=V+f|0,Y[$++]=v+m|0,Y[$++]=M+c|0,Y[$++]=O+l|0,Y[$++]=S+i|0,Y[$++]=T+t|0,Y[$++]=j+$6|0,Y[$++]=q+D6|0}function hF(J,W,X,G,Y){let $=G+0,K=G+16*Y;for(let w=0;w<16;w++)X[K+w]=J[W+(2*Y-1)*16+w];for(let w=0;w<Y;w++,$+=16,W+=16){if(NS(X,K,J,W,X,$),w>0)K+=16;NS(X,$,J,W+=16,X,K)}}function bh(J,W,X){let G=EK({dkLen:32,asyncTick:10,maxmem:1073742848},X),{N:Y,r:$,p:K,dkLen:w,asyncTick:H,maxmem:Z,onProgress:z}=G;if(I0(Y,"N"),I0($,"r"),I0(K,"p"),I0(w,"dkLen"),I0(H,"asyncTick"),I0(Z,"maxmem"),z!==void 0&&typeof z!=="function")throw Error("progressCb must be a function");let N=128*$,F=N/4,Q=Math.pow(2,32);if(Y<=1||(Y&Y-1)!==0||Y>Q)throw Error('"N" expected a power of 2, and 2^1 <= N <= 2^32');if(K<1||K>(Q-1)*32/N)throw Error('"p" expected integer 1..((2^32 - 1) * 32) / (128 * r)');if(w<1||w>(Q-1)*32)throw Error('"dkLen" expected integer 1..(2^32 - 1) * 32');if(N*(Y+K)>Z)throw Error('"maxmem" limit was hit, expected 128*r*(N+p) <= "maxmem"='+Z);let v=RF(UY,J,W,{c:1,dkLen:N*K}),M=BK(v),O=BK(new Uint8Array(N*Y)),S=BK(new Uint8Array(N)),T=()=>{};if(z){let j=2*Y*K,q=Math.max(Math.floor(j/1e4),1),_=0;T=()=>{if(_++,z&&(!(_%q)||_===j))z(_/j)}}return{N:Y,r:$,p:K,dkLen:w,blockSize32:F,V:O,B32:M,B:v,tmp:S,blockMixCb:T,asyncTick:H}}function kh(J,W,X,G,Y){let $=RF(UY,J,X,{c:1,dkLen:W});return b0(X,G,Y),$}async function US(J,W,X){let{N:G,r:Y,p:$,dkLen:K,blockSize32:w,V:H,B32:Z,B:z,tmp:N,blockMixCb:F,asyncTick:Q}=bh(J,W,X);qF(Z);for(let V=0;V<$;V++){let v=w*V;for(let O=0;O<w;O++)H[O]=Z[v+O];let M=0;await AK(G-1,Q,()=>{hF(H,M,H,M+=w,Y),F()}),hF(H,(G-1)*w,Z,v,Y),F(),await AK(G,Q,()=>{let O=(Z[v+w-16]&G-1)>>>0;for(let S=0;S<w;S++)N[S]=Z[v+S]^H[O*w+S];hF(N,0,Z,v,Y),F()})}return qF(Z),kh(J,K,z,H,N)}var QS=D(()=>{o_();kF();mW()});function LS(J){switch(J){case"a-z":return"abcdefghijklmnopqrstuvwxyz";case"A-Z":return"ABCDEFGHIJKLMNOPQRSTUVWXYZ";case"0-9":return"0123456789";case"-_":return"-_";default:throw Error(`Unsupported alphabet: ${J}`)}}function QY(...J){let W=J.map(LS).join("");if(W.length===0)throw Error("No valid characters provided for random string generation.");let X=W.length;return(G,...Y)=>{if(G<=0)throw Error("Length must be a positive integer.");let $=W,K=X;if(Y.length>0)$=Y.map(LS).join(""),K=$.length;let w=Math.floor(256/K)*K,H=new Uint8Array(G*2),Z=H.length,z="",N=Z,F;while(z.length<G){if(N>=Z)crypto.getRandomValues(H),N=0;if(F=H[N++],F<w)z+=$[F%K]}return z}}var IK=()=>{};function fF(J,W){if(typeof J==="string")J=new TextEncoder().encode(J);if(typeof W==="string")W=new TextEncoder().encode(W);let X=new Uint8Array(J),G=new Uint8Array(W),Y=X.length^G.length,$=Math.max(X.length,G.length);for(let K=0;K<$;K++)Y|=(K<X.length?X[K]:0)^(K<G.length?G[K]:0);return Y===0}async function VS(J,W){return await US(J.normalize("NFKC"),W,{N:LY.N,p:LY.p,r:LY.r,dkLen:LY.dkLen,maxmem:128*LY.N*LY.r*2})}var LY,DS=async(J)=>{let W=ZY.encode(crypto.getRandomValues(new Uint8Array(16))),X=await VS(J,W);return`${W}:${ZY.encode(X)}`},vS=async({hash:J,password:W})=>{let[X,G]=J.split(":");if(!X||!G)throw new W6("Invalid password hash");return fF(await VS(W,X),i_(G))},t6,JJ=async({key:J,data:W})=>{let X=await C0("SHA-256").digest(J),G=A_(W);return MF(jF(TF)(new Uint8Array(X)).encrypt(G))},WJ=async({key:J,data:W})=>{let X=await C0("SHA-256").digest(J),G=B_(W),Y=jF(TF)(new Uint8Array(X));return new TextDecoder().decode(Y.decrypt(G))};var r4=D(()=>{R4();eJ();d_();O9();qK();QS();mW();IK();LY={N:16384,r:16,p:1,dkLen:64};t6=QY("a-z","0-9","A-Z","-_")});async function bK(){return hh}var hh;var kK=D(()=>{hh=import("async_hooks").then((J)=>J.AsyncLocalStorage).catch((J)=>{if("AsyncLocalStorage"in globalThis)return globalThis.AsyncLocalStorage;throw console.warn("[better-auth] Warning: AsyncLocalStorage is not available in this environment. Some features may not work as expected."),console.warn("[better-auth] Please read more about this warning at https://better-auth.com/docs/installation#mount-handler"),console.warn("[better-auth] If you are using Cloudflare Workers, please see: https://developers.cloudflare.com/workers/configuration/compatibility-flags/#nodejs-compatibility-flag"),J})});async function F8(){let J=(await MS()).getStore();if(!J)throw Error("No auth context found. Please make sure you are calling this function within a `runWithEndpointContext` callback.");return J}async function VY(J,W){return(await MS()).run(J,W)}async function lF(){return(await uF()).getStore()!==void 0}async function xF(){let J=(await uF()).getStore();if(!J)throw Error("No request state found. Please make sure you are calling this function within a `runWithRequestState` callback.");return J}async function cF(J,W){return(await uF()).run(J,W)}function pF(J){let W=Object.freeze({});return{get ref(){return W},async get(){let X=await xF();if(!X.has(W)){let G=await J();return X.set(W,G),G}return X.get(W)},async set(X){(await xF()).set(W,X)}}}var gF=null,MS=async()=>{if(!gF)gF=new(await bK());return gF},mF=null,uF=async()=>{if(!mF)mF=new(await bK());return mF},yF=null,dF=async()=>{if(!yF)yF=new(await bK());return yF},s=async(J)=>{return dF().then((W)=>{return W.getStore()||J}).catch(()=>{return J})},nF=async(J,W)=>{let X=!0;return dF().then((G)=>{return X=!0,G.run(J,W)}).catch((G)=>{if(!X)return W();throw G})},S9=async(J,W)=>{let X=!0;return dF().then((G)=>{return X=!0,J.transaction(async(Y)=>{return G.run(Y,W)})}).catch((G)=>{if(!X)return W();throw G})};var rF=D(()=>{kK()});var MJ=D(()=>{kK();rF()});function tF(){return{root:{key:""},static:new hK}}function oF(J){return J.split("/").filter(Boolean)}function OS(J,W){let X=new hK;for(let[G,Y]of W){let $=G<0?J.slice(-1*G).join("/"):J[G];if(typeof Y==="string")X[Y]=$;else{let K=$.match(Y);if(K)for(let w in K.groups)X[w]=K.groups[w]}}return X}function sF(J,W="",X,G){let Y=oF(X),$=J.root,K=0,w=[];for(let Z=0;Z<Y.length;Z++){let z=Y[Z];if(z.startsWith("**")){if(!$.wildcard)$.wildcard={key:"**"};$=$.wildcard,w.push([-Z,z.split(":")[1]||"_",z.length===2]);break}if(z==="*"||z.includes(":")){if(!$.param)$.param={key:"*"};$=$.param;let F=z==="*";w.push([Z,F?`_${K++}`:fh(z),F]);continue}let N=$.static?.[z];if(N)$=N;else{let F={key:z};if(!$.static)$.static=new hK;$.static[z]=F,$=F}}let H=w.length>0;if(!$.methods)$.methods=new hK;if(!$.methods[W])$.methods[W]=[];if($.methods[W].push({data:G||null,paramsMap:H?w:void 0}),!H)J.static[X]=$}function fh(J){if(!J.includes(":",1))return J.slice(1);let W=J.replace(/:(\w+)/g,(X,G)=>`(?<${G}>\\w+)`);return new RegExp(`^${W}$`)}function PS(J,W="",X,G){if(X[X.length-1]==="/")X=X.slice(0,-1);let Y=J.static[X];if(Y&&Y.methods){let w=Y.methods[W]||Y.methods[""];if(w!==void 0)return w[0]}let $=oF(X),K=iF(J,J.root,W,$,0)?.[0];if(K===void 0)return;if(G?.params===!1)return K;return{data:K.data,params:K.paramsMap?OS($,K.paramsMap):void 0}}function iF(J,W,X,G,Y){if(Y===G.length){if(W.methods){let K=W.methods[X]||W.methods[""];if(K)return K}if(W.param&&W.param.methods){let K=W.param.methods[X]||W.param.methods[""];if(K){let w=K[0].paramsMap;if(w?.[w?.length-1]?.[2])return K}}if(W.wildcard&&W.wildcard.methods){let K=W.wildcard.methods[X]||W.wildcard.methods[""];if(K){let w=K[0].paramsMap;if(w?.[w?.length-1]?.[2])return K}}return}let $=G[Y];if(W.static){let K=W.static[$];if(K){let w=iF(J,K,X,G,Y+1);if(w)return w}}if(W.param){let K=iF(J,W.param,X,G,Y+1);if(K)return K}if(W.wildcard&&W.wildcard.methods)return W.wildcard.methods[X]||W.wildcard.methods[""];return}function jS(J,W="",X,G){if(X[X.length-1]==="/")X=X.slice(0,-1);let Y=oF(X),$=aF(J,J.root,W,Y,0);if(G?.params===!1)return $;return $.map((K)=>{return{data:K.data,params:K.paramsMap?OS(Y,K.paramsMap):void 0}})}function aF(J,W,X,G,Y,$=[]){let K=G[Y];if(W.wildcard&&W.wildcard.methods){let H=W.wildcard.methods[X]||W.wildcard.methods[""];if(H)$.push(...H)}if(W.param){if(aF(J,W.param,X,G,Y+1,$),Y===G.length&&W.param.methods){let H=W.param.methods[X]||W.param.methods[""];if(H)$.push(...H)}}let w=W.static?.[K];if(w)aF(J,w,X,G,Y+1,$);if(Y===G.length&&W.methods){let H=W.methods[X]||W.methods[""];if(H)$.push(...H)}return $}var hK;var _S=D(()=>{hK=(()=>{let J=function(){};return J.prototype=Object.create(null),J})()});function gh(){let J=Object.getOwnPropertyDescriptor(Error,"stackTraceLimit");if(J===void 0)return Object.isExtensible(Error);return Object.prototype.hasOwnProperty.call(J,"writable")?J.writable:J.set!==void 0}function mh(J){let W=J.split(`
    at `);if(W.length<=1)return J;return W.splice(1,1),W.join(`
    at `)}function yh(J,W){class X extends J{#J;constructor(...G){if(gh()){let $=Error.stackTraceLimit;Error.stackTraceLimit=0;super(...G);Error.stackTraceLimit=$}else super(...G);let Y=Error().stack;if(Y)this.#J=mh(Y.replace(/^Error/,this.name))}get errorStack(){return this.#J}}return Object.defineProperty(X.prototype,"constructor",{get(){return W},enumerable:!1,configurable:!0}),X}async function ch(J,W){let X=J.headers.get("content-type")||"",G=X.toLowerCase();if(!J.body)return;if(W&&W.length>0){if(!W.some((Y)=>{let $=G.split(";")[0].trim(),K=Y.toLowerCase().trim();return $===K||$.includes(K)})){if(!G)throw new L(415,{message:`Content-Type is required. Allowed types: ${W.join(", ")}`,code:"UNSUPPORTED_MEDIA_TYPE"});throw new L(415,{message:`Content-Type "${X}" is not allowed. Allowed types: ${W.join(", ")}`,code:"UNSUPPORTED_MEDIA_TYPE"})}}if(G.includes("application/json"))return await J.json();if(G.includes("application/x-www-form-urlencoded")){let Y=await J.formData(),$={};return Y.forEach((K,w)=>{$[w]=K.toString()}),$}if(G.includes("multipart/form-data")){let Y=await J.formData(),$={};return Y.forEach((K,w)=>{$[w]=K}),$}if(G.includes("text/plain"))return await J.text();if(G.includes("application/octet-stream"))return await J.arrayBuffer();if(G.includes("application/pdf")||G.includes("image/")||G.includes("video/"))return await J.blob();if(G.includes("application/stream")||J.body instanceof ReadableStream)return J.body;return await J.text()}function yK(J){return J instanceof L||J?.name==="APIError"}function ph(J){try{return J.includes("%")?decodeURIComponent(J):J}catch{return J}}function dh(J){if(J===void 0)return!1;let W=typeof J;if(W==="string"||W==="number"||W==="boolean"||W===null)return!0;if(W!=="object")return!1;if(Array.isArray(J))return!0;if(J.buffer)return!1;return J.constructor&&J.constructor.name==="Object"||typeof J.toJSON==="function"}function nh(J,W,X){let G=0,Y=new WeakMap;return JSON.stringify(J,(K,w)=>{if(typeof w==="bigint")return w.toString();if(typeof w==="object"&&w!==null){if(Y.has(w))return`[Circular ref-${Y.get(w)}]`;Y.set(w,G++)}if(W)return W(K,w);return w},X)}function rh(J){if(!J||typeof J!=="object")return!1;return"_flag"in J&&J._flag==="json"}function lW(J,W){if(J instanceof Response){if(W?.headers instanceof Headers)W.headers.forEach((Y,$)=>{J.headers.set($,Y)});return J}if(rh(J)){let{body:Y,routerResponse:$}=J;if($ instanceof Response)return $;let K=new Headers;if($?.headers){let w=new Headers($.headers);for(let[H,Z]of w.entries())w.set(H,Z)}if(J.headers)for(let[w,H]of new Headers(J.headers).entries())K.set(w,H);if(W?.headers)for(let[w,H]of new Headers(W.headers).entries())K.set(w,H);return K.set("Content-Type","application/json"),new Response(JSON.stringify(Y),{...$,headers:K,status:J.status??W?.status??$?.status,statusText:W?.statusText??$?.statusText})}if(yK(J))return lW(J.body,{status:W?.status??J.statusCode,statusText:J.status.toString(),headers:W?.headers||J.headers});let X=J,G=new Headers(W?.headers);if(!J){if(J===null)X=JSON.stringify(null);G.set("content-type","application/json")}else if(typeof J==="string")X=J,G.set("Content-Type","text/plain");else if(J instanceof ArrayBuffer||ArrayBuffer.isView(J))X=J,G.set("Content-Type","application/octet-stream");else if(J instanceof Blob)X=J,G.set("Content-Type",J.type||"application/octet-stream");else if(J instanceof FormData)X=J;else if(J instanceof URLSearchParams)X=J,G.set("Content-Type","application/x-www-form-urlencoded");else if(J instanceof ReadableStream)X=J,G.set("Content-Type","application/octet-stream");else if(dh(J))X=nh(J),G.set("Content-Type","application/json");return new Response(X,{...W,headers:G})}async function ih(J,W={}){let X={body:W.body,query:W.query};if(J.body){let G=await J.body["~standard"].validate(W.body);if(G.issues)return{data:null,error:SS(G.issues,"body")};X.body=G.value}if(J.query){let G=await J.query["~standard"].validate(W.query);if(G.issues)return{data:null,error:SS(G.issues,"query")};X.query=G.value}if(J.requireHeaders&&!W.headers)return{data:null,error:{message:"Headers is required"}};if(J.requireRequest&&!W.request)return{data:null,error:{message:"Request is required"}};return{data:X,error:null}}function SS(J,W){let X=[];for(let G of J){let Y=G.message;X.push(Y)}return{message:`Invalid ${W} parameters`}}function sh(J){if(typeof J!=="string")throw TypeError("argument str must be a string");let W=new Map,X=0;while(X<J.length){let G=J.indexOf("=",X);if(G===-1)break;let Y=J.indexOf(";",X);if(Y===-1)Y=J.length;else if(Y<G){X=J.lastIndexOf(";",G-1)+1;continue}let $=J.slice(X,G).trim();if(!W.has($)){let K=J.slice(G+1,Y).trim();if(K.codePointAt(0)===34)K=K.slice(1,-1);W.set($,ph(K))}X=Y+1}return W}function A9(J,W,X){let G=typeof J==="string"?J:void 0,Y=typeof W==="object"?W:J,$=typeof W==="function"?W:X;if((Y.method==="GET"||Y.method==="HEAD")&&Y.body)throw new lh("Body is not allowed with GET or HEAD methods");let K=async(...w)=>{let H=w[0]||{},Z=await dS(H,{options:Y,path:G}),z=await $(Z).catch(async(Q)=>{if(yK(Q)){let V=Y.onAPIError;if(V)await V(Q);if(H.asResponse)return Q}throw Q}),N=Z.responseHeaders,F=Z.responseStatus;return H.asResponse?lW(z,{headers:N,status:F}):H.returnHeaders?H.returnStatus?{headers:N,response:z,status:F}:{headers:N,response:z}:H.returnStatus?{response:z,status:F}:z};return K.options=Y,K.path=G,K}function fX(J,W){let X=async(G)=>{let Y=G,$=typeof J==="function"?J:W,K=await dS(Y,{options:typeof J==="function"?{}:J,path:"/"});if(!$)throw Error("handler must be defined");let w=await $(K),H=K.responseHeaders;return Y.returnHeaders?{headers:H,response:w}:w};return X.options=typeof J==="function"?{}:J,X}function U6(J,W,X){function G(w,H){var Z;Object.defineProperty(w,"_zod",{value:w._zod??{},enumerable:!1}),(Z=w._zod).traits??(Z.traits=new Set),w._zod.traits.add(J),W(w,H);for(let z in K.prototype)if(!(z in w))Object.defineProperty(w,z,{value:K.prototype[z].bind(w)});w._zod.constr=K,w._zod.def=H}let Y=X?.Parent??Object;class $ extends Y{}Object.defineProperty($,"name",{value:J});function K(w){var H;let Z=X?.Parent?new $:this;G(Z,w),(H=Z._zod).deferred??(H.deferred=[]);for(let z of Z._zod.deferred)z();return Z}return Object.defineProperty(K,"init",{value:G}),Object.defineProperty(K,Symbol.hasInstance,{value:(w)=>{if(X?.Parent&&w instanceof X.Parent)return!0;return w?._zod?.traits?.has(J)}}),Object.defineProperty(K,"name",{value:J}),K}function gX(J){if(J)Object.assign(JN,J);return JN}function Jf(J){let W=Object.values(J).filter((X)=>typeof X==="number");return Object.entries(J).filter(([X,G])=>W.indexOf(+X)===-1).map(([X,G])=>G)}function Wf(J,W){if(typeof W==="bigint")return W.toString();return W}function nS(J){return{get value(){{let W=J();return Object.defineProperty(this,"value",{value:W}),W}throw Error("cached value already set")}}}function KN(J){return J===null||J===void 0}function wN(J){let W=J.startsWith("^")?1:0,X=J.endsWith("$")?J.length-1:J.length;return J.slice(W,X)}function M4(J,W,X){Object.defineProperty(J,W,{get(){{let G=X();return J[W]=G,G}throw Error("cached value already set")},set(G){Object.defineProperty(J,W,{value:G})},configurable:!0})}function rS(J,W,X){Object.defineProperty(J,W,{value:X,writable:!0,enumerable:!0,configurable:!0})}function T9(J){return JSON.stringify(J)}function WN(J){return typeof J==="object"&&J!==null&&!Array.isArray(J)}function XN(J){if(WN(J)===!1)return!1;let W=J.constructor;if(W===void 0)return!0;let X=W.prototype;if(WN(X)===!1)return!1;if(Object.prototype.hasOwnProperty.call(X,"isPrototypeOf")===!1)return!1;return!0}function Gf(J){return J.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function yX(J,W,X){let G=new J._zod.constr(W??J._zod.def);if(!W||X?.parent)G._zod.parent=J;return G}function XJ(J){let W=J;if(!W)return{};if(typeof W==="string")return{error:()=>W};if(W?.message!==void 0){if(W?.error!==void 0)throw Error("Cannot specify both `message` and `error` params");W.error=W.message}if(delete W.message,typeof W.error==="string")return{...W,error:()=>W.error};return W}function $f(J){return Object.keys(J).filter((W)=>{return J[W]._zod.optin==="optional"&&J[W]._zod.optout==="optional"})}function Kf(J,W){let X={},G=J._zod.def;for(let Y in W){if(!(Y in G.shape))throw Error(`Unrecognized key: "${Y}"`);if(!W[Y])continue;X[Y]=G.shape[Y]}return yX(J,{...J._zod.def,shape:X,checks:[]})}function wf(J,W){let X={...J._zod.def.shape},G=J._zod.def;for(let Y in W){if(!(Y in G.shape))throw Error(`Unrecognized key: "${Y}"`);if(!W[Y])continue;delete X[Y]}return yX(J,{...J._zod.def,shape:X,checks:[]})}function Hf(J,W){if(!XN(W))throw Error("Invalid input to extend: expected a plain object");return yX(J,{...J._zod.def,get shape(){let X={...J._zod.def.shape,...W};return rS(this,"shape",X),X},checks:[]})}function Zf(J,W){return yX(J,{...J._zod.def,get shape(){let X={...J._zod.def.shape,...W._zod.def.shape};return rS(this,"shape",X),X},catchall:W._zod.def.catchall,checks:[]})}function zf(J,W,X){let G=W._zod.def.shape,Y={...G};if(X)for(let $ in X){if(!($ in G))throw Error(`Unrecognized key: "${$}"`);if(!X[$])continue;Y[$]=J?new J({type:"optional",innerType:G[$]}):G[$]}else for(let $ in G)Y[$]=J?new J({type:"optional",innerType:G[$]}):G[$];return yX(W,{...W._zod.def,shape:Y,checks:[]})}function Ff(J,W,X){let G=W._zod.def.shape,Y={...G};if(X)for(let $ in X){if(!($ in Y))throw Error(`Unrecognized key: "${$}"`);if(!X[$])continue;Y[$]=new J({type:"nonoptional",innerType:G[$]})}else for(let $ in G)Y[$]=new J({type:"nonoptional",innerType:G[$]});return yX(W,{...W._zod.def,shape:Y,checks:[]})}function q9(J,W=0){for(let X=W;X<J.issues.length;X++)if(J.issues[X]?.continue!==!0)return!0;return!1}function HN(J,W){return W.map((X)=>{var G;return(G=X).path??(G.path=[]),X.path.unshift(J),X})}function fK(J){return typeof J==="string"?J:J?.message}function mX(J,W,X){let G={...J,path:J.path??[]};if(!J.message)G.message=fK(J.inst?._zod.def?.error?.(J))??fK(W?.error?.(J))??fK(X.customError?.(J))??fK(X.localeError?.(J))??"Invalid input";if(delete G.inst,delete G.continue,!W?.reportInput)delete G.input;return G}function ZN(J){if(Array.isArray(J))return"array";if(typeof J==="string")return"string";return"unknown"}function R9(...J){let[W,X,G]=J;if(typeof W==="string")return{message:W,code:"custom",input:X,inst:G};return{...W}}function Nf(J,W=(X)=>X.message){let X={},G=[];for(let Y of J.issues)if(Y.path.length>0)X[Y.path[0]]=X[Y.path[0]]||[],X[Y.path[0]].push(W(Y));else G.push(W(Y));return{formErrors:G,fieldErrors:X}}function Uf(J,W){let X=W||function($){return $.message},G={_errors:[]},Y=($)=>{for(let K of $.issues)if(K.code==="invalid_union"&&K.errors.length)K.errors.map((w)=>Y({issues:w}));else if(K.code==="invalid_key")Y({issues:K.issues});else if(K.code==="invalid_element")Y({issues:K.issues});else if(K.path.length===0)G._errors.push(X(K));else{let w=G,H=0;while(H<K.path.length){let Z=K.path[H];if(H!==K.path.length-1)w[Z]=w[Z]||{_errors:[]};else w[Z]=w[Z]||{_errors:[]},w[Z]._errors.push(X(K));w=w[Z],H++}}};return Y(J),G}function qS(J,W,X){if(J.issues.length)W.issues.push(...HN(X,J.issues));W.value[X]=J.value}function gK(J,W,X){if(J.issues.length)W.issues.push(...HN(X,J.issues));W.value[X]=J.value}function BS(J,W,X,G){if(J.issues.length)if(G[X]===void 0)if(X in G)W.value[X]=void 0;else W.value[X]=J.value;else W.issues.push(...HN(X,J.issues));else if(J.value===void 0){if(X in G)W.value[X]=void 0}else W.value[X]=J.value}function AS(J,W,X,G){for(let Y of J)if(Y.issues.length===0)return W.value=Y.value,W;return W.issues.push({code:"invalid_union",input:W.value,inst:X,errors:J.map((Y)=>Y.issues.map(($)=>mX($,G,gX())))}),W}function YN(J,W){if(J===W)return{valid:!0,data:J};if(J instanceof Date&&W instanceof Date&&+J===+W)return{valid:!0,data:J};if(XN(J)&&XN(W)){let X=Object.keys(W),G=Object.keys(J).filter(($)=>X.indexOf($)!==-1),Y={...J,...W};for(let $ of G){let K=YN(J[$],W[$]);if(!K.valid)return{valid:!1,mergeErrorPath:[$,...K.mergeErrorPath]};Y[$]=K.data}return{valid:!0,data:Y}}if(Array.isArray(J)&&Array.isArray(W)){if(J.length!==W.length)return{valid:!1,mergeErrorPath:[]};let X=[];for(let G=0;G<J.length;G++){let Y=J[G],$=W[G],K=YN(Y,$);if(!K.valid)return{valid:!1,mergeErrorPath:[G,...K.mergeErrorPath]};X.push(K.data)}return{valid:!0,data:X}}return{valid:!1,mergeErrorPath:[]}}function ES(J,W,X){if(W.issues.length)J.issues.push(...W.issues);if(X.issues.length)J.issues.push(...X.issues);if(q9(J))return J;let G=YN(W.value,X.value);if(!G.valid)throw Error(`Unmergable intersection. Error path: ${JSON.stringify(G.mergeErrorPath)}`);return J.value=G.data,J}function RS(J,W){if(J.value===void 0)J.value=W.defaultValue;return J}function CS(J,W){if(!J.issues.length&&J.value===void 0)J.issues.push({code:"invalid_type",expected:"nonoptional",input:J.value,inst:W});return J}function IS(J,W,X){if(q9(J))return J;return W.out._zod.run({value:J.value,issues:J.issues},X)}function bS(J){return J.value=Object.freeze(J.value),J}function kS(J,W,X,G){if(!J){let Y={code:"custom",input:X,inst:G,path:[...G._zod.def.path??[]],continue:!G._zod.def.abort};if(G._zod.def.params)Y.params=G._zod.def.params;W.issues.push(R9(Y))}}function lf(){return new uf}function cf(J){return new J({type:"unknown"})}function pf(J,W){return new J({type:"never",...XJ(W)})}function df(J,W){return new vf({check:"max_length",...XJ(W),maximum:J})}function hS(J,W){return new Mf({check:"min_length",...XJ(W),minimum:J})}function nf(J,W){return new Of({check:"length_equals",...XJ(W),length:J})}function rf(J){return new Pf({check:"overwrite",tx:J})}function af(J,W,X){return new J({type:"array",element:W,...XJ(X)})}function tf(J,W,X){return new J({type:"custom",check:"custom",fn:W,...XJ(X)})}function fS(){return cf(Wg)}function Yg(J){return pf(Xg,J)}function $g(J,W){return af(Gg,J,W)}function wg(J,W){return new Kg({type:"union",options:J,...XJ(W)})}function Zg(J,W){return new Hg({type:"intersection",left:J,right:W})}function zg(J,W){return new GN({type:"enum",entries:Array.isArray(J)?Object.fromEntries(J.map((X)=>[X,X])):J,...XJ(W)})}function Ng(J){return new Fg({type:"transform",transform:J})}function gS(J){return new B9({type:"optional",innerType:J})}function mS(J){return new Ug({type:"nullable",innerType:J})}function Lg(J,W){return new Qg({type:"default",innerType:J,get defaultValue(){return typeof W==="function"?W():W}})}function Dg(J,W){return new Vg({type:"prefault",innerType:J,get defaultValue(){return typeof W==="function"?W():W}})}function vg(J,W){return new WT({type:"nonoptional",innerType:J,...XJ(W)})}function Og(J,W){return new Mg({type:"catch",innerType:J,catchValue:typeof W==="function"?W:()=>W})}function yS(J,W){return new Pg({type:"pipe",in:J,out:W})}function _g(J){return new jg({type:"readonly",innerType:J})}function Tg(J){let W=new DY({check:"custom"});return W._zod.check=J,W}function qg(J,W={}){return tf(Sg,J,W)}function Bg(J){let W=Tg((X)=>{return X.addIssue=(G)=>{if(typeof G==="string")X.issues.push(R9(G,X.value,W._zod.def));else{let Y=G;if(Y.fatal)Y.continue=!1;Y.code??(Y.code="custom"),Y.input??(Y.input=X.value),Y.inst??(Y.inst=W),Y.continue??(Y.continue=!W._zod.def.abort),X.issues.push(R9(Y))}},J(X.value,X)});return W}function XT(J){switch(J.constructor.name){case"ZodString":return"string";case"ZodNumber":return"number";case"ZodBoolean":return"boolean";case"ZodObject":return"object";case"ZodArray":return"array";default:return"string"}}function xS(J){let W=[];if(J.metadata?.openapi?.parameters)return W.push(...J.metadata.openapi.parameters),W;if(J.query instanceof xK)Object.entries(J.query.shape).forEach(([X,G])=>{if(G instanceof xK)W.push({name:X,in:"query",schema:{type:XT(G),..."minLength"in G&&G.minLength?{minLength:G.minLength}:{},description:G.description}})});return W}function Ag(J){if(J.metadata?.openapi?.requestBody)return J.metadata.openapi.requestBody;if(!J.body)return;if(J.body instanceof xK||J.body instanceof B9){let W=J.body.shape;if(!W)return;let X={},G=[];return Object.entries(W).forEach(([Y,$])=>{if($ instanceof xK){if(X[Y]={type:XT($),description:$.description},!($ instanceof B9))G.push(Y)}}),{required:J.body instanceof B9?!1:J.body?!0:!1,content:{"application/json":{schema:{type:"object",properties:X,required:G}}}}}}function uS(J){return{"400":{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}},required:["message"]}}},description:"Bad Request. Usually due to missing parameters, or invalid parameters."},"401":{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}},required:["message"]}}},description:"Unauthorized. Due to missing or invalid authentication."},"403":{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}}}}},description:"Forbidden. You do not have permission to access this resource or to perform this action."},"404":{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}}}}},description:"Not Found. The requested resource was not found."},"429":{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}}}}},description:"Too Many Requests. You have exceeded the rate limit. Try again later."},"500":{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}}}}},description:"Internal Server Error. This is a problem with the server that you cannot fix."},...J}}async function Eg(J,W){let X={schemas:{}};return Object.entries(J).forEach(([G,Y])=>{let $=Y.options;if(!Y.path||$.metadata?.SERVER_ONLY)return;if($.method==="GET")eF[Y.path]={get:{tags:["Default",...$.metadata?.openapi?.tags||[]],description:$.metadata?.openapi?.description,operationId:$.metadata?.openapi?.operationId,security:[{bearerAuth:[]}],parameters:xS($),responses:uS($.metadata?.openapi?.responses)}};if($.method==="POST"){let K=Ag($);eF[Y.path]={post:{tags:["Default",...$.metadata?.openapi?.tags||[]],description:$.metadata?.openapi?.description,operationId:$.metadata?.openapi?.operationId,security:[{bearerAuth:[]}],parameters:xS($),...K?{requestBody:K}:{requestBody:{content:{"application/json":{schema:{type:"object",properties:{}}}}}},responses:uS($.metadata?.openapi?.responses)}}}}),{openapi:"3.1.1",info:{title:"Better Auth",description:"API Reference for your Better Auth Instance",version:"1.1.0"},components:X,security:[{apiKeyCookie:[]}],servers:[{url:W?.url}],tags:[{name:"Default",description:"Default endpoints that are included with Better Auth by default. These endpoints are not part of any plugin."}],paths:eF}}var xh,uh,lh,L,$N,lS=async(J)=>{let W=typeof J==="string"?new TextEncoder().encode(J):J;return await z8().importKey("raw",W,$N,!1,["sign","verify"])},ah=async(J,W,X)=>{try{let G=atob(J),Y=new Uint8Array(G.length);for(let $=0,K=G.length;$<K;$++)Y[$]=G.charCodeAt($);return await z8().verify($N,X,Y,new TextEncoder().encode(W))}catch(G){return!1}},th=async(J,W)=>{let X=await lS(W),G=await z8().sign($N.name,X,new TextEncoder().encode(J));return btoa(String.fromCharCode(...new Uint8Array(G)))},oh=async(J,W)=>{let X=await th(J,W);return J=`${J}.${X}`,J=encodeURIComponent(J),J},TS=(J,W)=>{let X=J;if(W)if(W==="secure")X="__Secure-"+J;else if(W==="host")X="__Host-"+J;else return;return X},cS=(J,W,X={})=>{let G;if(X?.prefix==="secure")G=`${`__Secure-${J}`}=${W}`;else if(X?.prefix==="host")G=`${`__Host-${J}`}=${W}`;else G=`${J}=${W}`;if(J.startsWith("__Secure-")&&!X.secure)X.secure=!0;if(J.startsWith("__Host-")){if(!X.secure)X.secure=!0;if(X.path!=="/")X.path="/";if(X.domain)X.domain=void 0}if(X&&typeof X.maxAge==="number"&&X.maxAge>=0){if(X.maxAge>34560000)throw Error("Cookies Max-Age SHOULD NOT be greater than 400 days (34560000 seconds) in duration.");G+=`; Max-Age=${Math.floor(X.maxAge)}`}if(X.domain&&X.prefix!=="host")G+=`; Domain=${X.domain}`;if(X.path)G+=`; Path=${X.path}`;if(X.expires){if(X.expires.getTime()-Date.now()>34560000000)throw Error("Cookies Expires SHOULD NOT be greater than 400 days (34560000 seconds) in the future.");G+=`; Expires=${X.expires.toUTCString()}`}if(X.httpOnly)G+="; HttpOnly";if(X.secure)G+="; Secure";if(X.sameSite)G+=`; SameSite=${X.sameSite.charAt(0).toUpperCase()+X.sameSite.slice(1)}`;if(X.partitioned){if(!X.secure)X.secure=!0;G+="; Partitioned"}return G},eh=(J,W,X)=>{return W=encodeURIComponent(W),cS(J,W,X)},pS=async(J,W,X,G)=>{return W=await oh(W,X),cS(J,W,G)},dS=async(J,{options:W,path:X})=>{let G=new Headers,Y=void 0,{data:$,error:K}=await ih(W,J);if(K)throw new L(400,{message:K.message,code:"VALIDATION_ERROR"});let w="headers"in J?J.headers instanceof Headers?J.headers:new Headers(J.headers):("request"in J)&&J.request instanceof Request?J.request.headers:null,H=w?.get("cookie"),Z=H?sh(H):void 0,z={...J,body:$.body,query:$.query,path:J.path||X||"virtual:",context:"context"in J&&J.context?J.context:{},returned:void 0,headers:J?.headers,request:J?.request,params:"params"in J?J.params:void 0,method:J.method,setHeader:(N,F)=>{G.set(N,F)},getHeader:(N)=>{if(!w)return null;return w.get(N)},getCookie:(N,F)=>{let Q=TS(N,F);if(!Q)return null;return Z?.get(Q)||null},getSignedCookie:async(N,F,Q)=>{let V=TS(N,Q);if(!V)return null;let v=Z?.get(V);if(!v)return null;let M=v.lastIndexOf(".");if(M<1)return null;let O=v.substring(0,M),S=v.substring(M+1);if(S.length!==44||!S.endsWith("="))return null;return await ah(S,O,await lS(F))?O:!1},setCookie:(N,F,Q)=>{let V=eh(N,F,Q);return G.append("set-cookie",V),V},setSignedCookie:async(N,F,Q,V)=>{let v=await pS(N,F,Q,V);return G.append("set-cookie",v),v},redirect:(N)=>{return G.set("location",N),new L("FOUND",void 0,G)},error:(N,F,Q)=>{return new L(N,F,Q)},setStatus:(N)=>{Y=N},json:(N,F)=>{if(!J.asResponse)return N;return{body:F?.body||N,routerResponse:F,_flag:"json"}},responseHeaders:G,get responseStatus(){return Y}};for(let N of W.use||[]){let F=await N({...z,returnHeaders:!0,asResponse:!1});if(F.response)Object.assign(z.context,F.response);if(F.headers)F.headers.forEach((Q,V)=>{z.responseHeaders.set(V,Q)})}return z},HH6,ZH6,E9,JN,iS,Xf,Yf,zH6,aS=(J,W)=>{J.name="$ZodError",Object.defineProperty(J,"_zod",{value:J._zod,enumerable:!1}),Object.defineProperty(J,"issues",{value:W,enumerable:!1}),Object.defineProperty(J,"message",{get(){return JSON.stringify(W,Wf,2)},enumerable:!0}),Object.defineProperty(J,"toString",{value:()=>J.message,enumerable:!1})},tS,oS,Qf=(J)=>(W,X,G,Y)=>{let $=G?Object.assign(G,{async:!1}):{async:!1},K=W._zod.run({value:X,issues:[]},$);if(K instanceof Promise)throw new E9;if(K.issues.length){let w=new(Y?.Err??J)(K.issues.map((H)=>mX(H,$,gX())));throw iS(w,Y?.callee),w}return K.value},Lf=(J)=>async(W,X,G,Y)=>{let $=G?Object.assign(G,{async:!0}):{async:!0},K=W._zod.run({value:X,issues:[]},$);if(K instanceof Promise)K=await K;if(K.issues.length){let w=new(Y?.Err??J)(K.issues.map((H)=>mX(H,$,gX())));throw iS(w,Y?.callee),w}return K.value},sS=(J)=>(W,X,G)=>{let Y=G?{...G,async:!1}:{async:!1},$=W._zod.run({value:X,issues:[]},Y);if($ instanceof Promise)throw new E9;return $.issues.length?{success:!1,error:new(J??tS)($.issues.map((K)=>mX(K,Y,gX())))}:{success:!0,data:$.value}},Vf,eS=(J)=>async(W,X,G)=>{let Y=G?Object.assign(G,{async:!0}):{async:!0},$=W._zod.run({value:X,issues:[]},Y);if($ instanceof Promise)$=await $;return $.issues.length?{success:!1,error:new J($.issues.map((K)=>mX(K,Y,gX())))}:{success:!0,data:$.value}},Df,DY,vf,Mf,Of,Pf,jf=class{constructor(J=[]){if(this.content=[],this.indent=0,this)this.args=J}indented(J){this.indent+=1,J(this),this.indent-=1}write(J){if(typeof J==="function"){J(this,{execution:"sync"}),J(this,{execution:"async"});return}let W=J.split(`
`).filter((Y)=>Y),X=Math.min(...W.map((Y)=>Y.length-Y.trimStart().length)),G=W.map((Y)=>Y.slice(X)).map((Y)=>" ".repeat(this.indent*2)+Y);for(let Y of G)this.content.push(Y)}compile(){let J=Function,W=this?.args,X=[...(this?.content??[""]).map((G)=>`  ${G}`)];return new J(...W,X.join(`
`))}},_f,m4,Sf,Tf,qf,Bf,Af,Ef,Rf,Cf,If,bf,kf,hf,ff,gf,mf,yf,xf,FH6,NH6,uf=class{constructor(){this._map=new Map,this._idmap=new Map}add(J,...W){let X=W[0];if(this._map.set(J,X),X&&typeof X==="object"&&"id"in X){if(this._idmap.has(X.id))throw Error(`ID ${X.id} already exists in the registry`);this._idmap.set(X.id,J)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(J){let W=this._map.get(J);if(W&&typeof W==="object"&&"id"in W)this._idmap.delete(W.id);return this._map.delete(J),this}get(J){let W=J._zod.parent;if(W){let X={...this.get(W)??{}};return delete X.id,{...X,...this._map.get(J)}}return this._map.get(J)}has(J){return this._map.has(J)}},mK,JT=(J,W)=>{tS.init(J,W),J.name="ZodError",Object.defineProperties(J,{format:{value:(X)=>Uf(J,X)},flatten:{value:(X)=>Nf(J,X)},addIssue:{value:(X)=>J.issues.push(X)},addIssues:{value:(X)=>J.issues.push(...X)},isEmpty:{get(){return J.issues.length===0}}})},UH6,uK,of,sf,ef,Jg,Z0,Wg,Xg,Gg,xK,Kg,Hg,GN,Fg,B9,Ug,Qg,Vg,WT,Mg,Pg,jg,Sg,eF,Rg=(J,W)=>`<!doctype html>
<html>
  <head>
    <title>Scalar API Reference</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1" />
  </head>
  <body>
    <script
      id="api-reference"
      type="application/json">
    ${JSON.stringify(J)}
    </script>
	 <script>
      var configuration = {
	  	favicon: ${W?.logo?`data:image/svg+xml;utf8,${encodeURIComponent(W.logo)}`:void 0} ,
	   	theme: ${W?.theme||"saturn"},
        metaData: {
			title: ${W?.title||"Open API Reference"},
			description: ${W?.description||"Better Call Open API"},
		}
      }
      document.getElementById('api-reference').dataset.configuration =
        JSON.stringify(configuration)
    </script>
	  <script src="https://cdn.jsdelivr.net/npm/@scalar/api-reference"></script>
  </body>
</html>`,YT=(J,W)=>{if(!W?.openapi?.disabled){let $={path:"/api/reference",...W?.openapi};J.openapi=A9($.path,{method:"GET"},async(K)=>{let w=await Eg(J);return new Response(Rg(w,$.scalar),{headers:{"Content-Type":"text/html"}})})}let X=tF(),G=tF();for(let $ of Object.values(J)){if(!$.options||!$.path)continue;if($.options?.metadata?.SERVER_ONLY)continue;let K=Array.isArray($.options?.method)?$.options.method:[$.options?.method];for(let w of K)sF(X,w,$.path,$)}if(W?.routerMiddleware?.length)for(let{path:$,middleware:K}of W.routerMiddleware)sF(G,"*",$,K);let Y=async($)=>{let K=new URL($.url),w=W?.basePath?K.pathname.split(W.basePath).reduce((N,F,Q)=>{if(Q!==0)if(Q>1)N.push(`${W.basePath}${F}`);else N.push(F);return N},[]).join(""):K.pathname;if(!w?.length)return new Response(null,{status:404,statusText:"Not Found"});let H=PS(X,$.method,w);if(!H?.data)return new Response(null,{status:404,statusText:"Not Found"});let Z={};K.searchParams.forEach((N,F)=>{if(F in Z)if(Array.isArray(Z[F]))Z[F].push(N);else Z[F]=[Z[F],N];else Z[F]=N});let z=H.data;try{let N=z.options.metadata?.allowedMediaTypes||W?.allowedMediaTypes,F={path:w,method:$.method,headers:$.headers,params:H.params?JSON.parse(JSON.stringify(H.params)):{},request:$,body:z.options.disableBody?void 0:await ch(z.options.cloneRequest?$.clone():$,N),query:Z,_flag:"router",asResponse:!0,context:W?.routerContext},Q=jS(G,"*",w);if(Q?.length)for(let{data:V,params:v}of Q){let M=await V({...F,params:v,asResponse:!1});if(M instanceof Response)return M}return await z(F)}catch(N){if(W?.onError)try{let F=await W.onError(N);if(F instanceof Response)return lW(F)}catch(F){if(yK(F))return lW(F);throw F}if(W?.throwError)throw N;if(yK(N))return lW(N);return console.error("# SERVER_ERROR: ",N),new Response(null,{status:500,statusText:"Internal Server Error"})}};return{handler:async($)=>{let K=await W?.onRequest?.($);if(K instanceof Response)return K;let w=await Y(K instanceof Request?K:$),H=await W?.onResponse?.(w);if(H instanceof Response)return H;return w},endpoints:J}};var i4=D(()=>{IX();_S();xh={OK:200,CREATED:201,ACCEPTED:202,NO_CONTENT:204,MULTIPLE_CHOICES:300,MOVED_PERMANENTLY:301,FOUND:302,SEE_OTHER:303,NOT_MODIFIED:304,TEMPORARY_REDIRECT:307,BAD_REQUEST:400,UNAUTHORIZED:401,PAYMENT_REQUIRED:402,FORBIDDEN:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,NOT_ACCEPTABLE:406,PROXY_AUTHENTICATION_REQUIRED:407,REQUEST_TIMEOUT:408,CONFLICT:409,GONE:410,LENGTH_REQUIRED:411,PRECONDITION_FAILED:412,PAYLOAD_TOO_LARGE:413,URI_TOO_LONG:414,UNSUPPORTED_MEDIA_TYPE:415,RANGE_NOT_SATISFIABLE:416,EXPECTATION_FAILED:417,"I'M_A_TEAPOT":418,MISDIRECTED_REQUEST:421,UNPROCESSABLE_ENTITY:422,LOCKED:423,FAILED_DEPENDENCY:424,TOO_EARLY:425,UPGRADE_REQUIRED:426,PRECONDITION_REQUIRED:428,TOO_MANY_REQUESTS:429,REQUEST_HEADER_FIELDS_TOO_LARGE:431,UNAVAILABLE_FOR_LEGAL_REASONS:451,INTERNAL_SERVER_ERROR:500,NOT_IMPLEMENTED:501,BAD_GATEWAY:502,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,HTTP_VERSION_NOT_SUPPORTED:505,VARIANT_ALSO_NEGOTIATES:506,INSUFFICIENT_STORAGE:507,LOOP_DETECTED:508,NOT_EXTENDED:510,NETWORK_AUTHENTICATION_REQUIRED:511},uh=class extends Error{constructor(J="INTERNAL_SERVER_ERROR",W=void 0,X={},G=typeof J==="number"?J:xh[J]){super(W?.message,W?.cause?{cause:W.cause}:void 0);this.status=J,this.body=W,this.headers=X,this.statusCode=G,this.name="APIError",this.status=J,this.headers=X,this.statusCode=G,this.body=W?{code:W?.message?.toUpperCase().replace(/ /g,"_").replace(/[^A-Z0-9_]/g,""),...W}:void 0}},lh=class extends Error{constructor(J){super(J);this.name="BetterCallError"}},L=yh(uh,Error);$N={name:"HMAC",hash:"SHA-256"};A9.create=(J)=>{return(W,X,G)=>{return A9(W,{...X,use:[...X?.use||[],...J?.use||[]]},G)}};fX.create=(J)=>{function W(X,G){if(typeof X==="function")return fX({use:J?.use},X);if(!G)throw Error("Middleware handler is required");return fX({...X,method:"*",use:[...J?.use||[],...X.use||[]]},G)}return W};HH6=Object.freeze({status:"aborted"});ZH6=Symbol("zod_brand"),E9=class extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}},JN={};iS=Error.captureStackTrace?Error.captureStackTrace:(...J)=>{};Xf=nS(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{return Function(""),!0}catch(J){return!1}});Yf=new Set(["string","number","symbol"]);zH6={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-340282346638528860000000000000000000000,340282346638528860000000000000000000000],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};tS=U6("$ZodError",aS),oS=U6("$ZodError",aS,{Parent:Error});Vf=sS(oS),Df=eS(oS),DY=U6("$ZodCheck",(J,W)=>{var X;J._zod??(J._zod={}),J._zod.def=W,(X=J._zod).onattach??(X.onattach=[])}),vf=U6("$ZodCheckMaxLength",(J,W)=>{var X;DY.init(J,W),(X=J._zod.def).when??(X.when=(G)=>{let Y=G.value;return!KN(Y)&&Y.length!==void 0}),J._zod.onattach.push((G)=>{let Y=G._zod.bag.maximum??Number.POSITIVE_INFINITY;if(W.maximum<Y)G._zod.bag.maximum=W.maximum}),J._zod.check=(G)=>{let Y=G.value;if(Y.length<=W.maximum)return;let $=ZN(Y);G.issues.push({origin:$,code:"too_big",maximum:W.maximum,inclusive:!0,input:Y,inst:J,continue:!W.abort})}}),Mf=U6("$ZodCheckMinLength",(J,W)=>{var X;DY.init(J,W),(X=J._zod.def).when??(X.when=(G)=>{let Y=G.value;return!KN(Y)&&Y.length!==void 0}),J._zod.onattach.push((G)=>{let Y=G._zod.bag.minimum??Number.NEGATIVE_INFINITY;if(W.minimum>Y)G._zod.bag.minimum=W.minimum}),J._zod.check=(G)=>{let Y=G.value;if(Y.length>=W.minimum)return;let $=ZN(Y);G.issues.push({origin:$,code:"too_small",minimum:W.minimum,inclusive:!0,input:Y,inst:J,continue:!W.abort})}}),Of=U6("$ZodCheckLengthEquals",(J,W)=>{var X;DY.init(J,W),(X=J._zod.def).when??(X.when=(G)=>{let Y=G.value;return!KN(Y)&&Y.length!==void 0}),J._zod.onattach.push((G)=>{let Y=G._zod.bag;Y.minimum=W.length,Y.maximum=W.length,Y.length=W.length}),J._zod.check=(G)=>{let Y=G.value,$=Y.length;if($===W.length)return;let K=ZN(Y),w=$>W.length;G.issues.push({origin:K,...w?{code:"too_big",maximum:W.length}:{code:"too_small",minimum:W.length},inclusive:!0,exact:!0,input:G.value,inst:J,continue:!W.abort})}}),Pf=U6("$ZodCheckOverwrite",(J,W)=>{DY.init(J,W),J._zod.check=(X)=>{X.value=W.tx(X.value)}}),_f={major:4,minor:0,patch:0},m4=U6("$ZodType",(J,W)=>{var X;J??(J={}),J._zod.def=W,J._zod.bag=J._zod.bag||{},J._zod.version=_f;let G=[...J._zod.def.checks??[]];if(J._zod.traits.has("$ZodCheck"))G.unshift(J);for(let Y of G)for(let $ of Y._zod.onattach)$(J);if(G.length===0)(X=J._zod).deferred??(X.deferred=[]),J._zod.deferred?.push(()=>{J._zod.run=J._zod.parse});else{let Y=($,K,w)=>{let H=q9($),Z;for(let z of K){if(z._zod.def.when){if(!z._zod.def.when($))continue}else if(H)continue;let N=$.issues.length,F=z._zod.check($);if(F instanceof Promise&&w?.async===!1)throw new E9;if(Z||F instanceof Promise)Z=(Z??Promise.resolve()).then(async()=>{if(await F,$.issues.length===N)return;if(!H)H=q9($,N)});else{if($.issues.length===N)continue;if(!H)H=q9($,N)}}if(Z)return Z.then(()=>{return $});return $};J._zod.run=($,K)=>{let w=J._zod.parse($,K);if(w instanceof Promise){if(K.async===!1)throw new E9;return w.then((H)=>Y(H,G,K))}return Y(w,G,K)}}J["~standard"]={validate:(Y)=>{try{let $=Vf(J,Y);return $.success?{value:$.data}:{issues:$.error?.issues}}catch($){return Df(J,Y).then((K)=>K.success?{value:K.data}:{issues:K.error?.issues})}},vendor:"zod",version:1}}),Sf=U6("$ZodUnknown",(J,W)=>{m4.init(J,W),J._zod.parse=(X)=>X}),Tf=U6("$ZodNever",(J,W)=>{m4.init(J,W),J._zod.parse=(X,G)=>{return X.issues.push({expected:"never",code:"invalid_type",input:X.value,inst:J}),X}});qf=U6("$ZodArray",(J,W)=>{m4.init(J,W),J._zod.parse=(X,G)=>{let Y=X.value;if(!Array.isArray(Y))return X.issues.push({expected:"array",code:"invalid_type",input:Y,inst:J}),X;X.value=Array(Y.length);let $=[];for(let K=0;K<Y.length;K++){let w=Y[K],H=W.element._zod.run({value:w,issues:[]},G);if(H instanceof Promise)$.push(H.then((Z)=>qS(Z,X,K)));else qS(H,X,K)}if($.length)return Promise.all($).then(()=>X);return X}});Bf=U6("$ZodObject",(J,W)=>{m4.init(J,W);let X=nS(()=>{let N=Object.keys(W.shape);for(let Q of N)if(!(W.shape[Q]instanceof m4))throw Error(`Invalid element at key "${Q}": expected a Zod schema`);let F=$f(W.shape);return{shape:W.shape,keys:N,keySet:new Set(N),numKeys:N.length,optionalKeys:new Set(F)}});M4(J._zod,"propValues",()=>{let N=W.shape,F={};for(let Q in N){let V=N[Q]._zod;if(V.values){F[Q]??(F[Q]=new Set);for(let v of V.values)F[Q].add(v)}}return F});let G=(N)=>{let F=new jf(["shape","payload","ctx"]),Q=X.value,V=(S)=>{let T=T9(S);return`shape[${T}]._zod.run({ value: input[${T}], issues: [] }, ctx)`};F.write("const input = payload.value;");let v=Object.create(null),M=0;for(let S of Q.keys)v[S]=`key_${M++}`;F.write("const newResult = {}");for(let S of Q.keys)if(Q.optionalKeys.has(S)){let T=v[S];F.write(`const ${T} = ${V(S)};`);let j=T9(S);F.write(`
        if (${T}.issues.length) {
          if (input[${j}] === undefined) {
            if (${j} in input) {
              newResult[${j}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${T}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${j}, ...iss.path] : [${j}],
              }))
            );
          }
        } else if (${T}.value === undefined) {
          if (${j} in input) newResult[${j}] = undefined;
        } else {
          newResult[${j}] = ${T}.value;
        }
        `)}else{let T=v[S];F.write(`const ${T} = ${V(S)};`),F.write(`
          if (${T}.issues.length) payload.issues = payload.issues.concat(${T}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${T9(S)}, ...iss.path] : [${T9(S)}]
          })));`),F.write(`newResult[${T9(S)}] = ${T}.value`)}F.write("payload.value = newResult;"),F.write("return payload;");let O=F.compile();return(S,T)=>O(N,S,T)},Y,$=WN,K=!JN.jitless,H=K&&Xf.value,Z=W.catchall,z;J._zod.parse=(N,F)=>{z??(z=X.value);let Q=N.value;if(!$(Q))return N.issues.push({expected:"object",code:"invalid_type",input:Q,inst:J}),N;let V=[];if(K&&H&&F?.async===!1&&F.jitless!==!0){if(!Y)Y=G(W.shape);N=Y(N,F)}else{N.value={};let T=z.shape;for(let j of z.keys){let q=T[j],_=q._zod.run({value:Q[j],issues:[]},F),B=q._zod.optin==="optional"&&q._zod.optout==="optional";if(_ instanceof Promise)V.push(_.then((A)=>B?BS(A,N,j,Q):gK(A,N,j)));else if(B)BS(_,N,j,Q);else gK(_,N,j)}}if(!Z)return V.length?Promise.all(V).then(()=>N):N;let v=[],M=z.keySet,O=Z._zod,S=O.def.type;for(let T of Object.keys(Q)){if(M.has(T))continue;if(S==="never"){v.push(T);continue}let j=O.run({value:Q[T],issues:[]},F);if(j instanceof Promise)V.push(j.then((q)=>gK(q,N,T)));else gK(j,N,T)}if(v.length)N.issues.push({code:"unrecognized_keys",keys:v,input:Q,inst:J});if(!V.length)return N;return Promise.all(V).then(()=>{return N})}});Af=U6("$ZodUnion",(J,W)=>{m4.init(J,W),M4(J._zod,"optin",()=>W.options.some((X)=>X._zod.optin==="optional")?"optional":void 0),M4(J._zod,"optout",()=>W.options.some((X)=>X._zod.optout==="optional")?"optional":void 0),M4(J._zod,"values",()=>{if(W.options.every((X)=>X._zod.values))return new Set(W.options.flatMap((X)=>Array.from(X._zod.values)))}),M4(J._zod,"pattern",()=>{if(W.options.every((X)=>X._zod.pattern)){let X=W.options.map((G)=>G._zod.pattern);return new RegExp(`^(${X.map((G)=>wN(G.source)).join("|")})$`)}}),J._zod.parse=(X,G)=>{let Y=!1,$=[];for(let K of W.options){let w=K._zod.run({value:X.value,issues:[]},G);if(w instanceof Promise)$.push(w),Y=!0;else{if(w.issues.length===0)return w;$.push(w)}}if(!Y)return AS($,X,J,G);return Promise.all($).then((K)=>{return AS(K,X,J,G)})}}),Ef=U6("$ZodIntersection",(J,W)=>{m4.init(J,W),J._zod.parse=(X,G)=>{let Y=X.value,$=W.left._zod.run({value:Y,issues:[]},G),K=W.right._zod.run({value:Y,issues:[]},G);if($ instanceof Promise||K instanceof Promise)return Promise.all([$,K]).then(([w,H])=>{return ES(X,w,H)});return ES(X,$,K)}});Rf=U6("$ZodEnum",(J,W)=>{m4.init(J,W);let X=Jf(W.entries);J._zod.values=new Set(X),J._zod.pattern=new RegExp(`^(${X.filter((G)=>Yf.has(typeof G)).map((G)=>typeof G==="string"?Gf(G):G.toString()).join("|")})$`),J._zod.parse=(G,Y)=>{let $=G.value;if(J._zod.values.has($))return G;return G.issues.push({code:"invalid_value",values:X,input:$,inst:J}),G}}),Cf=U6("$ZodTransform",(J,W)=>{m4.init(J,W),J._zod.parse=(X,G)=>{let Y=W.transform(X.value,X);if(G.async)return(Y instanceof Promise?Y:Promise.resolve(Y)).then(($)=>{return X.value=$,X});if(Y instanceof Promise)throw new E9;return X.value=Y,X}}),If=U6("$ZodOptional",(J,W)=>{m4.init(J,W),J._zod.optin="optional",J._zod.optout="optional",M4(J._zod,"values",()=>{return W.innerType._zod.values?new Set([...W.innerType._zod.values,void 0]):void 0}),M4(J._zod,"pattern",()=>{let X=W.innerType._zod.pattern;return X?new RegExp(`^(${wN(X.source)})?$`):void 0}),J._zod.parse=(X,G)=>{if(W.innerType._zod.optin==="optional")return W.innerType._zod.run(X,G);if(X.value===void 0)return X;return W.innerType._zod.run(X,G)}}),bf=U6("$ZodNullable",(J,W)=>{m4.init(J,W),M4(J._zod,"optin",()=>W.innerType._zod.optin),M4(J._zod,"optout",()=>W.innerType._zod.optout),M4(J._zod,"pattern",()=>{let X=W.innerType._zod.pattern;return X?new RegExp(`^(${wN(X.source)}|null)$`):void 0}),M4(J._zod,"values",()=>{return W.innerType._zod.values?new Set([...W.innerType._zod.values,null]):void 0}),J._zod.parse=(X,G)=>{if(X.value===null)return X;return W.innerType._zod.run(X,G)}}),kf=U6("$ZodDefault",(J,W)=>{m4.init(J,W),J._zod.optin="optional",M4(J._zod,"values",()=>W.innerType._zod.values),J._zod.parse=(X,G)=>{if(X.value===void 0)return X.value=W.defaultValue,X;let Y=W.innerType._zod.run(X,G);if(Y instanceof Promise)return Y.then(($)=>RS($,W));return RS(Y,W)}});hf=U6("$ZodPrefault",(J,W)=>{m4.init(J,W),J._zod.optin="optional",M4(J._zod,"values",()=>W.innerType._zod.values),J._zod.parse=(X,G)=>{if(X.value===void 0)X.value=W.defaultValue;return W.innerType._zod.run(X,G)}}),ff=U6("$ZodNonOptional",(J,W)=>{m4.init(J,W),M4(J._zod,"values",()=>{let X=W.innerType._zod.values;return X?new Set([...X].filter((G)=>G!==void 0)):void 0}),J._zod.parse=(X,G)=>{let Y=W.innerType._zod.run(X,G);if(Y instanceof Promise)return Y.then(($)=>CS($,J));return CS(Y,J)}});gf=U6("$ZodCatch",(J,W)=>{m4.init(J,W),J._zod.optin="optional",M4(J._zod,"optout",()=>W.innerType._zod.optout),M4(J._zod,"values",()=>W.innerType._zod.values),J._zod.parse=(X,G)=>{let Y=W.innerType._zod.run(X,G);if(Y instanceof Promise)return Y.then(($)=>{if(X.value=$.value,$.issues.length)X.value=W.catchValue({...X,error:{issues:$.issues.map((K)=>mX(K,G,gX()))},input:X.value}),X.issues=[];return X});if(X.value=Y.value,Y.issues.length)X.value=W.catchValue({...X,error:{issues:Y.issues.map(($)=>mX($,G,gX()))},input:X.value}),X.issues=[];return X}}),mf=U6("$ZodPipe",(J,W)=>{m4.init(J,W),M4(J._zod,"values",()=>W.in._zod.values),M4(J._zod,"optin",()=>W.in._zod.optin),M4(J._zod,"optout",()=>W.out._zod.optout),J._zod.parse=(X,G)=>{let Y=W.in._zod.run(X,G);if(Y instanceof Promise)return Y.then(($)=>IS($,W,G));return IS(Y,W,G)}});yf=U6("$ZodReadonly",(J,W)=>{m4.init(J,W),M4(J._zod,"propValues",()=>W.innerType._zod.propValues),M4(J._zod,"values",()=>W.innerType._zod.values),M4(J._zod,"optin",()=>W.innerType._zod.optin),M4(J._zod,"optout",()=>W.innerType._zod.optout),J._zod.parse=(X,G)=>{let Y=W.innerType._zod.run(X,G);if(Y instanceof Promise)return Y.then(bS);return bS(Y)}});xf=U6("$ZodCustom",(J,W)=>{DY.init(J,W),m4.init(J,W),J._zod.parse=(X,G)=>{return X},J._zod.check=(X)=>{let G=X.value,Y=W.fn(G);if(Y instanceof Promise)return Y.then(($)=>kS($,X,G,J));kS(Y,X,G,J)}});FH6=Symbol("ZodOutput"),NH6=Symbol("ZodInput");mK=lf();UH6=U6("ZodError",JT),uK=U6("ZodError",JT,{Parent:Error}),of=Qf(uK),sf=Lf(uK),ef=sS(uK),Jg=eS(uK),Z0=U6("ZodType",(J,W)=>{return m4.init(J,W),J.def=W,Object.defineProperty(J,"_def",{value:W}),J.check=(...X)=>{return J.clone({...W,checks:[...W.checks??[],...X.map((G)=>typeof G==="function"?{_zod:{check:G,def:{check:"custom"},onattach:[]}}:G)]})},J.clone=(X,G)=>yX(J,X,G),J.brand=()=>J,J.register=(X,G)=>{return X.add(J,G),J},J.parse=(X,G)=>of(J,X,G,{callee:J.parse}),J.safeParse=(X,G)=>ef(J,X,G),J.parseAsync=async(X,G)=>sf(J,X,G,{callee:J.parseAsync}),J.safeParseAsync=async(X,G)=>Jg(J,X,G),J.spa=J.safeParseAsync,J.refine=(X,G)=>J.check(qg(X,G)),J.superRefine=(X)=>J.check(Bg(X)),J.overwrite=(X)=>J.check(rf(X)),J.optional=()=>gS(J),J.nullable=()=>mS(J),J.nullish=()=>gS(mS(J)),J.nonoptional=(X)=>vg(J,X),J.array=()=>$g(J),J.or=(X)=>wg([J,X]),J.and=(X)=>Zg(J,X),J.transform=(X)=>yS(J,Ng(X)),J.default=(X)=>Lg(J,X),J.prefault=(X)=>Dg(J,X),J.catch=(X)=>Og(J,X),J.pipe=(X)=>yS(J,X),J.readonly=()=>_g(J),J.describe=(X)=>{let G=J.clone();return mK.add(G,{description:X}),G},Object.defineProperty(J,"description",{get(){return mK.get(J)?.description},configurable:!0}),J.meta=(...X)=>{if(X.length===0)return mK.get(J);let G=J.clone();return mK.add(G,X[0]),G},J.isOptional=()=>J.safeParse(void 0).success,J.isNullable=()=>J.safeParse(null).success,J}),Wg=U6("ZodUnknown",(J,W)=>{Sf.init(J,W),Z0.init(J,W)});Xg=U6("ZodNever",(J,W)=>{Tf.init(J,W),Z0.init(J,W)});Gg=U6("ZodArray",(J,W)=>{qf.init(J,W),Z0.init(J,W),J.element=W.element,J.min=(X,G)=>J.check(hS(X,G)),J.nonempty=(X)=>J.check(hS(1,X)),J.max=(X,G)=>J.check(df(X,G)),J.length=(X,G)=>J.check(nf(X,G)),J.unwrap=()=>J.element});xK=U6("ZodObject",(J,W)=>{Bf.init(J,W),Z0.init(J,W),M4(J,"shape",()=>W.shape),J.keyof=()=>zg(Object.keys(J._zod.def.shape)),J.catchall=(X)=>J.clone({...J._zod.def,catchall:X}),J.passthrough=()=>J.clone({...J._zod.def,catchall:fS()}),J.loose=()=>J.clone({...J._zod.def,catchall:fS()}),J.strict=()=>J.clone({...J._zod.def,catchall:Yg()}),J.strip=()=>J.clone({...J._zod.def,catchall:void 0}),J.extend=(X)=>{return Hf(J,X)},J.merge=(X)=>Zf(J,X),J.pick=(X)=>Kf(J,X),J.omit=(X)=>wf(J,X),J.partial=(...X)=>zf(B9,J,X[0]),J.required=(...X)=>Ff(WT,J,X[0])}),Kg=U6("ZodUnion",(J,W)=>{Af.init(J,W),Z0.init(J,W),J.options=W.options});Hg=U6("ZodIntersection",(J,W)=>{Ef.init(J,W),Z0.init(J,W)});GN=U6("ZodEnum",(J,W)=>{Rf.init(J,W),Z0.init(J,W),J.enum=W.entries,J.options=Object.values(W.entries);let X=new Set(Object.keys(W.entries));J.extract=(G,Y)=>{let $={};for(let K of G)if(X.has(K))$[K]=W.entries[K];else throw Error(`Key ${K} not found in enum`);return new GN({...W,checks:[],...XJ(Y),entries:$})},J.exclude=(G,Y)=>{let $={...W.entries};for(let K of G)if(X.has(K))delete $[K];else throw Error(`Key ${K} not found in enum`);return new GN({...W,checks:[],...XJ(Y),entries:$})}});Fg=U6("ZodTransform",(J,W)=>{Cf.init(J,W),Z0.init(J,W),J._zod.parse=(X,G)=>{X.addIssue=($)=>{if(typeof $==="string")X.issues.push(R9($,X.value,W));else{let K=$;if(K.fatal)K.continue=!1;K.code??(K.code="custom"),K.input??(K.input=X.value),K.inst??(K.inst=J),K.continue??(K.continue=!0),X.issues.push(R9(K))}};let Y=W.transform(X.value,X);if(Y instanceof Promise)return Y.then(($)=>{return X.value=$,X});return X.value=Y,X}});B9=U6("ZodOptional",(J,W)=>{If.init(J,W),Z0.init(J,W),J.unwrap=()=>J._zod.def.innerType});Ug=U6("ZodNullable",(J,W)=>{bf.init(J,W),Z0.init(J,W),J.unwrap=()=>J._zod.def.innerType});Qg=U6("ZodDefault",(J,W)=>{kf.init(J,W),Z0.init(J,W),J.unwrap=()=>J._zod.def.innerType,J.removeDefault=J.unwrap});Vg=U6("ZodPrefault",(J,W)=>{hf.init(J,W),Z0.init(J,W),J.unwrap=()=>J._zod.def.innerType});WT=U6("ZodNonOptional",(J,W)=>{ff.init(J,W),Z0.init(J,W),J.unwrap=()=>J._zod.def.innerType});Mg=U6("ZodCatch",(J,W)=>{gf.init(J,W),Z0.init(J,W),J.unwrap=()=>J._zod.def.innerType,J.removeCatch=J.unwrap});Pg=U6("ZodPipe",(J,W)=>{mf.init(J,W),Z0.init(J,W),J.in=W.in,J.out=W.out});jg=U6("ZodReadonly",(J,W)=>{yf.init(J,W),Z0.init(J,W)});Sg=U6("ZodCustom",(J,W)=>{xf.init(J,W),Z0.init(J,W)});eF={}});function I(J,W,X){function G(w,H){var Z;Object.defineProperty(w,"_zod",{value:w._zod??{},enumerable:!1}),(Z=w._zod).traits??(Z.traits=new Set),w._zod.traits.add(J),W(w,H);for(let z in K.prototype)if(!(z in w))Object.defineProperty(w,z,{value:K.prototype[z].bind(w)});w._zod.constr=K,w._zod.def=H}let Y=X?.Parent??Object;class $ extends Y{}Object.defineProperty($,"name",{value:J});function K(w){var H;let Z=X?.Parent?new $:this;G(Z,w),(H=Z._zod).deferred??(H.deferred=[]);for(let z of Z._zod.deferred)z();return Z}return Object.defineProperty(K,"init",{value:G}),Object.defineProperty(K,Symbol.hasInstance,{value:(w)=>{if(X?.Parent&&w instanceof X.Parent)return!0;return w?._zod?.traits?.has(J)}}),Object.defineProperty(K,"name",{value:J}),K}function I4(J){if(J)Object.assign(C9,J);return C9}var lK,cK,OJ,xX,C9;var vY=D(()=>{lK=Object.freeze({status:"aborted"});cK=Symbol("zod_brand");OJ=class OJ extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}};xX=class xX extends Error{constructor(J){super(`Encountered unidirectional transform during encode: ${J}`);this.name="ZodEncodeError"}};C9={}});var d={};s0(d,{unwrapMessage:()=>I9,uint8ArrayToHex:()=>Wm,uint8ArrayToBase64url:()=>eg,uint8ArrayToBase64:()=>KT,stringifyPrimitive:()=>p,shallowClone:()=>UN,safeExtend:()=>rg,required:()=>tg,randomString:()=>xg,propertyKeyTypes:()=>h9,promiseAllObject:()=>yg,primitiveTypes:()=>QN,prefixIssues:()=>N8,pick:()=>pg,partial:()=>ag,optionalKeys:()=>LN,omit:()=>dg,objectClone:()=>fg,numKeys:()=>ug,nullish:()=>cW,normalizeParams:()=>r,mergeDefs:()=>dW,merge:()=>ig,jsonStringifyReplacer:()=>MY,joinValues:()=>h,issue:()=>PY,isPlainObject:()=>nW,isObject:()=>uX,hexToUint8Array:()=>Jm,getSizableOrigin:()=>f9,getParsedType:()=>lg,getLengthableOrigin:()=>g9,getEnumValues:()=>b9,getElementAtPath:()=>mg,floatSafeRemainder:()=>FN,finalizeIssue:()=>U8,extend:()=>ng,escapeRegex:()=>PJ,esc:()=>pK,defineLazy:()=>j6,createTransparentProxy:()=>cg,cloneDef:()=>gg,clone:()=>v0,cleanRegex:()=>k9,cleanEnum:()=>og,captureStackTrace:()=>dK,cached:()=>OY,base64urlToUint8Array:()=>sg,base64ToUint8Array:()=>$T,assignProp:()=>pW,assertNotEqual:()=>Ig,assertNever:()=>kg,assertIs:()=>bg,assertEqual:()=>Cg,assert:()=>hg,allowsEval:()=>NN,aborted:()=>rW,NUMBER_FORMAT_RANGES:()=>VN,Class:()=>wT,BIGINT_FORMAT_RANGES:()=>DN});function Cg(J){return J}function Ig(J){return J}function bg(J){}function kg(J){throw Error()}function hg(J){}function b9(J){let W=Object.values(J).filter((G)=>typeof G==="number");return Object.entries(J).filter(([G,Y])=>W.indexOf(+G)===-1).map(([G,Y])=>Y)}function h(J,W="|"){return J.map((X)=>p(X)).join(W)}function MY(J,W){if(typeof W==="bigint")return W.toString();return W}function OY(J){return{get value(){{let X=J();return Object.defineProperty(this,"value",{value:X}),X}throw Error("cached value already set")}}}function cW(J){return J===null||J===void 0}function k9(J){let W=J.startsWith("^")?1:0,X=J.endsWith("$")?J.length-1:J.length;return J.slice(W,X)}function FN(J,W){let X=(J.toString().split(".")[1]||"").length,G=W.toString(),Y=(G.split(".")[1]||"").length;if(Y===0&&/\d?e-\d?/.test(G)){let H=G.match(/\d?e-(\d?)/);if(H?.[1])Y=Number.parseInt(H[1])}let $=X>Y?X:Y,K=Number.parseInt(J.toFixed($).replace(".","")),w=Number.parseInt(W.toFixed($).replace(".",""));return K%w/10**$}function j6(J,W,X){let G=void 0;Object.defineProperty(J,W,{get(){if(G===GT)return;if(G===void 0)G=GT,G=X();return G},set(Y){Object.defineProperty(J,W,{value:Y})},configurable:!0})}function fg(J){return Object.create(Object.getPrototypeOf(J),Object.getOwnPropertyDescriptors(J))}function pW(J,W,X){Object.defineProperty(J,W,{value:X,writable:!0,enumerable:!0,configurable:!0})}function dW(...J){let W={};for(let X of J){let G=Object.getOwnPropertyDescriptors(X);Object.assign(W,G)}return Object.defineProperties({},W)}function gg(J){return dW(J._zod.def)}function mg(J,W){if(!W)return J;return W.reduce((X,G)=>X?.[G],J)}function yg(J){let W=Object.keys(J),X=W.map((G)=>J[G]);return Promise.all(X).then((G)=>{let Y={};for(let $=0;$<W.length;$++)Y[W[$]]=G[$];return Y})}function xg(J=10){let X="";for(let G=0;G<J;G++)X+="abcdefghijklmnopqrstuvwxyz"[Math.floor(Math.random()*26)];return X}function pK(J){return JSON.stringify(J)}function uX(J){return typeof J==="object"&&J!==null&&!Array.isArray(J)}function nW(J){if(uX(J)===!1)return!1;let W=J.constructor;if(W===void 0)return!0;let X=W.prototype;if(uX(X)===!1)return!1;if(Object.prototype.hasOwnProperty.call(X,"isPrototypeOf")===!1)return!1;return!0}function UN(J){if(nW(J))return{...J};if(Array.isArray(J))return[...J];return J}function ug(J){let W=0;for(let X in J)if(Object.prototype.hasOwnProperty.call(J,X))W++;return W}function PJ(J){return J.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function v0(J,W,X){let G=new J._zod.constr(W??J._zod.def);if(!W||X?.parent)G._zod.parent=J;return G}function r(J){let W=J;if(!W)return{};if(typeof W==="string")return{error:()=>W};if(W?.message!==void 0){if(W?.error!==void 0)throw Error("Cannot specify both `message` and `error` params");W.error=W.message}if(delete W.message,typeof W.error==="string")return{...W,error:()=>W.error};return W}function cg(J){let W;return new Proxy({},{get(X,G,Y){return W??(W=J()),Reflect.get(W,G,Y)},set(X,G,Y,$){return W??(W=J()),Reflect.set(W,G,Y,$)},has(X,G){return W??(W=J()),Reflect.has(W,G)},deleteProperty(X,G){return W??(W=J()),Reflect.deleteProperty(W,G)},ownKeys(X){return W??(W=J()),Reflect.ownKeys(W)},getOwnPropertyDescriptor(X,G){return W??(W=J()),Reflect.getOwnPropertyDescriptor(W,G)},defineProperty(X,G,Y){return W??(W=J()),Reflect.defineProperty(W,G,Y)}})}function p(J){if(typeof J==="bigint")return J.toString()+"n";if(typeof J==="string")return`"${J}"`;return`${J}`}function LN(J){return Object.keys(J).filter((W)=>{return J[W]._zod.optin==="optional"&&J[W]._zod.optout==="optional"})}function pg(J,W){let X=J._zod.def,G=dW(J._zod.def,{get shape(){let Y={};for(let $ in W){if(!($ in X.shape))throw Error(`Unrecognized key: "${$}"`);if(!W[$])continue;Y[$]=X.shape[$]}return pW(this,"shape",Y),Y},checks:[]});return v0(J,G)}function dg(J,W){let X=J._zod.def,G=dW(J._zod.def,{get shape(){let Y={...J._zod.def.shape};for(let $ in W){if(!($ in X.shape))throw Error(`Unrecognized key: "${$}"`);if(!W[$])continue;delete Y[$]}return pW(this,"shape",Y),Y},checks:[]});return v0(J,G)}function ng(J,W){if(!nW(W))throw Error("Invalid input to extend: expected a plain object");let X=J._zod.def.checks;if(X&&X.length>0)throw Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");let Y=dW(J._zod.def,{get shape(){let $={...J._zod.def.shape,...W};return pW(this,"shape",$),$},checks:[]});return v0(J,Y)}function rg(J,W){if(!nW(W))throw Error("Invalid input to safeExtend: expected a plain object");let X={...J._zod.def,get shape(){let G={...J._zod.def.shape,...W};return pW(this,"shape",G),G},checks:J._zod.def.checks};return v0(J,X)}function ig(J,W){let X=dW(J._zod.def,{get shape(){let G={...J._zod.def.shape,...W._zod.def.shape};return pW(this,"shape",G),G},get catchall(){return W._zod.def.catchall},checks:[]});return v0(J,X)}function ag(J,W,X){let G=dW(W._zod.def,{get shape(){let Y=W._zod.def.shape,$={...Y};if(X)for(let K in X){if(!(K in Y))throw Error(`Unrecognized key: "${K}"`);if(!X[K])continue;$[K]=J?new J({type:"optional",innerType:Y[K]}):Y[K]}else for(let K in Y)$[K]=J?new J({type:"optional",innerType:Y[K]}):Y[K];return pW(this,"shape",$),$},checks:[]});return v0(W,G)}function tg(J,W,X){let G=dW(W._zod.def,{get shape(){let Y=W._zod.def.shape,$={...Y};if(X)for(let K in X){if(!(K in $))throw Error(`Unrecognized key: "${K}"`);if(!X[K])continue;$[K]=new J({type:"nonoptional",innerType:Y[K]})}else for(let K in Y)$[K]=new J({type:"nonoptional",innerType:Y[K]});return pW(this,"shape",$),$},checks:[]});return v0(W,G)}function rW(J,W=0){if(J.aborted===!0)return!0;for(let X=W;X<J.issues.length;X++)if(J.issues[X]?.continue!==!0)return!0;return!1}function N8(J,W){return W.map((X)=>{var G;return(G=X).path??(G.path=[]),X.path.unshift(J),X})}function I9(J){return typeof J==="string"?J:J?.message}function U8(J,W,X){let G={...J,path:J.path??[]};if(!J.message){let Y=I9(J.inst?._zod.def?.error?.(J))??I9(W?.error?.(J))??I9(X.customError?.(J))??I9(X.localeError?.(J))??"Invalid input";G.message=Y}if(delete G.inst,delete G.continue,!W?.reportInput)delete G.input;return G}function f9(J){if(J instanceof Set)return"set";if(J instanceof Map)return"map";if(J instanceof File)return"file";return"unknown"}function g9(J){if(Array.isArray(J))return"array";if(typeof J==="string")return"string";return"unknown"}function PY(...J){let[W,X,G]=J;if(typeof W==="string")return{message:W,code:"custom",input:X,inst:G};return{...W}}function og(J){return Object.entries(J).filter(([W,X])=>{return Number.isNaN(Number.parseInt(W,10))}).map((W)=>W[1])}function $T(J){let W=atob(J),X=new Uint8Array(W.length);for(let G=0;G<W.length;G++)X[G]=W.charCodeAt(G);return X}function KT(J){let W="";for(let X=0;X<J.length;X++)W+=String.fromCharCode(J[X]);return btoa(W)}function sg(J){let W=J.replace(/-/g,"+").replace(/_/g,"/"),X="=".repeat((4-W.length%4)%4);return $T(W+X)}function eg(J){return KT(J).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function Jm(J){let W=J.replace(/^0x/,"");if(W.length%2!==0)throw Error("Invalid hex string length");let X=new Uint8Array(W.length/2);for(let G=0;G<W.length;G+=2)X[G/2]=Number.parseInt(W.slice(G,G+2),16);return X}function Wm(J){return Array.from(J).map((W)=>W.toString(16).padStart(2,"0")).join("")}class wT{constructor(...J){}}var GT,dK,NN,lg=(J)=>{let W=typeof J;switch(W){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(J)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":if(Array.isArray(J))return"array";if(J===null)return"null";if(J.then&&typeof J.then==="function"&&J.catch&&typeof J.catch==="function")return"promise";if(typeof Map<"u"&&J instanceof Map)return"map";if(typeof Set<"u"&&J instanceof Set)return"set";if(typeof Date<"u"&&J instanceof Date)return"date";if(typeof File<"u"&&J instanceof File)return"file";return"object";default:throw Error(`Unknown data type: ${W}`)}},h9,QN,VN,DN;var Y6=D(()=>{GT=Symbol("evaluating");dK="captureStackTrace"in Error?Error.captureStackTrace:(...J)=>{};NN=OY(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{return new Function(""),!0}catch(J){return!1}});h9=new Set(["string","number","symbol"]),QN=new Set(["string","number","bigint","boolean","symbol","undefined"]);VN={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-340282346638528860000000000000000000000,340282346638528860000000000000000000000],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},DN={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]}});function jY(J,W=(X)=>X.message){let X={},G=[];for(let Y of J.issues)if(Y.path.length>0)X[Y.path[0]]=X[Y.path[0]]||[],X[Y.path[0]].push(W(Y));else G.push(W(Y));return{formErrors:G,fieldErrors:X}}function _Y(J,W=(X)=>X.message){let X={_errors:[]},G=(Y)=>{for(let $ of Y.issues)if($.code==="invalid_union"&&$.errors.length)$.errors.map((K)=>G({issues:K}));else if($.code==="invalid_key")G({issues:$.issues});else if($.code==="invalid_element")G({issues:$.issues});else if($.path.length===0)X._errors.push(W($));else{let K=X,w=0;while(w<$.path.length){let H=$.path[w];if(w!==$.path.length-1)K[H]=K[H]||{_errors:[]};else K[H]=K[H]||{_errors:[]},K[H]._errors.push(W($));K=K[H],w++}}};return G(J),X}function nK(J,W=(X)=>X.message){let X={errors:[]},G=(Y,$=[])=>{var K,w;for(let H of Y.issues)if(H.code==="invalid_union"&&H.errors.length)H.errors.map((Z)=>G({issues:Z},H.path));else if(H.code==="invalid_key")G({issues:H.issues},H.path);else if(H.code==="invalid_element")G({issues:H.issues},H.path);else{let Z=[...$,...H.path];if(Z.length===0){X.errors.push(W(H));continue}let z=X,N=0;while(N<Z.length){let F=Z[N],Q=N===Z.length-1;if(typeof F==="string")z.properties??(z.properties={}),(K=z.properties)[F]??(K[F]={errors:[]}),z=z.properties[F];else z.items??(z.items=[]),(w=z.items)[F]??(w[F]={errors:[]}),z=z.items[F];if(Q)z.errors.push(W(H));N++}}};return G(J),X}function ZT(J){let W=[],X=J.map((G)=>typeof G==="object"?G.key:G);for(let G of X)if(typeof G==="number")W.push(`[${G}]`);else if(typeof G==="symbol")W.push(`[${JSON.stringify(String(G))}]`);else if(/[^\w$]/.test(G))W.push(`[${JSON.stringify(G)}]`);else{if(W.length)W.push(".");W.push(G)}return W.join("")}function rK(J){let W=[],X=[...J.issues].sort((G,Y)=>(G.path??[]).length-(Y.path??[]).length);for(let G of X)if(W.push(`\u2716 ${G.message}`),G.path?.length)W.push(`  \u2192 at ${ZT(G.path)}`);return W.join(`
`)}var HT=(J,W)=>{J.name="$ZodError",Object.defineProperty(J,"_zod",{value:J._zod,enumerable:!1}),Object.defineProperty(J,"issues",{value:W,enumerable:!1}),J.message=JSON.stringify(W,MY,2),Object.defineProperty(J,"toString",{value:()=>J.message,enumerable:!1})},m9,r0;var vN=D(()=>{vY();Y6();m9=I("$ZodError",HT),r0=I("$ZodError",HT,{Parent:Error})});var SY=(J)=>(W,X,G,Y)=>{let $=G?Object.assign(G,{async:!1}):{async:!1},K=W._zod.run({value:X,issues:[]},$);if(K instanceof Promise)throw new OJ;if(K.issues.length){let w=new(Y?.Err??J)(K.issues.map((H)=>U8(H,$,I4())));throw dK(w,Y?.callee),w}return K.value},iK,TY=(J)=>async(W,X,G,Y)=>{let $=G?Object.assign(G,{async:!0}):{async:!0},K=W._zod.run({value:X,issues:[]},$);if(K instanceof Promise)K=await K;if(K.issues.length){let w=new(Y?.Err??J)(K.issues.map((H)=>U8(H,$,I4())));throw dK(w,Y?.callee),w}return K.value},aK,qY=(J)=>(W,X,G)=>{let Y=G?{...G,async:!1}:{async:!1},$=W._zod.run({value:X,issues:[]},Y);if($ instanceof Promise)throw new OJ;return $.issues.length?{success:!1,error:new(J??m9)($.issues.map((K)=>U8(K,Y,I4())))}:{success:!0,data:$.value}},MN,BY=(J)=>async(W,X,G)=>{let Y=G?Object.assign(G,{async:!0}):{async:!0},$=W._zod.run({value:X,issues:[]},Y);if($ instanceof Promise)$=await $;return $.issues.length?{success:!1,error:new J($.issues.map((K)=>U8(K,Y,I4())))}:{success:!0,data:$.value}},ON,tK=(J)=>(W,X,G)=>{let Y=G?Object.assign(G,{direction:"backward"}):{direction:"backward"};return SY(J)(W,X,Y)},Ym,oK=(J)=>(W,X,G)=>{return SY(J)(W,X,G)},Gm,sK=(J)=>async(W,X,G)=>{let Y=G?Object.assign(G,{direction:"backward"}):{direction:"backward"};return TY(J)(W,X,Y)},$m,eK=(J)=>async(W,X,G)=>{return TY(J)(W,X,G)},Km,Jw=(J)=>(W,X,G)=>{let Y=G?Object.assign(G,{direction:"backward"}):{direction:"backward"};return qY(J)(W,X,Y)},wm,Ww=(J)=>(W,X,G)=>{return qY(J)(W,X,G)},Hm,Xw=(J)=>async(W,X,G)=>{let Y=G?Object.assign(G,{direction:"backward"}):{direction:"backward"};return BY(J)(W,X,Y)},Zm,Yw=(J)=>async(W,X,G)=>{return BY(J)(W,X,G)},zm;var PN=D(()=>{vY();vN();Y6();iK=SY(r0),aK=TY(r0),MN=qY(r0),ON=BY(r0),Ym=tK(r0),Gm=oK(r0),$m=sK(r0),Km=eK(r0),wm=Jw(r0),Hm=Ww(r0),Zm=Xw(r0),zm=Yw(r0)});var Q8={};s0(Q8,{xid:()=>TN,uuid7:()=>Qm,uuid6:()=>Um,uuid4:()=>Nm,uuid:()=>lX,uppercase:()=>tN,unicodeEmail:()=>zT,undefined:()=>iN,ulid:()=>SN,time:()=>xN,string:()=>lN,sha512_hex:()=>bm,sha512_base64url:()=>hm,sha512_base64:()=>km,sha384_hex:()=>Rm,sha384_base64url:()=>Im,sha384_base64:()=>Cm,sha256_hex:()=>Bm,sha256_base64url:()=>Em,sha256_base64:()=>Am,sha1_hex:()=>Sm,sha1_base64url:()=>qm,sha1_base64:()=>Tm,rfc5322Email:()=>Vm,number:()=>dN,null:()=>rN,nanoid:()=>BN,md5_hex:()=>Pm,md5_base64url:()=>_m,md5_base64:()=>jm,lowercase:()=>aN,ksuid:()=>qN,ipv6:()=>bN,ipv4:()=>IN,integer:()=>pN,idnEmail:()=>Dm,html5Email:()=>Lm,hostname:()=>gN,hex:()=>Om,guid:()=>EN,extendedDuration:()=>Fm,emoji:()=>CN,email:()=>RN,e164:()=>mN,duration:()=>AN,domain:()=>Mm,datetime:()=>uN,date:()=>yN,cuid2:()=>_N,cuid:()=>jN,cidrv6:()=>hN,cidrv4:()=>kN,browserEmail:()=>vm,boolean:()=>nN,bigint:()=>cN,base64url:()=>Gw,base64:()=>fN});function CN(){return new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")}function NT(J){return typeof J.precision==="number"?J.precision===-1?"(?:[01]\\d|2[0-3]):[0-5]\\d":J.precision===0?"(?:[01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d":`(?:[01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d\\.\\d{${J.precision}}`:"(?:[01]\\d|2[0-3]):[0-5]\\d(?::[0-5]\\d(?:\\.\\d+)?)?"}function xN(J){return new RegExp(`^${NT(J)}$`)}function uN(J){let W=NT({precision:J.precision}),X=["Z"];if(J.local)X.push("");if(J.offset)X.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");let G=`${W}(?:${X.join("|")})`;return new RegExp(`^${FT}T(?:${G})$`)}function y9(J,W){return new RegExp(`^[A-Za-z0-9+/]{${J}}${W}$`)}function x9(J){return new RegExp(`^[A-Za-z0-9_-]{${J}}$`)}var jN,_N,SN,TN,qN,BN,AN,Fm,EN,lX=(J)=>{if(!J)return/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/;return new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${J}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`)},Nm,Um,Qm,RN,Lm,Vm,zT,Dm,vm,IN,bN,kN,hN,fN,Gw,gN,Mm,mN,FT="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",yN,lN=(J)=>{let W=J?`[\\s\\S]{${J?.minimum??0},${J?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${W}$`)},cN,pN,dN,nN,rN,iN,aN,tN,Om,Pm,jm,_m,Sm,Tm,qm,Bm,Am,Em,Rm,Cm,Im,bm,km,hm;var $w=D(()=>{jN=/^[cC][^\s-]{8,}$/,_N=/^[0-9a-z]+$/,SN=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,TN=/^[0-9a-vA-V]{20}$/,qN=/^[A-Za-z0-9]{27}$/,BN=/^[a-zA-Z0-9_-]{21}$/,AN=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,Fm=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,EN=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Nm=lX(4),Um=lX(6),Qm=lX(7),RN=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,Lm=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Vm=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,zT=/^[^\s@"]{1,64}@[^\s@]{1,255}$/u,Dm=zT,vm=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;IN=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,bN=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,kN=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,hN=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,fN=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Gw=/^[A-Za-z0-9_-]*$/,gN=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,Mm=/^([a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/,mN=/^\+(?:[0-9]){6,14}[0-9]$/,yN=new RegExp(`^${FT}$`);cN=/^-?\d+n?$/,pN=/^-?\d+$/,dN=/^-?\d+(?:\.\d+)?/,nN=/^(?:true|false)$/i,rN=/^null$/i,iN=/^undefined$/i,aN=/^[^A-Z]*$/,tN=/^[^a-z]*$/,Om=/^[0-9a-fA-F]*$/;Pm=/^[0-9a-fA-F]{32}$/,jm=y9(22,"=="),_m=x9(22),Sm=/^[0-9a-fA-F]{40}$/,Tm=y9(27,"="),qm=x9(27),Bm=/^[0-9a-fA-F]{64}$/,Am=y9(43,"="),Em=x9(43),Rm=/^[0-9a-fA-F]{96}$/,Cm=y9(64,""),Im=x9(64),bm=/^[0-9a-fA-F]{128}$/,km=y9(86,"=="),hm=x9(86)});function UT(J,W,X){if(J.issues.length)W.issues.push(...N8(X,J.issues))}var L4,QT,Kw,ww,oN,sN,eN,JU,WU,XU,YU,GU,$U,AY,KU,wU,HU,ZU,zU,FU,NU,UU,QU;var Hw=D(()=>{vY();$w();Y6();L4=I("$ZodCheck",(J,W)=>{var X;J._zod??(J._zod={}),J._zod.def=W,(X=J._zod).onattach??(X.onattach=[])}),QT={number:"number",bigint:"bigint",object:"date"},Kw=I("$ZodCheckLessThan",(J,W)=>{L4.init(J,W);let X=QT[typeof W.value];J._zod.onattach.push((G)=>{let Y=G._zod.bag,$=(W.inclusive?Y.maximum:Y.exclusiveMaximum)??Number.POSITIVE_INFINITY;if(W.value<$)if(W.inclusive)Y.maximum=W.value;else Y.exclusiveMaximum=W.value}),J._zod.check=(G)=>{if(W.inclusive?G.value<=W.value:G.value<W.value)return;G.issues.push({origin:X,code:"too_big",maximum:W.value,input:G.value,inclusive:W.inclusive,inst:J,continue:!W.abort})}}),ww=I("$ZodCheckGreaterThan",(J,W)=>{L4.init(J,W);let X=QT[typeof W.value];J._zod.onattach.push((G)=>{let Y=G._zod.bag,$=(W.inclusive?Y.minimum:Y.exclusiveMinimum)??Number.NEGATIVE_INFINITY;if(W.value>$)if(W.inclusive)Y.minimum=W.value;else Y.exclusiveMinimum=W.value}),J._zod.check=(G)=>{if(W.inclusive?G.value>=W.value:G.value>W.value)return;G.issues.push({origin:X,code:"too_small",minimum:W.value,input:G.value,inclusive:W.inclusive,inst:J,continue:!W.abort})}}),oN=I("$ZodCheckMultipleOf",(J,W)=>{L4.init(J,W),J._zod.onattach.push((X)=>{var G;(G=X._zod.bag).multipleOf??(G.multipleOf=W.value)}),J._zod.check=(X)=>{if(typeof X.value!==typeof W.value)throw Error("Cannot mix number and bigint in multiple_of check.");if(typeof X.value==="bigint"?X.value%W.value===BigInt(0):FN(X.value,W.value)===0)return;X.issues.push({origin:typeof X.value,code:"not_multiple_of",divisor:W.value,input:X.value,inst:J,continue:!W.abort})}}),sN=I("$ZodCheckNumberFormat",(J,W)=>{L4.init(J,W),W.format=W.format||"float64";let X=W.format?.includes("int"),G=X?"int":"number",[Y,$]=VN[W.format];J._zod.onattach.push((K)=>{let w=K._zod.bag;if(w.format=W.format,w.minimum=Y,w.maximum=$,X)w.pattern=pN}),J._zod.check=(K)=>{let w=K.value;if(X){if(!Number.isInteger(w)){K.issues.push({expected:G,format:W.format,code:"invalid_type",continue:!1,input:w,inst:J});return}if(!Number.isSafeInteger(w)){if(w>0)K.issues.push({input:w,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:J,origin:G,continue:!W.abort});else K.issues.push({input:w,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:J,origin:G,continue:!W.abort});return}}if(w<Y)K.issues.push({origin:"number",input:w,code:"too_small",minimum:Y,inclusive:!0,inst:J,continue:!W.abort});if(w>$)K.issues.push({origin:"number",input:w,code:"too_big",maximum:$,inst:J})}}),eN=I("$ZodCheckBigIntFormat",(J,W)=>{L4.init(J,W);let[X,G]=DN[W.format];J._zod.onattach.push((Y)=>{let $=Y._zod.bag;$.format=W.format,$.minimum=X,$.maximum=G}),J._zod.check=(Y)=>{let $=Y.value;if($<X)Y.issues.push({origin:"bigint",input:$,code:"too_small",minimum:X,inclusive:!0,inst:J,continue:!W.abort});if($>G)Y.issues.push({origin:"bigint",input:$,code:"too_big",maximum:G,inst:J})}}),JU=I("$ZodCheckMaxSize",(J,W)=>{var X;L4.init(J,W),(X=J._zod.def).when??(X.when=(G)=>{let Y=G.value;return!cW(Y)&&Y.size!==void 0}),J._zod.onattach.push((G)=>{let Y=G._zod.bag.maximum??Number.POSITIVE_INFINITY;if(W.maximum<Y)G._zod.bag.maximum=W.maximum}),J._zod.check=(G)=>{let Y=G.value;if(Y.size<=W.maximum)return;G.issues.push({origin:f9(Y),code:"too_big",maximum:W.maximum,inclusive:!0,input:Y,inst:J,continue:!W.abort})}}),WU=I("$ZodCheckMinSize",(J,W)=>{var X;L4.init(J,W),(X=J._zod.def).when??(X.when=(G)=>{let Y=G.value;return!cW(Y)&&Y.size!==void 0}),J._zod.onattach.push((G)=>{let Y=G._zod.bag.minimum??Number.NEGATIVE_INFINITY;if(W.minimum>Y)G._zod.bag.minimum=W.minimum}),J._zod.check=(G)=>{let Y=G.value;if(Y.size>=W.minimum)return;G.issues.push({origin:f9(Y),code:"too_small",minimum:W.minimum,inclusive:!0,input:Y,inst:J,continue:!W.abort})}}),XU=I("$ZodCheckSizeEquals",(J,W)=>{var X;L4.init(J,W),(X=J._zod.def).when??(X.when=(G)=>{let Y=G.value;return!cW(Y)&&Y.size!==void 0}),J._zod.onattach.push((G)=>{let Y=G._zod.bag;Y.minimum=W.size,Y.maximum=W.size,Y.size=W.size}),J._zod.check=(G)=>{let Y=G.value,$=Y.size;if($===W.size)return;let K=$>W.size;G.issues.push({origin:f9(Y),...K?{code:"too_big",maximum:W.size}:{code:"too_small",minimum:W.size},inclusive:!0,exact:!0,input:G.value,inst:J,continue:!W.abort})}}),YU=I("$ZodCheckMaxLength",(J,W)=>{var X;L4.init(J,W),(X=J._zod.def).when??(X.when=(G)=>{let Y=G.value;return!cW(Y)&&Y.length!==void 0}),J._zod.onattach.push((G)=>{let Y=G._zod.bag.maximum??Number.POSITIVE_INFINITY;if(W.maximum<Y)G._zod.bag.maximum=W.maximum}),J._zod.check=(G)=>{let Y=G.value;if(Y.length<=W.maximum)return;let K=g9(Y);G.issues.push({origin:K,code:"too_big",maximum:W.maximum,inclusive:!0,input:Y,inst:J,continue:!W.abort})}}),GU=I("$ZodCheckMinLength",(J,W)=>{var X;L4.init(J,W),(X=J._zod.def).when??(X.when=(G)=>{let Y=G.value;return!cW(Y)&&Y.length!==void 0}),J._zod.onattach.push((G)=>{let Y=G._zod.bag.minimum??Number.NEGATIVE_INFINITY;if(W.minimum>Y)G._zod.bag.minimum=W.minimum}),J._zod.check=(G)=>{let Y=G.value;if(Y.length>=W.minimum)return;let K=g9(Y);G.issues.push({origin:K,code:"too_small",minimum:W.minimum,inclusive:!0,input:Y,inst:J,continue:!W.abort})}}),$U=I("$ZodCheckLengthEquals",(J,W)=>{var X;L4.init(J,W),(X=J._zod.def).when??(X.when=(G)=>{let Y=G.value;return!cW(Y)&&Y.length!==void 0}),J._zod.onattach.push((G)=>{let Y=G._zod.bag;Y.minimum=W.length,Y.maximum=W.length,Y.length=W.length}),J._zod.check=(G)=>{let Y=G.value,$=Y.length;if($===W.length)return;let K=g9(Y),w=$>W.length;G.issues.push({origin:K,...w?{code:"too_big",maximum:W.length}:{code:"too_small",minimum:W.length},inclusive:!0,exact:!0,input:G.value,inst:J,continue:!W.abort})}}),AY=I("$ZodCheckStringFormat",(J,W)=>{var X,G;if(L4.init(J,W),J._zod.onattach.push((Y)=>{let $=Y._zod.bag;if($.format=W.format,W.pattern)$.patterns??($.patterns=new Set),$.patterns.add(W.pattern)}),W.pattern)(X=J._zod).check??(X.check=(Y)=>{if(W.pattern.lastIndex=0,W.pattern.test(Y.value))return;Y.issues.push({origin:"string",code:"invalid_format",format:W.format,input:Y.value,...W.pattern?{pattern:W.pattern.toString()}:{},inst:J,continue:!W.abort})});else(G=J._zod).check??(G.check=()=>{})}),KU=I("$ZodCheckRegex",(J,W)=>{AY.init(J,W),J._zod.check=(X)=>{if(W.pattern.lastIndex=0,W.pattern.test(X.value))return;X.issues.push({origin:"string",code:"invalid_format",format:"regex",input:X.value,pattern:W.pattern.toString(),inst:J,continue:!W.abort})}}),wU=I("$ZodCheckLowerCase",(J,W)=>{W.pattern??(W.pattern=aN),AY.init(J,W)}),HU=I("$ZodCheckUpperCase",(J,W)=>{W.pattern??(W.pattern=tN),AY.init(J,W)}),ZU=I("$ZodCheckIncludes",(J,W)=>{L4.init(J,W);let X=PJ(W.includes),G=new RegExp(typeof W.position==="number"?`^.{${W.position}}${X}`:X);W.pattern=G,J._zod.onattach.push((Y)=>{let $=Y._zod.bag;$.patterns??($.patterns=new Set),$.patterns.add(G)}),J._zod.check=(Y)=>{if(Y.value.includes(W.includes,W.position))return;Y.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:W.includes,input:Y.value,inst:J,continue:!W.abort})}}),zU=I("$ZodCheckStartsWith",(J,W)=>{L4.init(J,W);let X=new RegExp(`^${PJ(W.prefix)}.*`);W.pattern??(W.pattern=X),J._zod.onattach.push((G)=>{let Y=G._zod.bag;Y.patterns??(Y.patterns=new Set),Y.patterns.add(X)}),J._zod.check=(G)=>{if(G.value.startsWith(W.prefix))return;G.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:W.prefix,input:G.value,inst:J,continue:!W.abort})}}),FU=I("$ZodCheckEndsWith",(J,W)=>{L4.init(J,W);let X=new RegExp(`.*${PJ(W.suffix)}$`);W.pattern??(W.pattern=X),J._zod.onattach.push((G)=>{let Y=G._zod.bag;Y.patterns??(Y.patterns=new Set),Y.patterns.add(X)}),J._zod.check=(G)=>{if(G.value.endsWith(W.suffix))return;G.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:W.suffix,input:G.value,inst:J,continue:!W.abort})}});NU=I("$ZodCheckProperty",(J,W)=>{L4.init(J,W),J._zod.check=(X)=>{let G=W.schema._zod.run({value:X.value[W.property],issues:[]},{});if(G instanceof Promise)return G.then((Y)=>UT(Y,X,W.property));UT(G,X,W.property);return}}),UU=I("$ZodCheckMimeType",(J,W)=>{L4.init(J,W);let X=new Set(W.mime);J._zod.onattach.push((G)=>{G._zod.bag.mime=W.mime}),J._zod.check=(G)=>{if(X.has(G.value.type))return;G.issues.push({code:"invalid_value",values:W.mime,input:G.value.type,inst:J,continue:!W.abort})}}),QU=I("$ZodCheckOverwrite",(J,W)=>{L4.init(J,W),J._zod.check=(X)=>{X.value=W.tx(X.value)}})});class Zw{constructor(J=[]){if(this.content=[],this.indent=0,this)this.args=J}indented(J){this.indent+=1,J(this),this.indent-=1}write(J){if(typeof J==="function"){J(this,{execution:"sync"}),J(this,{execution:"async"});return}let X=J.split(`
`).filter(($)=>$),G=Math.min(...X.map(($)=>$.length-$.trimStart().length)),Y=X.map(($)=>$.slice(G)).map(($)=>" ".repeat(this.indent*2)+$);for(let $ of Y)this.content.push($)}compile(){let J=Function,W=this?.args,G=[...(this?.content??[""]).map((Y)=>`  ${Y}`)];return new J(...W,G.join(`
`))}}var LU;var VU=D(()=>{LU={major:4,minor:1,patch:12}});function gU(J){if(J==="")return!0;if(J.length%4!==0)return!1;try{return atob(J),!0}catch{return!1}}function qT(J){if(!Gw.test(J))return!1;let W=J.replace(/[-_]/g,(G)=>G==="-"?"+":"/"),X=W.padEnd(Math.ceil(W.length/4)*4,"=");return gU(X)}function BT(J,W=null){try{let X=J.split(".");if(X.length!==3)return!1;let[G]=X;if(!G)return!1;let Y=JSON.parse(atob(G));if("typ"in Y&&Y?.typ!=="JWT")return!1;if(!Y.alg)return!1;if(W&&(!("alg"in Y)||Y.alg!==W))return!1;return!0}catch{return!1}}function VT(J,W,X){if(J.issues.length)W.issues.push(...N8(X,J.issues));W.value[X]=J.value}function Qw(J,W,X,G){if(J.issues.length)W.issues.push(...N8(X,J.issues));if(J.value===void 0){if(X in G)W.value[X]=void 0}else W.value[X]=J.value}function AT(J){let W=Object.keys(J.shape);for(let G of W)if(!J.shape?.[G]?._zod?.traits?.has("$ZodType"))throw Error(`Invalid element at key "${G}": expected a Zod schema`);let X=LN(J.shape);return{...J,keys:W,keySet:new Set(W),numKeys:W.length,optionalKeys:new Set(X)}}function ET(J,W,X,G,Y,$){let K=[],w=Y.keySet,H=Y.catchall._zod,Z=H.def.type;for(let z of Object.keys(W)){if(w.has(z))continue;if(Z==="never"){K.push(z);continue}let N=H.run({value:W[z],issues:[]},G);if(N instanceof Promise)J.push(N.then((F)=>Qw(F,X,z,W)));else Qw(N,X,z,W)}if(K.length)X.issues.push({code:"unrecognized_keys",keys:K,input:W,inst:$});if(!J.length)return X;return Promise.all(J).then(()=>{return X})}function DT(J,W,X,G){for(let $ of J)if($.issues.length===0)return W.value=$.value,W;let Y=J.filter(($)=>!rW($));if(Y.length===1)return W.value=Y[0].value,Y[0];return W.issues.push({code:"invalid_union",input:W.value,inst:X,errors:J.map(($)=>$.issues.map((K)=>U8(K,G,I4())))}),W}function DU(J,W){if(J===W)return{valid:!0,data:J};if(J instanceof Date&&W instanceof Date&&+J===+W)return{valid:!0,data:J};if(nW(J)&&nW(W)){let X=Object.keys(W),G=Object.keys(J).filter(($)=>X.indexOf($)!==-1),Y={...J,...W};for(let $ of G){let K=DU(J[$],W[$]);if(!K.valid)return{valid:!1,mergeErrorPath:[$,...K.mergeErrorPath]};Y[$]=K.data}return{valid:!0,data:Y}}if(Array.isArray(J)&&Array.isArray(W)){if(J.length!==W.length)return{valid:!1,mergeErrorPath:[]};let X=[];for(let G=0;G<J.length;G++){let Y=J[G],$=W[G],K=DU(Y,$);if(!K.valid)return{valid:!1,mergeErrorPath:[G,...K.mergeErrorPath]};X.push(K.data)}return{valid:!0,data:X}}return{valid:!1,mergeErrorPath:[]}}function vT(J,W,X){if(W.issues.length)J.issues.push(...W.issues);if(X.issues.length)J.issues.push(...X.issues);if(rW(J))return J;let G=DU(W.value,X.value);if(!G.valid)throw Error(`Unmergable intersection. Error path: ${JSON.stringify(G.mergeErrorPath)}`);return J.value=G.data,J}function zw(J,W,X){if(J.issues.length)W.issues.push(...N8(X,J.issues));W.value[X]=J.value}function MT(J,W,X,G,Y,$,K){if(J.issues.length)if(h9.has(typeof G))X.issues.push(...N8(G,J.issues));else X.issues.push({code:"invalid_key",origin:"map",input:Y,inst:$,issues:J.issues.map((w)=>U8(w,K,I4()))});if(W.issues.length)if(h9.has(typeof G))X.issues.push(...N8(G,W.issues));else X.issues.push({origin:"map",code:"invalid_element",input:Y,inst:$,key:G,issues:W.issues.map((w)=>U8(w,K,I4()))});X.value.set(J.value,W.value)}function OT(J,W){if(J.issues.length)W.issues.push(...J.issues);W.value.add(J.value)}function PT(J,W){if(J.issues.length&&W===void 0)return{issues:[],value:void 0};return J}function jT(J,W){if(J.value===void 0)J.value=W.defaultValue;return J}function _T(J,W){if(!J.issues.length&&J.value===void 0)J.issues.push({code:"invalid_type",expected:"nonoptional",input:J.value,inst:W});return J}function Fw(J,W,X){if(J.issues.length)return J.aborted=!0,J;return W._zod.run({value:J.value,issues:J.issues},X)}function Nw(J,W,X){if(J.issues.length)return J.aborted=!0,J;if((X.direction||"forward")==="forward"){let Y=W.transform(J.value,J);if(Y instanceof Promise)return Y.then(($)=>Uw(J,$,W.out,X));return Uw(J,Y,W.out,X)}else{let Y=W.reverseTransform(J.value,J);if(Y instanceof Promise)return Y.then(($)=>Uw(J,$,W.in,X));return Uw(J,Y,W.in,X)}}function Uw(J,W,X,G){if(J.issues.length)return J.aborted=!0,J;return X._zod.run({value:W,issues:J.issues},G)}function ST(J){return J.value=Object.freeze(J.value),J}function TT(J,W,X,G){if(!J){let Y={code:"custom",input:X,inst:G,path:[...G._zod.def.path??[]],continue:!G._zod.def.abort};if(G._zod.def.params)Y.params=G._zod.def.params;W.issues.push(PY(Y))}}var N6,cX,K4,vU,MU,OU,PU,jU,_U,SU,TU,qU,BU,AU,EU,RU,CU,IU,bU,kU,hU,fU,mU,yU,xU,uU,lU,Lw,cU,u9,Vw,pU,dU,nU,rU,iU,aU,tU,oU,sU,eU,RT,JQ,Dw,WQ,XQ,vw,YQ,GQ,$Q,KQ,wQ,HQ,ZQ,zQ,FQ,NQ,UQ,QQ,LQ,VQ,DQ,vQ,l9,MQ,OQ,PQ,jQ,_Q,SQ;var TQ=D(()=>{Hw();vY();PN();$w();Y6();VU();Y6();N6=I("$ZodType",(J,W)=>{var X;J??(J={}),J._zod.def=W,J._zod.bag=J._zod.bag||{},J._zod.version=LU;let G=[...J._zod.def.checks??[]];if(J._zod.traits.has("$ZodCheck"))G.unshift(J);for(let Y of G)for(let $ of Y._zod.onattach)$(J);if(G.length===0)(X=J._zod).deferred??(X.deferred=[]),J._zod.deferred?.push(()=>{J._zod.run=J._zod.parse});else{let Y=(K,w,H)=>{let Z=rW(K),z;for(let N of w){if(N._zod.def.when){if(!N._zod.def.when(K))continue}else if(Z)continue;let F=K.issues.length,Q=N._zod.check(K);if(Q instanceof Promise&&H?.async===!1)throw new OJ;if(z||Q instanceof Promise)z=(z??Promise.resolve()).then(async()=>{if(await Q,K.issues.length===F)return;if(!Z)Z=rW(K,F)});else{if(K.issues.length===F)continue;if(!Z)Z=rW(K,F)}}if(z)return z.then(()=>{return K});return K},$=(K,w,H)=>{if(rW(K))return K.aborted=!0,K;let Z=Y(w,G,H);if(Z instanceof Promise){if(H.async===!1)throw new OJ;return Z.then((z)=>J._zod.parse(z,H))}return J._zod.parse(Z,H)};J._zod.run=(K,w)=>{if(w.skipChecks)return J._zod.parse(K,w);if(w.direction==="backward"){let Z=J._zod.parse({value:K.value,issues:[]},{...w,skipChecks:!0});if(Z instanceof Promise)return Z.then((z)=>{return $(z,K,w)});return $(Z,K,w)}let H=J._zod.parse(K,w);if(H instanceof Promise){if(w.async===!1)throw new OJ;return H.then((Z)=>Y(Z,G,w))}return Y(H,G,w)}}J["~standard"]={validate:(Y)=>{try{let $=MN(J,Y);return $.success?{value:$.data}:{issues:$.error?.issues}}catch($){return ON(J,Y).then((K)=>K.success?{value:K.data}:{issues:K.error?.issues})}},vendor:"zod",version:1}}),cX=I("$ZodString",(J,W)=>{N6.init(J,W),J._zod.pattern=[...J?._zod.bag?.patterns??[]].pop()??lN(J._zod.bag),J._zod.parse=(X,G)=>{if(W.coerce)try{X.value=String(X.value)}catch(Y){}if(typeof X.value==="string")return X;return X.issues.push({expected:"string",code:"invalid_type",input:X.value,inst:J}),X}}),K4=I("$ZodStringFormat",(J,W)=>{AY.init(J,W),cX.init(J,W)}),vU=I("$ZodGUID",(J,W)=>{W.pattern??(W.pattern=EN),K4.init(J,W)}),MU=I("$ZodUUID",(J,W)=>{if(W.version){let G={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[W.version];if(G===void 0)throw Error(`Invalid UUID version: "${W.version}"`);W.pattern??(W.pattern=lX(G))}else W.pattern??(W.pattern=lX());K4.init(J,W)}),OU=I("$ZodEmail",(J,W)=>{W.pattern??(W.pattern=RN),K4.init(J,W)}),PU=I("$ZodURL",(J,W)=>{K4.init(J,W),J._zod.check=(X)=>{try{let G=X.value.trim(),Y=new URL(G);if(W.hostname){if(W.hostname.lastIndex=0,!W.hostname.test(Y.hostname))X.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:gN.source,input:X.value,inst:J,continue:!W.abort})}if(W.protocol){if(W.protocol.lastIndex=0,!W.protocol.test(Y.protocol.endsWith(":")?Y.protocol.slice(0,-1):Y.protocol))X.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:W.protocol.source,input:X.value,inst:J,continue:!W.abort})}if(W.normalize)X.value=Y.href;else X.value=G;return}catch(G){X.issues.push({code:"invalid_format",format:"url",input:X.value,inst:J,continue:!W.abort})}}}),jU=I("$ZodEmoji",(J,W)=>{W.pattern??(W.pattern=CN()),K4.init(J,W)}),_U=I("$ZodNanoID",(J,W)=>{W.pattern??(W.pattern=BN),K4.init(J,W)}),SU=I("$ZodCUID",(J,W)=>{W.pattern??(W.pattern=jN),K4.init(J,W)}),TU=I("$ZodCUID2",(J,W)=>{W.pattern??(W.pattern=_N),K4.init(J,W)}),qU=I("$ZodULID",(J,W)=>{W.pattern??(W.pattern=SN),K4.init(J,W)}),BU=I("$ZodXID",(J,W)=>{W.pattern??(W.pattern=TN),K4.init(J,W)}),AU=I("$ZodKSUID",(J,W)=>{W.pattern??(W.pattern=qN),K4.init(J,W)}),EU=I("$ZodISODateTime",(J,W)=>{W.pattern??(W.pattern=uN(W)),K4.init(J,W)}),RU=I("$ZodISODate",(J,W)=>{W.pattern??(W.pattern=yN),K4.init(J,W)}),CU=I("$ZodISOTime",(J,W)=>{W.pattern??(W.pattern=xN(W)),K4.init(J,W)}),IU=I("$ZodISODuration",(J,W)=>{W.pattern??(W.pattern=AN),K4.init(J,W)}),bU=I("$ZodIPv4",(J,W)=>{W.pattern??(W.pattern=IN),K4.init(J,W),J._zod.onattach.push((X)=>{let G=X._zod.bag;G.format="ipv4"})}),kU=I("$ZodIPv6",(J,W)=>{W.pattern??(W.pattern=bN),K4.init(J,W),J._zod.onattach.push((X)=>{let G=X._zod.bag;G.format="ipv6"}),J._zod.check=(X)=>{try{new URL(`http://[${X.value}]`)}catch{X.issues.push({code:"invalid_format",format:"ipv6",input:X.value,inst:J,continue:!W.abort})}}}),hU=I("$ZodCIDRv4",(J,W)=>{W.pattern??(W.pattern=kN),K4.init(J,W)}),fU=I("$ZodCIDRv6",(J,W)=>{W.pattern??(W.pattern=hN),K4.init(J,W),J._zod.check=(X)=>{let G=X.value.split("/");try{if(G.length!==2)throw Error();let[Y,$]=G;if(!$)throw Error();let K=Number($);if(`${K}`!==$)throw Error();if(K<0||K>128)throw Error();new URL(`http://[${Y}]`)}catch{X.issues.push({code:"invalid_format",format:"cidrv6",input:X.value,inst:J,continue:!W.abort})}}});mU=I("$ZodBase64",(J,W)=>{W.pattern??(W.pattern=fN),K4.init(J,W),J._zod.onattach.push((X)=>{X._zod.bag.contentEncoding="base64"}),J._zod.check=(X)=>{if(gU(X.value))return;X.issues.push({code:"invalid_format",format:"base64",input:X.value,inst:J,continue:!W.abort})}});yU=I("$ZodBase64URL",(J,W)=>{W.pattern??(W.pattern=Gw),K4.init(J,W),J._zod.onattach.push((X)=>{X._zod.bag.contentEncoding="base64url"}),J._zod.check=(X)=>{if(qT(X.value))return;X.issues.push({code:"invalid_format",format:"base64url",input:X.value,inst:J,continue:!W.abort})}}),xU=I("$ZodE164",(J,W)=>{W.pattern??(W.pattern=mN),K4.init(J,W)});uU=I("$ZodJWT",(J,W)=>{K4.init(J,W),J._zod.check=(X)=>{if(BT(X.value,W.alg))return;X.issues.push({code:"invalid_format",format:"jwt",input:X.value,inst:J,continue:!W.abort})}}),lU=I("$ZodCustomStringFormat",(J,W)=>{K4.init(J,W),J._zod.check=(X)=>{if(W.fn(X.value))return;X.issues.push({code:"invalid_format",format:W.format,input:X.value,inst:J,continue:!W.abort})}}),Lw=I("$ZodNumber",(J,W)=>{N6.init(J,W),J._zod.pattern=J._zod.bag.pattern??dN,J._zod.parse=(X,G)=>{if(W.coerce)try{X.value=Number(X.value)}catch(K){}let Y=X.value;if(typeof Y==="number"&&!Number.isNaN(Y)&&Number.isFinite(Y))return X;let $=typeof Y==="number"?Number.isNaN(Y)?"NaN":!Number.isFinite(Y)?"Infinity":void 0:void 0;return X.issues.push({expected:"number",code:"invalid_type",input:Y,inst:J,...$?{received:$}:{}}),X}}),cU=I("$ZodNumber",(J,W)=>{sN.init(J,W),Lw.init(J,W)}),u9=I("$ZodBoolean",(J,W)=>{N6.init(J,W),J._zod.pattern=nN,J._zod.parse=(X,G)=>{if(W.coerce)try{X.value=Boolean(X.value)}catch($){}let Y=X.value;if(typeof Y==="boolean")return X;return X.issues.push({expected:"boolean",code:"invalid_type",input:Y,inst:J}),X}}),Vw=I("$ZodBigInt",(J,W)=>{N6.init(J,W),J._zod.pattern=cN,J._zod.parse=(X,G)=>{if(W.coerce)try{X.value=BigInt(X.value)}catch(Y){}if(typeof X.value==="bigint")return X;return X.issues.push({expected:"bigint",code:"invalid_type",input:X.value,inst:J}),X}}),pU=I("$ZodBigInt",(J,W)=>{eN.init(J,W),Vw.init(J,W)}),dU=I("$ZodSymbol",(J,W)=>{N6.init(J,W),J._zod.parse=(X,G)=>{let Y=X.value;if(typeof Y==="symbol")return X;return X.issues.push({expected:"symbol",code:"invalid_type",input:Y,inst:J}),X}}),nU=I("$ZodUndefined",(J,W)=>{N6.init(J,W),J._zod.pattern=iN,J._zod.values=new Set([void 0]),J._zod.optin="optional",J._zod.optout="optional",J._zod.parse=(X,G)=>{let Y=X.value;if(typeof Y>"u")return X;return X.issues.push({expected:"undefined",code:"invalid_type",input:Y,inst:J}),X}}),rU=I("$ZodNull",(J,W)=>{N6.init(J,W),J._zod.pattern=rN,J._zod.values=new Set([null]),J._zod.parse=(X,G)=>{let Y=X.value;if(Y===null)return X;return X.issues.push({expected:"null",code:"invalid_type",input:Y,inst:J}),X}}),iU=I("$ZodAny",(J,W)=>{N6.init(J,W),J._zod.parse=(X)=>X}),aU=I("$ZodUnknown",(J,W)=>{N6.init(J,W),J._zod.parse=(X)=>X}),tU=I("$ZodNever",(J,W)=>{N6.init(J,W),J._zod.parse=(X,G)=>{return X.issues.push({expected:"never",code:"invalid_type",input:X.value,inst:J}),X}}),oU=I("$ZodVoid",(J,W)=>{N6.init(J,W),J._zod.parse=(X,G)=>{let Y=X.value;if(typeof Y>"u")return X;return X.issues.push({expected:"void",code:"invalid_type",input:Y,inst:J}),X}}),sU=I("$ZodDate",(J,W)=>{N6.init(J,W),J._zod.parse=(X,G)=>{if(W.coerce)try{X.value=new Date(X.value)}catch(w){}let Y=X.value,$=Y instanceof Date;if($&&!Number.isNaN(Y.getTime()))return X;return X.issues.push({expected:"date",code:"invalid_type",input:Y,...$?{received:"Invalid Date"}:{},inst:J}),X}});eU=I("$ZodArray",(J,W)=>{N6.init(J,W),J._zod.parse=(X,G)=>{let Y=X.value;if(!Array.isArray(Y))return X.issues.push({expected:"array",code:"invalid_type",input:Y,inst:J}),X;X.value=Array(Y.length);let $=[];for(let K=0;K<Y.length;K++){let w=Y[K],H=W.element._zod.run({value:w,issues:[]},G);if(H instanceof Promise)$.push(H.then((Z)=>VT(Z,X,K)));else VT(H,X,K)}if($.length)return Promise.all($).then(()=>X);return X}});RT=I("$ZodObject",(J,W)=>{if(N6.init(J,W),!Object.getOwnPropertyDescriptor(W,"shape")?.get){let w=W.shape;Object.defineProperty(W,"shape",{get:()=>{let H={...w};return Object.defineProperty(W,"shape",{value:H}),H}})}let G=OY(()=>AT(W));j6(J._zod,"propValues",()=>{let w=W.shape,H={};for(let Z in w){let z=w[Z]._zod;if(z.values){H[Z]??(H[Z]=new Set);for(let N of z.values)H[Z].add(N)}}return H});let Y=uX,$=W.catchall,K;J._zod.parse=(w,H)=>{K??(K=G.value);let Z=w.value;if(!Y(Z))return w.issues.push({expected:"object",code:"invalid_type",input:Z,inst:J}),w;w.value={};let z=[],N=K.shape;for(let F of K.keys){let V=N[F]._zod.run({value:Z[F],issues:[]},H);if(V instanceof Promise)z.push(V.then((v)=>Qw(v,w,F,Z)));else Qw(V,w,F,Z)}if(!$)return z.length?Promise.all(z).then(()=>w):w;return ET(z,Z,w,H,G.value,J)}}),JQ=I("$ZodObjectJIT",(J,W)=>{RT.init(J,W);let X=J._zod.parse,G=OY(()=>AT(W)),Y=(F)=>{let Q=new Zw(["shape","payload","ctx"]),V=G.value,v=(T)=>{let j=pK(T);return`shape[${j}]._zod.run({ value: input[${j}], issues: [] }, ctx)`};Q.write("const input = payload.value;");let M=Object.create(null),O=0;for(let T of V.keys)M[T]=`key_${O++}`;Q.write("const newResult = {};");for(let T of V.keys){let j=M[T],q=pK(T);Q.write(`const ${j} = ${v(T)};`),Q.write(`
        if (${j}.issues.length) {
          payload.issues = payload.issues.concat(${j}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${q}, ...iss.path] : [${q}]
          })));
        }
        
        
        if (${j}.value === undefined) {
          if (${q} in input) {
            newResult[${q}] = undefined;
          }
        } else {
          newResult[${q}] = ${j}.value;
        }
        
      `)}Q.write("payload.value = newResult;"),Q.write("return payload;");let S=Q.compile();return(T,j)=>S(F,T,j)},$,K=uX,w=!C9.jitless,Z=w&&NN.value,z=W.catchall,N;J._zod.parse=(F,Q)=>{N??(N=G.value);let V=F.value;if(!K(V))return F.issues.push({expected:"object",code:"invalid_type",input:V,inst:J}),F;if(w&&Z&&Q?.async===!1&&Q.jitless!==!0){if(!$)$=Y(W.shape);if(F=$(F,Q),!z)return F;return ET([],V,F,Q,N,J)}return X(F,Q)}});Dw=I("$ZodUnion",(J,W)=>{N6.init(J,W),j6(J._zod,"optin",()=>W.options.some((Y)=>Y._zod.optin==="optional")?"optional":void 0),j6(J._zod,"optout",()=>W.options.some((Y)=>Y._zod.optout==="optional")?"optional":void 0),j6(J._zod,"values",()=>{if(W.options.every((Y)=>Y._zod.values))return new Set(W.options.flatMap((Y)=>Array.from(Y._zod.values)));return}),j6(J._zod,"pattern",()=>{if(W.options.every((Y)=>Y._zod.pattern)){let Y=W.options.map(($)=>$._zod.pattern);return new RegExp(`^(${Y.map(($)=>k9($.source)).join("|")})$`)}return});let X=W.options.length===1,G=W.options[0]._zod.run;J._zod.parse=(Y,$)=>{if(X)return G(Y,$);let K=!1,w=[];for(let H of W.options){let Z=H._zod.run({value:Y.value,issues:[]},$);if(Z instanceof Promise)w.push(Z),K=!0;else{if(Z.issues.length===0)return Z;w.push(Z)}}if(!K)return DT(w,Y,J,$);return Promise.all(w).then((H)=>{return DT(H,Y,J,$)})}}),WQ=I("$ZodDiscriminatedUnion",(J,W)=>{Dw.init(J,W);let X=J._zod.parse;j6(J._zod,"propValues",()=>{let Y={};for(let $ of W.options){let K=$._zod.propValues;if(!K||Object.keys(K).length===0)throw Error(`Invalid discriminated union option at index "${W.options.indexOf($)}"`);for(let[w,H]of Object.entries(K)){if(!Y[w])Y[w]=new Set;for(let Z of H)Y[w].add(Z)}}return Y});let G=OY(()=>{let Y=W.options,$=new Map;for(let K of Y){let w=K._zod.propValues?.[W.discriminator];if(!w||w.size===0)throw Error(`Invalid discriminated union option at index "${W.options.indexOf(K)}"`);for(let H of w){if($.has(H))throw Error(`Duplicate discriminator value "${String(H)}"`);$.set(H,K)}}return $});J._zod.parse=(Y,$)=>{let K=Y.value;if(!uX(K))return Y.issues.push({code:"invalid_type",expected:"object",input:K,inst:J}),Y;let w=G.value.get(K?.[W.discriminator]);if(w)return w._zod.run(Y,$);if(W.unionFallback)return X(Y,$);return Y.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:W.discriminator,input:K,path:[W.discriminator],inst:J}),Y}}),XQ=I("$ZodIntersection",(J,W)=>{N6.init(J,W),J._zod.parse=(X,G)=>{let Y=X.value,$=W.left._zod.run({value:Y,issues:[]},G),K=W.right._zod.run({value:Y,issues:[]},G);if($ instanceof Promise||K instanceof Promise)return Promise.all([$,K]).then(([H,Z])=>{return vT(X,H,Z)});return vT(X,$,K)}});vw=I("$ZodTuple",(J,W)=>{N6.init(J,W);let X=W.items,G=X.length-[...X].reverse().findIndex((Y)=>Y._zod.optin!=="optional");J._zod.parse=(Y,$)=>{let K=Y.value;if(!Array.isArray(K))return Y.issues.push({input:K,inst:J,expected:"tuple",code:"invalid_type"}),Y;Y.value=[];let w=[];if(!W.rest){let Z=K.length>X.length,z=K.length<G-1;if(Z||z)return Y.issues.push({...Z?{code:"too_big",maximum:X.length}:{code:"too_small",minimum:X.length},input:K,inst:J,origin:"array"}),Y}let H=-1;for(let Z of X){if(H++,H>=K.length){if(H>=G)continue}let z=Z._zod.run({value:K[H],issues:[]},$);if(z instanceof Promise)w.push(z.then((N)=>zw(N,Y,H)));else zw(z,Y,H)}if(W.rest){let Z=K.slice(X.length);for(let z of Z){H++;let N=W.rest._zod.run({value:z,issues:[]},$);if(N instanceof Promise)w.push(N.then((F)=>zw(F,Y,H)));else zw(N,Y,H)}}if(w.length)return Promise.all(w).then(()=>Y);return Y}});YQ=I("$ZodRecord",(J,W)=>{N6.init(J,W),J._zod.parse=(X,G)=>{let Y=X.value;if(!nW(Y))return X.issues.push({expected:"record",code:"invalid_type",input:Y,inst:J}),X;let $=[];if(W.keyType._zod.values){let K=W.keyType._zod.values;X.value={};for(let H of K)if(typeof H==="string"||typeof H==="number"||typeof H==="symbol"){let Z=W.valueType._zod.run({value:Y[H],issues:[]},G);if(Z instanceof Promise)$.push(Z.then((z)=>{if(z.issues.length)X.issues.push(...N8(H,z.issues));X.value[H]=z.value}));else{if(Z.issues.length)X.issues.push(...N8(H,Z.issues));X.value[H]=Z.value}}let w;for(let H in Y)if(!K.has(H))w=w??[],w.push(H);if(w&&w.length>0)X.issues.push({code:"unrecognized_keys",input:Y,inst:J,keys:w})}else{X.value={};for(let K of Reflect.ownKeys(Y)){if(K==="__proto__")continue;let w=W.keyType._zod.run({value:K,issues:[]},G);if(w instanceof Promise)throw Error("Async schemas not supported in object keys currently");if(w.issues.length){X.issues.push({code:"invalid_key",origin:"record",issues:w.issues.map((Z)=>U8(Z,G,I4())),input:K,path:[K],inst:J}),X.value[w.value]=w.value;continue}let H=W.valueType._zod.run({value:Y[K],issues:[]},G);if(H instanceof Promise)$.push(H.then((Z)=>{if(Z.issues.length)X.issues.push(...N8(K,Z.issues));X.value[w.value]=Z.value}));else{if(H.issues.length)X.issues.push(...N8(K,H.issues));X.value[w.value]=H.value}}}if($.length)return Promise.all($).then(()=>X);return X}}),GQ=I("$ZodMap",(J,W)=>{N6.init(J,W),J._zod.parse=(X,G)=>{let Y=X.value;if(!(Y instanceof Map))return X.issues.push({expected:"map",code:"invalid_type",input:Y,inst:J}),X;let $=[];X.value=new Map;for(let[K,w]of Y){let H=W.keyType._zod.run({value:K,issues:[]},G),Z=W.valueType._zod.run({value:w,issues:[]},G);if(H instanceof Promise||Z instanceof Promise)$.push(Promise.all([H,Z]).then(([z,N])=>{MT(z,N,X,K,Y,J,G)}));else MT(H,Z,X,K,Y,J,G)}if($.length)return Promise.all($).then(()=>X);return X}});$Q=I("$ZodSet",(J,W)=>{N6.init(J,W),J._zod.parse=(X,G)=>{let Y=X.value;if(!(Y instanceof Set))return X.issues.push({input:Y,inst:J,expected:"set",code:"invalid_type"}),X;let $=[];X.value=new Set;for(let K of Y){let w=W.valueType._zod.run({value:K,issues:[]},G);if(w instanceof Promise)$.push(w.then((H)=>OT(H,X)));else OT(w,X)}if($.length)return Promise.all($).then(()=>X);return X}});KQ=I("$ZodEnum",(J,W)=>{N6.init(J,W);let X=b9(W.entries),G=new Set(X);J._zod.values=G,J._zod.pattern=new RegExp(`^(${X.filter((Y)=>h9.has(typeof Y)).map((Y)=>typeof Y==="string"?PJ(Y):Y.toString()).join("|")})$`),J._zod.parse=(Y,$)=>{let K=Y.value;if(G.has(K))return Y;return Y.issues.push({code:"invalid_value",values:X,input:K,inst:J}),Y}}),wQ=I("$ZodLiteral",(J,W)=>{if(N6.init(J,W),W.values.length===0)throw Error("Cannot create literal schema with no valid values");J._zod.values=new Set(W.values),J._zod.pattern=new RegExp(`^(${W.values.map((X)=>typeof X==="string"?PJ(X):X?PJ(X.toString()):String(X)).join("|")})$`),J._zod.parse=(X,G)=>{let Y=X.value;if(J._zod.values.has(Y))return X;return X.issues.push({code:"invalid_value",values:W.values,input:Y,inst:J}),X}}),HQ=I("$ZodFile",(J,W)=>{N6.init(J,W),J._zod.parse=(X,G)=>{let Y=X.value;if(Y instanceof File)return X;return X.issues.push({expected:"file",code:"invalid_type",input:Y,inst:J}),X}}),ZQ=I("$ZodTransform",(J,W)=>{N6.init(J,W),J._zod.parse=(X,G)=>{if(G.direction==="backward")throw new xX(J.constructor.name);let Y=W.transform(X.value,X);if(G.async)return(Y instanceof Promise?Y:Promise.resolve(Y)).then((K)=>{return X.value=K,X});if(Y instanceof Promise)throw new OJ;return X.value=Y,X}});zQ=I("$ZodOptional",(J,W)=>{N6.init(J,W),J._zod.optin="optional",J._zod.optout="optional",j6(J._zod,"values",()=>{return W.innerType._zod.values?new Set([...W.innerType._zod.values,void 0]):void 0}),j6(J._zod,"pattern",()=>{let X=W.innerType._zod.pattern;return X?new RegExp(`^(${k9(X.source)})?$`):void 0}),J._zod.parse=(X,G)=>{if(W.innerType._zod.optin==="optional"){let Y=W.innerType._zod.run(X,G);if(Y instanceof Promise)return Y.then(($)=>PT($,X.value));return PT(Y,X.value)}if(X.value===void 0)return X;return W.innerType._zod.run(X,G)}}),FQ=I("$ZodNullable",(J,W)=>{N6.init(J,W),j6(J._zod,"optin",()=>W.innerType._zod.optin),j6(J._zod,"optout",()=>W.innerType._zod.optout),j6(J._zod,"pattern",()=>{let X=W.innerType._zod.pattern;return X?new RegExp(`^(${k9(X.source)}|null)$`):void 0}),j6(J._zod,"values",()=>{return W.innerType._zod.values?new Set([...W.innerType._zod.values,null]):void 0}),J._zod.parse=(X,G)=>{if(X.value===null)return X;return W.innerType._zod.run(X,G)}}),NQ=I("$ZodDefault",(J,W)=>{N6.init(J,W),J._zod.optin="optional",j6(J._zod,"values",()=>W.innerType._zod.values),J._zod.parse=(X,G)=>{if(G.direction==="backward")return W.innerType._zod.run(X,G);if(X.value===void 0)return X.value=W.defaultValue,X;let Y=W.innerType._zod.run(X,G);if(Y instanceof Promise)return Y.then(($)=>jT($,W));return jT(Y,W)}});UQ=I("$ZodPrefault",(J,W)=>{N6.init(J,W),J._zod.optin="optional",j6(J._zod,"values",()=>W.innerType._zod.values),J._zod.parse=(X,G)=>{if(G.direction==="backward")return W.innerType._zod.run(X,G);if(X.value===void 0)X.value=W.defaultValue;return W.innerType._zod.run(X,G)}}),QQ=I("$ZodNonOptional",(J,W)=>{N6.init(J,W),j6(J._zod,"values",()=>{let X=W.innerType._zod.values;return X?new Set([...X].filter((G)=>G!==void 0)):void 0}),J._zod.parse=(X,G)=>{let Y=W.innerType._zod.run(X,G);if(Y instanceof Promise)return Y.then(($)=>_T($,J));return _T(Y,J)}});LQ=I("$ZodSuccess",(J,W)=>{N6.init(J,W),J._zod.parse=(X,G)=>{if(G.direction==="backward")throw new xX("ZodSuccess");let Y=W.innerType._zod.run(X,G);if(Y instanceof Promise)return Y.then(($)=>{return X.value=$.issues.length===0,X});return X.value=Y.issues.length===0,X}}),VQ=I("$ZodCatch",(J,W)=>{N6.init(J,W),j6(J._zod,"optin",()=>W.innerType._zod.optin),j6(J._zod,"optout",()=>W.innerType._zod.optout),j6(J._zod,"values",()=>W.innerType._zod.values),J._zod.parse=(X,G)=>{if(G.direction==="backward")return W.innerType._zod.run(X,G);let Y=W.innerType._zod.run(X,G);if(Y instanceof Promise)return Y.then(($)=>{if(X.value=$.value,$.issues.length)X.value=W.catchValue({...X,error:{issues:$.issues.map((K)=>U8(K,G,I4()))},input:X.value}),X.issues=[];return X});if(X.value=Y.value,Y.issues.length)X.value=W.catchValue({...X,error:{issues:Y.issues.map(($)=>U8($,G,I4()))},input:X.value}),X.issues=[];return X}}),DQ=I("$ZodNaN",(J,W)=>{N6.init(J,W),J._zod.parse=(X,G)=>{if(typeof X.value!=="number"||!Number.isNaN(X.value))return X.issues.push({input:X.value,inst:J,expected:"nan",code:"invalid_type"}),X;return X}}),vQ=I("$ZodPipe",(J,W)=>{N6.init(J,W),j6(J._zod,"values",()=>W.in._zod.values),j6(J._zod,"optin",()=>W.in._zod.optin),j6(J._zod,"optout",()=>W.out._zod.optout),j6(J._zod,"propValues",()=>W.in._zod.propValues),J._zod.parse=(X,G)=>{if(G.direction==="backward"){let $=W.out._zod.run(X,G);if($ instanceof Promise)return $.then((K)=>Fw(K,W.in,G));return Fw($,W.in,G)}let Y=W.in._zod.run(X,G);if(Y instanceof Promise)return Y.then(($)=>Fw($,W.out,G));return Fw(Y,W.out,G)}});l9=I("$ZodCodec",(J,W)=>{N6.init(J,W),j6(J._zod,"values",()=>W.in._zod.values),j6(J._zod,"optin",()=>W.in._zod.optin),j6(J._zod,"optout",()=>W.out._zod.optout),j6(J._zod,"propValues",()=>W.in._zod.propValues),J._zod.parse=(X,G)=>{if((G.direction||"forward")==="forward"){let $=W.in._zod.run(X,G);if($ instanceof Promise)return $.then((K)=>Nw(K,W,G));return Nw($,W,G)}else{let $=W.out._zod.run(X,G);if($ instanceof Promise)return $.then((K)=>Nw(K,W,G));return Nw($,W,G)}}});MQ=I("$ZodReadonly",(J,W)=>{N6.init(J,W),j6(J._zod,"propValues",()=>W.innerType._zod.propValues),j6(J._zod,"values",()=>W.innerType._zod.values),j6(J._zod,"optin",()=>W.innerType._zod.optin),j6(J._zod,"optout",()=>W.innerType._zod.optout),J._zod.parse=(X,G)=>{if(G.direction==="backward")return W.innerType._zod.run(X,G);let Y=W.innerType._zod.run(X,G);if(Y instanceof Promise)return Y.then(ST);return ST(Y)}});OQ=I("$ZodTemplateLiteral",(J,W)=>{N6.init(J,W);let X=[];for(let G of W.parts)if(typeof G==="object"&&G!==null){if(!G._zod.pattern)throw Error(`Invalid template literal part, no pattern found: ${[...G._zod.traits].shift()}`);let Y=G._zod.pattern instanceof RegExp?G._zod.pattern.source:G._zod.pattern;if(!Y)throw Error(`Invalid template literal part: ${G._zod.traits}`);let $=Y.startsWith("^")?1:0,K=Y.endsWith("$")?Y.length-1:Y.length;X.push(Y.slice($,K))}else if(G===null||QN.has(typeof G))X.push(PJ(`${G}`));else throw Error(`Invalid template literal part: ${G}`);J._zod.pattern=new RegExp(`^${X.join("")}$`),J._zod.parse=(G,Y)=>{if(typeof G.value!=="string")return G.issues.push({input:G.value,inst:J,expected:"template_literal",code:"invalid_type"}),G;if(J._zod.pattern.lastIndex=0,!J._zod.pattern.test(G.value))return G.issues.push({input:G.value,inst:J,code:"invalid_format",format:W.format??"template_literal",pattern:J._zod.pattern.source}),G;return G}}),PQ=I("$ZodFunction",(J,W)=>{return N6.init(J,W),J._def=W,J._zod.def=W,J.implement=(X)=>{if(typeof X!=="function")throw Error("implement() must be called with a function");return function(...G){let Y=J._def.input?iK(J._def.input,G):G,$=Reflect.apply(X,this,Y);if(J._def.output)return iK(J._def.output,$);return $}},J.implementAsync=(X)=>{if(typeof X!=="function")throw Error("implementAsync() must be called with a function");return async function(...G){let Y=J._def.input?await aK(J._def.input,G):G,$=await Reflect.apply(X,this,Y);if(J._def.output)return await aK(J._def.output,$);return $}},J._zod.parse=(X,G)=>{if(typeof X.value!=="function")return X.issues.push({code:"invalid_type",expected:"function",input:X.value,inst:J}),X;if(J._def.output&&J._def.output._zod.def.type==="promise")X.value=J.implementAsync(X.value);else X.value=J.implement(X.value);return X},J.input=(...X)=>{let G=J.constructor;if(Array.isArray(X[0]))return new G({type:"function",input:new vw({type:"tuple",items:X[0],rest:X[1]}),output:J._def.output});return new G({type:"function",input:X[0],output:J._def.output})},J.output=(X)=>{return new J.constructor({type:"function",input:J._def.input,output:X})},J}),jQ=I("$ZodPromise",(J,W)=>{N6.init(J,W),J._zod.parse=(X,G)=>{return Promise.resolve(X.value).then((Y)=>W.innerType._zod.run({value:Y,issues:[]},G))}}),_Q=I("$ZodLazy",(J,W)=>{N6.init(J,W),j6(J._zod,"innerType",()=>W.getter()),j6(J._zod,"pattern",()=>J._zod.innerType._zod.pattern),j6(J._zod,"propValues",()=>J._zod.innerType._zod.propValues),j6(J._zod,"optin",()=>J._zod.innerType._zod.optin??void 0),j6(J._zod,"optout",()=>J._zod.innerType._zod.optout??void 0),J._zod.parse=(X,G)=>{return J._zod.innerType._zod.run(X,G)}}),SQ=I("$ZodCustom",(J,W)=>{L4.init(J,W),N6.init(J,W),J._zod.parse=(X,G)=>{return X},J._zod.check=(X)=>{let G=X.value,Y=W.fn(G);if(Y instanceof Promise)return Y.then(($)=>TT($,X,G,J));TT(Y,X,G,J);return}})});function qQ(){return{localeError:gm()}}var gm=()=>{let J={string:{unit:"\u062D\u0631\u0641",verb:"\u0623\u0646 \u064A\u062D\u0648\u064A"},file:{unit:"\u0628\u0627\u064A\u062A",verb:"\u0623\u0646 \u064A\u062D\u0648\u064A"},array:{unit:"\u0639\u0646\u0635\u0631",verb:"\u0623\u0646 \u064A\u062D\u0648\u064A"},set:{unit:"\u0639\u0646\u0635\u0631",verb:"\u0623\u0646 \u064A\u062D\u0648\u064A"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"number";case"object":{if(Array.isArray(Y))return"array";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"\u0645\u062F\u062E\u0644",email:"\u0628\u0631\u064A\u062F \u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A",url:"\u0631\u0627\u0628\u0637",emoji:"\u0625\u064A\u0645\u0648\u062C\u064A",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"\u062A\u0627\u0631\u064A\u062E \u0648\u0648\u0642\u062A \u0628\u0645\u0639\u064A\u0627\u0631 ISO",date:"\u062A\u0627\u0631\u064A\u062E \u0628\u0645\u0639\u064A\u0627\u0631 ISO",time:"\u0648\u0642\u062A \u0628\u0645\u0639\u064A\u0627\u0631 ISO",duration:"\u0645\u062F\u0629 \u0628\u0645\u0639\u064A\u0627\u0631 ISO",ipv4:"\u0639\u0646\u0648\u0627\u0646 IPv4",ipv6:"\u0639\u0646\u0648\u0627\u0646 IPv6",cidrv4:"\u0645\u062F\u0649 \u0639\u0646\u0627\u0648\u064A\u0646 \u0628\u0635\u064A\u063A\u0629 IPv4",cidrv6:"\u0645\u062F\u0649 \u0639\u0646\u0627\u0648\u064A\u0646 \u0628\u0635\u064A\u063A\u0629 IPv6",base64:"\u0646\u064E\u0635 \u0628\u062A\u0631\u0645\u064A\u0632 base64-encoded",base64url:"\u0646\u064E\u0635 \u0628\u062A\u0631\u0645\u064A\u0632 base64url-encoded",json_string:"\u0646\u064E\u0635 \u0639\u0644\u0649 \u0647\u064A\u0626\u0629 JSON",e164:"\u0631\u0642\u0645 \u0647\u0627\u062A\u0641 \u0628\u0645\u0639\u064A\u0627\u0631 E.164",jwt:"JWT",template_literal:"\u0645\u062F\u062E\u0644"};return(Y)=>{switch(Y.code){case"invalid_type":return`\u0645\u062F\u062E\u0644\u0627\u062A \u063A\u064A\u0631 \u0645\u0642\u0628\u0648\u0644\u0629: \u064A\u0641\u062A\u0631\u0636 \u0625\u062F\u062E\u0627\u0644 ${Y.expected}\u060C \u0648\u0644\u0643\u0646 \u062A\u0645 \u0625\u062F\u062E\u0627\u0644 ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`\u0645\u062F\u062E\u0644\u0627\u062A \u063A\u064A\u0631 \u0645\u0642\u0628\u0648\u0644\u0629: \u064A\u0641\u062A\u0631\u0636 \u0625\u062F\u062E\u0627\u0644 ${p(Y.values[0])}`;return`\u0627\u062E\u062A\u064A\u0627\u0631 \u063A\u064A\u0631 \u0645\u0642\u0628\u0648\u0644: \u064A\u062A\u0648\u0642\u0639 \u0627\u0646\u062A\u0642\u0627\u0621 \u0623\u062D\u062F \u0647\u0630\u0647 \u0627\u0644\u062E\u064A\u0627\u0631\u0627\u062A: ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return` \u0623\u0643\u0628\u0631 \u0645\u0646 \u0627\u0644\u0644\u0627\u0632\u0645: \u064A\u0641\u062A\u0631\u0636 \u0623\u0646 \u062A\u0643\u0648\u0646 ${Y.origin??"\u0627\u0644\u0642\u064A\u0645\u0629"} ${$} ${Y.maximum.toString()} ${K.unit??"\u0639\u0646\u0635\u0631"}`;return`\u0623\u0643\u0628\u0631 \u0645\u0646 \u0627\u0644\u0644\u0627\u0632\u0645: \u064A\u0641\u062A\u0631\u0636 \u0623\u0646 \u062A\u0643\u0648\u0646 ${Y.origin??"\u0627\u0644\u0642\u064A\u0645\u0629"} ${$} ${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`\u0623\u0635\u063A\u0631 \u0645\u0646 \u0627\u0644\u0644\u0627\u0632\u0645: \u064A\u0641\u062A\u0631\u0636 \u0644\u0640 ${Y.origin} \u0623\u0646 \u064A\u0643\u0648\u0646 ${$} ${Y.minimum.toString()} ${K.unit}`;return`\u0623\u0635\u063A\u0631 \u0645\u0646 \u0627\u0644\u0644\u0627\u0632\u0645: \u064A\u0641\u062A\u0631\u0636 \u0644\u0640 ${Y.origin} \u0623\u0646 \u064A\u0643\u0648\u0646 ${$} ${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`\u0646\u064E\u0635 \u063A\u064A\u0631 \u0645\u0642\u0628\u0648\u0644: \u064A\u062C\u0628 \u0623\u0646 \u064A\u0628\u062F\u0623 \u0628\u0640 "${Y.prefix}"`;if($.format==="ends_with")return`\u0646\u064E\u0635 \u063A\u064A\u0631 \u0645\u0642\u0628\u0648\u0644: \u064A\u062C\u0628 \u0623\u0646 \u064A\u0646\u062A\u0647\u064A \u0628\u0640 "${$.suffix}"`;if($.format==="includes")return`\u0646\u064E\u0635 \u063A\u064A\u0631 \u0645\u0642\u0628\u0648\u0644: \u064A\u062C\u0628 \u0623\u0646 \u064A\u062A\u0636\u0645\u0651\u064E\u0646 "${$.includes}"`;if($.format==="regex")return`\u0646\u064E\u0635 \u063A\u064A\u0631 \u0645\u0642\u0628\u0648\u0644: \u064A\u062C\u0628 \u0623\u0646 \u064A\u0637\u0627\u0628\u0642 \u0627\u0644\u0646\u0645\u0637 ${$.pattern}`;return`${G[$.format]??Y.format} \u063A\u064A\u0631 \u0645\u0642\u0628\u0648\u0644`}case"not_multiple_of":return`\u0631\u0642\u0645 \u063A\u064A\u0631 \u0645\u0642\u0628\u0648\u0644: \u064A\u062C\u0628 \u0623\u0646 \u064A\u0643\u0648\u0646 \u0645\u0646 \u0645\u0636\u0627\u0639\u0641\u0627\u062A ${Y.divisor}`;case"unrecognized_keys":return`\u0645\u0639\u0631\u0641${Y.keys.length>1?"\u0627\u062A":""} \u063A\u0631\u064A\u0628${Y.keys.length>1?"\u0629":""}: ${h(Y.keys,"\u060C ")}`;case"invalid_key":return`\u0645\u0639\u0631\u0641 \u063A\u064A\u0631 \u0645\u0642\u0628\u0648\u0644 \u0641\u064A ${Y.origin}`;case"invalid_union":return"\u0645\u062F\u062E\u0644 \u063A\u064A\u0631 \u0645\u0642\u0628\u0648\u0644";case"invalid_element":return`\u0645\u062F\u062E\u0644 \u063A\u064A\u0631 \u0645\u0642\u0628\u0648\u0644 \u0641\u064A ${Y.origin}`;default:return"\u0645\u062F\u062E\u0644 \u063A\u064A\u0631 \u0645\u0642\u0628\u0648\u0644"}}};var CT=D(()=>{Y6()});function BQ(){return{localeError:mm()}}var mm=()=>{let J={string:{unit:"simvol",verb:"olmal\u0131d\u0131r"},file:{unit:"bayt",verb:"olmal\u0131d\u0131r"},array:{unit:"element",verb:"olmal\u0131d\u0131r"},set:{unit:"element",verb:"olmal\u0131d\u0131r"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"number";case"object":{if(Array.isArray(Y))return"array";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"};return(Y)=>{switch(Y.code){case"invalid_type":return`Yanl\u0131\u015F d\u0259y\u0259r: g\xF6zl\u0259nil\u0259n ${Y.expected}, daxil olan ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`Yanl\u0131\u015F d\u0259y\u0259r: g\xF6zl\u0259nil\u0259n ${p(Y.values[0])}`;return`Yanl\u0131\u015F se\xE7im: a\u015Fa\u011F\u0131dak\u0131lardan biri olmal\u0131d\u0131r: ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`\xC7ox b\xF6y\xFCk: g\xF6zl\u0259nil\u0259n ${Y.origin??"d\u0259y\u0259r"} ${$}${Y.maximum.toString()} ${K.unit??"element"}`;return`\xC7ox b\xF6y\xFCk: g\xF6zl\u0259nil\u0259n ${Y.origin??"d\u0259y\u0259r"} ${$}${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`\xC7ox ki\xE7ik: g\xF6zl\u0259nil\u0259n ${Y.origin} ${$}${Y.minimum.toString()} ${K.unit}`;return`\xC7ox ki\xE7ik: g\xF6zl\u0259nil\u0259n ${Y.origin} ${$}${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`Yanl\u0131\u015F m\u0259tn: "${$.prefix}" il\u0259 ba\u015Flamal\u0131d\u0131r`;if($.format==="ends_with")return`Yanl\u0131\u015F m\u0259tn: "${$.suffix}" il\u0259 bitm\u0259lidir`;if($.format==="includes")return`Yanl\u0131\u015F m\u0259tn: "${$.includes}" daxil olmal\u0131d\u0131r`;if($.format==="regex")return`Yanl\u0131\u015F m\u0259tn: ${$.pattern} \u015Fablonuna uy\u011Fun olmal\u0131d\u0131r`;return`Yanl\u0131\u015F ${G[$.format]??Y.format}`}case"not_multiple_of":return`Yanl\u0131\u015F \u0259d\u0259d: ${Y.divisor} il\u0259 b\xF6l\xFCn\u0259 bil\u0259n olmal\u0131d\u0131r`;case"unrecognized_keys":return`Tan\u0131nmayan a\xE7ar${Y.keys.length>1?"lar":""}: ${h(Y.keys,", ")}`;case"invalid_key":return`${Y.origin} daxilind\u0259 yanl\u0131\u015F a\xE7ar`;case"invalid_union":return"Yanl\u0131\u015F d\u0259y\u0259r";case"invalid_element":return`${Y.origin} daxilind\u0259 yanl\u0131\u015F d\u0259y\u0259r`;default:return"Yanl\u0131\u015F d\u0259y\u0259r"}}};var IT=D(()=>{Y6()});function bT(J,W,X,G){let Y=Math.abs(J),$=Y%10,K=Y%100;if(K>=11&&K<=19)return G;if($===1)return W;if($>=2&&$<=4)return X;return G}function AQ(){return{localeError:ym()}}var ym=()=>{let J={string:{unit:{one:"\u0441\u0456\u043C\u0432\u0430\u043B",few:"\u0441\u0456\u043C\u0432\u0430\u043B\u044B",many:"\u0441\u0456\u043C\u0432\u0430\u043B\u0430\u045E"},verb:"\u043C\u0435\u0446\u044C"},array:{unit:{one:"\u044D\u043B\u0435\u043C\u0435\u043D\u0442",few:"\u044D\u043B\u0435\u043C\u0435\u043D\u0442\u044B",many:"\u044D\u043B\u0435\u043C\u0435\u043D\u0442\u0430\u045E"},verb:"\u043C\u0435\u0446\u044C"},set:{unit:{one:"\u044D\u043B\u0435\u043C\u0435\u043D\u0442",few:"\u044D\u043B\u0435\u043C\u0435\u043D\u0442\u044B",many:"\u044D\u043B\u0435\u043C\u0435\u043D\u0442\u0430\u045E"},verb:"\u043C\u0435\u0446\u044C"},file:{unit:{one:"\u0431\u0430\u0439\u0442",few:"\u0431\u0430\u0439\u0442\u044B",many:"\u0431\u0430\u0439\u0442\u0430\u045E"},verb:"\u043C\u0435\u0446\u044C"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"\u043B\u0456\u043A";case"object":{if(Array.isArray(Y))return"\u043C\u0430\u0441\u0456\u045E";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"\u0443\u0432\u043E\u0434",email:"email \u0430\u0434\u0440\u0430\u0441",url:"URL",emoji:"\u044D\u043C\u043E\u0434\u0437\u0456",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO \u0434\u0430\u0442\u0430 \u0456 \u0447\u0430\u0441",date:"ISO \u0434\u0430\u0442\u0430",time:"ISO \u0447\u0430\u0441",duration:"ISO \u043F\u0440\u0430\u0446\u044F\u0433\u043B\u0430\u0441\u0446\u044C",ipv4:"IPv4 \u0430\u0434\u0440\u0430\u0441",ipv6:"IPv6 \u0430\u0434\u0440\u0430\u0441",cidrv4:"IPv4 \u0434\u044B\u044F\u043F\u0430\u0437\u043E\u043D",cidrv6:"IPv6 \u0434\u044B\u044F\u043F\u0430\u0437\u043E\u043D",base64:"\u0440\u0430\u0434\u043E\u043A \u0443 \u0444\u0430\u0440\u043C\u0430\u0446\u0435 base64",base64url:"\u0440\u0430\u0434\u043E\u043A \u0443 \u0444\u0430\u0440\u043C\u0430\u0446\u0435 base64url",json_string:"JSON \u0440\u0430\u0434\u043E\u043A",e164:"\u043D\u0443\u043C\u0430\u0440 E.164",jwt:"JWT",template_literal:"\u0443\u0432\u043E\u0434"};return(Y)=>{switch(Y.code){case"invalid_type":return`\u041D\u044F\u043F\u0440\u0430\u0432\u0456\u043B\u044C\u043D\u044B \u045E\u0432\u043E\u0434: \u0447\u0430\u043A\u0430\u045E\u0441\u044F ${Y.expected}, \u0430\u0442\u0440\u044B\u043C\u0430\u043D\u0430 ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`\u041D\u044F\u043F\u0440\u0430\u0432\u0456\u043B\u044C\u043D\u044B \u045E\u0432\u043E\u0434: \u0447\u0430\u043A\u0430\u043B\u0430\u0441\u044F ${p(Y.values[0])}`;return`\u041D\u044F\u043F\u0440\u0430\u0432\u0456\u043B\u044C\u043D\u044B \u0432\u0430\u0440\u044B\u044F\u043D\u0442: \u0447\u0430\u043A\u0430\u045E\u0441\u044F \u0430\u0434\u0437\u0456\u043D \u0437 ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K){let w=Number(Y.maximum),H=bT(w,K.unit.one,K.unit.few,K.unit.many);return`\u0417\u0430\u043D\u0430\u0434\u0442\u0430 \u0432\u044F\u043B\u0456\u043A\u0456: \u0447\u0430\u043A\u0430\u043B\u0430\u0441\u044F, \u0448\u0442\u043E ${Y.origin??"\u0437\u043D\u0430\u0447\u044D\u043D\u043D\u0435"} \u043F\u0430\u0432\u0456\u043D\u043D\u0430 ${K.verb} ${$}${Y.maximum.toString()} ${H}`}return`\u0417\u0430\u043D\u0430\u0434\u0442\u0430 \u0432\u044F\u043B\u0456\u043A\u0456: \u0447\u0430\u043A\u0430\u043B\u0430\u0441\u044F, \u0448\u0442\u043E ${Y.origin??"\u0437\u043D\u0430\u0447\u044D\u043D\u043D\u0435"} \u043F\u0430\u0432\u0456\u043D\u043D\u0430 \u0431\u044B\u0446\u044C ${$}${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K){let w=Number(Y.minimum),H=bT(w,K.unit.one,K.unit.few,K.unit.many);return`\u0417\u0430\u043D\u0430\u0434\u0442\u0430 \u043C\u0430\u043B\u044B: \u0447\u0430\u043A\u0430\u043B\u0430\u0441\u044F, \u0448\u0442\u043E ${Y.origin} \u043F\u0430\u0432\u0456\u043D\u043D\u0430 ${K.verb} ${$}${Y.minimum.toString()} ${H}`}return`\u0417\u0430\u043D\u0430\u0434\u0442\u0430 \u043C\u0430\u043B\u044B: \u0447\u0430\u043A\u0430\u043B\u0430\u0441\u044F, \u0448\u0442\u043E ${Y.origin} \u043F\u0430\u0432\u0456\u043D\u043D\u0430 \u0431\u044B\u0446\u044C ${$}${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`\u041D\u044F\u043F\u0440\u0430\u0432\u0456\u043B\u044C\u043D\u044B \u0440\u0430\u0434\u043E\u043A: \u043F\u0430\u0432\u0456\u043D\u0435\u043D \u043F\u0430\u0447\u044B\u043D\u0430\u0446\u0446\u0430 \u0437 "${$.prefix}"`;if($.format==="ends_with")return`\u041D\u044F\u043F\u0440\u0430\u0432\u0456\u043B\u044C\u043D\u044B \u0440\u0430\u0434\u043E\u043A: \u043F\u0430\u0432\u0456\u043D\u0435\u043D \u0437\u0430\u043A\u0430\u043D\u0447\u0432\u0430\u0446\u0446\u0430 \u043D\u0430 "${$.suffix}"`;if($.format==="includes")return`\u041D\u044F\u043F\u0440\u0430\u0432\u0456\u043B\u044C\u043D\u044B \u0440\u0430\u0434\u043E\u043A: \u043F\u0430\u0432\u0456\u043D\u0435\u043D \u0437\u043C\u044F\u0448\u0447\u0430\u0446\u044C "${$.includes}"`;if($.format==="regex")return`\u041D\u044F\u043F\u0440\u0430\u0432\u0456\u043B\u044C\u043D\u044B \u0440\u0430\u0434\u043E\u043A: \u043F\u0430\u0432\u0456\u043D\u0435\u043D \u0430\u0434\u043F\u0430\u0432\u044F\u0434\u0430\u0446\u044C \u0448\u0430\u0431\u043B\u043E\u043D\u0443 ${$.pattern}`;return`\u041D\u044F\u043F\u0440\u0430\u0432\u0456\u043B\u044C\u043D\u044B ${G[$.format]??Y.format}`}case"not_multiple_of":return`\u041D\u044F\u043F\u0440\u0430\u0432\u0456\u043B\u044C\u043D\u044B \u043B\u0456\u043A: \u043F\u0430\u0432\u0456\u043D\u0435\u043D \u0431\u044B\u0446\u044C \u043A\u0440\u0430\u0442\u043D\u044B\u043C ${Y.divisor}`;case"unrecognized_keys":return`\u041D\u0435\u0440\u0430\u0441\u043F\u0430\u0437\u043D\u0430\u043D\u044B ${Y.keys.length>1?"\u043A\u043B\u044E\u0447\u044B":"\u043A\u043B\u044E\u0447"}: ${h(Y.keys,", ")}`;case"invalid_key":return`\u041D\u044F\u043F\u0440\u0430\u0432\u0456\u043B\u044C\u043D\u044B \u043A\u043B\u044E\u0447 \u0443 ${Y.origin}`;case"invalid_union":return"\u041D\u044F\u043F\u0440\u0430\u0432\u0456\u043B\u044C\u043D\u044B \u045E\u0432\u043E\u0434";case"invalid_element":return`\u041D\u044F\u043F\u0440\u0430\u0432\u0456\u043B\u044C\u043D\u0430\u0435 \u0437\u043D\u0430\u0447\u044D\u043D\u043D\u0435 \u045E ${Y.origin}`;default:return"\u041D\u044F\u043F\u0440\u0430\u0432\u0456\u043B\u044C\u043D\u044B \u045E\u0432\u043E\u0434"}}};var kT=D(()=>{Y6()});function EQ(){return{localeError:um()}}var xm=(J)=>{let W=typeof J;switch(W){case"number":return Number.isNaN(J)?"NaN":"\u0447\u0438\u0441\u043B\u043E";case"object":{if(Array.isArray(J))return"\u043C\u0430\u0441\u0438\u0432";if(J===null)return"null";if(Object.getPrototypeOf(J)!==Object.prototype&&J.constructor)return J.constructor.name}}return W},um=()=>{let J={string:{unit:"\u0441\u0438\u043C\u0432\u043E\u043B\u0430",verb:"\u0434\u0430 \u0441\u044A\u0434\u044A\u0440\u0436\u0430"},file:{unit:"\u0431\u0430\u0439\u0442\u0430",verb:"\u0434\u0430 \u0441\u044A\u0434\u044A\u0440\u0436\u0430"},array:{unit:"\u0435\u043B\u0435\u043C\u0435\u043D\u0442\u0430",verb:"\u0434\u0430 \u0441\u044A\u0434\u044A\u0440\u0436\u0430"},set:{unit:"\u0435\u043B\u0435\u043C\u0435\u043D\u0442\u0430",verb:"\u0434\u0430 \u0441\u044A\u0434\u044A\u0440\u0436\u0430"}};function W(G){return J[G]??null}let X={regex:"\u0432\u0445\u043E\u0434",email:"\u0438\u043C\u0435\u0439\u043B \u0430\u0434\u0440\u0435\u0441",url:"URL",emoji:"\u0435\u043C\u043E\u0434\u0436\u0438",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO \u0432\u0440\u0435\u043C\u0435",date:"ISO \u0434\u0430\u0442\u0430",time:"ISO \u0432\u0440\u0435\u043C\u0435",duration:"ISO \u043F\u0440\u043E\u0434\u044A\u043B\u0436\u0438\u0442\u0435\u043B\u043D\u043E\u0441\u0442",ipv4:"IPv4 \u0430\u0434\u0440\u0435\u0441",ipv6:"IPv6 \u0430\u0434\u0440\u0435\u0441",cidrv4:"IPv4 \u0434\u0438\u0430\u043F\u0430\u0437\u043E\u043D",cidrv6:"IPv6 \u0434\u0438\u0430\u043F\u0430\u0437\u043E\u043D",base64:"base64-\u043A\u043E\u0434\u0438\u0440\u0430\u043D \u043D\u0438\u0437",base64url:"base64url-\u043A\u043E\u0434\u0438\u0440\u0430\u043D \u043D\u0438\u0437",json_string:"JSON \u043D\u0438\u0437",e164:"E.164 \u043D\u043E\u043C\u0435\u0440",jwt:"JWT",template_literal:"\u0432\u0445\u043E\u0434"};return(G)=>{switch(G.code){case"invalid_type":return`\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u0435\u043D \u0432\u0445\u043E\u0434: \u043E\u0447\u0430\u043A\u0432\u0430\u043D ${G.expected}, \u043F\u043E\u043B\u0443\u0447\u0435\u043D ${xm(G.input)}`;case"invalid_value":if(G.values.length===1)return`\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u0435\u043D \u0432\u0445\u043E\u0434: \u043E\u0447\u0430\u043A\u0432\u0430\u043D ${p(G.values[0])}`;return`\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u043D\u0430 \u043E\u043F\u0446\u0438\u044F: \u043E\u0447\u0430\u043A\u0432\u0430\u043D\u043E \u0435\u0434\u043D\u043E \u043E\u0442 ${h(G.values,"|")}`;case"too_big":{let Y=G.inclusive?"<=":"<",$=W(G.origin);if($)return`\u0422\u0432\u044A\u0440\u0434\u0435 \u0433\u043E\u043B\u044F\u043C\u043E: \u043E\u0447\u0430\u043A\u0432\u0430 \u0441\u0435 ${G.origin??"\u0441\u0442\u043E\u0439\u043D\u043E\u0441\u0442"} \u0434\u0430 \u0441\u044A\u0434\u044A\u0440\u0436\u0430 ${Y}${G.maximum.toString()} ${$.unit??"\u0435\u043B\u0435\u043C\u0435\u043D\u0442\u0430"}`;return`\u0422\u0432\u044A\u0440\u0434\u0435 \u0433\u043E\u043B\u044F\u043C\u043E: \u043E\u0447\u0430\u043A\u0432\u0430 \u0441\u0435 ${G.origin??"\u0441\u0442\u043E\u0439\u043D\u043E\u0441\u0442"} \u0434\u0430 \u0431\u044A\u0434\u0435 ${Y}${G.maximum.toString()}`}case"too_small":{let Y=G.inclusive?">=":">",$=W(G.origin);if($)return`\u0422\u0432\u044A\u0440\u0434\u0435 \u043C\u0430\u043B\u043A\u043E: \u043E\u0447\u0430\u043A\u0432\u0430 \u0441\u0435 ${G.origin} \u0434\u0430 \u0441\u044A\u0434\u044A\u0440\u0436\u0430 ${Y}${G.minimum.toString()} ${$.unit}`;return`\u0422\u0432\u044A\u0440\u0434\u0435 \u043C\u0430\u043B\u043A\u043E: \u043E\u0447\u0430\u043A\u0432\u0430 \u0441\u0435 ${G.origin} \u0434\u0430 \u0431\u044A\u0434\u0435 ${Y}${G.minimum.toString()}`}case"invalid_format":{let Y=G;if(Y.format==="starts_with")return`\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u0435\u043D \u043D\u0438\u0437: \u0442\u0440\u044F\u0431\u0432\u0430 \u0434\u0430 \u0437\u0430\u043F\u043E\u0447\u0432\u0430 \u0441 "${Y.prefix}"`;if(Y.format==="ends_with")return`\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u0435\u043D \u043D\u0438\u0437: \u0442\u0440\u044F\u0431\u0432\u0430 \u0434\u0430 \u0437\u0430\u0432\u044A\u0440\u0448\u0432\u0430 \u0441 "${Y.suffix}"`;if(Y.format==="includes")return`\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u0435\u043D \u043D\u0438\u0437: \u0442\u0440\u044F\u0431\u0432\u0430 \u0434\u0430 \u0432\u043A\u043B\u044E\u0447\u0432\u0430 "${Y.includes}"`;if(Y.format==="regex")return`\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u0435\u043D \u043D\u0438\u0437: \u0442\u0440\u044F\u0431\u0432\u0430 \u0434\u0430 \u0441\u044A\u0432\u043F\u0430\u0434\u0430 \u0441 ${Y.pattern}`;let $="\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u0435\u043D";if(Y.format==="emoji")$="\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u043D\u043E";if(Y.format==="datetime")$="\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u043D\u043E";if(Y.format==="date")$="\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u043D\u0430";if(Y.format==="time")$="\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u043D\u043E";if(Y.format==="duration")$="\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u043D\u0430";return`${$} ${X[Y.format]??G.format}`}case"not_multiple_of":return`\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u043D\u043E \u0447\u0438\u0441\u043B\u043E: \u0442\u0440\u044F\u0431\u0432\u0430 \u0434\u0430 \u0431\u044A\u0434\u0435 \u043A\u0440\u0430\u0442\u043D\u043E \u043D\u0430 ${G.divisor}`;case"unrecognized_keys":return`\u041D\u0435\u0440\u0430\u0437\u043F\u043E\u0437\u043D\u0430\u0442${G.keys.length>1?"\u0438":""} \u043A\u043B\u044E\u0447${G.keys.length>1?"\u043E\u0432\u0435":""}: ${h(G.keys,", ")}`;case"invalid_key":return`\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u0435\u043D \u043A\u043B\u044E\u0447 \u0432 ${G.origin}`;case"invalid_union":return"\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u0435\u043D \u0432\u0445\u043E\u0434";case"invalid_element":return`\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u043D\u0430 \u0441\u0442\u043E\u0439\u043D\u043E\u0441\u0442 \u0432 ${G.origin}`;default:return"\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u0435\u043D \u0432\u0445\u043E\u0434"}}};var hT=D(()=>{Y6()});function RQ(){return{localeError:lm()}}var lm=()=>{let J={string:{unit:"car\xE0cters",verb:"contenir"},file:{unit:"bytes",verb:"contenir"},array:{unit:"elements",verb:"contenir"},set:{unit:"elements",verb:"contenir"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"number";case"object":{if(Array.isArray(Y))return"array";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"entrada",email:"adre\xE7a electr\xF2nica",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data i hora ISO",date:"data ISO",time:"hora ISO",duration:"durada ISO",ipv4:"adre\xE7a IPv4",ipv6:"adre\xE7a IPv6",cidrv4:"rang IPv4",cidrv6:"rang IPv6",base64:"cadena codificada en base64",base64url:"cadena codificada en base64url",json_string:"cadena JSON",e164:"n\xFAmero E.164",jwt:"JWT",template_literal:"entrada"};return(Y)=>{switch(Y.code){case"invalid_type":return`Tipus inv\xE0lid: s'esperava ${Y.expected}, s'ha rebut ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`Valor inv\xE0lid: s'esperava ${p(Y.values[0])}`;return`Opci\xF3 inv\xE0lida: s'esperava una de ${h(Y.values," o ")}`;case"too_big":{let $=Y.inclusive?"com a m\xE0xim":"menys de",K=W(Y.origin);if(K)return`Massa gran: s'esperava que ${Y.origin??"el valor"} contingu\xE9s ${$} ${Y.maximum.toString()} ${K.unit??"elements"}`;return`Massa gran: s'esperava que ${Y.origin??"el valor"} fos ${$} ${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?"com a m\xEDnim":"m\xE9s de",K=W(Y.origin);if(K)return`Massa petit: s'esperava que ${Y.origin} contingu\xE9s ${$} ${Y.minimum.toString()} ${K.unit}`;return`Massa petit: s'esperava que ${Y.origin} fos ${$} ${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`Format inv\xE0lid: ha de comen\xE7ar amb "${$.prefix}"`;if($.format==="ends_with")return`Format inv\xE0lid: ha d'acabar amb "${$.suffix}"`;if($.format==="includes")return`Format inv\xE0lid: ha d'incloure "${$.includes}"`;if($.format==="regex")return`Format inv\xE0lid: ha de coincidir amb el patr\xF3 ${$.pattern}`;return`Format inv\xE0lid per a ${G[$.format]??Y.format}`}case"not_multiple_of":return`N\xFAmero inv\xE0lid: ha de ser m\xFAltiple de ${Y.divisor}`;case"unrecognized_keys":return`Clau${Y.keys.length>1?"s":""} no reconeguda${Y.keys.length>1?"s":""}: ${h(Y.keys,", ")}`;case"invalid_key":return`Clau inv\xE0lida a ${Y.origin}`;case"invalid_union":return"Entrada inv\xE0lida";case"invalid_element":return`Element inv\xE0lid a ${Y.origin}`;default:return"Entrada inv\xE0lida"}}};var fT=D(()=>{Y6()});function CQ(){return{localeError:cm()}}var cm=()=>{let J={string:{unit:"znak\u016F",verb:"m\xEDt"},file:{unit:"bajt\u016F",verb:"m\xEDt"},array:{unit:"prvk\u016F",verb:"m\xEDt"},set:{unit:"prvk\u016F",verb:"m\xEDt"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"\u010D\xEDslo";case"string":return"\u0159et\u011Bzec";case"boolean":return"boolean";case"bigint":return"bigint";case"function":return"funkce";case"symbol":return"symbol";case"undefined":return"undefined";case"object":{if(Array.isArray(Y))return"pole";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"regul\xE1rn\xED v\xFDraz",email:"e-mailov\xE1 adresa",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"datum a \u010Das ve form\xE1tu ISO",date:"datum ve form\xE1tu ISO",time:"\u010Das ve form\xE1tu ISO",duration:"doba trv\xE1n\xED ISO",ipv4:"IPv4 adresa",ipv6:"IPv6 adresa",cidrv4:"rozsah IPv4",cidrv6:"rozsah IPv6",base64:"\u0159et\u011Bzec zak\xF3dovan\xFD ve form\xE1tu base64",base64url:"\u0159et\u011Bzec zak\xF3dovan\xFD ve form\xE1tu base64url",json_string:"\u0159et\u011Bzec ve form\xE1tu JSON",e164:"\u010D\xEDslo E.164",jwt:"JWT",template_literal:"vstup"};return(Y)=>{switch(Y.code){case"invalid_type":return`Neplatn\xFD vstup: o\u010Dek\xE1v\xE1no ${Y.expected}, obdr\u017Eeno ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`Neplatn\xFD vstup: o\u010Dek\xE1v\xE1no ${p(Y.values[0])}`;return`Neplatn\xE1 mo\u017Enost: o\u010Dek\xE1v\xE1na jedna z hodnot ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`Hodnota je p\u0159\xEDli\u0161 velk\xE1: ${Y.origin??"hodnota"} mus\xED m\xEDt ${$}${Y.maximum.toString()} ${K.unit??"prvk\u016F"}`;return`Hodnota je p\u0159\xEDli\u0161 velk\xE1: ${Y.origin??"hodnota"} mus\xED b\xFDt ${$}${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`Hodnota je p\u0159\xEDli\u0161 mal\xE1: ${Y.origin??"hodnota"} mus\xED m\xEDt ${$}${Y.minimum.toString()} ${K.unit??"prvk\u016F"}`;return`Hodnota je p\u0159\xEDli\u0161 mal\xE1: ${Y.origin??"hodnota"} mus\xED b\xFDt ${$}${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`Neplatn\xFD \u0159et\u011Bzec: mus\xED za\u010D\xEDnat na "${$.prefix}"`;if($.format==="ends_with")return`Neplatn\xFD \u0159et\u011Bzec: mus\xED kon\u010Dit na "${$.suffix}"`;if($.format==="includes")return`Neplatn\xFD \u0159et\u011Bzec: mus\xED obsahovat "${$.includes}"`;if($.format==="regex")return`Neplatn\xFD \u0159et\u011Bzec: mus\xED odpov\xEDdat vzoru ${$.pattern}`;return`Neplatn\xFD form\xE1t ${G[$.format]??Y.format}`}case"not_multiple_of":return`Neplatn\xE9 \u010D\xEDslo: mus\xED b\xFDt n\xE1sobkem ${Y.divisor}`;case"unrecognized_keys":return`Nezn\xE1m\xE9 kl\xED\u010De: ${h(Y.keys,", ")}`;case"invalid_key":return`Neplatn\xFD kl\xED\u010D v ${Y.origin}`;case"invalid_union":return"Neplatn\xFD vstup";case"invalid_element":return`Neplatn\xE1 hodnota v ${Y.origin}`;default:return"Neplatn\xFD vstup"}}};var gT=D(()=>{Y6()});function IQ(){return{localeError:pm()}}var pm=()=>{let J={string:{unit:"tegn",verb:"havde"},file:{unit:"bytes",verb:"havde"},array:{unit:"elementer",verb:"indeholdt"},set:{unit:"elementer",verb:"indeholdt"}},W={string:"streng",number:"tal",boolean:"boolean",array:"liste",object:"objekt",set:"s\xE6t",file:"fil"};function X(K){return J[K]??null}function G(K){return W[K]??K}let Y=(K)=>{let w=typeof K;switch(w){case"number":return Number.isNaN(K)?"NaN":"tal";case"object":{if(Array.isArray(K))return"liste";if(K===null)return"null";if(Object.getPrototypeOf(K)!==Object.prototype&&K.constructor)return K.constructor.name;return"objekt"}}return w},$={regex:"input",email:"e-mailadresse",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO dato- og klokkesl\xE6t",date:"ISO-dato",time:"ISO-klokkesl\xE6t",duration:"ISO-varighed",ipv4:"IPv4-omr\xE5de",ipv6:"IPv6-omr\xE5de",cidrv4:"IPv4-spektrum",cidrv6:"IPv6-spektrum",base64:"base64-kodet streng",base64url:"base64url-kodet streng",json_string:"JSON-streng",e164:"E.164-nummer",jwt:"JWT",template_literal:"input"};return(K)=>{switch(K.code){case"invalid_type":return`Ugyldigt input: forventede ${G(K.expected)}, fik ${G(Y(K.input))}`;case"invalid_value":if(K.values.length===1)return`Ugyldig v\xE6rdi: forventede ${p(K.values[0])}`;return`Ugyldigt valg: forventede en af f\xF8lgende ${h(K.values,"|")}`;case"too_big":{let w=K.inclusive?"<=":"<",H=X(K.origin),Z=G(K.origin);if(H)return`For stor: forventede ${Z??"value"} ${H.verb} ${w} ${K.maximum.toString()} ${H.unit??"elementer"}`;return`For stor: forventede ${Z??"value"} havde ${w} ${K.maximum.toString()}`}case"too_small":{let w=K.inclusive?">=":">",H=X(K.origin),Z=G(K.origin);if(H)return`For lille: forventede ${Z} ${H.verb} ${w} ${K.minimum.toString()} ${H.unit}`;return`For lille: forventede ${Z} havde ${w} ${K.minimum.toString()}`}case"invalid_format":{let w=K;if(w.format==="starts_with")return`Ugyldig streng: skal starte med "${w.prefix}"`;if(w.format==="ends_with")return`Ugyldig streng: skal ende med "${w.suffix}"`;if(w.format==="includes")return`Ugyldig streng: skal indeholde "${w.includes}"`;if(w.format==="regex")return`Ugyldig streng: skal matche m\xF8nsteret ${w.pattern}`;return`Ugyldig ${$[w.format]??K.format}`}case"not_multiple_of":return`Ugyldigt tal: skal v\xE6re deleligt med ${K.divisor}`;case"unrecognized_keys":return`${K.keys.length>1?"Ukendte n\xF8gler":"Ukendt n\xF8gle"}: ${h(K.keys,", ")}`;case"invalid_key":return`Ugyldig n\xF8gle i ${K.origin}`;case"invalid_union":return"Ugyldigt input: matcher ingen af de tilladte typer";case"invalid_element":return`Ugyldig v\xE6rdi i ${K.origin}`;default:return"Ugyldigt input"}}};var mT=D(()=>{Y6()});function bQ(){return{localeError:dm()}}var dm=()=>{let J={string:{unit:"Zeichen",verb:"zu haben"},file:{unit:"Bytes",verb:"zu haben"},array:{unit:"Elemente",verb:"zu haben"},set:{unit:"Elemente",verb:"zu haben"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"Zahl";case"object":{if(Array.isArray(Y))return"Array";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"Eingabe",email:"E-Mail-Adresse",url:"URL",emoji:"Emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-Datum und -Uhrzeit",date:"ISO-Datum",time:"ISO-Uhrzeit",duration:"ISO-Dauer",ipv4:"IPv4-Adresse",ipv6:"IPv6-Adresse",cidrv4:"IPv4-Bereich",cidrv6:"IPv6-Bereich",base64:"Base64-codierter String",base64url:"Base64-URL-codierter String",json_string:"JSON-String",e164:"E.164-Nummer",jwt:"JWT",template_literal:"Eingabe"};return(Y)=>{switch(Y.code){case"invalid_type":return`Ung\xFCltige Eingabe: erwartet ${Y.expected}, erhalten ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`Ung\xFCltige Eingabe: erwartet ${p(Y.values[0])}`;return`Ung\xFCltige Option: erwartet eine von ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`Zu gro\xDF: erwartet, dass ${Y.origin??"Wert"} ${$}${Y.maximum.toString()} ${K.unit??"Elemente"} hat`;return`Zu gro\xDF: erwartet, dass ${Y.origin??"Wert"} ${$}${Y.maximum.toString()} ist`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`Zu klein: erwartet, dass ${Y.origin} ${$}${Y.minimum.toString()} ${K.unit} hat`;return`Zu klein: erwartet, dass ${Y.origin} ${$}${Y.minimum.toString()} ist`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`Ung\xFCltiger String: muss mit "${$.prefix}" beginnen`;if($.format==="ends_with")return`Ung\xFCltiger String: muss mit "${$.suffix}" enden`;if($.format==="includes")return`Ung\xFCltiger String: muss "${$.includes}" enthalten`;if($.format==="regex")return`Ung\xFCltiger String: muss dem Muster ${$.pattern} entsprechen`;return`Ung\xFCltig: ${G[$.format]??Y.format}`}case"not_multiple_of":return`Ung\xFCltige Zahl: muss ein Vielfaches von ${Y.divisor} sein`;case"unrecognized_keys":return`${Y.keys.length>1?"Unbekannte Schl\xFCssel":"Unbekannter Schl\xFCssel"}: ${h(Y.keys,", ")}`;case"invalid_key":return`Ung\xFCltiger Schl\xFCssel in ${Y.origin}`;case"invalid_union":return"Ung\xFCltige Eingabe";case"invalid_element":return`Ung\xFCltiger Wert in ${Y.origin}`;default:return"Ung\xFCltige Eingabe"}}};var yT=D(()=>{Y6()});function c9(){return{localeError:rm()}}var nm=(J)=>{let W=typeof J;switch(W){case"number":return Number.isNaN(J)?"NaN":"number";case"object":{if(Array.isArray(J))return"array";if(J===null)return"null";if(Object.getPrototypeOf(J)!==Object.prototype&&J.constructor)return J.constructor.name}}return W},rm=()=>{let J={string:{unit:"characters",verb:"to have"},file:{unit:"bytes",verb:"to have"},array:{unit:"items",verb:"to have"},set:{unit:"items",verb:"to have"}};function W(G){return J[G]??null}let X={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"};return(G)=>{switch(G.code){case"invalid_type":return`Invalid input: expected ${G.expected}, received ${nm(G.input)}`;case"invalid_value":if(G.values.length===1)return`Invalid input: expected ${p(G.values[0])}`;return`Invalid option: expected one of ${h(G.values,"|")}`;case"too_big":{let Y=G.inclusive?"<=":"<",$=W(G.origin);if($)return`Too big: expected ${G.origin??"value"} to have ${Y}${G.maximum.toString()} ${$.unit??"elements"}`;return`Too big: expected ${G.origin??"value"} to be ${Y}${G.maximum.toString()}`}case"too_small":{let Y=G.inclusive?">=":">",$=W(G.origin);if($)return`Too small: expected ${G.origin} to have ${Y}${G.minimum.toString()} ${$.unit}`;return`Too small: expected ${G.origin} to be ${Y}${G.minimum.toString()}`}case"invalid_format":{let Y=G;if(Y.format==="starts_with")return`Invalid string: must start with "${Y.prefix}"`;if(Y.format==="ends_with")return`Invalid string: must end with "${Y.suffix}"`;if(Y.format==="includes")return`Invalid string: must include "${Y.includes}"`;if(Y.format==="regex")return`Invalid string: must match pattern ${Y.pattern}`;return`Invalid ${X[Y.format]??G.format}`}case"not_multiple_of":return`Invalid number: must be a multiple of ${G.divisor}`;case"unrecognized_keys":return`Unrecognized key${G.keys.length>1?"s":""}: ${h(G.keys,", ")}`;case"invalid_key":return`Invalid key in ${G.origin}`;case"invalid_union":return"Invalid input";case"invalid_element":return`Invalid value in ${G.origin}`;default:return"Invalid input"}}};var kQ=D(()=>{Y6()});function hQ(){return{localeError:am()}}var im=(J)=>{let W=typeof J;switch(W){case"number":return Number.isNaN(J)?"NaN":"nombro";case"object":{if(Array.isArray(J))return"tabelo";if(J===null)return"senvalora";if(Object.getPrototypeOf(J)!==Object.prototype&&J.constructor)return J.constructor.name}}return W},am=()=>{let J={string:{unit:"karaktrojn",verb:"havi"},file:{unit:"bajtojn",verb:"havi"},array:{unit:"elementojn",verb:"havi"},set:{unit:"elementojn",verb:"havi"}};function W(G){return J[G]??null}let X={regex:"enigo",email:"retadreso",url:"URL",emoji:"emo\u011Dio",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-datotempo",date:"ISO-dato",time:"ISO-tempo",duration:"ISO-da\u016Dro",ipv4:"IPv4-adreso",ipv6:"IPv6-adreso",cidrv4:"IPv4-rango",cidrv6:"IPv6-rango",base64:"64-ume kodita karaktraro",base64url:"URL-64-ume kodita karaktraro",json_string:"JSON-karaktraro",e164:"E.164-nombro",jwt:"JWT",template_literal:"enigo"};return(G)=>{switch(G.code){case"invalid_type":return`Nevalida enigo: atendi\u011Dis ${G.expected}, ricevi\u011Dis ${im(G.input)}`;case"invalid_value":if(G.values.length===1)return`Nevalida enigo: atendi\u011Dis ${p(G.values[0])}`;return`Nevalida opcio: atendi\u011Dis unu el ${h(G.values,"|")}`;case"too_big":{let Y=G.inclusive?"<=":"<",$=W(G.origin);if($)return`Tro granda: atendi\u011Dis ke ${G.origin??"valoro"} havu ${Y}${G.maximum.toString()} ${$.unit??"elementojn"}`;return`Tro granda: atendi\u011Dis ke ${G.origin??"valoro"} havu ${Y}${G.maximum.toString()}`}case"too_small":{let Y=G.inclusive?">=":">",$=W(G.origin);if($)return`Tro malgranda: atendi\u011Dis ke ${G.origin} havu ${Y}${G.minimum.toString()} ${$.unit}`;return`Tro malgranda: atendi\u011Dis ke ${G.origin} estu ${Y}${G.minimum.toString()}`}case"invalid_format":{let Y=G;if(Y.format==="starts_with")return`Nevalida karaktraro: devas komenci\u011Di per "${Y.prefix}"`;if(Y.format==="ends_with")return`Nevalida karaktraro: devas fini\u011Di per "${Y.suffix}"`;if(Y.format==="includes")return`Nevalida karaktraro: devas inkluzivi "${Y.includes}"`;if(Y.format==="regex")return`Nevalida karaktraro: devas kongrui kun la modelo ${Y.pattern}`;return`Nevalida ${X[Y.format]??G.format}`}case"not_multiple_of":return`Nevalida nombro: devas esti oblo de ${G.divisor}`;case"unrecognized_keys":return`Nekonata${G.keys.length>1?"j":""} \u015Dlosilo${G.keys.length>1?"j":""}: ${h(G.keys,", ")}`;case"invalid_key":return`Nevalida \u015Dlosilo en ${G.origin}`;case"invalid_union":return"Nevalida enigo";case"invalid_element":return`Nevalida valoro en ${G.origin}`;default:return"Nevalida enigo"}}};var xT=D(()=>{Y6()});function fQ(){return{localeError:tm()}}var tm=()=>{let J={string:{unit:"caracteres",verb:"tener"},file:{unit:"bytes",verb:"tener"},array:{unit:"elementos",verb:"tener"},set:{unit:"elementos",verb:"tener"}},W={string:"texto",number:"n\xFAmero",boolean:"booleano",array:"arreglo",object:"objeto",set:"conjunto",file:"archivo",date:"fecha",bigint:"n\xFAmero grande",symbol:"s\xEDmbolo",undefined:"indefinido",null:"nulo",function:"funci\xF3n",map:"mapa",record:"registro",tuple:"tupla",enum:"enumeraci\xF3n",union:"uni\xF3n",literal:"literal",promise:"promesa",void:"vac\xEDo",never:"nunca",unknown:"desconocido",any:"cualquiera"};function X(K){return J[K]??null}function G(K){return W[K]??K}let Y=(K)=>{let w=typeof K;switch(w){case"number":return Number.isNaN(K)?"NaN":"number";case"object":{if(Array.isArray(K))return"array";if(K===null)return"null";if(Object.getPrototypeOf(K)!==Object.prototype)return K.constructor.name;return"object"}}return w},$={regex:"entrada",email:"direcci\xF3n de correo electr\xF3nico",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"fecha y hora ISO",date:"fecha ISO",time:"hora ISO",duration:"duraci\xF3n ISO",ipv4:"direcci\xF3n IPv4",ipv6:"direcci\xF3n IPv6",cidrv4:"rango IPv4",cidrv6:"rango IPv6",base64:"cadena codificada en base64",base64url:"URL codificada en base64",json_string:"cadena JSON",e164:"n\xFAmero E.164",jwt:"JWT",template_literal:"entrada"};return(K)=>{switch(K.code){case"invalid_type":return`Entrada inv\xE1lida: se esperaba ${G(K.expected)}, recibido ${G(Y(K.input))}`;case"invalid_value":if(K.values.length===1)return`Entrada inv\xE1lida: se esperaba ${p(K.values[0])}`;return`Opci\xF3n inv\xE1lida: se esperaba una de ${h(K.values,"|")}`;case"too_big":{let w=K.inclusive?"<=":"<",H=X(K.origin),Z=G(K.origin);if(H)return`Demasiado grande: se esperaba que ${Z??"valor"} tuviera ${w}${K.maximum.toString()} ${H.unit??"elementos"}`;return`Demasiado grande: se esperaba que ${Z??"valor"} fuera ${w}${K.maximum.toString()}`}case"too_small":{let w=K.inclusive?">=":">",H=X(K.origin),Z=G(K.origin);if(H)return`Demasiado peque\xF1o: se esperaba que ${Z} tuviera ${w}${K.minimum.toString()} ${H.unit}`;return`Demasiado peque\xF1o: se esperaba que ${Z} fuera ${w}${K.minimum.toString()}`}case"invalid_format":{let w=K;if(w.format==="starts_with")return`Cadena inv\xE1lida: debe comenzar con "${w.prefix}"`;if(w.format==="ends_with")return`Cadena inv\xE1lida: debe terminar en "${w.suffix}"`;if(w.format==="includes")return`Cadena inv\xE1lida: debe incluir "${w.includes}"`;if(w.format==="regex")return`Cadena inv\xE1lida: debe coincidir con el patr\xF3n ${w.pattern}`;return`Inv\xE1lido ${$[w.format]??K.format}`}case"not_multiple_of":return`N\xFAmero inv\xE1lido: debe ser m\xFAltiplo de ${K.divisor}`;case"unrecognized_keys":return`Llave${K.keys.length>1?"s":""} desconocida${K.keys.length>1?"s":""}: ${h(K.keys,", ")}`;case"invalid_key":return`Llave inv\xE1lida en ${G(K.origin)}`;case"invalid_union":return"Entrada inv\xE1lida";case"invalid_element":return`Valor inv\xE1lido en ${G(K.origin)}`;default:return"Entrada inv\xE1lida"}}};var uT=D(()=>{Y6()});function gQ(){return{localeError:om()}}var om=()=>{let J={string:{unit:"\u06A9\u0627\u0631\u0627\u06A9\u062A\u0631",verb:"\u062F\u0627\u0634\u062A\u0647 \u0628\u0627\u0634\u062F"},file:{unit:"\u0628\u0627\u06CC\u062A",verb:"\u062F\u0627\u0634\u062A\u0647 \u0628\u0627\u0634\u062F"},array:{unit:"\u0622\u06CC\u062A\u0645",verb:"\u062F\u0627\u0634\u062A\u0647 \u0628\u0627\u0634\u062F"},set:{unit:"\u0622\u06CC\u062A\u0645",verb:"\u062F\u0627\u0634\u062A\u0647 \u0628\u0627\u0634\u062F"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"\u0639\u062F\u062F";case"object":{if(Array.isArray(Y))return"\u0622\u0631\u0627\u06CC\u0647";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"\u0648\u0631\u0648\u062F\u06CC",email:"\u0622\u062F\u0631\u0633 \u0627\u06CC\u0645\u06CC\u0644",url:"URL",emoji:"\u0627\u06CC\u0645\u0648\u062C\u06CC",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"\u062A\u0627\u0631\u06CC\u062E \u0648 \u0632\u0645\u0627\u0646 \u0627\u06CC\u0632\u0648",date:"\u062A\u0627\u0631\u06CC\u062E \u0627\u06CC\u0632\u0648",time:"\u0632\u0645\u0627\u0646 \u0627\u06CC\u0632\u0648",duration:"\u0645\u062F\u062A \u0632\u0645\u0627\u0646 \u0627\u06CC\u0632\u0648",ipv4:"IPv4 \u0622\u062F\u0631\u0633",ipv6:"IPv6 \u0622\u062F\u0631\u0633",cidrv4:"IPv4 \u062F\u0627\u0645\u0646\u0647",cidrv6:"IPv6 \u062F\u0627\u0645\u0646\u0647",base64:"base64-encoded \u0631\u0634\u062A\u0647",base64url:"base64url-encoded \u0631\u0634\u062A\u0647",json_string:"JSON \u0631\u0634\u062A\u0647",e164:"E.164 \u0639\u062F\u062F",jwt:"JWT",template_literal:"\u0648\u0631\u0648\u062F\u06CC"};return(Y)=>{switch(Y.code){case"invalid_type":return`\u0648\u0631\u0648\u062F\u06CC \u0646\u0627\u0645\u0639\u062A\u0628\u0631: \u0645\u06CC\u200C\u0628\u0627\u06CC\u0633\u062A ${Y.expected} \u0645\u06CC\u200C\u0628\u0648\u062F\u060C ${X(Y.input)} \u062F\u0631\u06CC\u0627\u0641\u062A \u0634\u062F`;case"invalid_value":if(Y.values.length===1)return`\u0648\u0631\u0648\u062F\u06CC \u0646\u0627\u0645\u0639\u062A\u0628\u0631: \u0645\u06CC\u200C\u0628\u0627\u06CC\u0633\u062A ${p(Y.values[0])} \u0645\u06CC\u200C\u0628\u0648\u062F`;return`\u06AF\u0632\u06CC\u0646\u0647 \u0646\u0627\u0645\u0639\u062A\u0628\u0631: \u0645\u06CC\u200C\u0628\u0627\u06CC\u0633\u062A \u06CC\u06A9\u06CC \u0627\u0632 ${h(Y.values,"|")} \u0645\u06CC\u200C\u0628\u0648\u062F`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`\u062E\u06CC\u0644\u06CC \u0628\u0632\u0631\u06AF: ${Y.origin??"\u0645\u0642\u062F\u0627\u0631"} \u0628\u0627\u06CC\u062F ${$}${Y.maximum.toString()} ${K.unit??"\u0639\u0646\u0635\u0631"} \u0628\u0627\u0634\u062F`;return`\u062E\u06CC\u0644\u06CC \u0628\u0632\u0631\u06AF: ${Y.origin??"\u0645\u0642\u062F\u0627\u0631"} \u0628\u0627\u06CC\u062F ${$}${Y.maximum.toString()} \u0628\u0627\u0634\u062F`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`\u062E\u06CC\u0644\u06CC \u06A9\u0648\u0686\u06A9: ${Y.origin} \u0628\u0627\u06CC\u062F ${$}${Y.minimum.toString()} ${K.unit} \u0628\u0627\u0634\u062F`;return`\u062E\u06CC\u0644\u06CC \u06A9\u0648\u0686\u06A9: ${Y.origin} \u0628\u0627\u06CC\u062F ${$}${Y.minimum.toString()} \u0628\u0627\u0634\u062F`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`\u0631\u0634\u062A\u0647 \u0646\u0627\u0645\u0639\u062A\u0628\u0631: \u0628\u0627\u06CC\u062F \u0628\u0627 "${$.prefix}" \u0634\u0631\u0648\u0639 \u0634\u0648\u062F`;if($.format==="ends_with")return`\u0631\u0634\u062A\u0647 \u0646\u0627\u0645\u0639\u062A\u0628\u0631: \u0628\u0627\u06CC\u062F \u0628\u0627 "${$.suffix}" \u062A\u0645\u0627\u0645 \u0634\u0648\u062F`;if($.format==="includes")return`\u0631\u0634\u062A\u0647 \u0646\u0627\u0645\u0639\u062A\u0628\u0631: \u0628\u0627\u06CC\u062F \u0634\u0627\u0645\u0644 "${$.includes}" \u0628\u0627\u0634\u062F`;if($.format==="regex")return`\u0631\u0634\u062A\u0647 \u0646\u0627\u0645\u0639\u062A\u0628\u0631: \u0628\u0627\u06CC\u062F \u0628\u0627 \u0627\u0644\u06AF\u0648\u06CC ${$.pattern} \u0645\u0637\u0627\u0628\u0642\u062A \u062F\u0627\u0634\u062A\u0647 \u0628\u0627\u0634\u062F`;return`${G[$.format]??Y.format} \u0646\u0627\u0645\u0639\u062A\u0628\u0631`}case"not_multiple_of":return`\u0639\u062F\u062F \u0646\u0627\u0645\u0639\u062A\u0628\u0631: \u0628\u0627\u06CC\u062F \u0645\u0636\u0631\u0628 ${Y.divisor} \u0628\u0627\u0634\u062F`;case"unrecognized_keys":return`\u06A9\u0644\u06CC\u062F${Y.keys.length>1?"\u0647\u0627\u06CC":""} \u0646\u0627\u0634\u0646\u0627\u0633: ${h(Y.keys,", ")}`;case"invalid_key":return`\u06A9\u0644\u06CC\u062F \u0646\u0627\u0634\u0646\u0627\u0633 \u062F\u0631 ${Y.origin}`;case"invalid_union":return"\u0648\u0631\u0648\u062F\u06CC \u0646\u0627\u0645\u0639\u062A\u0628\u0631";case"invalid_element":return`\u0645\u0642\u062F\u0627\u0631 \u0646\u0627\u0645\u0639\u062A\u0628\u0631 \u062F\u0631 ${Y.origin}`;default:return"\u0648\u0631\u0648\u062F\u06CC \u0646\u0627\u0645\u0639\u062A\u0628\u0631"}}};var lT=D(()=>{Y6()});function mQ(){return{localeError:sm()}}var sm=()=>{let J={string:{unit:"merkki\xE4",subject:"merkkijonon"},file:{unit:"tavua",subject:"tiedoston"},array:{unit:"alkiota",subject:"listan"},set:{unit:"alkiota",subject:"joukon"},number:{unit:"",subject:"luvun"},bigint:{unit:"",subject:"suuren kokonaisluvun"},int:{unit:"",subject:"kokonaisluvun"},date:{unit:"",subject:"p\xE4iv\xE4m\xE4\xE4r\xE4n"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"number";case"object":{if(Array.isArray(Y))return"array";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"s\xE4\xE4nn\xF6llinen lauseke",email:"s\xE4hk\xF6postiosoite",url:"URL-osoite",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-aikaleima",date:"ISO-p\xE4iv\xE4m\xE4\xE4r\xE4",time:"ISO-aika",duration:"ISO-kesto",ipv4:"IPv4-osoite",ipv6:"IPv6-osoite",cidrv4:"IPv4-alue",cidrv6:"IPv6-alue",base64:"base64-koodattu merkkijono",base64url:"base64url-koodattu merkkijono",json_string:"JSON-merkkijono",e164:"E.164-luku",jwt:"JWT",template_literal:"templaattimerkkijono"};return(Y)=>{switch(Y.code){case"invalid_type":return`Virheellinen tyyppi: odotettiin ${Y.expected}, oli ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`Virheellinen sy\xF6te: t\xE4ytyy olla ${p(Y.values[0])}`;return`Virheellinen valinta: t\xE4ytyy olla yksi seuraavista: ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`Liian suuri: ${K.subject} t\xE4ytyy olla ${$}${Y.maximum.toString()} ${K.unit}`.trim();return`Liian suuri: arvon t\xE4ytyy olla ${$}${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`Liian pieni: ${K.subject} t\xE4ytyy olla ${$}${Y.minimum.toString()} ${K.unit}`.trim();return`Liian pieni: arvon t\xE4ytyy olla ${$}${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`Virheellinen sy\xF6te: t\xE4ytyy alkaa "${$.prefix}"`;if($.format==="ends_with")return`Virheellinen sy\xF6te: t\xE4ytyy loppua "${$.suffix}"`;if($.format==="includes")return`Virheellinen sy\xF6te: t\xE4ytyy sis\xE4lt\xE4\xE4 "${$.includes}"`;if($.format==="regex")return`Virheellinen sy\xF6te: t\xE4ytyy vastata s\xE4\xE4nn\xF6llist\xE4 lauseketta ${$.pattern}`;return`Virheellinen ${G[$.format]??Y.format}`}case"not_multiple_of":return`Virheellinen luku: t\xE4ytyy olla luvun ${Y.divisor} monikerta`;case"unrecognized_keys":return`${Y.keys.length>1?"Tuntemattomat avaimet":"Tuntematon avain"}: ${h(Y.keys,", ")}`;case"invalid_key":return"Virheellinen avain tietueessa";case"invalid_union":return"Virheellinen unioni";case"invalid_element":return"Virheellinen arvo joukossa";default:return"Virheellinen sy\xF6te"}}};var cT=D(()=>{Y6()});function yQ(){return{localeError:em()}}var em=()=>{let J={string:{unit:"caract\xE8res",verb:"avoir"},file:{unit:"octets",verb:"avoir"},array:{unit:"\xE9l\xE9ments",verb:"avoir"},set:{unit:"\xE9l\xE9ments",verb:"avoir"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"nombre";case"object":{if(Array.isArray(Y))return"tableau";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"entr\xE9e",email:"adresse e-mail",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"date et heure ISO",date:"date ISO",time:"heure ISO",duration:"dur\xE9e ISO",ipv4:"adresse IPv4",ipv6:"adresse IPv6",cidrv4:"plage IPv4",cidrv6:"plage IPv6",base64:"cha\xEEne encod\xE9e en base64",base64url:"cha\xEEne encod\xE9e en base64url",json_string:"cha\xEEne JSON",e164:"num\xE9ro E.164",jwt:"JWT",template_literal:"entr\xE9e"};return(Y)=>{switch(Y.code){case"invalid_type":return`Entr\xE9e invalide : ${Y.expected} attendu, ${X(Y.input)} re\xE7u`;case"invalid_value":if(Y.values.length===1)return`Entr\xE9e invalide : ${p(Y.values[0])} attendu`;return`Option invalide : une valeur parmi ${h(Y.values,"|")} attendue`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`Trop grand : ${Y.origin??"valeur"} doit ${K.verb} ${$}${Y.maximum.toString()} ${K.unit??"\xE9l\xE9ment(s)"}`;return`Trop grand : ${Y.origin??"valeur"} doit \xEAtre ${$}${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`Trop petit : ${Y.origin} doit ${K.verb} ${$}${Y.minimum.toString()} ${K.unit}`;return`Trop petit : ${Y.origin} doit \xEAtre ${$}${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`Cha\xEEne invalide : doit commencer par "${$.prefix}"`;if($.format==="ends_with")return`Cha\xEEne invalide : doit se terminer par "${$.suffix}"`;if($.format==="includes")return`Cha\xEEne invalide : doit inclure "${$.includes}"`;if($.format==="regex")return`Cha\xEEne invalide : doit correspondre au mod\xE8le ${$.pattern}`;return`${G[$.format]??Y.format} invalide`}case"not_multiple_of":return`Nombre invalide : doit \xEAtre un multiple de ${Y.divisor}`;case"unrecognized_keys":return`Cl\xE9${Y.keys.length>1?"s":""} non reconnue${Y.keys.length>1?"s":""} : ${h(Y.keys,", ")}`;case"invalid_key":return`Cl\xE9 invalide dans ${Y.origin}`;case"invalid_union":return"Entr\xE9e invalide";case"invalid_element":return`Valeur invalide dans ${Y.origin}`;default:return"Entr\xE9e invalide"}}};var pT=D(()=>{Y6()});function xQ(){return{localeError:Jy()}}var Jy=()=>{let J={string:{unit:"caract\xE8res",verb:"avoir"},file:{unit:"octets",verb:"avoir"},array:{unit:"\xE9l\xE9ments",verb:"avoir"},set:{unit:"\xE9l\xE9ments",verb:"avoir"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"number";case"object":{if(Array.isArray(Y))return"array";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"entr\xE9e",email:"adresse courriel",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"date-heure ISO",date:"date ISO",time:"heure ISO",duration:"dur\xE9e ISO",ipv4:"adresse IPv4",ipv6:"adresse IPv6",cidrv4:"plage IPv4",cidrv6:"plage IPv6",base64:"cha\xEEne encod\xE9e en base64",base64url:"cha\xEEne encod\xE9e en base64url",json_string:"cha\xEEne JSON",e164:"num\xE9ro E.164",jwt:"JWT",template_literal:"entr\xE9e"};return(Y)=>{switch(Y.code){case"invalid_type":return`Entr\xE9e invalide : attendu ${Y.expected}, re\xE7u ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`Entr\xE9e invalide : attendu ${p(Y.values[0])}`;return`Option invalide : attendu l'une des valeurs suivantes ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"\u2264":"<",K=W(Y.origin);if(K)return`Trop grand : attendu que ${Y.origin??"la valeur"} ait ${$}${Y.maximum.toString()} ${K.unit}`;return`Trop grand : attendu que ${Y.origin??"la valeur"} soit ${$}${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?"\u2265":">",K=W(Y.origin);if(K)return`Trop petit : attendu que ${Y.origin} ait ${$}${Y.minimum.toString()} ${K.unit}`;return`Trop petit : attendu que ${Y.origin} soit ${$}${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`Cha\xEEne invalide : doit commencer par "${$.prefix}"`;if($.format==="ends_with")return`Cha\xEEne invalide : doit se terminer par "${$.suffix}"`;if($.format==="includes")return`Cha\xEEne invalide : doit inclure "${$.includes}"`;if($.format==="regex")return`Cha\xEEne invalide : doit correspondre au motif ${$.pattern}`;return`${G[$.format]??Y.format} invalide`}case"not_multiple_of":return`Nombre invalide : doit \xEAtre un multiple de ${Y.divisor}`;case"unrecognized_keys":return`Cl\xE9${Y.keys.length>1?"s":""} non reconnue${Y.keys.length>1?"s":""} : ${h(Y.keys,", ")}`;case"invalid_key":return`Cl\xE9 invalide dans ${Y.origin}`;case"invalid_union":return"Entr\xE9e invalide";case"invalid_element":return`Valeur invalide dans ${Y.origin}`;default:return"Entr\xE9e invalide"}}};var dT=D(()=>{Y6()});function uQ(){return{localeError:Wy()}}var Wy=()=>{let J={string:{unit:"\u05D0\u05D5\u05EA\u05D9\u05D5\u05EA",verb:"\u05DC\u05DB\u05DC\u05D5\u05DC"},file:{unit:"\u05D1\u05D9\u05D9\u05D8\u05D9\u05DD",verb:"\u05DC\u05DB\u05DC\u05D5\u05DC"},array:{unit:"\u05E4\u05E8\u05D9\u05D8\u05D9\u05DD",verb:"\u05DC\u05DB\u05DC\u05D5\u05DC"},set:{unit:"\u05E4\u05E8\u05D9\u05D8\u05D9\u05DD",verb:"\u05DC\u05DB\u05DC\u05D5\u05DC"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"number";case"object":{if(Array.isArray(Y))return"array";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"\u05E7\u05DC\u05D8",email:"\u05DB\u05EA\u05D5\u05D1\u05EA \u05D0\u05D9\u05DE\u05D9\u05D9\u05DC",url:"\u05DB\u05EA\u05D5\u05D1\u05EA \u05E8\u05E9\u05EA",emoji:"\u05D0\u05D9\u05DE\u05D5\u05D2'\u05D9",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"\u05EA\u05D0\u05E8\u05D9\u05DA \u05D5\u05D6\u05DE\u05DF ISO",date:"\u05EA\u05D0\u05E8\u05D9\u05DA ISO",time:"\u05D6\u05DE\u05DF ISO",duration:"\u05DE\u05E9\u05DA \u05D6\u05DE\u05DF ISO",ipv4:"\u05DB\u05EA\u05D5\u05D1\u05EA IPv4",ipv6:"\u05DB\u05EA\u05D5\u05D1\u05EA IPv6",cidrv4:"\u05D8\u05D5\u05D5\u05D7 IPv4",cidrv6:"\u05D8\u05D5\u05D5\u05D7 IPv6",base64:"\u05DE\u05D7\u05E8\u05D5\u05D6\u05EA \u05D1\u05D1\u05E1\u05D9\u05E1 64",base64url:"\u05DE\u05D7\u05E8\u05D5\u05D6\u05EA \u05D1\u05D1\u05E1\u05D9\u05E1 64 \u05DC\u05DB\u05EA\u05D5\u05D1\u05D5\u05EA \u05E8\u05E9\u05EA",json_string:"\u05DE\u05D7\u05E8\u05D5\u05D6\u05EA JSON",e164:"\u05DE\u05E1\u05E4\u05E8 E.164",jwt:"JWT",template_literal:"\u05E7\u05DC\u05D8"};return(Y)=>{switch(Y.code){case"invalid_type":return`\u05E7\u05DC\u05D8 \u05DC\u05D0 \u05EA\u05E7\u05D9\u05DF: \u05E6\u05E8\u05D9\u05DA ${Y.expected}, \u05D4\u05EA\u05E7\u05D1\u05DC ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`\u05E7\u05DC\u05D8 \u05DC\u05D0 \u05EA\u05E7\u05D9\u05DF: \u05E6\u05E8\u05D9\u05DA ${p(Y.values[0])}`;return`\u05E7\u05DC\u05D8 \u05DC\u05D0 \u05EA\u05E7\u05D9\u05DF: \u05E6\u05E8\u05D9\u05DA \u05D0\u05D7\u05EA \u05DE\u05D4\u05D0\u05E4\u05E9\u05E8\u05D5\u05D9\u05D5\u05EA  ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`\u05D2\u05D3\u05D5\u05DC \u05DE\u05D3\u05D9: ${Y.origin??"value"} \u05E6\u05E8\u05D9\u05DA \u05DC\u05D4\u05D9\u05D5\u05EA ${$}${Y.maximum.toString()} ${K.unit??"elements"}`;return`\u05D2\u05D3\u05D5\u05DC \u05DE\u05D3\u05D9: ${Y.origin??"value"} \u05E6\u05E8\u05D9\u05DA \u05DC\u05D4\u05D9\u05D5\u05EA ${$}${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`\u05E7\u05D8\u05DF \u05DE\u05D3\u05D9: ${Y.origin} \u05E6\u05E8\u05D9\u05DA \u05DC\u05D4\u05D9\u05D5\u05EA ${$}${Y.minimum.toString()} ${K.unit}`;return`\u05E7\u05D8\u05DF \u05DE\u05D3\u05D9: ${Y.origin} \u05E6\u05E8\u05D9\u05DA \u05DC\u05D4\u05D9\u05D5\u05EA ${$}${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`\u05DE\u05D7\u05E8\u05D5\u05D6\u05EA \u05DC\u05D0 \u05EA\u05E7\u05D9\u05E0\u05D4: \u05D7\u05D9\u05D9\u05D1\u05EA \u05DC\u05D4\u05EA\u05D7\u05D9\u05DC \u05D1"${$.prefix}"`;if($.format==="ends_with")return`\u05DE\u05D7\u05E8\u05D5\u05D6\u05EA \u05DC\u05D0 \u05EA\u05E7\u05D9\u05E0\u05D4: \u05D7\u05D9\u05D9\u05D1\u05EA \u05DC\u05D4\u05E1\u05EA\u05D9\u05D9\u05DD \u05D1 "${$.suffix}"`;if($.format==="includes")return`\u05DE\u05D7\u05E8\u05D5\u05D6\u05EA \u05DC\u05D0 \u05EA\u05E7\u05D9\u05E0\u05D4: \u05D7\u05D9\u05D9\u05D1\u05EA \u05DC\u05DB\u05DC\u05D5\u05DC "${$.includes}"`;if($.format==="regex")return`\u05DE\u05D7\u05E8\u05D5\u05D6\u05EA \u05DC\u05D0 \u05EA\u05E7\u05D9\u05E0\u05D4: \u05D7\u05D9\u05D9\u05D1\u05EA \u05DC\u05D4\u05EA\u05D0\u05D9\u05DD \u05DC\u05EA\u05D1\u05E0\u05D9\u05EA ${$.pattern}`;return`${G[$.format]??Y.format} \u05DC\u05D0 \u05EA\u05E7\u05D9\u05DF`}case"not_multiple_of":return`\u05DE\u05E1\u05E4\u05E8 \u05DC\u05D0 \u05EA\u05E7\u05D9\u05DF: \u05D7\u05D9\u05D9\u05D1 \u05DC\u05D4\u05D9\u05D5\u05EA \u05DE\u05DB\u05E4\u05DC\u05D4 \u05E9\u05DC ${Y.divisor}`;case"unrecognized_keys":return`\u05DE\u05E4\u05EA\u05D7${Y.keys.length>1?"\u05D5\u05EA":""} \u05DC\u05D0 \u05DE\u05D6\u05D5\u05D4${Y.keys.length>1?"\u05D9\u05DD":"\u05D4"}: ${h(Y.keys,", ")}`;case"invalid_key":return`\u05DE\u05E4\u05EA\u05D7 \u05DC\u05D0 \u05EA\u05E7\u05D9\u05DF \u05D1${Y.origin}`;case"invalid_union":return"\u05E7\u05DC\u05D8 \u05DC\u05D0 \u05EA\u05E7\u05D9\u05DF";case"invalid_element":return`\u05E2\u05E8\u05DA \u05DC\u05D0 \u05EA\u05E7\u05D9\u05DF \u05D1${Y.origin}`;default:return"\u05E7\u05DC\u05D8 \u05DC\u05D0 \u05EA\u05E7\u05D9\u05DF"}}};var nT=D(()=>{Y6()});function lQ(){return{localeError:Xy()}}var Xy=()=>{let J={string:{unit:"karakter",verb:"legyen"},file:{unit:"byte",verb:"legyen"},array:{unit:"elem",verb:"legyen"},set:{unit:"elem",verb:"legyen"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"sz\xE1m";case"object":{if(Array.isArray(Y))return"t\xF6mb";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"bemenet",email:"email c\xEDm",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO id\u0151b\xE9lyeg",date:"ISO d\xE1tum",time:"ISO id\u0151",duration:"ISO id\u0151intervallum",ipv4:"IPv4 c\xEDm",ipv6:"IPv6 c\xEDm",cidrv4:"IPv4 tartom\xE1ny",cidrv6:"IPv6 tartom\xE1ny",base64:"base64-k\xF3dolt string",base64url:"base64url-k\xF3dolt string",json_string:"JSON string",e164:"E.164 sz\xE1m",jwt:"JWT",template_literal:"bemenet"};return(Y)=>{switch(Y.code){case"invalid_type":return`\xC9rv\xE9nytelen bemenet: a v\xE1rt \xE9rt\xE9k ${Y.expected}, a kapott \xE9rt\xE9k ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`\xC9rv\xE9nytelen bemenet: a v\xE1rt \xE9rt\xE9k ${p(Y.values[0])}`;return`\xC9rv\xE9nytelen opci\xF3: valamelyik \xE9rt\xE9k v\xE1rt ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`T\xFAl nagy: ${Y.origin??"\xE9rt\xE9k"} m\xE9rete t\xFAl nagy ${$}${Y.maximum.toString()} ${K.unit??"elem"}`;return`T\xFAl nagy: a bemeneti \xE9rt\xE9k ${Y.origin??"\xE9rt\xE9k"} t\xFAl nagy: ${$}${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`T\xFAl kicsi: a bemeneti \xE9rt\xE9k ${Y.origin} m\xE9rete t\xFAl kicsi ${$}${Y.minimum.toString()} ${K.unit}`;return`T\xFAl kicsi: a bemeneti \xE9rt\xE9k ${Y.origin} t\xFAl kicsi ${$}${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`\xC9rv\xE9nytelen string: "${$.prefix}" \xE9rt\xE9kkel kell kezd\u0151dnie`;if($.format==="ends_with")return`\xC9rv\xE9nytelen string: "${$.suffix}" \xE9rt\xE9kkel kell v\xE9gz\u0151dnie`;if($.format==="includes")return`\xC9rv\xE9nytelen string: "${$.includes}" \xE9rt\xE9ket kell tartalmaznia`;if($.format==="regex")return`\xC9rv\xE9nytelen string: ${$.pattern} mint\xE1nak kell megfelelnie`;return`\xC9rv\xE9nytelen ${G[$.format]??Y.format}`}case"not_multiple_of":return`\xC9rv\xE9nytelen sz\xE1m: ${Y.divisor} t\xF6bbsz\xF6r\xF6s\xE9nek kell lennie`;case"unrecognized_keys":return`Ismeretlen kulcs${Y.keys.length>1?"s":""}: ${h(Y.keys,", ")}`;case"invalid_key":return`\xC9rv\xE9nytelen kulcs ${Y.origin}`;case"invalid_union":return"\xC9rv\xE9nytelen bemenet";case"invalid_element":return`\xC9rv\xE9nytelen \xE9rt\xE9k: ${Y.origin}`;default:return"\xC9rv\xE9nytelen bemenet"}}};var rT=D(()=>{Y6()});function cQ(){return{localeError:Yy()}}var Yy=()=>{let J={string:{unit:"karakter",verb:"memiliki"},file:{unit:"byte",verb:"memiliki"},array:{unit:"item",verb:"memiliki"},set:{unit:"item",verb:"memiliki"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"number";case"object":{if(Array.isArray(Y))return"array";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"input",email:"alamat email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"tanggal dan waktu format ISO",date:"tanggal format ISO",time:"jam format ISO",duration:"durasi format ISO",ipv4:"alamat IPv4",ipv6:"alamat IPv6",cidrv4:"rentang alamat IPv4",cidrv6:"rentang alamat IPv6",base64:"string dengan enkode base64",base64url:"string dengan enkode base64url",json_string:"string JSON",e164:"angka E.164",jwt:"JWT",template_literal:"input"};return(Y)=>{switch(Y.code){case"invalid_type":return`Input tidak valid: diharapkan ${Y.expected}, diterima ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`Input tidak valid: diharapkan ${p(Y.values[0])}`;return`Pilihan tidak valid: diharapkan salah satu dari ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`Terlalu besar: diharapkan ${Y.origin??"value"} memiliki ${$}${Y.maximum.toString()} ${K.unit??"elemen"}`;return`Terlalu besar: diharapkan ${Y.origin??"value"} menjadi ${$}${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`Terlalu kecil: diharapkan ${Y.origin} memiliki ${$}${Y.minimum.toString()} ${K.unit}`;return`Terlalu kecil: diharapkan ${Y.origin} menjadi ${$}${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`String tidak valid: harus dimulai dengan "${$.prefix}"`;if($.format==="ends_with")return`String tidak valid: harus berakhir dengan "${$.suffix}"`;if($.format==="includes")return`String tidak valid: harus menyertakan "${$.includes}"`;if($.format==="regex")return`String tidak valid: harus sesuai pola ${$.pattern}`;return`${G[$.format]??Y.format} tidak valid`}case"not_multiple_of":return`Angka tidak valid: harus kelipatan dari ${Y.divisor}`;case"unrecognized_keys":return`Kunci tidak dikenali ${Y.keys.length>1?"s":""}: ${h(Y.keys,", ")}`;case"invalid_key":return`Kunci tidak valid di ${Y.origin}`;case"invalid_union":return"Input tidak valid";case"invalid_element":return`Nilai tidak valid di ${Y.origin}`;default:return"Input tidak valid"}}};var iT=D(()=>{Y6()});function pQ(){return{localeError:$y()}}var Gy=(J)=>{let W=typeof J;switch(W){case"number":return Number.isNaN(J)?"NaN":"n\xFAmer";case"object":{if(Array.isArray(J))return"fylki";if(J===null)return"null";if(Object.getPrototypeOf(J)!==Object.prototype&&J.constructor)return J.constructor.name}}return W},$y=()=>{let J={string:{unit:"stafi",verb:"a\xF0 hafa"},file:{unit:"b\xE6ti",verb:"a\xF0 hafa"},array:{unit:"hluti",verb:"a\xF0 hafa"},set:{unit:"hluti",verb:"a\xF0 hafa"}};function W(G){return J[G]??null}let X={regex:"gildi",email:"netfang",url:"vefsl\xF3\xF0",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO dagsetning og t\xEDmi",date:"ISO dagsetning",time:"ISO t\xEDmi",duration:"ISO t\xEDmalengd",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded strengur",base64url:"base64url-encoded strengur",json_string:"JSON strengur",e164:"E.164 t\xF6lugildi",jwt:"JWT",template_literal:"gildi"};return(G)=>{switch(G.code){case"invalid_type":return`Rangt gildi: \xDE\xFA sl\xF3st inn ${Gy(G.input)} \xFEar sem \xE1 a\xF0 vera ${G.expected}`;case"invalid_value":if(G.values.length===1)return`Rangt gildi: gert r\xE1\xF0 fyrir ${p(G.values[0])}`;return`\xD3gilt val: m\xE1 vera eitt af eftirfarandi ${h(G.values,"|")}`;case"too_big":{let Y=G.inclusive?"<=":"<",$=W(G.origin);if($)return`Of st\xF3rt: gert er r\xE1\xF0 fyrir a\xF0 ${G.origin??"gildi"} hafi ${Y}${G.maximum.toString()} ${$.unit??"hluti"}`;return`Of st\xF3rt: gert er r\xE1\xF0 fyrir a\xF0 ${G.origin??"gildi"} s\xE9 ${Y}${G.maximum.toString()}`}case"too_small":{let Y=G.inclusive?">=":">",$=W(G.origin);if($)return`Of l\xEDti\xF0: gert er r\xE1\xF0 fyrir a\xF0 ${G.origin} hafi ${Y}${G.minimum.toString()} ${$.unit}`;return`Of l\xEDti\xF0: gert er r\xE1\xF0 fyrir a\xF0 ${G.origin} s\xE9 ${Y}${G.minimum.toString()}`}case"invalid_format":{let Y=G;if(Y.format==="starts_with")return`\xD3gildur strengur: ver\xF0ur a\xF0 byrja \xE1 "${Y.prefix}"`;if(Y.format==="ends_with")return`\xD3gildur strengur: ver\xF0ur a\xF0 enda \xE1 "${Y.suffix}"`;if(Y.format==="includes")return`\xD3gildur strengur: ver\xF0ur a\xF0 innihalda "${Y.includes}"`;if(Y.format==="regex")return`\xD3gildur strengur: ver\xF0ur a\xF0 fylgja mynstri ${Y.pattern}`;return`Rangt ${X[Y.format]??G.format}`}case"not_multiple_of":return`R\xF6ng tala: ver\xF0ur a\xF0 vera margfeldi af ${G.divisor}`;case"unrecognized_keys":return`\xD3\xFEekkt ${G.keys.length>1?"ir lyklar":"ur lykill"}: ${h(G.keys,", ")}`;case"invalid_key":return`Rangur lykill \xED ${G.origin}`;case"invalid_union":return"Rangt gildi";case"invalid_element":return`Rangt gildi \xED ${G.origin}`;default:return"Rangt gildi"}}};var aT=D(()=>{Y6()});function dQ(){return{localeError:Ky()}}var Ky=()=>{let J={string:{unit:"caratteri",verb:"avere"},file:{unit:"byte",verb:"avere"},array:{unit:"elementi",verb:"avere"},set:{unit:"elementi",verb:"avere"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"numero";case"object":{if(Array.isArray(Y))return"vettore";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"input",email:"indirizzo email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data e ora ISO",date:"data ISO",time:"ora ISO",duration:"durata ISO",ipv4:"indirizzo IPv4",ipv6:"indirizzo IPv6",cidrv4:"intervallo IPv4",cidrv6:"intervallo IPv6",base64:"stringa codificata in base64",base64url:"URL codificata in base64",json_string:"stringa JSON",e164:"numero E.164",jwt:"JWT",template_literal:"input"};return(Y)=>{switch(Y.code){case"invalid_type":return`Input non valido: atteso ${Y.expected}, ricevuto ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`Input non valido: atteso ${p(Y.values[0])}`;return`Opzione non valida: atteso uno tra ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`Troppo grande: ${Y.origin??"valore"} deve avere ${$}${Y.maximum.toString()} ${K.unit??"elementi"}`;return`Troppo grande: ${Y.origin??"valore"} deve essere ${$}${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`Troppo piccolo: ${Y.origin} deve avere ${$}${Y.minimum.toString()} ${K.unit}`;return`Troppo piccolo: ${Y.origin} deve essere ${$}${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`Stringa non valida: deve iniziare con "${$.prefix}"`;if($.format==="ends_with")return`Stringa non valida: deve terminare con "${$.suffix}"`;if($.format==="includes")return`Stringa non valida: deve includere "${$.includes}"`;if($.format==="regex")return`Stringa non valida: deve corrispondere al pattern ${$.pattern}`;return`Invalid ${G[$.format]??Y.format}`}case"not_multiple_of":return`Numero non valido: deve essere un multiplo di ${Y.divisor}`;case"unrecognized_keys":return`Chiav${Y.keys.length>1?"i":"e"} non riconosciut${Y.keys.length>1?"e":"a"}: ${h(Y.keys,", ")}`;case"invalid_key":return`Chiave non valida in ${Y.origin}`;case"invalid_union":return"Input non valido";case"invalid_element":return`Valore non valido in ${Y.origin}`;default:return"Input non valido"}}};var tT=D(()=>{Y6()});function nQ(){return{localeError:wy()}}var wy=()=>{let J={string:{unit:"\u6587\u5B57",verb:"\u3067\u3042\u308B"},file:{unit:"\u30D0\u30A4\u30C8",verb:"\u3067\u3042\u308B"},array:{unit:"\u8981\u7D20",verb:"\u3067\u3042\u308B"},set:{unit:"\u8981\u7D20",verb:"\u3067\u3042\u308B"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"\u6570\u5024";case"object":{if(Array.isArray(Y))return"\u914D\u5217";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"\u5165\u529B\u5024",email:"\u30E1\u30FC\u30EB\u30A2\u30C9\u30EC\u30B9",url:"URL",emoji:"\u7D75\u6587\u5B57",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO\u65E5\u6642",date:"ISO\u65E5\u4ED8",time:"ISO\u6642\u523B",duration:"ISO\u671F\u9593",ipv4:"IPv4\u30A2\u30C9\u30EC\u30B9",ipv6:"IPv6\u30A2\u30C9\u30EC\u30B9",cidrv4:"IPv4\u7BC4\u56F2",cidrv6:"IPv6\u7BC4\u56F2",base64:"base64\u30A8\u30F3\u30B3\u30FC\u30C9\u6587\u5B57\u5217",base64url:"base64url\u30A8\u30F3\u30B3\u30FC\u30C9\u6587\u5B57\u5217",json_string:"JSON\u6587\u5B57\u5217",e164:"E.164\u756A\u53F7",jwt:"JWT",template_literal:"\u5165\u529B\u5024"};return(Y)=>{switch(Y.code){case"invalid_type":return`\u7121\u52B9\u306A\u5165\u529B: ${Y.expected}\u304C\u671F\u5F85\u3055\u308C\u307E\u3057\u305F\u304C\u3001${X(Y.input)}\u304C\u5165\u529B\u3055\u308C\u307E\u3057\u305F`;case"invalid_value":if(Y.values.length===1)return`\u7121\u52B9\u306A\u5165\u529B: ${p(Y.values[0])}\u304C\u671F\u5F85\u3055\u308C\u307E\u3057\u305F`;return`\u7121\u52B9\u306A\u9078\u629E: ${h(Y.values,"\u3001")}\u306E\u3044\u305A\u308C\u304B\u3067\u3042\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059`;case"too_big":{let $=Y.inclusive?"\u4EE5\u4E0B\u3067\u3042\u308B":"\u3088\u308A\u5C0F\u3055\u3044",K=W(Y.origin);if(K)return`\u5927\u304D\u3059\u304E\u308B\u5024: ${Y.origin??"\u5024"}\u306F${Y.maximum.toString()}${K.unit??"\u8981\u7D20"}${$}\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059`;return`\u5927\u304D\u3059\u304E\u308B\u5024: ${Y.origin??"\u5024"}\u306F${Y.maximum.toString()}${$}\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059`}case"too_small":{let $=Y.inclusive?"\u4EE5\u4E0A\u3067\u3042\u308B":"\u3088\u308A\u5927\u304D\u3044",K=W(Y.origin);if(K)return`\u5C0F\u3055\u3059\u304E\u308B\u5024: ${Y.origin}\u306F${Y.minimum.toString()}${K.unit}${$}\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059`;return`\u5C0F\u3055\u3059\u304E\u308B\u5024: ${Y.origin}\u306F${Y.minimum.toString()}${$}\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`\u7121\u52B9\u306A\u6587\u5B57\u5217: "${$.prefix}"\u3067\u59CB\u307E\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059`;if($.format==="ends_with")return`\u7121\u52B9\u306A\u6587\u5B57\u5217: "${$.suffix}"\u3067\u7D42\u308F\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059`;if($.format==="includes")return`\u7121\u52B9\u306A\u6587\u5B57\u5217: "${$.includes}"\u3092\u542B\u3080\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059`;if($.format==="regex")return`\u7121\u52B9\u306A\u6587\u5B57\u5217: \u30D1\u30BF\u30FC\u30F3${$.pattern}\u306B\u4E00\u81F4\u3059\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059`;return`\u7121\u52B9\u306A${G[$.format]??Y.format}`}case"not_multiple_of":return`\u7121\u52B9\u306A\u6570\u5024: ${Y.divisor}\u306E\u500D\u6570\u3067\u3042\u308B\u5FC5\u8981\u304C\u3042\u308A\u307E\u3059`;case"unrecognized_keys":return`\u8A8D\u8B58\u3055\u308C\u3066\u3044\u306A\u3044\u30AD\u30FC${Y.keys.length>1?"\u7FA4":""}: ${h(Y.keys,"\u3001")}`;case"invalid_key":return`${Y.origin}\u5185\u306E\u7121\u52B9\u306A\u30AD\u30FC`;case"invalid_union":return"\u7121\u52B9\u306A\u5165\u529B";case"invalid_element":return`${Y.origin}\u5185\u306E\u7121\u52B9\u306A\u5024`;default:return"\u7121\u52B9\u306A\u5165\u529B"}}};var oT=D(()=>{Y6()});function rQ(){return{localeError:Zy()}}var Hy=(J)=>{let W=typeof J;switch(W){case"number":return Number.isNaN(J)?"NaN":"\u10E0\u10D8\u10EA\u10EE\u10D5\u10D8";case"object":{if(Array.isArray(J))return"\u10DB\u10D0\u10E1\u10D8\u10D5\u10D8";if(J===null)return"null";if(Object.getPrototypeOf(J)!==Object.prototype&&J.constructor)return J.constructor.name}}return{string:"\u10E1\u10E2\u10E0\u10D8\u10DC\u10D2\u10D8",boolean:"\u10D1\u10E3\u10DA\u10D4\u10D0\u10DC\u10D8",undefined:"undefined",bigint:"bigint",symbol:"symbol",function:"\u10E4\u10E3\u10DC\u10E5\u10EA\u10D8\u10D0"}[W]??W},Zy=()=>{let J={string:{unit:"\u10E1\u10D8\u10DB\u10D1\u10DD\u10DA\u10DD",verb:"\u10E3\u10DC\u10D3\u10D0 \u10E8\u10D4\u10D8\u10EA\u10D0\u10D5\u10D3\u10D4\u10E1"},file:{unit:"\u10D1\u10D0\u10D8\u10E2\u10D8",verb:"\u10E3\u10DC\u10D3\u10D0 \u10E8\u10D4\u10D8\u10EA\u10D0\u10D5\u10D3\u10D4\u10E1"},array:{unit:"\u10D4\u10DA\u10D4\u10DB\u10D4\u10DC\u10E2\u10D8",verb:"\u10E3\u10DC\u10D3\u10D0 \u10E8\u10D4\u10D8\u10EA\u10D0\u10D5\u10D3\u10D4\u10E1"},set:{unit:"\u10D4\u10DA\u10D4\u10DB\u10D4\u10DC\u10E2\u10D8",verb:"\u10E3\u10DC\u10D3\u10D0 \u10E8\u10D4\u10D8\u10EA\u10D0\u10D5\u10D3\u10D4\u10E1"}};function W(G){return J[G]??null}let X={regex:"\u10E8\u10D4\u10E7\u10D5\u10D0\u10DC\u10D0",email:"\u10D4\u10DA-\u10E4\u10DD\u10E1\u10E2\u10D8\u10E1 \u10DB\u10D8\u10E1\u10D0\u10DB\u10D0\u10E0\u10D7\u10D8",url:"URL",emoji:"\u10D4\u10DB\u10DD\u10EF\u10D8",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"\u10D7\u10D0\u10E0\u10D8\u10E6\u10D8-\u10D3\u10E0\u10DD",date:"\u10D7\u10D0\u10E0\u10D8\u10E6\u10D8",time:"\u10D3\u10E0\u10DD",duration:"\u10EE\u10D0\u10DC\u10D2\u10E0\u10EB\u10DA\u10D8\u10D5\u10DD\u10D1\u10D0",ipv4:"IPv4 \u10DB\u10D8\u10E1\u10D0\u10DB\u10D0\u10E0\u10D7\u10D8",ipv6:"IPv6 \u10DB\u10D8\u10E1\u10D0\u10DB\u10D0\u10E0\u10D7\u10D8",cidrv4:"IPv4 \u10D3\u10D8\u10D0\u10DE\u10D0\u10D6\u10DD\u10DC\u10D8",cidrv6:"IPv6 \u10D3\u10D8\u10D0\u10DE\u10D0\u10D6\u10DD\u10DC\u10D8",base64:"base64-\u10D9\u10DD\u10D3\u10D8\u10E0\u10D4\u10D1\u10E3\u10DA\u10D8 \u10E1\u10E2\u10E0\u10D8\u10DC\u10D2\u10D8",base64url:"base64url-\u10D9\u10DD\u10D3\u10D8\u10E0\u10D4\u10D1\u10E3\u10DA\u10D8 \u10E1\u10E2\u10E0\u10D8\u10DC\u10D2\u10D8",json_string:"JSON \u10E1\u10E2\u10E0\u10D8\u10DC\u10D2\u10D8",e164:"E.164 \u10DC\u10DD\u10DB\u10D4\u10E0\u10D8",jwt:"JWT",template_literal:"\u10E8\u10D4\u10E7\u10D5\u10D0\u10DC\u10D0"};return(G)=>{switch(G.code){case"invalid_type":return`\u10D0\u10E0\u10D0\u10E1\u10EC\u10DD\u10E0\u10D8 \u10E8\u10D4\u10E7\u10D5\u10D0\u10DC\u10D0: \u10DB\u10DD\u10E1\u10D0\u10DA\u10DD\u10D3\u10DC\u10D4\u10DA\u10D8 ${G.expected}, \u10DB\u10D8\u10E6\u10D4\u10D1\u10E3\u10DA\u10D8 ${Hy(G.input)}`;case"invalid_value":if(G.values.length===1)return`\u10D0\u10E0\u10D0\u10E1\u10EC\u10DD\u10E0\u10D8 \u10E8\u10D4\u10E7\u10D5\u10D0\u10DC\u10D0: \u10DB\u10DD\u10E1\u10D0\u10DA\u10DD\u10D3\u10DC\u10D4\u10DA\u10D8 ${p(G.values[0])}`;return`\u10D0\u10E0\u10D0\u10E1\u10EC\u10DD\u10E0\u10D8 \u10D5\u10D0\u10E0\u10D8\u10D0\u10DC\u10E2\u10D8: \u10DB\u10DD\u10E1\u10D0\u10DA\u10DD\u10D3\u10DC\u10D4\u10DA\u10D8\u10D0 \u10D4\u10E0\u10D7-\u10D4\u10E0\u10D7\u10D8 ${h(G.values,"|")}-\u10D3\u10D0\u10DC`;case"too_big":{let Y=G.inclusive?"<=":"<",$=W(G.origin);if($)return`\u10D6\u10D4\u10D3\u10DB\u10D4\u10E2\u10D0\u10D3 \u10D3\u10D8\u10D3\u10D8: \u10DB\u10DD\u10E1\u10D0\u10DA\u10DD\u10D3\u10DC\u10D4\u10DA\u10D8 ${G.origin??"\u10DB\u10DC\u10D8\u10E8\u10D5\u10DC\u10D4\u10DA\u10DD\u10D1\u10D0"} ${$.verb} ${Y}${G.maximum.toString()} ${$.unit}`;return`\u10D6\u10D4\u10D3\u10DB\u10D4\u10E2\u10D0\u10D3 \u10D3\u10D8\u10D3\u10D8: \u10DB\u10DD\u10E1\u10D0\u10DA\u10DD\u10D3\u10DC\u10D4\u10DA\u10D8 ${G.origin??"\u10DB\u10DC\u10D8\u10E8\u10D5\u10DC\u10D4\u10DA\u10DD\u10D1\u10D0"} \u10D8\u10E7\u10DD\u10E1 ${Y}${G.maximum.toString()}`}case"too_small":{let Y=G.inclusive?">=":">",$=W(G.origin);if($)return`\u10D6\u10D4\u10D3\u10DB\u10D4\u10E2\u10D0\u10D3 \u10DE\u10D0\u10E2\u10D0\u10E0\u10D0: \u10DB\u10DD\u10E1\u10D0\u10DA\u10DD\u10D3\u10DC\u10D4\u10DA\u10D8 ${G.origin} ${$.verb} ${Y}${G.minimum.toString()} ${$.unit}`;return`\u10D6\u10D4\u10D3\u10DB\u10D4\u10E2\u10D0\u10D3 \u10DE\u10D0\u10E2\u10D0\u10E0\u10D0: \u10DB\u10DD\u10E1\u10D0\u10DA\u10DD\u10D3\u10DC\u10D4\u10DA\u10D8 ${G.origin} \u10D8\u10E7\u10DD\u10E1 ${Y}${G.minimum.toString()}`}case"invalid_format":{let Y=G;if(Y.format==="starts_with")return`\u10D0\u10E0\u10D0\u10E1\u10EC\u10DD\u10E0\u10D8 \u10E1\u10E2\u10E0\u10D8\u10DC\u10D2\u10D8: \u10E3\u10DC\u10D3\u10D0 \u10D8\u10EC\u10E7\u10D4\u10D1\u10DD\u10D3\u10D4\u10E1 "${Y.prefix}"-\u10D8\u10D7`;if(Y.format==="ends_with")return`\u10D0\u10E0\u10D0\u10E1\u10EC\u10DD\u10E0\u10D8 \u10E1\u10E2\u10E0\u10D8\u10DC\u10D2\u10D8: \u10E3\u10DC\u10D3\u10D0 \u10DB\u10D7\u10D0\u10D5\u10E0\u10D3\u10D4\u10D1\u10DD\u10D3\u10D4\u10E1 "${Y.suffix}"-\u10D8\u10D7`;if(Y.format==="includes")return`\u10D0\u10E0\u10D0\u10E1\u10EC\u10DD\u10E0\u10D8 \u10E1\u10E2\u10E0\u10D8\u10DC\u10D2\u10D8: \u10E3\u10DC\u10D3\u10D0 \u10E8\u10D4\u10D8\u10EA\u10D0\u10D5\u10D3\u10D4\u10E1 "${Y.includes}"-\u10E1`;if(Y.format==="regex")return`\u10D0\u10E0\u10D0\u10E1\u10EC\u10DD\u10E0\u10D8 \u10E1\u10E2\u10E0\u10D8\u10DC\u10D2\u10D8: \u10E3\u10DC\u10D3\u10D0 \u10E8\u10D4\u10D4\u10E1\u10D0\u10D1\u10D0\u10DB\u10D4\u10D1\u10DD\u10D3\u10D4\u10E1 \u10E8\u10D0\u10D1\u10DA\u10DD\u10DC\u10E1 ${Y.pattern}`;return`\u10D0\u10E0\u10D0\u10E1\u10EC\u10DD\u10E0\u10D8 ${X[Y.format]??G.format}`}case"not_multiple_of":return`\u10D0\u10E0\u10D0\u10E1\u10EC\u10DD\u10E0\u10D8 \u10E0\u10D8\u10EA\u10EE\u10D5\u10D8: \u10E3\u10DC\u10D3\u10D0 \u10D8\u10E7\u10DD\u10E1 ${G.divisor}-\u10D8\u10E1 \u10EF\u10D4\u10E0\u10D0\u10D3\u10D8`;case"unrecognized_keys":return`\u10E3\u10EA\u10DC\u10DD\u10D1\u10D8 \u10D2\u10D0\u10E1\u10D0\u10E6\u10D4\u10D1${G.keys.length>1?"\u10D4\u10D1\u10D8":"\u10D8"}: ${h(G.keys,", ")}`;case"invalid_key":return`\u10D0\u10E0\u10D0\u10E1\u10EC\u10DD\u10E0\u10D8 \u10D2\u10D0\u10E1\u10D0\u10E6\u10D4\u10D1\u10D8 ${G.origin}-\u10E8\u10D8`;case"invalid_union":return"\u10D0\u10E0\u10D0\u10E1\u10EC\u10DD\u10E0\u10D8 \u10E8\u10D4\u10E7\u10D5\u10D0\u10DC\u10D0";case"invalid_element":return`\u10D0\u10E0\u10D0\u10E1\u10EC\u10DD\u10E0\u10D8 \u10DB\u10DC\u10D8\u10E8\u10D5\u10DC\u10D4\u10DA\u10DD\u10D1\u10D0 ${G.origin}-\u10E8\u10D8`;default:return"\u10D0\u10E0\u10D0\u10E1\u10EC\u10DD\u10E0\u10D8 \u10E8\u10D4\u10E7\u10D5\u10D0\u10DC\u10D0"}}};var sT=D(()=>{Y6()});function p9(){return{localeError:zy()}}var zy=()=>{let J={string:{unit:"\u178F\u17BD\u17A2\u1780\u17D2\u179F\u179A",verb:"\u1782\u17BD\u179A\u1798\u17B6\u1793"},file:{unit:"\u1794\u17C3",verb:"\u1782\u17BD\u179A\u1798\u17B6\u1793"},array:{unit:"\u1792\u17B6\u178F\u17BB",verb:"\u1782\u17BD\u179A\u1798\u17B6\u1793"},set:{unit:"\u1792\u17B6\u178F\u17BB",verb:"\u1782\u17BD\u179A\u1798\u17B6\u1793"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"\u1798\u17B7\u1793\u1798\u17C2\u1793\u1787\u17B6\u179B\u17C1\u1781 (NaN)":"\u179B\u17C1\u1781";case"object":{if(Array.isArray(Y))return"\u17A2\u17B6\u179A\u17C1 (Array)";if(Y===null)return"\u1782\u17D2\u1798\u17B6\u1793\u178F\u1798\u17D2\u179B\u17C3 (null)";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"\u1791\u17B7\u1793\u17D2\u1793\u1793\u17D0\u1799\u1794\u1789\u17D2\u1785\u17BC\u179B",email:"\u17A2\u17B6\u179F\u1799\u178A\u17D2\u178B\u17B6\u1793\u17A2\u17CA\u17B8\u1798\u17C2\u179B",url:"URL",emoji:"\u179F\u1789\u17D2\u1789\u17B6\u17A2\u17B6\u179A\u1798\u17D2\u1798\u178E\u17CD",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"\u1780\u17B6\u179B\u1794\u179A\u17B7\u1785\u17D2\u1786\u17C1\u1791 \u1793\u17B7\u1784\u1798\u17C9\u17C4\u1784 ISO",date:"\u1780\u17B6\u179B\u1794\u179A\u17B7\u1785\u17D2\u1786\u17C1\u1791 ISO",time:"\u1798\u17C9\u17C4\u1784 ISO",duration:"\u179A\u1799\u17C8\u1796\u17C1\u179B ISO",ipv4:"\u17A2\u17B6\u179F\u1799\u178A\u17D2\u178B\u17B6\u1793 IPv4",ipv6:"\u17A2\u17B6\u179F\u1799\u178A\u17D2\u178B\u17B6\u1793 IPv6",cidrv4:"\u178A\u17C2\u1793\u17A2\u17B6\u179F\u1799\u178A\u17D2\u178B\u17B6\u1793 IPv4",cidrv6:"\u178A\u17C2\u1793\u17A2\u17B6\u179F\u1799\u178A\u17D2\u178B\u17B6\u1793 IPv6",base64:"\u1781\u17D2\u179F\u17C2\u17A2\u1780\u17D2\u179F\u179A\u17A2\u17CA\u17B7\u1780\u17BC\u178A base64",base64url:"\u1781\u17D2\u179F\u17C2\u17A2\u1780\u17D2\u179F\u179A\u17A2\u17CA\u17B7\u1780\u17BC\u178A base64url",json_string:"\u1781\u17D2\u179F\u17C2\u17A2\u1780\u17D2\u179F\u179A JSON",e164:"\u179B\u17C1\u1781 E.164",jwt:"JWT",template_literal:"\u1791\u17B7\u1793\u17D2\u1793\u1793\u17D0\u1799\u1794\u1789\u17D2\u1785\u17BC\u179B"};return(Y)=>{switch(Y.code){case"invalid_type":return`\u1791\u17B7\u1793\u17D2\u1793\u1793\u17D0\u1799\u1794\u1789\u17D2\u1785\u17BC\u179B\u1798\u17B7\u1793\u178F\u17D2\u179A\u17B9\u1798\u178F\u17D2\u179A\u17BC\u179C\u17D6 \u178F\u17D2\u179A\u17BC\u179C\u1780\u17B6\u179A ${Y.expected} \u1794\u17C9\u17BB\u1793\u17D2\u178F\u17C2\u1791\u1791\u17BD\u179B\u1794\u17B6\u1793 ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`\u1791\u17B7\u1793\u17D2\u1793\u1793\u17D0\u1799\u1794\u1789\u17D2\u1785\u17BC\u179B\u1798\u17B7\u1793\u178F\u17D2\u179A\u17B9\u1798\u178F\u17D2\u179A\u17BC\u179C\u17D6 \u178F\u17D2\u179A\u17BC\u179C\u1780\u17B6\u179A ${p(Y.values[0])}`;return`\u1787\u1798\u17D2\u179A\u17BE\u179F\u1798\u17B7\u1793\u178F\u17D2\u179A\u17B9\u1798\u178F\u17D2\u179A\u17BC\u179C\u17D6 \u178F\u17D2\u179A\u17BC\u179C\u1787\u17B6\u1798\u17BD\u1799\u1780\u17D2\u1793\u17BB\u1784\u1785\u17C6\u178E\u17C4\u1798 ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`\u1792\u17C6\u1796\u17C1\u1780\u17D6 \u178F\u17D2\u179A\u17BC\u179C\u1780\u17B6\u179A ${Y.origin??"\u178F\u1798\u17D2\u179B\u17C3"} ${$} ${Y.maximum.toString()} ${K.unit??"\u1792\u17B6\u178F\u17BB"}`;return`\u1792\u17C6\u1796\u17C1\u1780\u17D6 \u178F\u17D2\u179A\u17BC\u179C\u1780\u17B6\u179A ${Y.origin??"\u178F\u1798\u17D2\u179B\u17C3"} ${$} ${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`\u178F\u17BC\u1785\u1796\u17C1\u1780\u17D6 \u178F\u17D2\u179A\u17BC\u179C\u1780\u17B6\u179A ${Y.origin} ${$} ${Y.minimum.toString()} ${K.unit}`;return`\u178F\u17BC\u1785\u1796\u17C1\u1780\u17D6 \u178F\u17D2\u179A\u17BC\u179C\u1780\u17B6\u179A ${Y.origin} ${$} ${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`\u1781\u17D2\u179F\u17C2\u17A2\u1780\u17D2\u179F\u179A\u1798\u17B7\u1793\u178F\u17D2\u179A\u17B9\u1798\u178F\u17D2\u179A\u17BC\u179C\u17D6 \u178F\u17D2\u179A\u17BC\u179C\u1785\u17B6\u1794\u17CB\u1795\u17D2\u178F\u17BE\u1798\u178A\u17C4\u1799 "${$.prefix}"`;if($.format==="ends_with")return`\u1781\u17D2\u179F\u17C2\u17A2\u1780\u17D2\u179F\u179A\u1798\u17B7\u1793\u178F\u17D2\u179A\u17B9\u1798\u178F\u17D2\u179A\u17BC\u179C\u17D6 \u178F\u17D2\u179A\u17BC\u179C\u1794\u1789\u17D2\u1785\u1794\u17CB\u178A\u17C4\u1799 "${$.suffix}"`;if($.format==="includes")return`\u1781\u17D2\u179F\u17C2\u17A2\u1780\u17D2\u179F\u179A\u1798\u17B7\u1793\u178F\u17D2\u179A\u17B9\u1798\u178F\u17D2\u179A\u17BC\u179C\u17D6 \u178F\u17D2\u179A\u17BC\u179C\u1798\u17B6\u1793 "${$.includes}"`;if($.format==="regex")return`\u1781\u17D2\u179F\u17C2\u17A2\u1780\u17D2\u179F\u179A\u1798\u17B7\u1793\u178F\u17D2\u179A\u17B9\u1798\u178F\u17D2\u179A\u17BC\u179C\u17D6 \u178F\u17D2\u179A\u17BC\u179C\u178F\u17C2\u1795\u17D2\u1782\u17BC\u1795\u17D2\u1782\u1784\u1793\u17B9\u1784\u1791\u1798\u17D2\u179A\u1784\u17CB\u178A\u17C2\u179B\u1794\u17B6\u1793\u1780\u17C6\u178E\u178F\u17CB ${$.pattern}`;return`\u1798\u17B7\u1793\u178F\u17D2\u179A\u17B9\u1798\u178F\u17D2\u179A\u17BC\u179C\u17D6 ${G[$.format]??Y.format}`}case"not_multiple_of":return`\u179B\u17C1\u1781\u1798\u17B7\u1793\u178F\u17D2\u179A\u17B9\u1798\u178F\u17D2\u179A\u17BC\u179C\u17D6 \u178F\u17D2\u179A\u17BC\u179C\u178F\u17C2\u1787\u17B6\u1796\u17A0\u17BB\u1782\u17BB\u178E\u1793\u17C3 ${Y.divisor}`;case"unrecognized_keys":return`\u179A\u1780\u1783\u17BE\u1789\u179F\u17C4\u1798\u17B7\u1793\u179F\u17D2\u1782\u17B6\u179B\u17CB\u17D6 ${h(Y.keys,", ")}`;case"invalid_key":return`\u179F\u17C4\u1798\u17B7\u1793\u178F\u17D2\u179A\u17B9\u1798\u178F\u17D2\u179A\u17BC\u179C\u1793\u17C5\u1780\u17D2\u1793\u17BB\u1784 ${Y.origin}`;case"invalid_union":return"\u1791\u17B7\u1793\u17D2\u1793\u1793\u17D0\u1799\u1798\u17B7\u1793\u178F\u17D2\u179A\u17B9\u1798\u178F\u17D2\u179A\u17BC\u179C";case"invalid_element":return`\u1791\u17B7\u1793\u17D2\u1793\u1793\u17D0\u1799\u1798\u17B7\u1793\u178F\u17D2\u179A\u17B9\u1798\u178F\u17D2\u179A\u17BC\u179C\u1793\u17C5\u1780\u17D2\u1793\u17BB\u1784 ${Y.origin}`;default:return"\u1791\u17B7\u1793\u17D2\u1793\u1793\u17D0\u1799\u1798\u17B7\u1793\u178F\u17D2\u179A\u17B9\u1798\u178F\u17D2\u179A\u17BC\u179C"}}};var iQ=D(()=>{Y6()});function aQ(){return p9()}var eT=D(()=>{iQ()});function tQ(){return{localeError:Fy()}}var Fy=()=>{let J={string:{unit:"\uBB38\uC790",verb:"to have"},file:{unit:"\uBC14\uC774\uD2B8",verb:"to have"},array:{unit:"\uAC1C",verb:"to have"},set:{unit:"\uAC1C",verb:"to have"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"number";case"object":{if(Array.isArray(Y))return"array";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"\uC785\uB825",email:"\uC774\uBA54\uC77C \uC8FC\uC18C",url:"URL",emoji:"\uC774\uBAA8\uC9C0",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO \uB0A0\uC9DC\uC2DC\uAC04",date:"ISO \uB0A0\uC9DC",time:"ISO \uC2DC\uAC04",duration:"ISO \uAE30\uAC04",ipv4:"IPv4 \uC8FC\uC18C",ipv6:"IPv6 \uC8FC\uC18C",cidrv4:"IPv4 \uBC94\uC704",cidrv6:"IPv6 \uBC94\uC704",base64:"base64 \uC778\uCF54\uB529 \uBB38\uC790\uC5F4",base64url:"base64url \uC778\uCF54\uB529 \uBB38\uC790\uC5F4",json_string:"JSON \uBB38\uC790\uC5F4",e164:"E.164 \uBC88\uD638",jwt:"JWT",template_literal:"\uC785\uB825"};return(Y)=>{switch(Y.code){case"invalid_type":return`\uC798\uBABB\uB41C \uC785\uB825: \uC608\uC0C1 \uD0C0\uC785\uC740 ${Y.expected}, \uBC1B\uC740 \uD0C0\uC785\uC740 ${X(Y.input)}\uC785\uB2C8\uB2E4`;case"invalid_value":if(Y.values.length===1)return`\uC798\uBABB\uB41C \uC785\uB825: \uAC12\uC740 ${p(Y.values[0])} \uC774\uC5B4\uC57C \uD569\uB2C8\uB2E4`;return`\uC798\uBABB\uB41C \uC635\uC158: ${h(Y.values,"\uB610\uB294 ")} \uC911 \uD558\uB098\uC5EC\uC57C \uD569\uB2C8\uB2E4`;case"too_big":{let $=Y.inclusive?"\uC774\uD558":"\uBBF8\uB9CC",K=$==="\uBBF8\uB9CC"?"\uC774\uC5B4\uC57C \uD569\uB2C8\uB2E4":"\uC5EC\uC57C \uD569\uB2C8\uB2E4",w=W(Y.origin),H=w?.unit??"\uC694\uC18C";if(w)return`${Y.origin??"\uAC12"}\uC774 \uB108\uBB34 \uD07D\uB2C8\uB2E4: ${Y.maximum.toString()}${H} ${$}${K}`;return`${Y.origin??"\uAC12"}\uC774 \uB108\uBB34 \uD07D\uB2C8\uB2E4: ${Y.maximum.toString()} ${$}${K}`}case"too_small":{let $=Y.inclusive?"\uC774\uC0C1":"\uCD08\uACFC",K=$==="\uC774\uC0C1"?"\uC774\uC5B4\uC57C \uD569\uB2C8\uB2E4":"\uC5EC\uC57C \uD569\uB2C8\uB2E4",w=W(Y.origin),H=w?.unit??"\uC694\uC18C";if(w)return`${Y.origin??"\uAC12"}\uC774 \uB108\uBB34 \uC791\uC2B5\uB2C8\uB2E4: ${Y.minimum.toString()}${H} ${$}${K}`;return`${Y.origin??"\uAC12"}\uC774 \uB108\uBB34 \uC791\uC2B5\uB2C8\uB2E4: ${Y.minimum.toString()} ${$}${K}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`\uC798\uBABB\uB41C \uBB38\uC790\uC5F4: "${$.prefix}"(\uC73C)\uB85C \uC2DC\uC791\uD574\uC57C \uD569\uB2C8\uB2E4`;if($.format==="ends_with")return`\uC798\uBABB\uB41C \uBB38\uC790\uC5F4: "${$.suffix}"(\uC73C)\uB85C \uB05D\uB098\uC57C \uD569\uB2C8\uB2E4`;if($.format==="includes")return`\uC798\uBABB\uB41C \uBB38\uC790\uC5F4: "${$.includes}"\uC744(\uB97C) \uD3EC\uD568\uD574\uC57C \uD569\uB2C8\uB2E4`;if($.format==="regex")return`\uC798\uBABB\uB41C \uBB38\uC790\uC5F4: \uC815\uADDC\uC2DD ${$.pattern} \uD328\uD134\uACFC \uC77C\uCE58\uD574\uC57C \uD569\uB2C8\uB2E4`;return`\uC798\uBABB\uB41C ${G[$.format]??Y.format}`}case"not_multiple_of":return`\uC798\uBABB\uB41C \uC22B\uC790: ${Y.divisor}\uC758 \uBC30\uC218\uC5EC\uC57C \uD569\uB2C8\uB2E4`;case"unrecognized_keys":return`\uC778\uC2DD\uD560 \uC218 \uC5C6\uB294 \uD0A4: ${h(Y.keys,", ")}`;case"invalid_key":return`\uC798\uBABB\uB41C \uD0A4: ${Y.origin}`;case"invalid_union":return"\uC798\uBABB\uB41C \uC785\uB825";case"invalid_element":return`\uC798\uBABB\uB41C \uAC12: ${Y.origin}`;default:return"\uC798\uBABB\uB41C \uC785\uB825"}}};var J2=D(()=>{Y6()});function W2(J){let W=Math.abs(J),X=W%10,G=W%100;if(G>=11&&G<=19||X===0)return"many";if(X===1)return"one";return"few"}function oQ(){return{localeError:Uy()}}var Ny=(J)=>{return n9(typeof J,J)},n9=(J,W=void 0)=>{switch(J){case"number":return Number.isNaN(W)?"NaN":"skai\u010Dius";case"bigint":return"sveikasis skai\u010Dius";case"string":return"eilut\u0117";case"boolean":return"login\u0117 reik\u0161m\u0117";case"undefined":case"void":return"neapibr\u0117\u017Eta reik\u0161m\u0117";case"function":return"funkcija";case"symbol":return"simbolis";case"object":{if(W===void 0)return"ne\u017Einomas objektas";if(W===null)return"nulin\u0117 reik\u0161m\u0117";if(Array.isArray(W))return"masyvas";if(Object.getPrototypeOf(W)!==Object.prototype&&W.constructor)return W.constructor.name;return"objektas"}case"null":return"nulin\u0117 reik\u0161m\u0117"}return J},d9=(J)=>{return J.charAt(0).toUpperCase()+J.slice(1)},Uy=()=>{let J={string:{unit:{one:"simbolis",few:"simboliai",many:"simboli\u0173"},verb:{smaller:{inclusive:"turi b\u016Bti ne ilgesn\u0117 kaip",notInclusive:"turi b\u016Bti trumpesn\u0117 kaip"},bigger:{inclusive:"turi b\u016Bti ne trumpesn\u0117 kaip",notInclusive:"turi b\u016Bti ilgesn\u0117 kaip"}}},file:{unit:{one:"baitas",few:"baitai",many:"bait\u0173"},verb:{smaller:{inclusive:"turi b\u016Bti ne didesnis kaip",notInclusive:"turi b\u016Bti ma\u017Eesnis kaip"},bigger:{inclusive:"turi b\u016Bti ne ma\u017Eesnis kaip",notInclusive:"turi b\u016Bti didesnis kaip"}}},array:{unit:{one:"element\u0105",few:"elementus",many:"element\u0173"},verb:{smaller:{inclusive:"turi tur\u0117ti ne daugiau kaip",notInclusive:"turi tur\u0117ti ma\u017Eiau kaip"},bigger:{inclusive:"turi tur\u0117ti ne ma\u017Eiau kaip",notInclusive:"turi tur\u0117ti daugiau kaip"}}},set:{unit:{one:"element\u0105",few:"elementus",many:"element\u0173"},verb:{smaller:{inclusive:"turi tur\u0117ti ne daugiau kaip",notInclusive:"turi tur\u0117ti ma\u017Eiau kaip"},bigger:{inclusive:"turi tur\u0117ti ne ma\u017Eiau kaip",notInclusive:"turi tur\u0117ti daugiau kaip"}}}};function W(G,Y,$,K){let w=J[G]??null;if(w===null)return w;return{unit:w.unit[Y],verb:w.verb[K][$?"inclusive":"notInclusive"]}}let X={regex:"\u012Fvestis",email:"el. pa\u0161to adresas",url:"URL",emoji:"jaustukas",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO data ir laikas",date:"ISO data",time:"ISO laikas",duration:"ISO trukm\u0117",ipv4:"IPv4 adresas",ipv6:"IPv6 adresas",cidrv4:"IPv4 tinklo prefiksas (CIDR)",cidrv6:"IPv6 tinklo prefiksas (CIDR)",base64:"base64 u\u017Ekoduota eilut\u0117",base64url:"base64url u\u017Ekoduota eilut\u0117",json_string:"JSON eilut\u0117",e164:"E.164 numeris",jwt:"JWT",template_literal:"\u012Fvestis"};return(G)=>{switch(G.code){case"invalid_type":return`Gautas tipas ${Ny(G.input)}, o tik\u0117tasi - ${n9(G.expected)}`;case"invalid_value":if(G.values.length===1)return`Privalo b\u016Bti ${p(G.values[0])}`;return`Privalo b\u016Bti vienas i\u0161 ${h(G.values,"|")} pasirinkim\u0173`;case"too_big":{let Y=n9(G.origin),$=W(G.origin,W2(Number(G.maximum)),G.inclusive??!1,"smaller");if($?.verb)return`${d9(Y??G.origin??"reik\u0161m\u0117")} ${$.verb} ${G.maximum.toString()} ${$.unit??"element\u0173"}`;let K=G.inclusive?"ne didesnis kaip":"ma\u017Eesnis kaip";return`${d9(Y??G.origin??"reik\u0161m\u0117")} turi b\u016Bti ${K} ${G.maximum.toString()} ${$?.unit}`}case"too_small":{let Y=n9(G.origin),$=W(G.origin,W2(Number(G.minimum)),G.inclusive??!1,"bigger");if($?.verb)return`${d9(Y??G.origin??"reik\u0161m\u0117")} ${$.verb} ${G.minimum.toString()} ${$.unit??"element\u0173"}`;let K=G.inclusive?"ne ma\u017Eesnis kaip":"didesnis kaip";return`${d9(Y??G.origin??"reik\u0161m\u0117")} turi b\u016Bti ${K} ${G.minimum.toString()} ${$?.unit}`}case"invalid_format":{let Y=G;if(Y.format==="starts_with")return`Eilut\u0117 privalo prasid\u0117ti "${Y.prefix}"`;if(Y.format==="ends_with")return`Eilut\u0117 privalo pasibaigti "${Y.suffix}"`;if(Y.format==="includes")return`Eilut\u0117 privalo \u012Ftraukti "${Y.includes}"`;if(Y.format==="regex")return`Eilut\u0117 privalo atitikti ${Y.pattern}`;return`Neteisingas ${X[Y.format]??G.format}`}case"not_multiple_of":return`Skai\u010Dius privalo b\u016Bti ${G.divisor} kartotinis.`;case"unrecognized_keys":return`Neatpa\u017Eint${G.keys.length>1?"i":"as"} rakt${G.keys.length>1?"ai":"as"}: ${h(G.keys,", ")}`;case"invalid_key":return"Rastas klaidingas raktas";case"invalid_union":return"Klaidinga \u012Fvestis";case"invalid_element":{let Y=n9(G.origin);return`${d9(Y??G.origin??"reik\u0161m\u0117")} turi klaiding\u0105 \u012Fvest\u012F`}default:return"Klaidinga \u012Fvestis"}}};var X2=D(()=>{Y6()});function sQ(){return{localeError:Qy()}}var Qy=()=>{let J={string:{unit:"\u0437\u043D\u0430\u0446\u0438",verb:"\u0434\u0430 \u0438\u043C\u0430\u0430\u0442"},file:{unit:"\u0431\u0430\u0458\u0442\u0438",verb:"\u0434\u0430 \u0438\u043C\u0430\u0430\u0442"},array:{unit:"\u0441\u0442\u0430\u0432\u043A\u0438",verb:"\u0434\u0430 \u0438\u043C\u0430\u0430\u0442"},set:{unit:"\u0441\u0442\u0430\u0432\u043A\u0438",verb:"\u0434\u0430 \u0438\u043C\u0430\u0430\u0442"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"\u0431\u0440\u043E\u0458";case"object":{if(Array.isArray(Y))return"\u043D\u0438\u0437\u0430";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"\u0432\u043D\u0435\u0441",email:"\u0430\u0434\u0440\u0435\u0441\u0430 \u043D\u0430 \u0435-\u043F\u043E\u0448\u0442\u0430",url:"URL",emoji:"\u0435\u043C\u043E\u045F\u0438",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO \u0434\u0430\u0442\u0443\u043C \u0438 \u0432\u0440\u0435\u043C\u0435",date:"ISO \u0434\u0430\u0442\u0443\u043C",time:"ISO \u0432\u0440\u0435\u043C\u0435",duration:"ISO \u0432\u0440\u0435\u043C\u0435\u0442\u0440\u0430\u0435\u045A\u0435",ipv4:"IPv4 \u0430\u0434\u0440\u0435\u0441\u0430",ipv6:"IPv6 \u0430\u0434\u0440\u0435\u0441\u0430",cidrv4:"IPv4 \u043E\u043F\u0441\u0435\u0433",cidrv6:"IPv6 \u043E\u043F\u0441\u0435\u0433",base64:"base64-\u0435\u043D\u043A\u043E\u0434\u0438\u0440\u0430\u043D\u0430 \u043D\u0438\u0437\u0430",base64url:"base64url-\u0435\u043D\u043A\u043E\u0434\u0438\u0440\u0430\u043D\u0430 \u043D\u0438\u0437\u0430",json_string:"JSON \u043D\u0438\u0437\u0430",e164:"E.164 \u0431\u0440\u043E\u0458",jwt:"JWT",template_literal:"\u0432\u043D\u0435\u0441"};return(Y)=>{switch(Y.code){case"invalid_type":return`\u0413\u0440\u0435\u0448\u0435\u043D \u0432\u043D\u0435\u0441: \u0441\u0435 \u043E\u0447\u0435\u043A\u0443\u0432\u0430 ${Y.expected}, \u043F\u0440\u0438\u043C\u0435\u043D\u043E ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`Invalid input: expected ${p(Y.values[0])}`;return`\u0413\u0440\u0435\u0448\u0430\u043D\u0430 \u043E\u043F\u0446\u0438\u0458\u0430: \u0441\u0435 \u043E\u0447\u0435\u043A\u0443\u0432\u0430 \u0435\u0434\u043D\u0430 ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`\u041F\u0440\u0435\u043C\u043D\u043E\u0433\u0443 \u0433\u043E\u043B\u0435\u043C: \u0441\u0435 \u043E\u0447\u0435\u043A\u0443\u0432\u0430 ${Y.origin??"\u0432\u0440\u0435\u0434\u043D\u043E\u0441\u0442\u0430"} \u0434\u0430 \u0438\u043C\u0430 ${$}${Y.maximum.toString()} ${K.unit??"\u0435\u043B\u0435\u043C\u0435\u043D\u0442\u0438"}`;return`\u041F\u0440\u0435\u043C\u043D\u043E\u0433\u0443 \u0433\u043E\u043B\u0435\u043C: \u0441\u0435 \u043E\u0447\u0435\u043A\u0443\u0432\u0430 ${Y.origin??"\u0432\u0440\u0435\u0434\u043D\u043E\u0441\u0442\u0430"} \u0434\u0430 \u0431\u0438\u0434\u0435 ${$}${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`\u041F\u0440\u0435\u043C\u043D\u043E\u0433\u0443 \u043C\u0430\u043B: \u0441\u0435 \u043E\u0447\u0435\u043A\u0443\u0432\u0430 ${Y.origin} \u0434\u0430 \u0438\u043C\u0430 ${$}${Y.minimum.toString()} ${K.unit}`;return`\u041F\u0440\u0435\u043C\u043D\u043E\u0433\u0443 \u043C\u0430\u043B: \u0441\u0435 \u043E\u0447\u0435\u043A\u0443\u0432\u0430 ${Y.origin} \u0434\u0430 \u0431\u0438\u0434\u0435 ${$}${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`\u041D\u0435\u0432\u0430\u0436\u0435\u0447\u043A\u0430 \u043D\u0438\u0437\u0430: \u043C\u043E\u0440\u0430 \u0434\u0430 \u0437\u0430\u043F\u043E\u0447\u043D\u0443\u0432\u0430 \u0441\u043E "${$.prefix}"`;if($.format==="ends_with")return`\u041D\u0435\u0432\u0430\u0436\u0435\u0447\u043A\u0430 \u043D\u0438\u0437\u0430: \u043C\u043E\u0440\u0430 \u0434\u0430 \u0437\u0430\u0432\u0440\u0448\u0443\u0432\u0430 \u0441\u043E "${$.suffix}"`;if($.format==="includes")return`\u041D\u0435\u0432\u0430\u0436\u0435\u0447\u043A\u0430 \u043D\u0438\u0437\u0430: \u043C\u043E\u0440\u0430 \u0434\u0430 \u0432\u043A\u043B\u0443\u0447\u0443\u0432\u0430 "${$.includes}"`;if($.format==="regex")return`\u041D\u0435\u0432\u0430\u0436\u0435\u0447\u043A\u0430 \u043D\u0438\u0437\u0430: \u043C\u043E\u0440\u0430 \u0434\u0430 \u043E\u0434\u0433\u043E\u0430\u0440\u0430 \u043D\u0430 \u043F\u0430\u0442\u0435\u0440\u043D\u043E\u0442 ${$.pattern}`;return`Invalid ${G[$.format]??Y.format}`}case"not_multiple_of":return`\u0413\u0440\u0435\u0448\u0435\u043D \u0431\u0440\u043E\u0458: \u043C\u043E\u0440\u0430 \u0434\u0430 \u0431\u0438\u0434\u0435 \u0434\u0435\u043B\u0438\u0432 \u0441\u043E ${Y.divisor}`;case"unrecognized_keys":return`${Y.keys.length>1?"\u041D\u0435\u043F\u0440\u0435\u043F\u043E\u0437\u043D\u0430\u0435\u043D\u0438 \u043A\u043B\u0443\u0447\u0435\u0432\u0438":"\u041D\u0435\u043F\u0440\u0435\u043F\u043E\u0437\u043D\u0430\u0435\u043D \u043A\u043B\u0443\u0447"}: ${h(Y.keys,", ")}`;case"invalid_key":return`\u0413\u0440\u0435\u0448\u0435\u043D \u043A\u043B\u0443\u0447 \u0432\u043E ${Y.origin}`;case"invalid_union":return"\u0413\u0440\u0435\u0448\u0435\u043D \u0432\u043D\u0435\u0441";case"invalid_element":return`\u0413\u0440\u0435\u0448\u043D\u0430 \u0432\u0440\u0435\u0434\u043D\u043E\u0441\u0442 \u0432\u043E ${Y.origin}`;default:return"\u0413\u0440\u0435\u0448\u0435\u043D \u0432\u043D\u0435\u0441"}}};var Y2=D(()=>{Y6()});function eQ(){return{localeError:Ly()}}var Ly=()=>{let J={string:{unit:"aksara",verb:"mempunyai"},file:{unit:"bait",verb:"mempunyai"},array:{unit:"elemen",verb:"mempunyai"},set:{unit:"elemen",verb:"mempunyai"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"nombor";case"object":{if(Array.isArray(Y))return"array";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"input",email:"alamat e-mel",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"tarikh masa ISO",date:"tarikh ISO",time:"masa ISO",duration:"tempoh ISO",ipv4:"alamat IPv4",ipv6:"alamat IPv6",cidrv4:"julat IPv4",cidrv6:"julat IPv6",base64:"string dikodkan base64",base64url:"string dikodkan base64url",json_string:"string JSON",e164:"nombor E.164",jwt:"JWT",template_literal:"input"};return(Y)=>{switch(Y.code){case"invalid_type":return`Input tidak sah: dijangka ${Y.expected}, diterima ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`Input tidak sah: dijangka ${p(Y.values[0])}`;return`Pilihan tidak sah: dijangka salah satu daripada ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`Terlalu besar: dijangka ${Y.origin??"nilai"} ${K.verb} ${$}${Y.maximum.toString()} ${K.unit??"elemen"}`;return`Terlalu besar: dijangka ${Y.origin??"nilai"} adalah ${$}${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`Terlalu kecil: dijangka ${Y.origin} ${K.verb} ${$}${Y.minimum.toString()} ${K.unit}`;return`Terlalu kecil: dijangka ${Y.origin} adalah ${$}${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`String tidak sah: mesti bermula dengan "${$.prefix}"`;if($.format==="ends_with")return`String tidak sah: mesti berakhir dengan "${$.suffix}"`;if($.format==="includes")return`String tidak sah: mesti mengandungi "${$.includes}"`;if($.format==="regex")return`String tidak sah: mesti sepadan dengan corak ${$.pattern}`;return`${G[$.format]??Y.format} tidak sah`}case"not_multiple_of":return`Nombor tidak sah: perlu gandaan ${Y.divisor}`;case"unrecognized_keys":return`Kunci tidak dikenali: ${h(Y.keys,", ")}`;case"invalid_key":return`Kunci tidak sah dalam ${Y.origin}`;case"invalid_union":return"Input tidak sah";case"invalid_element":return`Nilai tidak sah dalam ${Y.origin}`;default:return"Input tidak sah"}}};var G2=D(()=>{Y6()});function JL(){return{localeError:Vy()}}var Vy=()=>{let J={string:{unit:"tekens"},file:{unit:"bytes"},array:{unit:"elementen"},set:{unit:"elementen"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"getal";case"object":{if(Array.isArray(Y))return"array";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"invoer",email:"emailadres",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datum en tijd",date:"ISO datum",time:"ISO tijd",duration:"ISO duur",ipv4:"IPv4-adres",ipv6:"IPv6-adres",cidrv4:"IPv4-bereik",cidrv6:"IPv6-bereik",base64:"base64-gecodeerde tekst",base64url:"base64 URL-gecodeerde tekst",json_string:"JSON string",e164:"E.164-nummer",jwt:"JWT",template_literal:"invoer"};return(Y)=>{switch(Y.code){case"invalid_type":return`Ongeldige invoer: verwacht ${Y.expected}, ontving ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`Ongeldige invoer: verwacht ${p(Y.values[0])}`;return`Ongeldige optie: verwacht \xE9\xE9n van ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`Te lang: verwacht dat ${Y.origin??"waarde"} ${$}${Y.maximum.toString()} ${K.unit??"elementen"} bevat`;return`Te lang: verwacht dat ${Y.origin??"waarde"} ${$}${Y.maximum.toString()} is`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`Te kort: verwacht dat ${Y.origin} ${$}${Y.minimum.toString()} ${K.unit} bevat`;return`Te kort: verwacht dat ${Y.origin} ${$}${Y.minimum.toString()} is`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`Ongeldige tekst: moet met "${$.prefix}" beginnen`;if($.format==="ends_with")return`Ongeldige tekst: moet op "${$.suffix}" eindigen`;if($.format==="includes")return`Ongeldige tekst: moet "${$.includes}" bevatten`;if($.format==="regex")return`Ongeldige tekst: moet overeenkomen met patroon ${$.pattern}`;return`Ongeldig: ${G[$.format]??Y.format}`}case"not_multiple_of":return`Ongeldig getal: moet een veelvoud van ${Y.divisor} zijn`;case"unrecognized_keys":return`Onbekende key${Y.keys.length>1?"s":""}: ${h(Y.keys,", ")}`;case"invalid_key":return`Ongeldige key in ${Y.origin}`;case"invalid_union":return"Ongeldige invoer";case"invalid_element":return`Ongeldige waarde in ${Y.origin}`;default:return"Ongeldige invoer"}}};var $2=D(()=>{Y6()});function WL(){return{localeError:Dy()}}var Dy=()=>{let J={string:{unit:"tegn",verb:"\xE5 ha"},file:{unit:"bytes",verb:"\xE5 ha"},array:{unit:"elementer",verb:"\xE5 inneholde"},set:{unit:"elementer",verb:"\xE5 inneholde"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"tall";case"object":{if(Array.isArray(Y))return"liste";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"input",email:"e-postadresse",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO dato- og klokkeslett",date:"ISO-dato",time:"ISO-klokkeslett",duration:"ISO-varighet",ipv4:"IPv4-omr\xE5de",ipv6:"IPv6-omr\xE5de",cidrv4:"IPv4-spekter",cidrv6:"IPv6-spekter",base64:"base64-enkodet streng",base64url:"base64url-enkodet streng",json_string:"JSON-streng",e164:"E.164-nummer",jwt:"JWT",template_literal:"input"};return(Y)=>{switch(Y.code){case"invalid_type":return`Ugyldig input: forventet ${Y.expected}, fikk ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`Ugyldig verdi: forventet ${p(Y.values[0])}`;return`Ugyldig valg: forventet en av ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`For stor(t): forventet ${Y.origin??"value"} til \xE5 ha ${$}${Y.maximum.toString()} ${K.unit??"elementer"}`;return`For stor(t): forventet ${Y.origin??"value"} til \xE5 ha ${$}${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`For lite(n): forventet ${Y.origin} til \xE5 ha ${$}${Y.minimum.toString()} ${K.unit}`;return`For lite(n): forventet ${Y.origin} til \xE5 ha ${$}${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`Ugyldig streng: m\xE5 starte med "${$.prefix}"`;if($.format==="ends_with")return`Ugyldig streng: m\xE5 ende med "${$.suffix}"`;if($.format==="includes")return`Ugyldig streng: m\xE5 inneholde "${$.includes}"`;if($.format==="regex")return`Ugyldig streng: m\xE5 matche m\xF8nsteret ${$.pattern}`;return`Ugyldig ${G[$.format]??Y.format}`}case"not_multiple_of":return`Ugyldig tall: m\xE5 v\xE6re et multiplum av ${Y.divisor}`;case"unrecognized_keys":return`${Y.keys.length>1?"Ukjente n\xF8kler":"Ukjent n\xF8kkel"}: ${h(Y.keys,", ")}`;case"invalid_key":return`Ugyldig n\xF8kkel i ${Y.origin}`;case"invalid_union":return"Ugyldig input";case"invalid_element":return`Ugyldig verdi i ${Y.origin}`;default:return"Ugyldig input"}}};var K2=D(()=>{Y6()});function XL(){return{localeError:vy()}}var vy=()=>{let J={string:{unit:"harf",verb:"olmal\u0131d\u0131r"},file:{unit:"bayt",verb:"olmal\u0131d\u0131r"},array:{unit:"unsur",verb:"olmal\u0131d\u0131r"},set:{unit:"unsur",verb:"olmal\u0131d\u0131r"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"numara";case"object":{if(Array.isArray(Y))return"saf";if(Y===null)return"gayb";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"giren",email:"epostag\xE2h",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO heng\xE2m\u0131",date:"ISO tarihi",time:"ISO zaman\u0131",duration:"ISO m\xFCddeti",ipv4:"IPv4 ni\u015F\xE2n\u0131",ipv6:"IPv6 ni\u015F\xE2n\u0131",cidrv4:"IPv4 menzili",cidrv6:"IPv6 menzili",base64:"base64-\u015Fifreli metin",base64url:"base64url-\u015Fifreli metin",json_string:"JSON metin",e164:"E.164 say\u0131s\u0131",jwt:"JWT",template_literal:"giren"};return(Y)=>{switch(Y.code){case"invalid_type":return`F\xE2sit giren: umulan ${Y.expected}, al\u0131nan ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`F\xE2sit giren: umulan ${p(Y.values[0])}`;return`F\xE2sit tercih: m\xFBteberler ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`Fazla b\xFCy\xFCk: ${Y.origin??"value"}, ${$}${Y.maximum.toString()} ${K.unit??"elements"} sahip olmal\u0131yd\u0131.`;return`Fazla b\xFCy\xFCk: ${Y.origin??"value"}, ${$}${Y.maximum.toString()} olmal\u0131yd\u0131.`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`Fazla k\xFC\xE7\xFCk: ${Y.origin}, ${$}${Y.minimum.toString()} ${K.unit} sahip olmal\u0131yd\u0131.`;return`Fazla k\xFC\xE7\xFCk: ${Y.origin}, ${$}${Y.minimum.toString()} olmal\u0131yd\u0131.`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`F\xE2sit metin: "${$.prefix}" ile ba\u015Flamal\u0131.`;if($.format==="ends_with")return`F\xE2sit metin: "${$.suffix}" ile bitmeli.`;if($.format==="includes")return`F\xE2sit metin: "${$.includes}" ihtiv\xE2 etmeli.`;if($.format==="regex")return`F\xE2sit metin: ${$.pattern} nak\u015F\u0131na uymal\u0131.`;return`F\xE2sit ${G[$.format]??Y.format}`}case"not_multiple_of":return`F\xE2sit say\u0131: ${Y.divisor} kat\u0131 olmal\u0131yd\u0131.`;case"unrecognized_keys":return`Tan\u0131nmayan anahtar ${Y.keys.length>1?"s":""}: ${h(Y.keys,", ")}`;case"invalid_key":return`${Y.origin} i\xE7in tan\u0131nmayan anahtar var.`;case"invalid_union":return"Giren tan\u0131namad\u0131.";case"invalid_element":return`${Y.origin} i\xE7in tan\u0131nmayan k\u0131ymet var.`;default:return"K\u0131ymet tan\u0131namad\u0131."}}};var w2=D(()=>{Y6()});function YL(){return{localeError:My()}}var My=()=>{let J={string:{unit:"\u062A\u0648\u06A9\u064A",verb:"\u0648\u0644\u0631\u064A"},file:{unit:"\u0628\u0627\u06CC\u067C\u0633",verb:"\u0648\u0644\u0631\u064A"},array:{unit:"\u062A\u0648\u06A9\u064A",verb:"\u0648\u0644\u0631\u064A"},set:{unit:"\u062A\u0648\u06A9\u064A",verb:"\u0648\u0644\u0631\u064A"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"\u0639\u062F\u062F";case"object":{if(Array.isArray(Y))return"\u0627\u0631\u06D0";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"\u0648\u0631\u0648\u062F\u064A",email:"\u0628\u0631\u06CC\u069A\u0646\u0627\u0644\u06CC\u06A9",url:"\u06CC\u0648 \u0622\u0631 \u0627\u0644",emoji:"\u0627\u06CC\u0645\u0648\u062C\u064A",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"\u0646\u06CC\u067C\u0647 \u0627\u0648 \u0648\u062E\u062A",date:"\u0646\u06D0\u067C\u0647",time:"\u0648\u062E\u062A",duration:"\u0645\u0648\u062F\u0647",ipv4:"\u062F IPv4 \u067E\u062A\u0647",ipv6:"\u062F IPv6 \u067E\u062A\u0647",cidrv4:"\u062F IPv4 \u0633\u0627\u062D\u0647",cidrv6:"\u062F IPv6 \u0633\u0627\u062D\u0647",base64:"base64-encoded \u0645\u062A\u0646",base64url:"base64url-encoded \u0645\u062A\u0646",json_string:"JSON \u0645\u062A\u0646",e164:"\u062F E.164 \u0634\u0645\u06D0\u0631\u0647",jwt:"JWT",template_literal:"\u0648\u0631\u0648\u062F\u064A"};return(Y)=>{switch(Y.code){case"invalid_type":return`\u0646\u0627\u0633\u0645 \u0648\u0631\u0648\u062F\u064A: \u0628\u0627\u06CC\u062F ${Y.expected} \u0648\u0627\u06CC, \u0645\u06AB\u0631 ${X(Y.input)} \u062A\u0631\u0644\u0627\u0633\u0647 \u0634\u0648`;case"invalid_value":if(Y.values.length===1)return`\u0646\u0627\u0633\u0645 \u0648\u0631\u0648\u062F\u064A: \u0628\u0627\u06CC\u062F ${p(Y.values[0])} \u0648\u0627\u06CC`;return`\u0646\u0627\u0633\u0645 \u0627\u0646\u062A\u062E\u0627\u0628: \u0628\u0627\u06CC\u062F \u06CC\u0648 \u0644\u0647 ${h(Y.values,"|")} \u0685\u062E\u0647 \u0648\u0627\u06CC`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`\u0689\u06CC\u0631 \u0644\u0648\u06CC: ${Y.origin??"\u0627\u0631\u0632\u069A\u062A"} \u0628\u0627\u06CC\u062F ${$}${Y.maximum.toString()} ${K.unit??"\u0639\u0646\u0635\u0631\u0648\u0646\u0647"} \u0648\u0644\u0631\u064A`;return`\u0689\u06CC\u0631 \u0644\u0648\u06CC: ${Y.origin??"\u0627\u0631\u0632\u069A\u062A"} \u0628\u0627\u06CC\u062F ${$}${Y.maximum.toString()} \u0648\u064A`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`\u0689\u06CC\u0631 \u06A9\u0648\u0686\u0646\u06CC: ${Y.origin} \u0628\u0627\u06CC\u062F ${$}${Y.minimum.toString()} ${K.unit} \u0648\u0644\u0631\u064A`;return`\u0689\u06CC\u0631 \u06A9\u0648\u0686\u0646\u06CC: ${Y.origin} \u0628\u0627\u06CC\u062F ${$}${Y.minimum.toString()} \u0648\u064A`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`\u0646\u0627\u0633\u0645 \u0645\u062A\u0646: \u0628\u0627\u06CC\u062F \u062F "${$.prefix}" \u0633\u0631\u0647 \u067E\u06CC\u0644 \u0634\u064A`;if($.format==="ends_with")return`\u0646\u0627\u0633\u0645 \u0645\u062A\u0646: \u0628\u0627\u06CC\u062F \u062F "${$.suffix}" \u0633\u0631\u0647 \u067E\u0627\u06CC \u062A\u0647 \u0648\u0631\u0633\u064A\u0696\u064A`;if($.format==="includes")return`\u0646\u0627\u0633\u0645 \u0645\u062A\u0646: \u0628\u0627\u06CC\u062F "${$.includes}" \u0648\u0644\u0631\u064A`;if($.format==="regex")return`\u0646\u0627\u0633\u0645 \u0645\u062A\u0646: \u0628\u0627\u06CC\u062F \u062F ${$.pattern} \u0633\u0631\u0647 \u0645\u0637\u0627\u0628\u0642\u062A \u0648\u0644\u0631\u064A`;return`${G[$.format]??Y.format} \u0646\u0627\u0633\u0645 \u062F\u06CC`}case"not_multiple_of":return`\u0646\u0627\u0633\u0645 \u0639\u062F\u062F: \u0628\u0627\u06CC\u062F \u062F ${Y.divisor} \u0645\u0636\u0631\u0628 \u0648\u064A`;case"unrecognized_keys":return`\u0646\u0627\u0633\u0645 ${Y.keys.length>1?"\u06A9\u0644\u06CC\u0689\u0648\u0646\u0647":"\u06A9\u0644\u06CC\u0689"}: ${h(Y.keys,", ")}`;case"invalid_key":return`\u0646\u0627\u0633\u0645 \u06A9\u0644\u06CC\u0689 \u067E\u0647 ${Y.origin} \u06A9\u06D0`;case"invalid_union":return"\u0646\u0627\u0633\u0645\u0647 \u0648\u0631\u0648\u062F\u064A";case"invalid_element":return`\u0646\u0627\u0633\u0645 \u0639\u0646\u0635\u0631 \u067E\u0647 ${Y.origin} \u06A9\u06D0`;default:return"\u0646\u0627\u0633\u0645\u0647 \u0648\u0631\u0648\u062F\u064A"}}};var H2=D(()=>{Y6()});function GL(){return{localeError:Oy()}}var Oy=()=>{let J={string:{unit:"znak\xF3w",verb:"mie\u0107"},file:{unit:"bajt\xF3w",verb:"mie\u0107"},array:{unit:"element\xF3w",verb:"mie\u0107"},set:{unit:"element\xF3w",verb:"mie\u0107"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"liczba";case"object":{if(Array.isArray(Y))return"tablica";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"wyra\u017Cenie",email:"adres email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data i godzina w formacie ISO",date:"data w formacie ISO",time:"godzina w formacie ISO",duration:"czas trwania ISO",ipv4:"adres IPv4",ipv6:"adres IPv6",cidrv4:"zakres IPv4",cidrv6:"zakres IPv6",base64:"ci\u0105g znak\xF3w zakodowany w formacie base64",base64url:"ci\u0105g znak\xF3w zakodowany w formacie base64url",json_string:"ci\u0105g znak\xF3w w formacie JSON",e164:"liczba E.164",jwt:"JWT",template_literal:"wej\u015Bcie"};return(Y)=>{switch(Y.code){case"invalid_type":return`Nieprawid\u0142owe dane wej\u015Bciowe: oczekiwano ${Y.expected}, otrzymano ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`Nieprawid\u0142owe dane wej\u015Bciowe: oczekiwano ${p(Y.values[0])}`;return`Nieprawid\u0142owa opcja: oczekiwano jednej z warto\u015Bci ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`Za du\u017Ca warto\u015B\u0107: oczekiwano, \u017Ce ${Y.origin??"warto\u015B\u0107"} b\u0119dzie mie\u0107 ${$}${Y.maximum.toString()} ${K.unit??"element\xF3w"}`;return`Zbyt du\u017C(y/a/e): oczekiwano, \u017Ce ${Y.origin??"warto\u015B\u0107"} b\u0119dzie wynosi\u0107 ${$}${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`Za ma\u0142a warto\u015B\u0107: oczekiwano, \u017Ce ${Y.origin??"warto\u015B\u0107"} b\u0119dzie mie\u0107 ${$}${Y.minimum.toString()} ${K.unit??"element\xF3w"}`;return`Zbyt ma\u0142(y/a/e): oczekiwano, \u017Ce ${Y.origin??"warto\u015B\u0107"} b\u0119dzie wynosi\u0107 ${$}${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`Nieprawid\u0142owy ci\u0105g znak\xF3w: musi zaczyna\u0107 si\u0119 od "${$.prefix}"`;if($.format==="ends_with")return`Nieprawid\u0142owy ci\u0105g znak\xF3w: musi ko\u0144czy\u0107 si\u0119 na "${$.suffix}"`;if($.format==="includes")return`Nieprawid\u0142owy ci\u0105g znak\xF3w: musi zawiera\u0107 "${$.includes}"`;if($.format==="regex")return`Nieprawid\u0142owy ci\u0105g znak\xF3w: musi odpowiada\u0107 wzorcowi ${$.pattern}`;return`Nieprawid\u0142ow(y/a/e) ${G[$.format]??Y.format}`}case"not_multiple_of":return`Nieprawid\u0142owa liczba: musi by\u0107 wielokrotno\u015Bci\u0105 ${Y.divisor}`;case"unrecognized_keys":return`Nierozpoznane klucze${Y.keys.length>1?"s":""}: ${h(Y.keys,", ")}`;case"invalid_key":return`Nieprawid\u0142owy klucz w ${Y.origin}`;case"invalid_union":return"Nieprawid\u0142owe dane wej\u015Bciowe";case"invalid_element":return`Nieprawid\u0142owa warto\u015B\u0107 w ${Y.origin}`;default:return"Nieprawid\u0142owe dane wej\u015Bciowe"}}};var Z2=D(()=>{Y6()});function $L(){return{localeError:Py()}}var Py=()=>{let J={string:{unit:"caracteres",verb:"ter"},file:{unit:"bytes",verb:"ter"},array:{unit:"itens",verb:"ter"},set:{unit:"itens",verb:"ter"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"n\xFAmero";case"object":{if(Array.isArray(Y))return"array";if(Y===null)return"nulo";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"padr\xE3o",email:"endere\xE7o de e-mail",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data e hora ISO",date:"data ISO",time:"hora ISO",duration:"dura\xE7\xE3o ISO",ipv4:"endere\xE7o IPv4",ipv6:"endere\xE7o IPv6",cidrv4:"faixa de IPv4",cidrv6:"faixa de IPv6",base64:"texto codificado em base64",base64url:"URL codificada em base64",json_string:"texto JSON",e164:"n\xFAmero E.164",jwt:"JWT",template_literal:"entrada"};return(Y)=>{switch(Y.code){case"invalid_type":return`Tipo inv\xE1lido: esperado ${Y.expected}, recebido ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`Entrada inv\xE1lida: esperado ${p(Y.values[0])}`;return`Op\xE7\xE3o inv\xE1lida: esperada uma das ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`Muito grande: esperado que ${Y.origin??"valor"} tivesse ${$}${Y.maximum.toString()} ${K.unit??"elementos"}`;return`Muito grande: esperado que ${Y.origin??"valor"} fosse ${$}${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`Muito pequeno: esperado que ${Y.origin} tivesse ${$}${Y.minimum.toString()} ${K.unit}`;return`Muito pequeno: esperado que ${Y.origin} fosse ${$}${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`Texto inv\xE1lido: deve come\xE7ar com "${$.prefix}"`;if($.format==="ends_with")return`Texto inv\xE1lido: deve terminar com "${$.suffix}"`;if($.format==="includes")return`Texto inv\xE1lido: deve incluir "${$.includes}"`;if($.format==="regex")return`Texto inv\xE1lido: deve corresponder ao padr\xE3o ${$.pattern}`;return`${G[$.format]??Y.format} inv\xE1lido`}case"not_multiple_of":return`N\xFAmero inv\xE1lido: deve ser m\xFAltiplo de ${Y.divisor}`;case"unrecognized_keys":return`Chave${Y.keys.length>1?"s":""} desconhecida${Y.keys.length>1?"s":""}: ${h(Y.keys,", ")}`;case"invalid_key":return`Chave inv\xE1lida em ${Y.origin}`;case"invalid_union":return"Entrada inv\xE1lida";case"invalid_element":return`Valor inv\xE1lido em ${Y.origin}`;default:return"Campo inv\xE1lido"}}};var z2=D(()=>{Y6()});function F2(J,W,X,G){let Y=Math.abs(J),$=Y%10,K=Y%100;if(K>=11&&K<=19)return G;if($===1)return W;if($>=2&&$<=4)return X;return G}function KL(){return{localeError:jy()}}var jy=()=>{let J={string:{unit:{one:"\u0441\u0438\u043C\u0432\u043E\u043B",few:"\u0441\u0438\u043C\u0432\u043E\u043B\u0430",many:"\u0441\u0438\u043C\u0432\u043E\u043B\u043E\u0432"},verb:"\u0438\u043C\u0435\u0442\u044C"},file:{unit:{one:"\u0431\u0430\u0439\u0442",few:"\u0431\u0430\u0439\u0442\u0430",many:"\u0431\u0430\u0439\u0442"},verb:"\u0438\u043C\u0435\u0442\u044C"},array:{unit:{one:"\u044D\u043B\u0435\u043C\u0435\u043D\u0442",few:"\u044D\u043B\u0435\u043C\u0435\u043D\u0442\u0430",many:"\u044D\u043B\u0435\u043C\u0435\u043D\u0442\u043E\u0432"},verb:"\u0438\u043C\u0435\u0442\u044C"},set:{unit:{one:"\u044D\u043B\u0435\u043C\u0435\u043D\u0442",few:"\u044D\u043B\u0435\u043C\u0435\u043D\u0442\u0430",many:"\u044D\u043B\u0435\u043C\u0435\u043D\u0442\u043E\u0432"},verb:"\u0438\u043C\u0435\u0442\u044C"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"\u0447\u0438\u0441\u043B\u043E";case"object":{if(Array.isArray(Y))return"\u043C\u0430\u0441\u0441\u0438\u0432";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"\u0432\u0432\u043E\u0434",email:"email \u0430\u0434\u0440\u0435\u0441",url:"URL",emoji:"\u044D\u043C\u043E\u0434\u0437\u0438",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO \u0434\u0430\u0442\u0430 \u0438 \u0432\u0440\u0435\u043C\u044F",date:"ISO \u0434\u0430\u0442\u0430",time:"ISO \u0432\u0440\u0435\u043C\u044F",duration:"ISO \u0434\u043B\u0438\u0442\u0435\u043B\u044C\u043D\u043E\u0441\u0442\u044C",ipv4:"IPv4 \u0430\u0434\u0440\u0435\u0441",ipv6:"IPv6 \u0430\u0434\u0440\u0435\u0441",cidrv4:"IPv4 \u0434\u0438\u0430\u043F\u0430\u0437\u043E\u043D",cidrv6:"IPv6 \u0434\u0438\u0430\u043F\u0430\u0437\u043E\u043D",base64:"\u0441\u0442\u0440\u043E\u043A\u0430 \u0432 \u0444\u043E\u0440\u043C\u0430\u0442\u0435 base64",base64url:"\u0441\u0442\u0440\u043E\u043A\u0430 \u0432 \u0444\u043E\u0440\u043C\u0430\u0442\u0435 base64url",json_string:"JSON \u0441\u0442\u0440\u043E\u043A\u0430",e164:"\u043D\u043E\u043C\u0435\u0440 E.164",jwt:"JWT",template_literal:"\u0432\u0432\u043E\u0434"};return(Y)=>{switch(Y.code){case"invalid_type":return`\u041D\u0435\u0432\u0435\u0440\u043D\u044B\u0439 \u0432\u0432\u043E\u0434: \u043E\u0436\u0438\u0434\u0430\u043B\u043E\u0441\u044C ${Y.expected}, \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u043E ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`\u041D\u0435\u0432\u0435\u0440\u043D\u044B\u0439 \u0432\u0432\u043E\u0434: \u043E\u0436\u0438\u0434\u0430\u043B\u043E\u0441\u044C ${p(Y.values[0])}`;return`\u041D\u0435\u0432\u0435\u0440\u043D\u044B\u0439 \u0432\u0430\u0440\u0438\u0430\u043D\u0442: \u043E\u0436\u0438\u0434\u0430\u043B\u043E\u0441\u044C \u043E\u0434\u043D\u043E \u0438\u0437 ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K){let w=Number(Y.maximum),H=F2(w,K.unit.one,K.unit.few,K.unit.many);return`\u0421\u043B\u0438\u0448\u043A\u043E\u043C \u0431\u043E\u043B\u044C\u0448\u043E\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435: \u043E\u0436\u0438\u0434\u0430\u043B\u043E\u0441\u044C, \u0447\u0442\u043E ${Y.origin??"\u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435"} \u0431\u0443\u0434\u0435\u0442 \u0438\u043C\u0435\u0442\u044C ${$}${Y.maximum.toString()} ${H}`}return`\u0421\u043B\u0438\u0448\u043A\u043E\u043C \u0431\u043E\u043B\u044C\u0448\u043E\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435: \u043E\u0436\u0438\u0434\u0430\u043B\u043E\u0441\u044C, \u0447\u0442\u043E ${Y.origin??"\u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435"} \u0431\u0443\u0434\u0435\u0442 ${$}${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K){let w=Number(Y.minimum),H=F2(w,K.unit.one,K.unit.few,K.unit.many);return`\u0421\u043B\u0438\u0448\u043A\u043E\u043C \u043C\u0430\u043B\u0435\u043D\u044C\u043A\u043E\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435: \u043E\u0436\u0438\u0434\u0430\u043B\u043E\u0441\u044C, \u0447\u0442\u043E ${Y.origin} \u0431\u0443\u0434\u0435\u0442 \u0438\u043C\u0435\u0442\u044C ${$}${Y.minimum.toString()} ${H}`}return`\u0421\u043B\u0438\u0448\u043A\u043E\u043C \u043C\u0430\u043B\u0435\u043D\u044C\u043A\u043E\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435: \u043E\u0436\u0438\u0434\u0430\u043B\u043E\u0441\u044C, \u0447\u0442\u043E ${Y.origin} \u0431\u0443\u0434\u0435\u0442 ${$}${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`\u041D\u0435\u0432\u0435\u0440\u043D\u0430\u044F \u0441\u0442\u0440\u043E\u043A\u0430: \u0434\u043E\u043B\u0436\u043D\u0430 \u043D\u0430\u0447\u0438\u043D\u0430\u0442\u044C\u0441\u044F \u0441 "${$.prefix}"`;if($.format==="ends_with")return`\u041D\u0435\u0432\u0435\u0440\u043D\u0430\u044F \u0441\u0442\u0440\u043E\u043A\u0430: \u0434\u043E\u043B\u0436\u043D\u0430 \u0437\u0430\u043A\u0430\u043D\u0447\u0438\u0432\u0430\u0442\u044C\u0441\u044F \u043D\u0430 "${$.suffix}"`;if($.format==="includes")return`\u041D\u0435\u0432\u0435\u0440\u043D\u0430\u044F \u0441\u0442\u0440\u043E\u043A\u0430: \u0434\u043E\u043B\u0436\u043D\u0430 \u0441\u043E\u0434\u0435\u0440\u0436\u0430\u0442\u044C "${$.includes}"`;if($.format==="regex")return`\u041D\u0435\u0432\u0435\u0440\u043D\u0430\u044F \u0441\u0442\u0440\u043E\u043A\u0430: \u0434\u043E\u043B\u0436\u043D\u0430 \u0441\u043E\u043E\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u043E\u0432\u0430\u0442\u044C \u0448\u0430\u0431\u043B\u043E\u043D\u0443 ${$.pattern}`;return`\u041D\u0435\u0432\u0435\u0440\u043D\u044B\u0439 ${G[$.format]??Y.format}`}case"not_multiple_of":return`\u041D\u0435\u0432\u0435\u0440\u043D\u043E\u0435 \u0447\u0438\u0441\u043B\u043E: \u0434\u043E\u043B\u0436\u043D\u043E \u0431\u044B\u0442\u044C \u043A\u0440\u0430\u0442\u043D\u044B\u043C ${Y.divisor}`;case"unrecognized_keys":return`\u041D\u0435\u0440\u0430\u0441\u043F\u043E\u0437\u043D\u0430\u043D\u043D${Y.keys.length>1?"\u044B\u0435":"\u044B\u0439"} \u043A\u043B\u044E\u0447${Y.keys.length>1?"\u0438":""}: ${h(Y.keys,", ")}`;case"invalid_key":return`\u041D\u0435\u0432\u0435\u0440\u043D\u044B\u0439 \u043A\u043B\u044E\u0447 \u0432 ${Y.origin}`;case"invalid_union":return"\u041D\u0435\u0432\u0435\u0440\u043D\u044B\u0435 \u0432\u0445\u043E\u0434\u043D\u044B\u0435 \u0434\u0430\u043D\u043D\u044B\u0435";case"invalid_element":return`\u041D\u0435\u0432\u0435\u0440\u043D\u043E\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435 \u0432 ${Y.origin}`;default:return"\u041D\u0435\u0432\u0435\u0440\u043D\u044B\u0435 \u0432\u0445\u043E\u0434\u043D\u044B\u0435 \u0434\u0430\u043D\u043D\u044B\u0435"}}};var N2=D(()=>{Y6()});function wL(){return{localeError:_y()}}var _y=()=>{let J={string:{unit:"znakov",verb:"imeti"},file:{unit:"bajtov",verb:"imeti"},array:{unit:"elementov",verb:"imeti"},set:{unit:"elementov",verb:"imeti"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"\u0161tevilo";case"object":{if(Array.isArray(Y))return"tabela";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"vnos",email:"e-po\u0161tni naslov",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datum in \u010Das",date:"ISO datum",time:"ISO \u010Das",duration:"ISO trajanje",ipv4:"IPv4 naslov",ipv6:"IPv6 naslov",cidrv4:"obseg IPv4",cidrv6:"obseg IPv6",base64:"base64 kodiran niz",base64url:"base64url kodiran niz",json_string:"JSON niz",e164:"E.164 \u0161tevilka",jwt:"JWT",template_literal:"vnos"};return(Y)=>{switch(Y.code){case"invalid_type":return`Neveljaven vnos: pri\u010Dakovano ${Y.expected}, prejeto ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`Neveljaven vnos: pri\u010Dakovano ${p(Y.values[0])}`;return`Neveljavna mo\u017Enost: pri\u010Dakovano eno izmed ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`Preveliko: pri\u010Dakovano, da bo ${Y.origin??"vrednost"} imelo ${$}${Y.maximum.toString()} ${K.unit??"elementov"}`;return`Preveliko: pri\u010Dakovano, da bo ${Y.origin??"vrednost"} ${$}${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`Premajhno: pri\u010Dakovano, da bo ${Y.origin} imelo ${$}${Y.minimum.toString()} ${K.unit}`;return`Premajhno: pri\u010Dakovano, da bo ${Y.origin} ${$}${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`Neveljaven niz: mora se za\u010Deti z "${$.prefix}"`;if($.format==="ends_with")return`Neveljaven niz: mora se kon\u010Dati z "${$.suffix}"`;if($.format==="includes")return`Neveljaven niz: mora vsebovati "${$.includes}"`;if($.format==="regex")return`Neveljaven niz: mora ustrezati vzorcu ${$.pattern}`;return`Neveljaven ${G[$.format]??Y.format}`}case"not_multiple_of":return`Neveljavno \u0161tevilo: mora biti ve\u010Dkratnik ${Y.divisor}`;case"unrecognized_keys":return`Neprepoznan${Y.keys.length>1?"i klju\u010Di":" klju\u010D"}: ${h(Y.keys,", ")}`;case"invalid_key":return`Neveljaven klju\u010D v ${Y.origin}`;case"invalid_union":return"Neveljaven vnos";case"invalid_element":return`Neveljavna vrednost v ${Y.origin}`;default:return"Neveljaven vnos"}}};var U2=D(()=>{Y6()});function HL(){return{localeError:Sy()}}var Sy=()=>{let J={string:{unit:"tecken",verb:"att ha"},file:{unit:"bytes",verb:"att ha"},array:{unit:"objekt",verb:"att inneh\xE5lla"},set:{unit:"objekt",verb:"att inneh\xE5lla"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"antal";case"object":{if(Array.isArray(Y))return"lista";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"regulj\xE4rt uttryck",email:"e-postadress",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-datum och tid",date:"ISO-datum",time:"ISO-tid",duration:"ISO-varaktighet",ipv4:"IPv4-intervall",ipv6:"IPv6-intervall",cidrv4:"IPv4-spektrum",cidrv6:"IPv6-spektrum",base64:"base64-kodad str\xE4ng",base64url:"base64url-kodad str\xE4ng",json_string:"JSON-str\xE4ng",e164:"E.164-nummer",jwt:"JWT",template_literal:"mall-literal"};return(Y)=>{switch(Y.code){case"invalid_type":return`Ogiltig inmatning: f\xF6rv\xE4ntat ${Y.expected}, fick ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`Ogiltig inmatning: f\xF6rv\xE4ntat ${p(Y.values[0])}`;return`Ogiltigt val: f\xF6rv\xE4ntade en av ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`F\xF6r stor(t): f\xF6rv\xE4ntade ${Y.origin??"v\xE4rdet"} att ha ${$}${Y.maximum.toString()} ${K.unit??"element"}`;return`F\xF6r stor(t): f\xF6rv\xE4ntat ${Y.origin??"v\xE4rdet"} att ha ${$}${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`F\xF6r lite(t): f\xF6rv\xE4ntade ${Y.origin??"v\xE4rdet"} att ha ${$}${Y.minimum.toString()} ${K.unit}`;return`F\xF6r lite(t): f\xF6rv\xE4ntade ${Y.origin??"v\xE4rdet"} att ha ${$}${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`Ogiltig str\xE4ng: m\xE5ste b\xF6rja med "${$.prefix}"`;if($.format==="ends_with")return`Ogiltig str\xE4ng: m\xE5ste sluta med "${$.suffix}"`;if($.format==="includes")return`Ogiltig str\xE4ng: m\xE5ste inneh\xE5lla "${$.includes}"`;if($.format==="regex")return`Ogiltig str\xE4ng: m\xE5ste matcha m\xF6nstret "${$.pattern}"`;return`Ogiltig(t) ${G[$.format]??Y.format}`}case"not_multiple_of":return`Ogiltigt tal: m\xE5ste vara en multipel av ${Y.divisor}`;case"unrecognized_keys":return`${Y.keys.length>1?"Ok\xE4nda nycklar":"Ok\xE4nd nyckel"}: ${h(Y.keys,", ")}`;case"invalid_key":return`Ogiltig nyckel i ${Y.origin??"v\xE4rdet"}`;case"invalid_union":return"Ogiltig input";case"invalid_element":return`Ogiltigt v\xE4rde i ${Y.origin??"v\xE4rdet"}`;default:return"Ogiltig input"}}};var Q2=D(()=>{Y6()});function ZL(){return{localeError:Ty()}}var Ty=()=>{let J={string:{unit:"\u0B8E\u0BB4\u0BC1\u0BA4\u0BCD\u0BA4\u0BC1\u0B95\u0BCD\u0B95\u0BB3\u0BCD",verb:"\u0B95\u0BCA\u0BA3\u0BCD\u0B9F\u0BBF\u0BB0\u0BC1\u0B95\u0BCD\u0B95 \u0BB5\u0BC7\u0BA3\u0BCD\u0B9F\u0BC1\u0BAE\u0BCD"},file:{unit:"\u0BAA\u0BC8\u0B9F\u0BCD\u0B9F\u0BC1\u0B95\u0BB3\u0BCD",verb:"\u0B95\u0BCA\u0BA3\u0BCD\u0B9F\u0BBF\u0BB0\u0BC1\u0B95\u0BCD\u0B95 \u0BB5\u0BC7\u0BA3\u0BCD\u0B9F\u0BC1\u0BAE\u0BCD"},array:{unit:"\u0B89\u0BB1\u0BC1\u0BAA\u0BCD\u0BAA\u0BC1\u0B95\u0BB3\u0BCD",verb:"\u0B95\u0BCA\u0BA3\u0BCD\u0B9F\u0BBF\u0BB0\u0BC1\u0B95\u0BCD\u0B95 \u0BB5\u0BC7\u0BA3\u0BCD\u0B9F\u0BC1\u0BAE\u0BCD"},set:{unit:"\u0B89\u0BB1\u0BC1\u0BAA\u0BCD\u0BAA\u0BC1\u0B95\u0BB3\u0BCD",verb:"\u0B95\u0BCA\u0BA3\u0BCD\u0B9F\u0BBF\u0BB0\u0BC1\u0B95\u0BCD\u0B95 \u0BB5\u0BC7\u0BA3\u0BCD\u0B9F\u0BC1\u0BAE\u0BCD"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"\u0B8E\u0BA3\u0BCD \u0B85\u0BB2\u0BCD\u0BB2\u0BBE\u0BA4\u0BA4\u0BC1":"\u0B8E\u0BA3\u0BCD";case"object":{if(Array.isArray(Y))return"\u0B85\u0BA3\u0BBF";if(Y===null)return"\u0BB5\u0BC6\u0BB1\u0BC1\u0BAE\u0BC8";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"\u0B89\u0BB3\u0BCD\u0BB3\u0BC0\u0B9F\u0BC1",email:"\u0BAE\u0BBF\u0BA9\u0BCD\u0BA9\u0B9E\u0BCD\u0B9A\u0BB2\u0BCD \u0BAE\u0BC1\u0B95\u0BB5\u0BB0\u0BBF",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO \u0BA4\u0BC7\u0BA4\u0BBF \u0BA8\u0BC7\u0BB0\u0BAE\u0BCD",date:"ISO \u0BA4\u0BC7\u0BA4\u0BBF",time:"ISO \u0BA8\u0BC7\u0BB0\u0BAE\u0BCD",duration:"ISO \u0B95\u0BBE\u0BB2 \u0B85\u0BB3\u0BB5\u0BC1",ipv4:"IPv4 \u0BAE\u0BC1\u0B95\u0BB5\u0BB0\u0BBF",ipv6:"IPv6 \u0BAE\u0BC1\u0B95\u0BB5\u0BB0\u0BBF",cidrv4:"IPv4 \u0BB5\u0BB0\u0BAE\u0BCD\u0BAA\u0BC1",cidrv6:"IPv6 \u0BB5\u0BB0\u0BAE\u0BCD\u0BAA\u0BC1",base64:"base64-encoded \u0B9A\u0BB0\u0BAE\u0BCD",base64url:"base64url-encoded \u0B9A\u0BB0\u0BAE\u0BCD",json_string:"JSON \u0B9A\u0BB0\u0BAE\u0BCD",e164:"E.164 \u0B8E\u0BA3\u0BCD",jwt:"JWT",template_literal:"input"};return(Y)=>{switch(Y.code){case"invalid_type":return`\u0BA4\u0BB5\u0BB1\u0BBE\u0BA9 \u0B89\u0BB3\u0BCD\u0BB3\u0BC0\u0B9F\u0BC1: \u0B8E\u0BA4\u0BBF\u0BB0\u0BCD\u0BAA\u0BBE\u0BB0\u0BCD\u0B95\u0BCD\u0B95\u0BAA\u0BCD\u0BAA\u0B9F\u0BCD\u0B9F\u0BA4\u0BC1 ${Y.expected}, \u0BAA\u0BC6\u0BB1\u0BAA\u0BCD\u0BAA\u0B9F\u0BCD\u0B9F\u0BA4\u0BC1 ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`\u0BA4\u0BB5\u0BB1\u0BBE\u0BA9 \u0B89\u0BB3\u0BCD\u0BB3\u0BC0\u0B9F\u0BC1: \u0B8E\u0BA4\u0BBF\u0BB0\u0BCD\u0BAA\u0BBE\u0BB0\u0BCD\u0B95\u0BCD\u0B95\u0BAA\u0BCD\u0BAA\u0B9F\u0BCD\u0B9F\u0BA4\u0BC1 ${p(Y.values[0])}`;return`\u0BA4\u0BB5\u0BB1\u0BBE\u0BA9 \u0BB5\u0BBF\u0BB0\u0BC1\u0BAA\u0BCD\u0BAA\u0BAE\u0BCD: \u0B8E\u0BA4\u0BBF\u0BB0\u0BCD\u0BAA\u0BBE\u0BB0\u0BCD\u0B95\u0BCD\u0B95\u0BAA\u0BCD\u0BAA\u0B9F\u0BCD\u0B9F\u0BA4\u0BC1 ${h(Y.values,"|")} \u0B87\u0BB2\u0BCD \u0B92\u0BA9\u0BCD\u0BB1\u0BC1`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`\u0BAE\u0BBF\u0B95 \u0BAA\u0BC6\u0BB0\u0BBF\u0BAF\u0BA4\u0BC1: \u0B8E\u0BA4\u0BBF\u0BB0\u0BCD\u0BAA\u0BBE\u0BB0\u0BCD\u0B95\u0BCD\u0B95\u0BAA\u0BCD\u0BAA\u0B9F\u0BCD\u0B9F\u0BA4\u0BC1 ${Y.origin??"\u0BAE\u0BA4\u0BBF\u0BAA\u0BCD\u0BAA\u0BC1"} ${$}${Y.maximum.toString()} ${K.unit??"\u0B89\u0BB1\u0BC1\u0BAA\u0BCD\u0BAA\u0BC1\u0B95\u0BB3\u0BCD"} \u0B86\u0B95 \u0B87\u0BB0\u0BC1\u0B95\u0BCD\u0B95 \u0BB5\u0BC7\u0BA3\u0BCD\u0B9F\u0BC1\u0BAE\u0BCD`;return`\u0BAE\u0BBF\u0B95 \u0BAA\u0BC6\u0BB0\u0BBF\u0BAF\u0BA4\u0BC1: \u0B8E\u0BA4\u0BBF\u0BB0\u0BCD\u0BAA\u0BBE\u0BB0\u0BCD\u0B95\u0BCD\u0B95\u0BAA\u0BCD\u0BAA\u0B9F\u0BCD\u0B9F\u0BA4\u0BC1 ${Y.origin??"\u0BAE\u0BA4\u0BBF\u0BAA\u0BCD\u0BAA\u0BC1"} ${$}${Y.maximum.toString()} \u0B86\u0B95 \u0B87\u0BB0\u0BC1\u0B95\u0BCD\u0B95 \u0BB5\u0BC7\u0BA3\u0BCD\u0B9F\u0BC1\u0BAE\u0BCD`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`\u0BAE\u0BBF\u0B95\u0B9A\u0BCD \u0B9A\u0BBF\u0BB1\u0BBF\u0BAF\u0BA4\u0BC1: \u0B8E\u0BA4\u0BBF\u0BB0\u0BCD\u0BAA\u0BBE\u0BB0\u0BCD\u0B95\u0BCD\u0B95\u0BAA\u0BCD\u0BAA\u0B9F\u0BCD\u0B9F\u0BA4\u0BC1 ${Y.origin} ${$}${Y.minimum.toString()} ${K.unit} \u0B86\u0B95 \u0B87\u0BB0\u0BC1\u0B95\u0BCD\u0B95 \u0BB5\u0BC7\u0BA3\u0BCD\u0B9F\u0BC1\u0BAE\u0BCD`;return`\u0BAE\u0BBF\u0B95\u0B9A\u0BCD \u0B9A\u0BBF\u0BB1\u0BBF\u0BAF\u0BA4\u0BC1: \u0B8E\u0BA4\u0BBF\u0BB0\u0BCD\u0BAA\u0BBE\u0BB0\u0BCD\u0B95\u0BCD\u0B95\u0BAA\u0BCD\u0BAA\u0B9F\u0BCD\u0B9F\u0BA4\u0BC1 ${Y.origin} ${$}${Y.minimum.toString()} \u0B86\u0B95 \u0B87\u0BB0\u0BC1\u0B95\u0BCD\u0B95 \u0BB5\u0BC7\u0BA3\u0BCD\u0B9F\u0BC1\u0BAE\u0BCD`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`\u0BA4\u0BB5\u0BB1\u0BBE\u0BA9 \u0B9A\u0BB0\u0BAE\u0BCD: "${$.prefix}" \u0B87\u0BB2\u0BCD \u0BA4\u0BCA\u0B9F\u0B99\u0BCD\u0B95 \u0BB5\u0BC7\u0BA3\u0BCD\u0B9F\u0BC1\u0BAE\u0BCD`;if($.format==="ends_with")return`\u0BA4\u0BB5\u0BB1\u0BBE\u0BA9 \u0B9A\u0BB0\u0BAE\u0BCD: "${$.suffix}" \u0B87\u0BB2\u0BCD \u0BAE\u0BC1\u0B9F\u0BBF\u0BB5\u0B9F\u0BC8\u0BAF \u0BB5\u0BC7\u0BA3\u0BCD\u0B9F\u0BC1\u0BAE\u0BCD`;if($.format==="includes")return`\u0BA4\u0BB5\u0BB1\u0BBE\u0BA9 \u0B9A\u0BB0\u0BAE\u0BCD: "${$.includes}" \u0B90 \u0B89\u0BB3\u0BCD\u0BB3\u0B9F\u0B95\u0BCD\u0B95 \u0BB5\u0BC7\u0BA3\u0BCD\u0B9F\u0BC1\u0BAE\u0BCD`;if($.format==="regex")return`\u0BA4\u0BB5\u0BB1\u0BBE\u0BA9 \u0B9A\u0BB0\u0BAE\u0BCD: ${$.pattern} \u0BAE\u0BC1\u0BB1\u0BC8\u0BAA\u0BBE\u0B9F\u0BCD\u0B9F\u0BC1\u0B9F\u0BA9\u0BCD \u0BAA\u0BCA\u0BB0\u0BC1\u0BA8\u0BCD\u0BA4 \u0BB5\u0BC7\u0BA3\u0BCD\u0B9F\u0BC1\u0BAE\u0BCD`;return`\u0BA4\u0BB5\u0BB1\u0BBE\u0BA9 ${G[$.format]??Y.format}`}case"not_multiple_of":return`\u0BA4\u0BB5\u0BB1\u0BBE\u0BA9 \u0B8E\u0BA3\u0BCD: ${Y.divisor} \u0B87\u0BA9\u0BCD \u0BAA\u0BB2\u0BAE\u0BBE\u0B95 \u0B87\u0BB0\u0BC1\u0B95\u0BCD\u0B95 \u0BB5\u0BC7\u0BA3\u0BCD\u0B9F\u0BC1\u0BAE\u0BCD`;case"unrecognized_keys":return`\u0B85\u0B9F\u0BC8\u0BAF\u0BBE\u0BB3\u0BAE\u0BCD \u0BA4\u0BC6\u0BB0\u0BBF\u0BAF\u0BBE\u0BA4 \u0BB5\u0BBF\u0B9A\u0BC8${Y.keys.length>1?"\u0B95\u0BB3\u0BCD":""}: ${h(Y.keys,", ")}`;case"invalid_key":return`${Y.origin} \u0B87\u0BB2\u0BCD \u0BA4\u0BB5\u0BB1\u0BBE\u0BA9 \u0BB5\u0BBF\u0B9A\u0BC8`;case"invalid_union":return"\u0BA4\u0BB5\u0BB1\u0BBE\u0BA9 \u0B89\u0BB3\u0BCD\u0BB3\u0BC0\u0B9F\u0BC1";case"invalid_element":return`${Y.origin} \u0B87\u0BB2\u0BCD \u0BA4\u0BB5\u0BB1\u0BBE\u0BA9 \u0BAE\u0BA4\u0BBF\u0BAA\u0BCD\u0BAA\u0BC1`;default:return"\u0BA4\u0BB5\u0BB1\u0BBE\u0BA9 \u0B89\u0BB3\u0BCD\u0BB3\u0BC0\u0B9F\u0BC1"}}};var L2=D(()=>{Y6()});function zL(){return{localeError:qy()}}var qy=()=>{let J={string:{unit:"\u0E15\u0E31\u0E27\u0E2D\u0E31\u0E01\u0E29\u0E23",verb:"\u0E04\u0E27\u0E23\u0E21\u0E35"},file:{unit:"\u0E44\u0E1A\u0E15\u0E4C",verb:"\u0E04\u0E27\u0E23\u0E21\u0E35"},array:{unit:"\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23",verb:"\u0E04\u0E27\u0E23\u0E21\u0E35"},set:{unit:"\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23",verb:"\u0E04\u0E27\u0E23\u0E21\u0E35"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"\u0E44\u0E21\u0E48\u0E43\u0E0A\u0E48\u0E15\u0E31\u0E27\u0E40\u0E25\u0E02 (NaN)":"\u0E15\u0E31\u0E27\u0E40\u0E25\u0E02";case"object":{if(Array.isArray(Y))return"\u0E2D\u0E32\u0E23\u0E4C\u0E40\u0E23\u0E22\u0E4C (Array)";if(Y===null)return"\u0E44\u0E21\u0E48\u0E21\u0E35\u0E04\u0E48\u0E32 (null)";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E17\u0E35\u0E48\u0E1B\u0E49\u0E2D\u0E19",email:"\u0E17\u0E35\u0E48\u0E2D\u0E22\u0E39\u0E48\u0E2D\u0E35\u0E40\u0E21\u0E25",url:"URL",emoji:"\u0E2D\u0E34\u0E42\u0E21\u0E08\u0E34",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E40\u0E27\u0E25\u0E32\u0E41\u0E1A\u0E1A ISO",date:"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E41\u0E1A\u0E1A ISO",time:"\u0E40\u0E27\u0E25\u0E32\u0E41\u0E1A\u0E1A ISO",duration:"\u0E0A\u0E48\u0E27\u0E07\u0E40\u0E27\u0E25\u0E32\u0E41\u0E1A\u0E1A ISO",ipv4:"\u0E17\u0E35\u0E48\u0E2D\u0E22\u0E39\u0E48 IPv4",ipv6:"\u0E17\u0E35\u0E48\u0E2D\u0E22\u0E39\u0E48 IPv6",cidrv4:"\u0E0A\u0E48\u0E27\u0E07 IP \u0E41\u0E1A\u0E1A IPv4",cidrv6:"\u0E0A\u0E48\u0E27\u0E07 IP \u0E41\u0E1A\u0E1A IPv6",base64:"\u0E02\u0E49\u0E2D\u0E04\u0E27\u0E32\u0E21\u0E41\u0E1A\u0E1A Base64",base64url:"\u0E02\u0E49\u0E2D\u0E04\u0E27\u0E32\u0E21\u0E41\u0E1A\u0E1A Base64 \u0E2A\u0E33\u0E2B\u0E23\u0E31\u0E1A URL",json_string:"\u0E02\u0E49\u0E2D\u0E04\u0E27\u0E32\u0E21\u0E41\u0E1A\u0E1A JSON",e164:"\u0E40\u0E1A\u0E2D\u0E23\u0E4C\u0E42\u0E17\u0E23\u0E28\u0E31\u0E1E\u0E17\u0E4C\u0E23\u0E30\u0E2B\u0E27\u0E48\u0E32\u0E07\u0E1B\u0E23\u0E30\u0E40\u0E17\u0E28 (E.164)",jwt:"\u0E42\u0E17\u0E40\u0E04\u0E19 JWT",template_literal:"\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E17\u0E35\u0E48\u0E1B\u0E49\u0E2D\u0E19"};return(Y)=>{switch(Y.code){case"invalid_type":return`\u0E1B\u0E23\u0E30\u0E40\u0E20\u0E17\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E44\u0E21\u0E48\u0E16\u0E39\u0E01\u0E15\u0E49\u0E2D\u0E07: \u0E04\u0E27\u0E23\u0E40\u0E1B\u0E47\u0E19 ${Y.expected} \u0E41\u0E15\u0E48\u0E44\u0E14\u0E49\u0E23\u0E31\u0E1A ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`\u0E04\u0E48\u0E32\u0E44\u0E21\u0E48\u0E16\u0E39\u0E01\u0E15\u0E49\u0E2D\u0E07: \u0E04\u0E27\u0E23\u0E40\u0E1B\u0E47\u0E19 ${p(Y.values[0])}`;return`\u0E15\u0E31\u0E27\u0E40\u0E25\u0E37\u0E2D\u0E01\u0E44\u0E21\u0E48\u0E16\u0E39\u0E01\u0E15\u0E49\u0E2D\u0E07: \u0E04\u0E27\u0E23\u0E40\u0E1B\u0E47\u0E19\u0E2B\u0E19\u0E36\u0E48\u0E07\u0E43\u0E19 ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"\u0E44\u0E21\u0E48\u0E40\u0E01\u0E34\u0E19":"\u0E19\u0E49\u0E2D\u0E22\u0E01\u0E27\u0E48\u0E32",K=W(Y.origin);if(K)return`\u0E40\u0E01\u0E34\u0E19\u0E01\u0E33\u0E2B\u0E19\u0E14: ${Y.origin??"\u0E04\u0E48\u0E32"} \u0E04\u0E27\u0E23\u0E21\u0E35${$} ${Y.maximum.toString()} ${K.unit??"\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23"}`;return`\u0E40\u0E01\u0E34\u0E19\u0E01\u0E33\u0E2B\u0E19\u0E14: ${Y.origin??"\u0E04\u0E48\u0E32"} \u0E04\u0E27\u0E23\u0E21\u0E35${$} ${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?"\u0E2D\u0E22\u0E48\u0E32\u0E07\u0E19\u0E49\u0E2D\u0E22":"\u0E21\u0E32\u0E01\u0E01\u0E27\u0E48\u0E32",K=W(Y.origin);if(K)return`\u0E19\u0E49\u0E2D\u0E22\u0E01\u0E27\u0E48\u0E32\u0E01\u0E33\u0E2B\u0E19\u0E14: ${Y.origin} \u0E04\u0E27\u0E23\u0E21\u0E35${$} ${Y.minimum.toString()} ${K.unit}`;return`\u0E19\u0E49\u0E2D\u0E22\u0E01\u0E27\u0E48\u0E32\u0E01\u0E33\u0E2B\u0E19\u0E14: ${Y.origin} \u0E04\u0E27\u0E23\u0E21\u0E35${$} ${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`\u0E23\u0E39\u0E1B\u0E41\u0E1A\u0E1A\u0E44\u0E21\u0E48\u0E16\u0E39\u0E01\u0E15\u0E49\u0E2D\u0E07: \u0E02\u0E49\u0E2D\u0E04\u0E27\u0E32\u0E21\u0E15\u0E49\u0E2D\u0E07\u0E02\u0E36\u0E49\u0E19\u0E15\u0E49\u0E19\u0E14\u0E49\u0E27\u0E22 "${$.prefix}"`;if($.format==="ends_with")return`\u0E23\u0E39\u0E1B\u0E41\u0E1A\u0E1A\u0E44\u0E21\u0E48\u0E16\u0E39\u0E01\u0E15\u0E49\u0E2D\u0E07: \u0E02\u0E49\u0E2D\u0E04\u0E27\u0E32\u0E21\u0E15\u0E49\u0E2D\u0E07\u0E25\u0E07\u0E17\u0E49\u0E32\u0E22\u0E14\u0E49\u0E27\u0E22 "${$.suffix}"`;if($.format==="includes")return`\u0E23\u0E39\u0E1B\u0E41\u0E1A\u0E1A\u0E44\u0E21\u0E48\u0E16\u0E39\u0E01\u0E15\u0E49\u0E2D\u0E07: \u0E02\u0E49\u0E2D\u0E04\u0E27\u0E32\u0E21\u0E15\u0E49\u0E2D\u0E07\u0E21\u0E35 "${$.includes}" \u0E2D\u0E22\u0E39\u0E48\u0E43\u0E19\u0E02\u0E49\u0E2D\u0E04\u0E27\u0E32\u0E21`;if($.format==="regex")return`\u0E23\u0E39\u0E1B\u0E41\u0E1A\u0E1A\u0E44\u0E21\u0E48\u0E16\u0E39\u0E01\u0E15\u0E49\u0E2D\u0E07: \u0E15\u0E49\u0E2D\u0E07\u0E15\u0E23\u0E07\u0E01\u0E31\u0E1A\u0E23\u0E39\u0E1B\u0E41\u0E1A\u0E1A\u0E17\u0E35\u0E48\u0E01\u0E33\u0E2B\u0E19\u0E14 ${$.pattern}`;return`\u0E23\u0E39\u0E1B\u0E41\u0E1A\u0E1A\u0E44\u0E21\u0E48\u0E16\u0E39\u0E01\u0E15\u0E49\u0E2D\u0E07: ${G[$.format]??Y.format}`}case"not_multiple_of":return`\u0E15\u0E31\u0E27\u0E40\u0E25\u0E02\u0E44\u0E21\u0E48\u0E16\u0E39\u0E01\u0E15\u0E49\u0E2D\u0E07: \u0E15\u0E49\u0E2D\u0E07\u0E40\u0E1B\u0E47\u0E19\u0E08\u0E33\u0E19\u0E27\u0E19\u0E17\u0E35\u0E48\u0E2B\u0E32\u0E23\u0E14\u0E49\u0E27\u0E22 ${Y.divisor} \u0E44\u0E14\u0E49\u0E25\u0E07\u0E15\u0E31\u0E27`;case"unrecognized_keys":return`\u0E1E\u0E1A\u0E04\u0E35\u0E22\u0E4C\u0E17\u0E35\u0E48\u0E44\u0E21\u0E48\u0E23\u0E39\u0E49\u0E08\u0E31\u0E01: ${h(Y.keys,", ")}`;case"invalid_key":return`\u0E04\u0E35\u0E22\u0E4C\u0E44\u0E21\u0E48\u0E16\u0E39\u0E01\u0E15\u0E49\u0E2D\u0E07\u0E43\u0E19 ${Y.origin}`;case"invalid_union":return"\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E44\u0E21\u0E48\u0E16\u0E39\u0E01\u0E15\u0E49\u0E2D\u0E07: \u0E44\u0E21\u0E48\u0E15\u0E23\u0E07\u0E01\u0E31\u0E1A\u0E23\u0E39\u0E1B\u0E41\u0E1A\u0E1A\u0E22\u0E39\u0E40\u0E19\u0E35\u0E22\u0E19\u0E17\u0E35\u0E48\u0E01\u0E33\u0E2B\u0E19\u0E14\u0E44\u0E27\u0E49";case"invalid_element":return`\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E44\u0E21\u0E48\u0E16\u0E39\u0E01\u0E15\u0E49\u0E2D\u0E07\u0E43\u0E19 ${Y.origin}`;default:return"\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E44\u0E21\u0E48\u0E16\u0E39\u0E01\u0E15\u0E49\u0E2D\u0E07"}}};var V2=D(()=>{Y6()});function FL(){return{localeError:Ay()}}var By=(J)=>{let W=typeof J;switch(W){case"number":return Number.isNaN(J)?"NaN":"number";case"object":{if(Array.isArray(J))return"array";if(J===null)return"null";if(Object.getPrototypeOf(J)!==Object.prototype&&J.constructor)return J.constructor.name}}return W},Ay=()=>{let J={string:{unit:"karakter",verb:"olmal\u0131"},file:{unit:"bayt",verb:"olmal\u0131"},array:{unit:"\xF6\u011Fe",verb:"olmal\u0131"},set:{unit:"\xF6\u011Fe",verb:"olmal\u0131"}};function W(G){return J[G]??null}let X={regex:"girdi",email:"e-posta adresi",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO tarih ve saat",date:"ISO tarih",time:"ISO saat",duration:"ISO s\xFCre",ipv4:"IPv4 adresi",ipv6:"IPv6 adresi",cidrv4:"IPv4 aral\u0131\u011F\u0131",cidrv6:"IPv6 aral\u0131\u011F\u0131",base64:"base64 ile \u015Fifrelenmi\u015F metin",base64url:"base64url ile \u015Fifrelenmi\u015F metin",json_string:"JSON dizesi",e164:"E.164 say\u0131s\u0131",jwt:"JWT",template_literal:"\u015Eablon dizesi"};return(G)=>{switch(G.code){case"invalid_type":return`Ge\xE7ersiz de\u011Fer: beklenen ${G.expected}, al\u0131nan ${By(G.input)}`;case"invalid_value":if(G.values.length===1)return`Ge\xE7ersiz de\u011Fer: beklenen ${p(G.values[0])}`;return`Ge\xE7ersiz se\xE7enek: a\u015Fa\u011F\u0131dakilerden biri olmal\u0131: ${h(G.values,"|")}`;case"too_big":{let Y=G.inclusive?"<=":"<",$=W(G.origin);if($)return`\xC7ok b\xFCy\xFCk: beklenen ${G.origin??"de\u011Fer"} ${Y}${G.maximum.toString()} ${$.unit??"\xF6\u011Fe"}`;return`\xC7ok b\xFCy\xFCk: beklenen ${G.origin??"de\u011Fer"} ${Y}${G.maximum.toString()}`}case"too_small":{let Y=G.inclusive?">=":">",$=W(G.origin);if($)return`\xC7ok k\xFC\xE7\xFCk: beklenen ${G.origin} ${Y}${G.minimum.toString()} ${$.unit}`;return`\xC7ok k\xFC\xE7\xFCk: beklenen ${G.origin} ${Y}${G.minimum.toString()}`}case"invalid_format":{let Y=G;if(Y.format==="starts_with")return`Ge\xE7ersiz metin: "${Y.prefix}" ile ba\u015Flamal\u0131`;if(Y.format==="ends_with")return`Ge\xE7ersiz metin: "${Y.suffix}" ile bitmeli`;if(Y.format==="includes")return`Ge\xE7ersiz metin: "${Y.includes}" i\xE7ermeli`;if(Y.format==="regex")return`Ge\xE7ersiz metin: ${Y.pattern} desenine uymal\u0131`;return`Ge\xE7ersiz ${X[Y.format]??G.format}`}case"not_multiple_of":return`Ge\xE7ersiz say\u0131: ${G.divisor} ile tam b\xF6l\xFCnebilmeli`;case"unrecognized_keys":return`Tan\u0131nmayan anahtar${G.keys.length>1?"lar":""}: ${h(G.keys,", ")}`;case"invalid_key":return`${G.origin} i\xE7inde ge\xE7ersiz anahtar`;case"invalid_union":return"Ge\xE7ersiz de\u011Fer";case"invalid_element":return`${G.origin} i\xE7inde ge\xE7ersiz de\u011Fer`;default:return"Ge\xE7ersiz de\u011Fer"}}};var D2=D(()=>{Y6()});function r9(){return{localeError:Ey()}}var Ey=()=>{let J={string:{unit:"\u0441\u0438\u043C\u0432\u043E\u043B\u0456\u0432",verb:"\u043C\u0430\u0442\u0438\u043C\u0435"},file:{unit:"\u0431\u0430\u0439\u0442\u0456\u0432",verb:"\u043C\u0430\u0442\u0438\u043C\u0435"},array:{unit:"\u0435\u043B\u0435\u043C\u0435\u043D\u0442\u0456\u0432",verb:"\u043C\u0430\u0442\u0438\u043C\u0435"},set:{unit:"\u0435\u043B\u0435\u043C\u0435\u043D\u0442\u0456\u0432",verb:"\u043C\u0430\u0442\u0438\u043C\u0435"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"\u0447\u0438\u0441\u043B\u043E";case"object":{if(Array.isArray(Y))return"\u043C\u0430\u0441\u0438\u0432";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"\u0432\u0445\u0456\u0434\u043D\u0456 \u0434\u0430\u043D\u0456",email:"\u0430\u0434\u0440\u0435\u0441\u0430 \u0435\u043B\u0435\u043A\u0442\u0440\u043E\u043D\u043D\u043E\u0457 \u043F\u043E\u0448\u0442\u0438",url:"URL",emoji:"\u0435\u043C\u043E\u0434\u0437\u0456",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"\u0434\u0430\u0442\u0430 \u0442\u0430 \u0447\u0430\u0441 ISO",date:"\u0434\u0430\u0442\u0430 ISO",time:"\u0447\u0430\u0441 ISO",duration:"\u0442\u0440\u0438\u0432\u0430\u043B\u0456\u0441\u0442\u044C ISO",ipv4:"\u0430\u0434\u0440\u0435\u0441\u0430 IPv4",ipv6:"\u0430\u0434\u0440\u0435\u0441\u0430 IPv6",cidrv4:"\u0434\u0456\u0430\u043F\u0430\u0437\u043E\u043D IPv4",cidrv6:"\u0434\u0456\u0430\u043F\u0430\u0437\u043E\u043D IPv6",base64:"\u0440\u044F\u0434\u043E\u043A \u0443 \u043A\u043E\u0434\u0443\u0432\u0430\u043D\u043D\u0456 base64",base64url:"\u0440\u044F\u0434\u043E\u043A \u0443 \u043A\u043E\u0434\u0443\u0432\u0430\u043D\u043D\u0456 base64url",json_string:"\u0440\u044F\u0434\u043E\u043A JSON",e164:"\u043D\u043E\u043C\u0435\u0440 E.164",jwt:"JWT",template_literal:"\u0432\u0445\u0456\u0434\u043D\u0456 \u0434\u0430\u043D\u0456"};return(Y)=>{switch(Y.code){case"invalid_type":return`\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u0456 \u0432\u0445\u0456\u0434\u043D\u0456 \u0434\u0430\u043D\u0456: \u043E\u0447\u0456\u043A\u0443\u0454\u0442\u044C\u0441\u044F ${Y.expected}, \u043E\u0442\u0440\u0438\u043C\u0430\u043D\u043E ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u0456 \u0432\u0445\u0456\u0434\u043D\u0456 \u0434\u0430\u043D\u0456: \u043E\u0447\u0456\u043A\u0443\u0454\u0442\u044C\u0441\u044F ${p(Y.values[0])}`;return`\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u0430 \u043E\u043F\u0446\u0456\u044F: \u043E\u0447\u0456\u043A\u0443\u0454\u0442\u044C\u0441\u044F \u043E\u0434\u043D\u0435 \u0437 ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`\u0417\u0430\u043D\u0430\u0434\u0442\u043E \u0432\u0435\u043B\u0438\u043A\u0435: \u043E\u0447\u0456\u043A\u0443\u0454\u0442\u044C\u0441\u044F, \u0449\u043E ${Y.origin??"\u0437\u043D\u0430\u0447\u0435\u043D\u043D\u044F"} ${K.verb} ${$}${Y.maximum.toString()} ${K.unit??"\u0435\u043B\u0435\u043C\u0435\u043D\u0442\u0456\u0432"}`;return`\u0417\u0430\u043D\u0430\u0434\u0442\u043E \u0432\u0435\u043B\u0438\u043A\u0435: \u043E\u0447\u0456\u043A\u0443\u0454\u0442\u044C\u0441\u044F, \u0449\u043E ${Y.origin??"\u0437\u043D\u0430\u0447\u0435\u043D\u043D\u044F"} \u0431\u0443\u0434\u0435 ${$}${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`\u0417\u0430\u043D\u0430\u0434\u0442\u043E \u043C\u0430\u043B\u0435: \u043E\u0447\u0456\u043A\u0443\u0454\u0442\u044C\u0441\u044F, \u0449\u043E ${Y.origin} ${K.verb} ${$}${Y.minimum.toString()} ${K.unit}`;return`\u0417\u0430\u043D\u0430\u0434\u0442\u043E \u043C\u0430\u043B\u0435: \u043E\u0447\u0456\u043A\u0443\u0454\u0442\u044C\u0441\u044F, \u0449\u043E ${Y.origin} \u0431\u0443\u0434\u0435 ${$}${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u0438\u0439 \u0440\u044F\u0434\u043E\u043A: \u043F\u043E\u0432\u0438\u043D\u0435\u043D \u043F\u043E\u0447\u0438\u043D\u0430\u0442\u0438\u0441\u044F \u0437 "${$.prefix}"`;if($.format==="ends_with")return`\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u0438\u0439 \u0440\u044F\u0434\u043E\u043A: \u043F\u043E\u0432\u0438\u043D\u0435\u043D \u0437\u0430\u043A\u0456\u043D\u0447\u0443\u0432\u0430\u0442\u0438\u0441\u044F \u043D\u0430 "${$.suffix}"`;if($.format==="includes")return`\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u0438\u0439 \u0440\u044F\u0434\u043E\u043A: \u043F\u043E\u0432\u0438\u043D\u0435\u043D \u043C\u0456\u0441\u0442\u0438\u0442\u0438 "${$.includes}"`;if($.format==="regex")return`\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u0438\u0439 \u0440\u044F\u0434\u043E\u043A: \u043F\u043E\u0432\u0438\u043D\u0435\u043D \u0432\u0456\u0434\u043F\u043E\u0432\u0456\u0434\u0430\u0442\u0438 \u0448\u0430\u0431\u043B\u043E\u043D\u0443 ${$.pattern}`;return`\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u0438\u0439 ${G[$.format]??Y.format}`}case"not_multiple_of":return`\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u0435 \u0447\u0438\u0441\u043B\u043E: \u043F\u043E\u0432\u0438\u043D\u043D\u043E \u0431\u0443\u0442\u0438 \u043A\u0440\u0430\u0442\u043D\u0438\u043C ${Y.divisor}`;case"unrecognized_keys":return`\u041D\u0435\u0440\u043E\u0437\u043F\u0456\u0437\u043D\u0430\u043D\u0438\u0439 \u043A\u043B\u044E\u0447${Y.keys.length>1?"\u0456":""}: ${h(Y.keys,", ")}`;case"invalid_key":return`\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u0438\u0439 \u043A\u043B\u044E\u0447 \u0443 ${Y.origin}`;case"invalid_union":return"\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u0456 \u0432\u0445\u0456\u0434\u043D\u0456 \u0434\u0430\u043D\u0456";case"invalid_element":return`\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u043D\u044F \u0443 ${Y.origin}`;default:return"\u041D\u0435\u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u0456 \u0432\u0445\u0456\u0434\u043D\u0456 \u0434\u0430\u043D\u0456"}}};var NL=D(()=>{Y6()});function UL(){return r9()}var v2=D(()=>{NL()});function QL(){return{localeError:Ry()}}var Ry=()=>{let J={string:{unit:"\u062D\u0631\u0648\u0641",verb:"\u06C1\u0648\u0646\u0627"},file:{unit:"\u0628\u0627\u0626\u0679\u0633",verb:"\u06C1\u0648\u0646\u0627"},array:{unit:"\u0622\u0626\u0679\u0645\u0632",verb:"\u06C1\u0648\u0646\u0627"},set:{unit:"\u0622\u0626\u0679\u0645\u0632",verb:"\u06C1\u0648\u0646\u0627"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"\u0646\u0645\u0628\u0631";case"object":{if(Array.isArray(Y))return"\u0622\u0631\u06D2";if(Y===null)return"\u0646\u0644";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"\u0627\u0646 \u067E\u0679",email:"\u0627\u06CC \u0645\u06CC\u0644 \u0627\u06CC\u0688\u0631\u06CC\u0633",url:"\u06CC\u0648 \u0622\u0631 \u0627\u06CC\u0644",emoji:"\u0627\u06CC\u0645\u0648\u062C\u06CC",uuid:"\u06CC\u0648 \u06CC\u0648 \u0622\u0626\u06CC \u0688\u06CC",uuidv4:"\u06CC\u0648 \u06CC\u0648 \u0622\u0626\u06CC \u0688\u06CC \u0648\u06CC 4",uuidv6:"\u06CC\u0648 \u06CC\u0648 \u0622\u0626\u06CC \u0688\u06CC \u0648\u06CC 6",nanoid:"\u0646\u06CC\u0646\u0648 \u0622\u0626\u06CC \u0688\u06CC",guid:"\u062C\u06CC \u06CC\u0648 \u0622\u0626\u06CC \u0688\u06CC",cuid:"\u0633\u06CC \u06CC\u0648 \u0622\u0626\u06CC \u0688\u06CC",cuid2:"\u0633\u06CC \u06CC\u0648 \u0622\u0626\u06CC \u0688\u06CC 2",ulid:"\u06CC\u0648 \u0627\u06CC\u0644 \u0622\u0626\u06CC \u0688\u06CC",xid:"\u0627\u06CC\u06A9\u0633 \u0622\u0626\u06CC \u0688\u06CC",ksuid:"\u06A9\u06D2 \u0627\u06CC\u0633 \u06CC\u0648 \u0622\u0626\u06CC \u0688\u06CC",datetime:"\u0622\u0626\u06CC \u0627\u06CC\u0633 \u0627\u0648 \u0688\u06CC\u0679 \u0679\u0627\u0626\u0645",date:"\u0622\u0626\u06CC \u0627\u06CC\u0633 \u0627\u0648 \u062A\u0627\u0631\u06CC\u062E",time:"\u0622\u0626\u06CC \u0627\u06CC\u0633 \u0627\u0648 \u0648\u0642\u062A",duration:"\u0622\u0626\u06CC \u0627\u06CC\u0633 \u0627\u0648 \u0645\u062F\u062A",ipv4:"\u0622\u0626\u06CC \u067E\u06CC \u0648\u06CC 4 \u0627\u06CC\u0688\u0631\u06CC\u0633",ipv6:"\u0622\u0626\u06CC \u067E\u06CC \u0648\u06CC 6 \u0627\u06CC\u0688\u0631\u06CC\u0633",cidrv4:"\u0622\u0626\u06CC \u067E\u06CC \u0648\u06CC 4 \u0631\u06CC\u0646\u062C",cidrv6:"\u0622\u0626\u06CC \u067E\u06CC \u0648\u06CC 6 \u0631\u06CC\u0646\u062C",base64:"\u0628\u06CC\u0633 64 \u0627\u0646 \u06A9\u0648\u0688\u0688 \u0633\u0679\u0631\u0646\u06AF",base64url:"\u0628\u06CC\u0633 64 \u06CC\u0648 \u0622\u0631 \u0627\u06CC\u0644 \u0627\u0646 \u06A9\u0648\u0688\u0688 \u0633\u0679\u0631\u0646\u06AF",json_string:"\u062C\u06D2 \u0627\u06CC\u0633 \u0627\u0648 \u0627\u06CC\u0646 \u0633\u0679\u0631\u0646\u06AF",e164:"\u0627\u06CC 164 \u0646\u0645\u0628\u0631",jwt:"\u062C\u06D2 \u0688\u0628\u0644\u06CC\u0648 \u0679\u06CC",template_literal:"\u0627\u0646 \u067E\u0679"};return(Y)=>{switch(Y.code){case"invalid_type":return`\u063A\u0644\u0637 \u0627\u0646 \u067E\u0679: ${Y.expected} \u0645\u062A\u0648\u0642\u0639 \u062A\u06BE\u0627\u060C ${X(Y.input)} \u0645\u0648\u0635\u0648\u0644 \u06C1\u0648\u0627`;case"invalid_value":if(Y.values.length===1)return`\u063A\u0644\u0637 \u0627\u0646 \u067E\u0679: ${p(Y.values[0])} \u0645\u062A\u0648\u0642\u0639 \u062A\u06BE\u0627`;return`\u063A\u0644\u0637 \u0622\u067E\u0634\u0646: ${h(Y.values,"|")} \u0645\u06CC\u06BA \u0633\u06D2 \u0627\u06CC\u06A9 \u0645\u062A\u0648\u0642\u0639 \u062A\u06BE\u0627`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`\u0628\u06C1\u062A \u0628\u0691\u0627: ${Y.origin??"\u0648\u06CC\u0644\u06CC\u0648"} \u06A9\u06D2 ${$}${Y.maximum.toString()} ${K.unit??"\u0639\u0646\u0627\u0635\u0631"} \u06C1\u0648\u0646\u06D2 \u0645\u062A\u0648\u0642\u0639 \u062A\u06BE\u06D2`;return`\u0628\u06C1\u062A \u0628\u0691\u0627: ${Y.origin??"\u0648\u06CC\u0644\u06CC\u0648"} \u06A9\u0627 ${$}${Y.maximum.toString()} \u06C1\u0648\u0646\u0627 \u0645\u062A\u0648\u0642\u0639 \u062A\u06BE\u0627`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`\u0628\u06C1\u062A \u0686\u06BE\u0648\u0679\u0627: ${Y.origin} \u06A9\u06D2 ${$}${Y.minimum.toString()} ${K.unit} \u06C1\u0648\u0646\u06D2 \u0645\u062A\u0648\u0642\u0639 \u062A\u06BE\u06D2`;return`\u0628\u06C1\u062A \u0686\u06BE\u0648\u0679\u0627: ${Y.origin} \u06A9\u0627 ${$}${Y.minimum.toString()} \u06C1\u0648\u0646\u0627 \u0645\u062A\u0648\u0642\u0639 \u062A\u06BE\u0627`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`\u063A\u0644\u0637 \u0633\u0679\u0631\u0646\u06AF: "${$.prefix}" \u0633\u06D2 \u0634\u0631\u0648\u0639 \u06C1\u0648\u0646\u0627 \u0686\u0627\u06C1\u06CC\u06D2`;if($.format==="ends_with")return`\u063A\u0644\u0637 \u0633\u0679\u0631\u0646\u06AF: "${$.suffix}" \u067E\u0631 \u062E\u062A\u0645 \u06C1\u0648\u0646\u0627 \u0686\u0627\u06C1\u06CC\u06D2`;if($.format==="includes")return`\u063A\u0644\u0637 \u0633\u0679\u0631\u0646\u06AF: "${$.includes}" \u0634\u0627\u0645\u0644 \u06C1\u0648\u0646\u0627 \u0686\u0627\u06C1\u06CC\u06D2`;if($.format==="regex")return`\u063A\u0644\u0637 \u0633\u0679\u0631\u0646\u06AF: \u067E\u06CC\u0679\u0631\u0646 ${$.pattern} \u0633\u06D2 \u0645\u06CC\u0686 \u06C1\u0648\u0646\u0627 \u0686\u0627\u06C1\u06CC\u06D2`;return`\u063A\u0644\u0637 ${G[$.format]??Y.format}`}case"not_multiple_of":return`\u063A\u0644\u0637 \u0646\u0645\u0628\u0631: ${Y.divisor} \u06A9\u0627 \u0645\u0636\u0627\u0639\u0641 \u06C1\u0648\u0646\u0627 \u0686\u0627\u06C1\u06CC\u06D2`;case"unrecognized_keys":return`\u063A\u06CC\u0631 \u062A\u0633\u0644\u06CC\u0645 \u0634\u062F\u06C1 \u06A9\u06CC${Y.keys.length>1?"\u0632":""}: ${h(Y.keys,"\u060C ")}`;case"invalid_key":return`${Y.origin} \u0645\u06CC\u06BA \u063A\u0644\u0637 \u06A9\u06CC`;case"invalid_union":return"\u063A\u0644\u0637 \u0627\u0646 \u067E\u0679";case"invalid_element":return`${Y.origin} \u0645\u06CC\u06BA \u063A\u0644\u0637 \u0648\u06CC\u0644\u06CC\u0648`;default:return"\u063A\u0644\u0637 \u0627\u0646 \u067E\u0679"}}};var M2=D(()=>{Y6()});function LL(){return{localeError:Cy()}}var Cy=()=>{let J={string:{unit:"k\xFD t\u1EF1",verb:"c\xF3"},file:{unit:"byte",verb:"c\xF3"},array:{unit:"ph\u1EA7n t\u1EED",verb:"c\xF3"},set:{unit:"ph\u1EA7n t\u1EED",verb:"c\xF3"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"s\u1ED1";case"object":{if(Array.isArray(Y))return"m\u1EA3ng";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"\u0111\u1EA7u v\xE0o",email:"\u0111\u1ECBa ch\u1EC9 email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ng\xE0y gi\u1EDD ISO",date:"ng\xE0y ISO",time:"gi\u1EDD ISO",duration:"kho\u1EA3ng th\u1EDDi gian ISO",ipv4:"\u0111\u1ECBa ch\u1EC9 IPv4",ipv6:"\u0111\u1ECBa ch\u1EC9 IPv6",cidrv4:"d\u1EA3i IPv4",cidrv6:"d\u1EA3i IPv6",base64:"chu\u1ED7i m\xE3 h\xF3a base64",base64url:"chu\u1ED7i m\xE3 h\xF3a base64url",json_string:"chu\u1ED7i JSON",e164:"s\u1ED1 E.164",jwt:"JWT",template_literal:"\u0111\u1EA7u v\xE0o"};return(Y)=>{switch(Y.code){case"invalid_type":return`\u0110\u1EA7u v\xE0o kh\xF4ng h\u1EE3p l\u1EC7: mong \u0111\u1EE3i ${Y.expected}, nh\u1EADn \u0111\u01B0\u1EE3c ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`\u0110\u1EA7u v\xE0o kh\xF4ng h\u1EE3p l\u1EC7: mong \u0111\u1EE3i ${p(Y.values[0])}`;return`T\xF9y ch\u1ECDn kh\xF4ng h\u1EE3p l\u1EC7: mong \u0111\u1EE3i m\u1ED9t trong c\xE1c gi\xE1 tr\u1ECB ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`Qu\xE1 l\u1EDBn: mong \u0111\u1EE3i ${Y.origin??"gi\xE1 tr\u1ECB"} ${K.verb} ${$}${Y.maximum.toString()} ${K.unit??"ph\u1EA7n t\u1EED"}`;return`Qu\xE1 l\u1EDBn: mong \u0111\u1EE3i ${Y.origin??"gi\xE1 tr\u1ECB"} ${$}${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`Qu\xE1 nh\u1ECF: mong \u0111\u1EE3i ${Y.origin} ${K.verb} ${$}${Y.minimum.toString()} ${K.unit}`;return`Qu\xE1 nh\u1ECF: mong \u0111\u1EE3i ${Y.origin} ${$}${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`Chu\u1ED7i kh\xF4ng h\u1EE3p l\u1EC7: ph\u1EA3i b\u1EAFt \u0111\u1EA7u b\u1EB1ng "${$.prefix}"`;if($.format==="ends_with")return`Chu\u1ED7i kh\xF4ng h\u1EE3p l\u1EC7: ph\u1EA3i k\u1EBFt th\xFAc b\u1EB1ng "${$.suffix}"`;if($.format==="includes")return`Chu\u1ED7i kh\xF4ng h\u1EE3p l\u1EC7: ph\u1EA3i bao g\u1ED3m "${$.includes}"`;if($.format==="regex")return`Chu\u1ED7i kh\xF4ng h\u1EE3p l\u1EC7: ph\u1EA3i kh\u1EDBp v\u1EDBi m\u1EABu ${$.pattern}`;return`${G[$.format]??Y.format} kh\xF4ng h\u1EE3p l\u1EC7`}case"not_multiple_of":return`S\u1ED1 kh\xF4ng h\u1EE3p l\u1EC7: ph\u1EA3i l\xE0 b\u1ED9i s\u1ED1 c\u1EE7a ${Y.divisor}`;case"unrecognized_keys":return`Kh\xF3a kh\xF4ng \u0111\u01B0\u1EE3c nh\u1EADn d\u1EA1ng: ${h(Y.keys,", ")}`;case"invalid_key":return`Kh\xF3a kh\xF4ng h\u1EE3p l\u1EC7 trong ${Y.origin}`;case"invalid_union":return"\u0110\u1EA7u v\xE0o kh\xF4ng h\u1EE3p l\u1EC7";case"invalid_element":return`Gi\xE1 tr\u1ECB kh\xF4ng h\u1EE3p l\u1EC7 trong ${Y.origin}`;default:return"\u0110\u1EA7u v\xE0o kh\xF4ng h\u1EE3p l\u1EC7"}}};var O2=D(()=>{Y6()});function VL(){return{localeError:Iy()}}var Iy=()=>{let J={string:{unit:"\u5B57\u7B26",verb:"\u5305\u542B"},file:{unit:"\u5B57\u8282",verb:"\u5305\u542B"},array:{unit:"\u9879",verb:"\u5305\u542B"},set:{unit:"\u9879",verb:"\u5305\u542B"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"\u975E\u6570\u5B57(NaN)":"\u6570\u5B57";case"object":{if(Array.isArray(Y))return"\u6570\u7EC4";if(Y===null)return"\u7A7A\u503C(null)";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"\u8F93\u5165",email:"\u7535\u5B50\u90AE\u4EF6",url:"URL",emoji:"\u8868\u60C5\u7B26\u53F7",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO\u65E5\u671F\u65F6\u95F4",date:"ISO\u65E5\u671F",time:"ISO\u65F6\u95F4",duration:"ISO\u65F6\u957F",ipv4:"IPv4\u5730\u5740",ipv6:"IPv6\u5730\u5740",cidrv4:"IPv4\u7F51\u6BB5",cidrv6:"IPv6\u7F51\u6BB5",base64:"base64\u7F16\u7801\u5B57\u7B26\u4E32",base64url:"base64url\u7F16\u7801\u5B57\u7B26\u4E32",json_string:"JSON\u5B57\u7B26\u4E32",e164:"E.164\u53F7\u7801",jwt:"JWT",template_literal:"\u8F93\u5165"};return(Y)=>{switch(Y.code){case"invalid_type":return`\u65E0\u6548\u8F93\u5165\uFF1A\u671F\u671B ${Y.expected}\uFF0C\u5B9E\u9645\u63A5\u6536 ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`\u65E0\u6548\u8F93\u5165\uFF1A\u671F\u671B ${p(Y.values[0])}`;return`\u65E0\u6548\u9009\u9879\uFF1A\u671F\u671B\u4EE5\u4E0B\u4E4B\u4E00 ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`\u6570\u503C\u8FC7\u5927\uFF1A\u671F\u671B ${Y.origin??"\u503C"} ${$}${Y.maximum.toString()} ${K.unit??"\u4E2A\u5143\u7D20"}`;return`\u6570\u503C\u8FC7\u5927\uFF1A\u671F\u671B ${Y.origin??"\u503C"} ${$}${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`\u6570\u503C\u8FC7\u5C0F\uFF1A\u671F\u671B ${Y.origin} ${$}${Y.minimum.toString()} ${K.unit}`;return`\u6570\u503C\u8FC7\u5C0F\uFF1A\u671F\u671B ${Y.origin} ${$}${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`\u65E0\u6548\u5B57\u7B26\u4E32\uFF1A\u5FC5\u987B\u4EE5 "${$.prefix}" \u5F00\u5934`;if($.format==="ends_with")return`\u65E0\u6548\u5B57\u7B26\u4E32\uFF1A\u5FC5\u987B\u4EE5 "${$.suffix}" \u7ED3\u5C3E`;if($.format==="includes")return`\u65E0\u6548\u5B57\u7B26\u4E32\uFF1A\u5FC5\u987B\u5305\u542B "${$.includes}"`;if($.format==="regex")return`\u65E0\u6548\u5B57\u7B26\u4E32\uFF1A\u5FC5\u987B\u6EE1\u8DB3\u6B63\u5219\u8868\u8FBE\u5F0F ${$.pattern}`;return`\u65E0\u6548${G[$.format]??Y.format}`}case"not_multiple_of":return`\u65E0\u6548\u6570\u5B57\uFF1A\u5FC5\u987B\u662F ${Y.divisor} \u7684\u500D\u6570`;case"unrecognized_keys":return`\u51FA\u73B0\u672A\u77E5\u7684\u952E(key): ${h(Y.keys,", ")}`;case"invalid_key":return`${Y.origin} \u4E2D\u7684\u952E(key)\u65E0\u6548`;case"invalid_union":return"\u65E0\u6548\u8F93\u5165";case"invalid_element":return`${Y.origin} \u4E2D\u5305\u542B\u65E0\u6548\u503C(value)`;default:return"\u65E0\u6548\u8F93\u5165"}}};var P2=D(()=>{Y6()});function DL(){return{localeError:by()}}var by=()=>{let J={string:{unit:"\u5B57\u5143",verb:"\u64C1\u6709"},file:{unit:"\u4F4D\u5143\u7D44",verb:"\u64C1\u6709"},array:{unit:"\u9805\u76EE",verb:"\u64C1\u6709"},set:{unit:"\u9805\u76EE",verb:"\u64C1\u6709"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"number";case"object":{if(Array.isArray(Y))return"array";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"\u8F38\u5165",email:"\u90F5\u4EF6\u5730\u5740",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO \u65E5\u671F\u6642\u9593",date:"ISO \u65E5\u671F",time:"ISO \u6642\u9593",duration:"ISO \u671F\u9593",ipv4:"IPv4 \u4F4D\u5740",ipv6:"IPv6 \u4F4D\u5740",cidrv4:"IPv4 \u7BC4\u570D",cidrv6:"IPv6 \u7BC4\u570D",base64:"base64 \u7DE8\u78BC\u5B57\u4E32",base64url:"base64url \u7DE8\u78BC\u5B57\u4E32",json_string:"JSON \u5B57\u4E32",e164:"E.164 \u6578\u503C",jwt:"JWT",template_literal:"\u8F38\u5165"};return(Y)=>{switch(Y.code){case"invalid_type":return`\u7121\u6548\u7684\u8F38\u5165\u503C\uFF1A\u9810\u671F\u70BA ${Y.expected}\uFF0C\u4F46\u6536\u5230 ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`\u7121\u6548\u7684\u8F38\u5165\u503C\uFF1A\u9810\u671F\u70BA ${p(Y.values[0])}`;return`\u7121\u6548\u7684\u9078\u9805\uFF1A\u9810\u671F\u70BA\u4EE5\u4E0B\u5176\u4E2D\u4E4B\u4E00 ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`\u6578\u503C\u904E\u5927\uFF1A\u9810\u671F ${Y.origin??"\u503C"} \u61C9\u70BA ${$}${Y.maximum.toString()} ${K.unit??"\u500B\u5143\u7D20"}`;return`\u6578\u503C\u904E\u5927\uFF1A\u9810\u671F ${Y.origin??"\u503C"} \u61C9\u70BA ${$}${Y.maximum.toString()}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`\u6578\u503C\u904E\u5C0F\uFF1A\u9810\u671F ${Y.origin} \u61C9\u70BA ${$}${Y.minimum.toString()} ${K.unit}`;return`\u6578\u503C\u904E\u5C0F\uFF1A\u9810\u671F ${Y.origin} \u61C9\u70BA ${$}${Y.minimum.toString()}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`\u7121\u6548\u7684\u5B57\u4E32\uFF1A\u5FC5\u9808\u4EE5 "${$.prefix}" \u958B\u982D`;if($.format==="ends_with")return`\u7121\u6548\u7684\u5B57\u4E32\uFF1A\u5FC5\u9808\u4EE5 "${$.suffix}" \u7D50\u5C3E`;if($.format==="includes")return`\u7121\u6548\u7684\u5B57\u4E32\uFF1A\u5FC5\u9808\u5305\u542B "${$.includes}"`;if($.format==="regex")return`\u7121\u6548\u7684\u5B57\u4E32\uFF1A\u5FC5\u9808\u7B26\u5408\u683C\u5F0F ${$.pattern}`;return`\u7121\u6548\u7684 ${G[$.format]??Y.format}`}case"not_multiple_of":return`\u7121\u6548\u7684\u6578\u5B57\uFF1A\u5FC5\u9808\u70BA ${Y.divisor} \u7684\u500D\u6578`;case"unrecognized_keys":return`\u7121\u6CD5\u8B58\u5225\u7684\u9375\u503C${Y.keys.length>1?"\u5011":""}\uFF1A${h(Y.keys,"\u3001")}`;case"invalid_key":return`${Y.origin} \u4E2D\u6709\u7121\u6548\u7684\u9375\u503C`;case"invalid_union":return"\u7121\u6548\u7684\u8F38\u5165\u503C";case"invalid_element":return`${Y.origin} \u4E2D\u6709\u7121\u6548\u7684\u503C`;default:return"\u7121\u6548\u7684\u8F38\u5165\u503C"}}};var j2=D(()=>{Y6()});function vL(){return{localeError:ky()}}var ky=()=>{let J={string:{unit:"\xE0mi",verb:"n\xED"},file:{unit:"bytes",verb:"n\xED"},array:{unit:"nkan",verb:"n\xED"},set:{unit:"nkan",verb:"n\xED"}};function W(Y){return J[Y]??null}let X=(Y)=>{let $=typeof Y;switch($){case"number":return Number.isNaN(Y)?"NaN":"n\u1ECD\u0301mb\xE0";case"object":{if(Array.isArray(Y))return"akop\u1ECD";if(Y===null)return"null";if(Object.getPrototypeOf(Y)!==Object.prototype&&Y.constructor)return Y.constructor.name}}return $},G={regex:"\u1EB9\u0300r\u1ECD \xECb\xE1w\u1ECDl\xE9",email:"\xE0d\xEDr\u1EB9\u0301s\xEC \xECm\u1EB9\u0301l\xEC",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"\xE0k\xF3k\xF2 ISO",date:"\u1ECDj\u1ECD\u0301 ISO",time:"\xE0k\xF3k\xF2 ISO",duration:"\xE0k\xF3k\xF2 t\xF3 p\xE9 ISO",ipv4:"\xE0d\xEDr\u1EB9\u0301s\xEC IPv4",ipv6:"\xE0d\xEDr\u1EB9\u0301s\xEC IPv6",cidrv4:"\xE0gb\xE8gb\xE8 IPv4",cidrv6:"\xE0gb\xE8gb\xE8 IPv6",base64:"\u1ECD\u0300r\u1ECD\u0300 t\xED a k\u1ECD\u0301 n\xED base64",base64url:"\u1ECD\u0300r\u1ECD\u0300 base64url",json_string:"\u1ECD\u0300r\u1ECD\u0300 JSON",e164:"n\u1ECD\u0301mb\xE0 E.164",jwt:"JWT",template_literal:"\u1EB9\u0300r\u1ECD \xECb\xE1w\u1ECDl\xE9"};return(Y)=>{switch(Y.code){case"invalid_type":return`\xCCb\xE1w\u1ECDl\xE9 a\u1E63\xEC\u1E63e: a n\xED l\xE1ti fi ${Y.expected}, \xE0m\u1ECD\u0300 a r\xED ${X(Y.input)}`;case"invalid_value":if(Y.values.length===1)return`\xCCb\xE1w\u1ECDl\xE9 a\u1E63\xEC\u1E63e: a n\xED l\xE1ti fi ${p(Y.values[0])}`;return`\xC0\u1E63\xE0y\xE0n a\u1E63\xEC\u1E63e: yan \u1ECD\u0300kan l\xE1ra ${h(Y.values,"|")}`;case"too_big":{let $=Y.inclusive?"<=":"<",K=W(Y.origin);if(K)return`T\xF3 p\u1ECD\u0300 j\xF9: a n\xED l\xE1ti j\u1EB9\u0301 p\xE9 ${Y.origin??"iye"} ${K.verb} ${$}${Y.maximum} ${K.unit}`;return`T\xF3 p\u1ECD\u0300 j\xF9: a n\xED l\xE1ti j\u1EB9\u0301 ${$}${Y.maximum}`}case"too_small":{let $=Y.inclusive?">=":">",K=W(Y.origin);if(K)return`K\xE9r\xE9 ju: a n\xED l\xE1ti j\u1EB9\u0301 p\xE9 ${Y.origin} ${K.verb} ${$}${Y.minimum} ${K.unit}`;return`K\xE9r\xE9 ju: a n\xED l\xE1ti j\u1EB9\u0301 ${$}${Y.minimum}`}case"invalid_format":{let $=Y;if($.format==="starts_with")return`\u1ECC\u0300r\u1ECD\u0300 a\u1E63\xEC\u1E63e: gb\u1ECD\u0301d\u1ECD\u0300 b\u1EB9\u0300r\u1EB9\u0300 p\u1EB9\u0300l\xFA "${$.prefix}"`;if($.format==="ends_with")return`\u1ECC\u0300r\u1ECD\u0300 a\u1E63\xEC\u1E63e: gb\u1ECD\u0301d\u1ECD\u0300 par\xED p\u1EB9\u0300l\xFA "${$.suffix}"`;if($.format==="includes")return`\u1ECC\u0300r\u1ECD\u0300 a\u1E63\xEC\u1E63e: gb\u1ECD\u0301d\u1ECD\u0300 n\xED "${$.includes}"`;if($.format==="regex")return`\u1ECC\u0300r\u1ECD\u0300 a\u1E63\xEC\u1E63e: gb\u1ECD\u0301d\u1ECD\u0300 b\xE1 \xE0p\u1EB9\u1EB9r\u1EB9 mu ${$.pattern}`;return`A\u1E63\xEC\u1E63e: ${G[$.format]??Y.format}`}case"not_multiple_of":return`N\u1ECD\u0301mb\xE0 a\u1E63\xEC\u1E63e: gb\u1ECD\u0301d\u1ECD\u0300 j\u1EB9\u0301 \xE8y\xE0 p\xEDp\xEDn ti ${Y.divisor}`;case"unrecognized_keys":return`B\u1ECDt\xECn\xEC \xE0\xECm\u1ECD\u0300: ${h(Y.keys,", ")}`;case"invalid_key":return`B\u1ECDt\xECn\xEC a\u1E63\xEC\u1E63e n\xEDn\xFA ${Y.origin}`;case"invalid_union":return"\xCCb\xE1w\u1ECDl\xE9 a\u1E63\xEC\u1E63e";case"invalid_element":return`Iye a\u1E63\xEC\u1E63e n\xEDn\xFA ${Y.origin}`;default:return"\xCCb\xE1w\u1ECDl\xE9 a\u1E63\xEC\u1E63e"}}};var _2=D(()=>{Y6()});var EY={};s0(EY,{zhTW:()=>DL,zhCN:()=>VL,yo:()=>vL,vi:()=>LL,ur:()=>QL,uk:()=>r9,ua:()=>UL,tr:()=>FL,th:()=>zL,ta:()=>ZL,sv:()=>HL,sl:()=>wL,ru:()=>KL,pt:()=>$L,ps:()=>YL,pl:()=>GL,ota:()=>XL,no:()=>WL,nl:()=>JL,ms:()=>eQ,mk:()=>sQ,lt:()=>oQ,ko:()=>tQ,km:()=>p9,kh:()=>aQ,ka:()=>rQ,ja:()=>nQ,it:()=>dQ,is:()=>pQ,id:()=>cQ,hu:()=>lQ,he:()=>uQ,frCA:()=>xQ,fr:()=>yQ,fi:()=>mQ,fa:()=>gQ,es:()=>fQ,eo:()=>hQ,en:()=>c9,de:()=>bQ,da:()=>IQ,cs:()=>CQ,ca:()=>RQ,bg:()=>EQ,be:()=>AQ,az:()=>BQ,ar:()=>qQ});var ML=D(()=>{CT();IT();kT();hT();fT();gT();mT();yT();kQ();xT();uT();lT();cT();pT();dT();nT();rT();iT();aT();tT();oT();sT();eT();iQ();J2();X2();Y2();G2();$2();K2();w2();H2();Z2();z2();N2();U2();Q2();L2();V2();D2();v2();NL();M2();O2();P2();j2();_2()});class i9{constructor(){this._map=new WeakMap,this._idmap=new Map}add(J,...W){let X=W[0];if(this._map.set(J,X),X&&typeof X==="object"&&"id"in X){if(this._idmap.has(X.id))throw Error(`ID ${X.id} already exists in the registry`);this._idmap.set(X.id,J)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(J){let W=this._map.get(J);if(W&&typeof W==="object"&&"id"in W)this._idmap.delete(W.id);return this._map.delete(J),this}get(J){let W=J._zod.parent;if(W){let X={...this.get(W)??{}};delete X.id;let G={...X,...this._map.get(J)};return Object.keys(G).length?G:void 0}return this._map.get(J)}has(J){return this._map.has(J)}}function a9(){return new i9}var Mw,Ow,YJ;var OL=D(()=>{Mw=Symbol("ZodOutput"),Ow=Symbol("ZodInput");YJ=a9()});function PL(J,W){return new J({type:"string",...r(W)})}function jL(J,W){return new J({type:"string",coerce:!0,...r(W)})}function Pw(J,W){return new J({type:"string",format:"email",check:"string_format",abort:!1,...r(W)})}function t9(J,W){return new J({type:"string",format:"guid",check:"string_format",abort:!1,...r(W)})}function jw(J,W){return new J({type:"string",format:"uuid",check:"string_format",abort:!1,...r(W)})}function _w(J,W){return new J({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...r(W)})}function Sw(J,W){return new J({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...r(W)})}function Tw(J,W){return new J({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...r(W)})}function o9(J,W){return new J({type:"string",format:"url",check:"string_format",abort:!1,...r(W)})}function qw(J,W){return new J({type:"string",format:"emoji",check:"string_format",abort:!1,...r(W)})}function Bw(J,W){return new J({type:"string",format:"nanoid",check:"string_format",abort:!1,...r(W)})}function Aw(J,W){return new J({type:"string",format:"cuid",check:"string_format",abort:!1,...r(W)})}function Ew(J,W){return new J({type:"string",format:"cuid2",check:"string_format",abort:!1,...r(W)})}function Rw(J,W){return new J({type:"string",format:"ulid",check:"string_format",abort:!1,...r(W)})}function Cw(J,W){return new J({type:"string",format:"xid",check:"string_format",abort:!1,...r(W)})}function Iw(J,W){return new J({type:"string",format:"ksuid",check:"string_format",abort:!1,...r(W)})}function bw(J,W){return new J({type:"string",format:"ipv4",check:"string_format",abort:!1,...r(W)})}function kw(J,W){return new J({type:"string",format:"ipv6",check:"string_format",abort:!1,...r(W)})}function hw(J,W){return new J({type:"string",format:"cidrv4",check:"string_format",abort:!1,...r(W)})}function fw(J,W){return new J({type:"string",format:"cidrv6",check:"string_format",abort:!1,...r(W)})}function gw(J,W){return new J({type:"string",format:"base64",check:"string_format",abort:!1,...r(W)})}function mw(J,W){return new J({type:"string",format:"base64url",check:"string_format",abort:!1,...r(W)})}function yw(J,W){return new J({type:"string",format:"e164",check:"string_format",abort:!1,...r(W)})}function xw(J,W){return new J({type:"string",format:"jwt",check:"string_format",abort:!1,...r(W)})}function _L(J,W){return new J({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...r(W)})}function SL(J,W){return new J({type:"string",format:"date",check:"string_format",...r(W)})}function TL(J,W){return new J({type:"string",format:"time",check:"string_format",precision:null,...r(W)})}function qL(J,W){return new J({type:"string",format:"duration",check:"string_format",...r(W)})}function BL(J,W){return new J({type:"number",checks:[],...r(W)})}function AL(J,W){return new J({type:"number",coerce:!0,checks:[],...r(W)})}function EL(J,W){return new J({type:"number",check:"number_format",abort:!1,format:"safeint",...r(W)})}function RL(J,W){return new J({type:"number",check:"number_format",abort:!1,format:"float32",...r(W)})}function CL(J,W){return new J({type:"number",check:"number_format",abort:!1,format:"float64",...r(W)})}function IL(J,W){return new J({type:"number",check:"number_format",abort:!1,format:"int32",...r(W)})}function bL(J,W){return new J({type:"number",check:"number_format",abort:!1,format:"uint32",...r(W)})}function kL(J,W){return new J({type:"boolean",...r(W)})}function hL(J,W){return new J({type:"boolean",coerce:!0,...r(W)})}function fL(J,W){return new J({type:"bigint",...r(W)})}function gL(J,W){return new J({type:"bigint",coerce:!0,...r(W)})}function mL(J,W){return new J({type:"bigint",check:"bigint_format",abort:!1,format:"int64",...r(W)})}function yL(J,W){return new J({type:"bigint",check:"bigint_format",abort:!1,format:"uint64",...r(W)})}function xL(J,W){return new J({type:"symbol",...r(W)})}function uL(J,W){return new J({type:"undefined",...r(W)})}function lL(J,W){return new J({type:"null",...r(W)})}function cL(J){return new J({type:"any"})}function pL(J){return new J({type:"unknown"})}function dL(J,W){return new J({type:"never",...r(W)})}function nL(J,W){return new J({type:"void",...r(W)})}function rL(J,W){return new J({type:"date",...r(W)})}function iL(J,W){return new J({type:"date",coerce:!0,...r(W)})}function aL(J,W){return new J({type:"nan",...r(W)})}function jJ(J,W){return new Kw({check:"less_than",...r(W),value:J,inclusive:!1})}function L8(J,W){return new Kw({check:"less_than",...r(W),value:J,inclusive:!0})}function _J(J,W){return new ww({check:"greater_than",...r(W),value:J,inclusive:!1})}function k0(J,W){return new ww({check:"greater_than",...r(W),value:J,inclusive:!0})}function lw(J){return _J(0,J)}function cw(J){return jJ(0,J)}function pw(J){return L8(0,J)}function dw(J){return k0(0,J)}function iW(J,W){return new oN({check:"multiple_of",...r(W),value:J})}function pX(J,W){return new JU({check:"max_size",...r(W),maximum:J})}function aW(J,W){return new WU({check:"min_size",...r(W),minimum:J})}function RY(J,W){return new XU({check:"size_equals",...r(W),size:J})}function dX(J,W){return new YU({check:"max_length",...r(W),maximum:J})}function wW(J,W){return new GU({check:"min_length",...r(W),minimum:J})}function nX(J,W){return new $U({check:"length_equals",...r(W),length:J})}function CY(J,W){return new KU({check:"string_format",format:"regex",...r(W),pattern:J})}function IY(J){return new wU({check:"string_format",format:"lowercase",...r(J)})}function bY(J){return new HU({check:"string_format",format:"uppercase",...r(J)})}function kY(J,W){return new ZU({check:"string_format",format:"includes",...r(W),includes:J})}function hY(J,W){return new zU({check:"string_format",format:"starts_with",...r(W),prefix:J})}function fY(J,W){return new FU({check:"string_format",format:"ends_with",...r(W),suffix:J})}function nw(J,W,X){return new NU({check:"property",property:J,schema:W,...r(X)})}function gY(J,W){return new UU({check:"mime_type",mime:J,...r(W)})}function SJ(J){return new QU({check:"overwrite",tx:J})}function mY(J){return SJ((W)=>W.normalize(J))}function yY(){return SJ((J)=>J.trim())}function xY(){return SJ((J)=>J.toLowerCase())}function uY(){return SJ((J)=>J.toUpperCase())}function tL(J,W,X){return new J({type:"array",element:W,...r(X)})}function hy(J,W,X){return new J({type:"union",options:W,...r(X)})}function fy(J,W,X,G){return new J({type:"union",options:X,discriminator:W,...r(G)})}function gy(J,W,X){return new J({type:"intersection",left:W,right:X})}function my(J,W,X,G){let Y=X instanceof N6;return new J({type:"tuple",items:W,rest:Y?X:null,...r(Y?G:X)})}function yy(J,W,X,G){return new J({type:"record",keyType:W,valueType:X,...r(G)})}function xy(J,W,X,G){return new J({type:"map",keyType:W,valueType:X,...r(G)})}function uy(J,W,X){return new J({type:"set",valueType:W,...r(X)})}function ly(J,W,X){let G=Array.isArray(W)?Object.fromEntries(W.map((Y)=>[Y,Y])):W;return new J({type:"enum",entries:G,...r(X)})}function cy(J,W,X){return new J({type:"enum",entries:W,...r(X)})}function py(J,W,X){return new J({type:"literal",values:Array.isArray(W)?W:[W],...r(X)})}function oL(J,W){return new J({type:"file",...r(W)})}function dy(J,W){return new J({type:"transform",transform:W})}function ny(J,W){return new J({type:"optional",innerType:W})}function ry(J,W){return new J({type:"nullable",innerType:W})}function iy(J,W,X){return new J({type:"default",innerType:W,get defaultValue(){return typeof X==="function"?X():UN(X)}})}function ay(J,W,X){return new J({type:"nonoptional",innerType:W,...r(X)})}function ty(J,W){return new J({type:"success",innerType:W})}function oy(J,W,X){return new J({type:"catch",innerType:W,catchValue:typeof X==="function"?X:()=>X})}function sy(J,W,X){return new J({type:"pipe",in:W,out:X})}function ey(J,W){return new J({type:"readonly",innerType:W})}function Jx(J,W,X){return new J({type:"template_literal",parts:W,...r(X)})}function Wx(J,W){return new J({type:"lazy",getter:W})}function Xx(J,W){return new J({type:"promise",innerType:W})}function sL(J,W,X){let G=r(X);return G.abort??(G.abort=!0),new J({type:"custom",check:"custom",fn:W,...G})}function eL(J,W,X){return new J({type:"custom",check:"custom",fn:W,...r(X)})}function JV(J){let W=S2((X)=>{return X.addIssue=(G)=>{if(typeof G==="string")X.issues.push(PY(G,X.value,W._zod.def));else{let Y=G;if(Y.fatal)Y.continue=!1;Y.code??(Y.code="custom"),Y.input??(Y.input=X.value),Y.inst??(Y.inst=W),Y.continue??(Y.continue=!W._zod.def.abort),X.issues.push(PY(Y))}},J(X.value,X)});return W}function S2(J,W){let X=new L4({check:"custom",...r(W)});return X._zod.check=J,X}function WV(J,W){let X=r(W),G=X.truthy??["true","1","yes","on","y","enabled"],Y=X.falsy??["false","0","no","off","n","disabled"];if(X.case!=="sensitive")G=G.map((Q)=>typeof Q==="string"?Q.toLowerCase():Q),Y=Y.map((Q)=>typeof Q==="string"?Q.toLowerCase():Q);let $=new Set(G),K=new Set(Y),w=J.Codec??l9,H=J.Boolean??u9,z=new(J.String??cX)({type:"string",error:X.error}),N=new H({type:"boolean",error:X.error}),F=new w({type:"pipe",in:z,out:N,transform:(Q,V)=>{let v=Q;if(X.case!=="sensitive")v=v.toLowerCase();if($.has(v))return!0;else if(K.has(v))return!1;else return V.issues.push({code:"invalid_value",expected:"stringbool",values:[...$,...K],input:V.value,inst:F,continue:!1}),{}},reverseTransform:(Q,V)=>{if(Q===!0)return G[0]||"true";else return Y[0]||"false"},error:X.error});return F}function lY(J,W,X,G={}){let Y=r(G),$={...r(G),check:"string_format",type:"string",format:W,fn:typeof X==="function"?X:(w)=>X.test(w),...Y};if(X instanceof RegExp)$.pattern=X;return new J($)}var uw;var T2=D(()=>{Hw();TQ();Y6();uw={Any:null,Minute:-1,Second:0,Millisecond:3,Microsecond:6}});class rw{constructor(J){this.counter=0,this.metadataRegistry=J?.metadata??YJ,this.target=J?.target??"draft-2020-12",this.unrepresentable=J?.unrepresentable??"throw",this.override=J?.override??(()=>{}),this.io=J?.io??"output",this.seen=new Map}process(J,W={path:[],schemaPath:[]}){var X;let G=J._zod.def,Y={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},$=this.seen.get(J);if($){if($.count++,W.schemaPath.includes(J))$.cycle=W.path;return $.schema}let K={schema:{},count:1,cycle:void 0,path:W.path};this.seen.set(J,K);let w=J._zod.toJSONSchema?.();if(w)K.schema=w;else{let z={...W,schemaPath:[...W.schemaPath,J],path:W.path},N=J._zod.parent;if(N)K.ref=N,this.process(N,z),this.seen.get(N).isParent=!0;else{let F=K.schema;switch(G.type){case"string":{let Q=F;Q.type="string";let{minimum:V,maximum:v,format:M,patterns:O,contentEncoding:S}=J._zod.bag;if(typeof V==="number")Q.minLength=V;if(typeof v==="number")Q.maxLength=v;if(M){if(Q.format=Y[M]??M,Q.format==="")delete Q.format}if(S)Q.contentEncoding=S;if(O&&O.size>0){let T=[...O];if(T.length===1)Q.pattern=T[0].source;else if(T.length>1)K.schema.allOf=[...T.map((j)=>({...this.target==="draft-7"||this.target==="draft-4"||this.target==="openapi-3.0"?{type:"string"}:{},pattern:j.source}))]}break}case"number":{let Q=F,{minimum:V,maximum:v,format:M,multipleOf:O,exclusiveMaximum:S,exclusiveMinimum:T}=J._zod.bag;if(typeof M==="string"&&M.includes("int"))Q.type="integer";else Q.type="number";if(typeof T==="number")if(this.target==="draft-4"||this.target==="openapi-3.0")Q.minimum=T,Q.exclusiveMinimum=!0;else Q.exclusiveMinimum=T;if(typeof V==="number"){if(Q.minimum=V,typeof T==="number"&&this.target!=="draft-4")if(T>=V)delete Q.minimum;else delete Q.exclusiveMinimum}if(typeof S==="number")if(this.target==="draft-4"||this.target==="openapi-3.0")Q.maximum=S,Q.exclusiveMaximum=!0;else Q.exclusiveMaximum=S;if(typeof v==="number"){if(Q.maximum=v,typeof S==="number"&&this.target!=="draft-4")if(S<=v)delete Q.maximum;else delete Q.exclusiveMaximum}if(typeof O==="number")Q.multipleOf=O;break}case"boolean":{let Q=F;Q.type="boolean";break}case"bigint":{if(this.unrepresentable==="throw")throw Error("BigInt cannot be represented in JSON Schema");break}case"symbol":{if(this.unrepresentable==="throw")throw Error("Symbols cannot be represented in JSON Schema");break}case"null":{if(this.target==="openapi-3.0")F.type="string",F.nullable=!0,F.enum=[null];else F.type="null";break}case"any":break;case"unknown":break;case"undefined":{if(this.unrepresentable==="throw")throw Error("Undefined cannot be represented in JSON Schema");break}case"void":{if(this.unrepresentable==="throw")throw Error("Void cannot be represented in JSON Schema");break}case"never":{F.not={};break}case"date":{if(this.unrepresentable==="throw")throw Error("Date cannot be represented in JSON Schema");break}case"array":{let Q=F,{minimum:V,maximum:v}=J._zod.bag;if(typeof V==="number")Q.minItems=V;if(typeof v==="number")Q.maxItems=v;Q.type="array",Q.items=this.process(G.element,{...z,path:[...z.path,"items"]});break}case"object":{let Q=F;Q.type="object",Q.properties={};let V=G.shape;for(let O in V)Q.properties[O]=this.process(V[O],{...z,path:[...z.path,"properties",O]});let v=new Set(Object.keys(V)),M=new Set([...v].filter((O)=>{let S=G.shape[O]._zod;if(this.io==="input")return S.optin===void 0;else return S.optout===void 0}));if(M.size>0)Q.required=Array.from(M);if(G.catchall?._zod.def.type==="never")Q.additionalProperties=!1;else if(!G.catchall){if(this.io==="output")Q.additionalProperties=!1}else if(G.catchall)Q.additionalProperties=this.process(G.catchall,{...z,path:[...z.path,"additionalProperties"]});break}case"union":{let Q=F,V=G.options.map((v,M)=>this.process(v,{...z,path:[...z.path,"anyOf",M]}));Q.anyOf=V;break}case"intersection":{let Q=F,V=this.process(G.left,{...z,path:[...z.path,"allOf",0]}),v=this.process(G.right,{...z,path:[...z.path,"allOf",1]}),M=(S)=>("allOf"in S)&&Object.keys(S).length===1,O=[...M(V)?V.allOf:[V],...M(v)?v.allOf:[v]];Q.allOf=O;break}case"tuple":{let Q=F;Q.type="array";let V=this.target==="draft-2020-12"?"prefixItems":"items",v=this.target==="draft-2020-12"?"items":this.target==="openapi-3.0"?"items":"additionalItems",M=G.items.map((j,q)=>this.process(j,{...z,path:[...z.path,V,q]})),O=G.rest?this.process(G.rest,{...z,path:[...z.path,v,...this.target==="openapi-3.0"?[G.items.length]:[]]}):null;if(this.target==="draft-2020-12"){if(Q.prefixItems=M,O)Q.items=O}else if(this.target==="openapi-3.0"){if(Q.items={anyOf:M},O)Q.items.anyOf.push(O);if(Q.minItems=M.length,!O)Q.maxItems=M.length}else if(Q.items=M,O)Q.additionalItems=O;let{minimum:S,maximum:T}=J._zod.bag;if(typeof S==="number")Q.minItems=S;if(typeof T==="number")Q.maxItems=T;break}case"record":{let Q=F;if(Q.type="object",this.target==="draft-7"||this.target==="draft-2020-12")Q.propertyNames=this.process(G.keyType,{...z,path:[...z.path,"propertyNames"]});Q.additionalProperties=this.process(G.valueType,{...z,path:[...z.path,"additionalProperties"]});break}case"map":{if(this.unrepresentable==="throw")throw Error("Map cannot be represented in JSON Schema");break}case"set":{if(this.unrepresentable==="throw")throw Error("Set cannot be represented in JSON Schema");break}case"enum":{let Q=F,V=b9(G.entries);if(V.every((v)=>typeof v==="number"))Q.type="number";if(V.every((v)=>typeof v==="string"))Q.type="string";Q.enum=V;break}case"literal":{let Q=F,V=[];for(let v of G.values)if(v===void 0){if(this.unrepresentable==="throw")throw Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof v==="bigint")if(this.unrepresentable==="throw")throw Error("BigInt literals cannot be represented in JSON Schema");else V.push(Number(v));else V.push(v);if(V.length===0);else if(V.length===1){let v=V[0];if(Q.type=v===null?"null":typeof v,this.target==="draft-4"||this.target==="openapi-3.0")Q.enum=[v];else Q.const=v}else{if(V.every((v)=>typeof v==="number"))Q.type="number";if(V.every((v)=>typeof v==="string"))Q.type="string";if(V.every((v)=>typeof v==="boolean"))Q.type="string";if(V.every((v)=>v===null))Q.type="null";Q.enum=V}break}case"file":{let Q=F,V={type:"string",format:"binary",contentEncoding:"binary"},{minimum:v,maximum:M,mime:O}=J._zod.bag;if(v!==void 0)V.minLength=v;if(M!==void 0)V.maxLength=M;if(O)if(O.length===1)V.contentMediaType=O[0],Object.assign(Q,V);else Q.anyOf=O.map((S)=>{return{...V,contentMediaType:S}});else Object.assign(Q,V);break}case"transform":{if(this.unrepresentable==="throw")throw Error("Transforms cannot be represented in JSON Schema");break}case"nullable":{let Q=this.process(G.innerType,z);if(this.target==="openapi-3.0")K.ref=G.innerType,F.nullable=!0;else F.anyOf=[Q,{type:"null"}];break}case"nonoptional":{this.process(G.innerType,z),K.ref=G.innerType;break}case"success":{let Q=F;Q.type="boolean";break}case"default":{this.process(G.innerType,z),K.ref=G.innerType,F.default=JSON.parse(JSON.stringify(G.defaultValue));break}case"prefault":{if(this.process(G.innerType,z),K.ref=G.innerType,this.io==="input")F._prefault=JSON.parse(JSON.stringify(G.defaultValue));break}case"catch":{this.process(G.innerType,z),K.ref=G.innerType;let Q;try{Q=G.catchValue(void 0)}catch{throw Error("Dynamic catch values are not supported in JSON Schema")}F.default=Q;break}case"nan":{if(this.unrepresentable==="throw")throw Error("NaN cannot be represented in JSON Schema");break}case"template_literal":{let Q=F,V=J._zod.pattern;if(!V)throw Error("Pattern not found in template literal");Q.type="string",Q.pattern=V.source;break}case"pipe":{let Q=this.io==="input"?G.in._zod.def.type==="transform"?G.out:G.in:G.out;this.process(Q,z),K.ref=Q;break}case"readonly":{this.process(G.innerType,z),K.ref=G.innerType,F.readOnly=!0;break}case"promise":{this.process(G.innerType,z),K.ref=G.innerType;break}case"optional":{this.process(G.innerType,z),K.ref=G.innerType;break}case"lazy":{let Q=J._zod.innerType;this.process(Q,z),K.ref=Q;break}case"custom":{if(this.unrepresentable==="throw")throw Error("Custom types cannot be represented in JSON Schema");break}case"function":{if(this.unrepresentable==="throw")throw Error("Function types cannot be represented in JSON Schema");break}default:}}}let H=this.metadataRegistry.get(J);if(H)Object.assign(K.schema,H);if(this.io==="input"&&y4(J))delete K.schema.examples,delete K.schema.default;if(this.io==="input"&&K.schema._prefault)(X=K.schema).default??(X.default=K.schema._prefault);return delete K.schema._prefault,this.seen.get(J).schema}emit(J,W){let X={cycles:W?.cycles??"ref",reused:W?.reused??"inline",external:W?.external??void 0},G=this.seen.get(J);if(!G)throw Error("Unprocessed schema. This is a bug in Zod.");let Y=(Z)=>{let z=this.target==="draft-2020-12"?"$defs":"definitions";if(X.external){let V=X.external.registry.get(Z[0])?.id,v=X.external.uri??((O)=>O);if(V)return{ref:v(V)};let M=Z[1].defId??Z[1].schema.id??`schema${this.counter++}`;return Z[1].defId=M,{defId:M,ref:`${v("__shared")}#/${z}/${M}`}}if(Z[1]===G)return{ref:"#"};let F=`${"#"}/${z}/`,Q=Z[1].schema.id??`__schema${this.counter++}`;return{defId:Q,ref:F+Q}},$=(Z)=>{if(Z[1].schema.$ref)return;let z=Z[1],{ref:N,defId:F}=Y(Z);if(z.def={...z.schema},F)z.defId=F;let Q=z.schema;for(let V in Q)delete Q[V];Q.$ref=N};if(X.cycles==="throw")for(let Z of this.seen.entries()){let z=Z[1];if(z.cycle)throw Error(`Cycle detected: #/${z.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let Z of this.seen.entries()){let z=Z[1];if(J===Z[0]){$(Z);continue}if(X.external){let F=X.external.registry.get(Z[0])?.id;if(J!==Z[0]&&F){$(Z);continue}}if(this.metadataRegistry.get(Z[0])?.id){$(Z);continue}if(z.cycle){$(Z);continue}if(z.count>1){if(X.reused==="ref"){$(Z);continue}}}let K=(Z,z)=>{let N=this.seen.get(Z),F=N.def??N.schema,Q={...F};if(N.ref===null)return;let V=N.ref;if(N.ref=null,V){K(V,z);let v=this.seen.get(V).schema;if(v.$ref&&(z.target==="draft-7"||z.target==="draft-4"||z.target==="openapi-3.0"))F.allOf=F.allOf??[],F.allOf.push(v);else Object.assign(F,v),Object.assign(F,Q)}if(!N.isParent)this.override({zodSchema:Z,jsonSchema:F,path:N.path??[]})};for(let Z of[...this.seen.entries()].reverse())K(Z[0],{target:this.target});let w={};if(this.target==="draft-2020-12")w.$schema="https://json-schema.org/draft/2020-12/schema";else if(this.target==="draft-7")w.$schema="http://json-schema.org/draft-07/schema#";else if(this.target==="draft-4")w.$schema="http://json-schema.org/draft-04/schema#";else if(this.target==="openapi-3.0");else console.warn(`Invalid target: ${this.target}`);if(X.external?.uri){let Z=X.external.registry.get(J)?.id;if(!Z)throw Error("Schema is missing an `id` property");w.$id=X.external.uri(Z)}Object.assign(w,G.def);let H=X.external?.defs??{};for(let Z of this.seen.entries()){let z=Z[1];if(z.def&&z.defId)H[z.defId]=z.def}if(X.external);else if(Object.keys(H).length>0)if(this.target==="draft-2020-12")w.$defs=H;else w.definitions=H;try{return JSON.parse(JSON.stringify(w))}catch(Z){throw Error("Error converting schema to JSON.")}}}function iw(J,W){if(J instanceof i9){let G=new rw(W),Y={};for(let w of J._idmap.entries()){let[H,Z]=w;G.process(Z)}let $={},K={registry:J,uri:W?.uri,defs:Y};for(let w of J._idmap.entries()){let[H,Z]=w;$[H]=G.emit(Z,{...W,external:K})}if(Object.keys(Y).length>0){let w=G.target==="draft-2020-12"?"$defs":"definitions";$.__shared={[w]:Y}}return{schemas:$}}let X=new rw(W);return X.process(J),X.emit(J,W)}function y4(J,W){let X=W??{seen:new Set};if(X.seen.has(J))return!1;X.seen.add(J);let Y=J._zod.def;switch(Y.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":return!1;case"array":return y4(Y.element,X);case"object":{for(let $ in Y.shape)if(y4(Y.shape[$],X))return!0;return!1}case"union":{for(let $ of Y.options)if(y4($,X))return!0;return!1}case"intersection":return y4(Y.left,X)||y4(Y.right,X);case"tuple":{for(let $ of Y.items)if(y4($,X))return!0;if(Y.rest&&y4(Y.rest,X))return!0;return!1}case"record":return y4(Y.keyType,X)||y4(Y.valueType,X);case"map":return y4(Y.keyType,X)||y4(Y.valueType,X);case"set":return y4(Y.valueType,X);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":return y4(Y.innerType,X);case"lazy":return y4(Y.getter(),X);case"default":return y4(Y.innerType,X);case"prefault":return y4(Y.innerType,X);case"custom":return!1;case"transform":return!0;case"pipe":return y4(Y.in,X)||y4(Y.out,X);case"success":return!1;case"catch":return!1;case"function":return!1;default:}throw Error(`Unknown schema type: ${Y.type}`)}var q2=D(()=>{OL();Y6()});var B2={};var A2=()=>{};var TJ={};s0(TJ,{version:()=>LU,util:()=>d,treeifyError:()=>nK,toJSONSchema:()=>iw,toDotPath:()=>ZT,safeParseAsync:()=>ON,safeParse:()=>MN,safeEncodeAsync:()=>Zm,safeEncode:()=>wm,safeDecodeAsync:()=>zm,safeDecode:()=>Hm,registry:()=>a9,regexes:()=>Q8,prettifyError:()=>rK,parseAsync:()=>aK,parse:()=>iK,locales:()=>EY,isValidJWT:()=>BT,isValidBase64URL:()=>qT,isValidBase64:()=>gU,globalRegistry:()=>YJ,globalConfig:()=>C9,formatError:()=>_Y,flattenError:()=>jY,encodeAsync:()=>$m,encode:()=>Ym,decodeAsync:()=>Km,decode:()=>Gm,config:()=>I4,clone:()=>v0,_xid:()=>Cw,_void:()=>nL,_uuidv7:()=>Tw,_uuidv6:()=>Sw,_uuidv4:()=>_w,_uuid:()=>jw,_url:()=>o9,_uppercase:()=>bY,_unknown:()=>pL,_union:()=>hy,_undefined:()=>uL,_ulid:()=>Rw,_uint64:()=>yL,_uint32:()=>bL,_tuple:()=>my,_trim:()=>yY,_transform:()=>dy,_toUpperCase:()=>uY,_toLowerCase:()=>xY,_templateLiteral:()=>Jx,_symbol:()=>xL,_superRefine:()=>JV,_success:()=>ty,_stringbool:()=>WV,_stringFormat:()=>lY,_string:()=>PL,_startsWith:()=>hY,_size:()=>RY,_set:()=>uy,_safeParseAsync:()=>BY,_safeParse:()=>qY,_safeEncodeAsync:()=>Xw,_safeEncode:()=>Jw,_safeDecodeAsync:()=>Yw,_safeDecode:()=>Ww,_regex:()=>CY,_refine:()=>eL,_record:()=>yy,_readonly:()=>ey,_property:()=>nw,_promise:()=>Xx,_positive:()=>lw,_pipe:()=>sy,_parseAsync:()=>TY,_parse:()=>SY,_overwrite:()=>SJ,_optional:()=>ny,_number:()=>BL,_nullable:()=>ry,_null:()=>lL,_normalize:()=>mY,_nonpositive:()=>pw,_nonoptional:()=>ay,_nonnegative:()=>dw,_never:()=>dL,_negative:()=>cw,_nativeEnum:()=>cy,_nanoid:()=>Bw,_nan:()=>aL,_multipleOf:()=>iW,_minSize:()=>aW,_minLength:()=>wW,_min:()=>k0,_mime:()=>gY,_maxSize:()=>pX,_maxLength:()=>dX,_max:()=>L8,_map:()=>xy,_lte:()=>L8,_lt:()=>jJ,_lowercase:()=>IY,_literal:()=>py,_length:()=>nX,_lazy:()=>Wx,_ksuid:()=>Iw,_jwt:()=>xw,_isoTime:()=>TL,_isoDuration:()=>qL,_isoDateTime:()=>_L,_isoDate:()=>SL,_ipv6:()=>kw,_ipv4:()=>bw,_intersection:()=>gy,_int64:()=>mL,_int32:()=>IL,_int:()=>EL,_includes:()=>kY,_guid:()=>t9,_gte:()=>k0,_gt:()=>_J,_float64:()=>CL,_float32:()=>RL,_file:()=>oL,_enum:()=>ly,_endsWith:()=>fY,_encodeAsync:()=>sK,_encode:()=>tK,_emoji:()=>qw,_email:()=>Pw,_e164:()=>yw,_discriminatedUnion:()=>fy,_default:()=>iy,_decodeAsync:()=>eK,_decode:()=>oK,_date:()=>rL,_custom:()=>sL,_cuid2:()=>Ew,_cuid:()=>Aw,_coercedString:()=>jL,_coercedNumber:()=>AL,_coercedDate:()=>iL,_coercedBoolean:()=>hL,_coercedBigint:()=>gL,_cidrv6:()=>fw,_cidrv4:()=>hw,_check:()=>S2,_catch:()=>oy,_boolean:()=>kL,_bigint:()=>fL,_base64url:()=>mw,_base64:()=>gw,_array:()=>tL,_any:()=>cL,TimePrecision:()=>uw,NEVER:()=>lK,JSONSchemaGenerator:()=>rw,JSONSchema:()=>B2,Doc:()=>Zw,$output:()=>Mw,$input:()=>Ow,$constructor:()=>I,$brand:()=>cK,$ZodXID:()=>BU,$ZodVoid:()=>oU,$ZodUnknown:()=>aU,$ZodUnion:()=>Dw,$ZodUndefined:()=>nU,$ZodUUID:()=>MU,$ZodURL:()=>PU,$ZodULID:()=>qU,$ZodType:()=>N6,$ZodTuple:()=>vw,$ZodTransform:()=>ZQ,$ZodTemplateLiteral:()=>OQ,$ZodSymbol:()=>dU,$ZodSuccess:()=>LQ,$ZodStringFormat:()=>K4,$ZodString:()=>cX,$ZodSet:()=>$Q,$ZodRegistry:()=>i9,$ZodRecord:()=>YQ,$ZodRealError:()=>r0,$ZodReadonly:()=>MQ,$ZodPromise:()=>jQ,$ZodPrefault:()=>UQ,$ZodPipe:()=>vQ,$ZodOptional:()=>zQ,$ZodObjectJIT:()=>JQ,$ZodObject:()=>RT,$ZodNumberFormat:()=>cU,$ZodNumber:()=>Lw,$ZodNullable:()=>FQ,$ZodNull:()=>rU,$ZodNonOptional:()=>QQ,$ZodNever:()=>tU,$ZodNanoID:()=>_U,$ZodNaN:()=>DQ,$ZodMap:()=>GQ,$ZodLiteral:()=>wQ,$ZodLazy:()=>_Q,$ZodKSUID:()=>AU,$ZodJWT:()=>uU,$ZodIntersection:()=>XQ,$ZodISOTime:()=>CU,$ZodISODuration:()=>IU,$ZodISODateTime:()=>EU,$ZodISODate:()=>RU,$ZodIPv6:()=>kU,$ZodIPv4:()=>bU,$ZodGUID:()=>vU,$ZodFunction:()=>PQ,$ZodFile:()=>HQ,$ZodError:()=>m9,$ZodEnum:()=>KQ,$ZodEncodeError:()=>xX,$ZodEmoji:()=>jU,$ZodEmail:()=>OU,$ZodE164:()=>xU,$ZodDiscriminatedUnion:()=>WQ,$ZodDefault:()=>NQ,$ZodDate:()=>sU,$ZodCustomStringFormat:()=>lU,$ZodCustom:()=>SQ,$ZodCodec:()=>l9,$ZodCheckUpperCase:()=>HU,$ZodCheckStringFormat:()=>AY,$ZodCheckStartsWith:()=>zU,$ZodCheckSizeEquals:()=>XU,$ZodCheckRegex:()=>KU,$ZodCheckProperty:()=>NU,$ZodCheckOverwrite:()=>QU,$ZodCheckNumberFormat:()=>sN,$ZodCheckMultipleOf:()=>oN,$ZodCheckMinSize:()=>WU,$ZodCheckMinLength:()=>GU,$ZodCheckMimeType:()=>UU,$ZodCheckMaxSize:()=>JU,$ZodCheckMaxLength:()=>YU,$ZodCheckLowerCase:()=>wU,$ZodCheckLessThan:()=>Kw,$ZodCheckLengthEquals:()=>$U,$ZodCheckIncludes:()=>ZU,$ZodCheckGreaterThan:()=>ww,$ZodCheckEndsWith:()=>FU,$ZodCheckBigIntFormat:()=>eN,$ZodCheck:()=>L4,$ZodCatch:()=>VQ,$ZodCUID2:()=>TU,$ZodCUID:()=>SU,$ZodCIDRv6:()=>fU,$ZodCIDRv4:()=>hU,$ZodBoolean:()=>u9,$ZodBigIntFormat:()=>pU,$ZodBigInt:()=>Vw,$ZodBase64URL:()=>yU,$ZodBase64:()=>mU,$ZodAsyncError:()=>OJ,$ZodArray:()=>eU,$ZodAny:()=>iU});var V8=D(()=>{Y6();$w();ML();A2();vY();PN();vN();TQ();Hw();VU();OL();T2();q2()});var XV=D(()=>{V8()});var X$={};s0(X$,{time:()=>$V,duration:()=>KV,datetime:()=>YV,date:()=>GV,ZodISOTime:()=>J$,ZodISODuration:()=>W$,ZodISODateTime:()=>s9,ZodISODate:()=>e9});function YV(J){return _L(s9,J)}function GV(J){return SL(e9,J)}function $V(J){return TL(J$,J)}function KV(J){return qL(W$,J)}var s9,e9,J$,W$;var aw=D(()=>{V8();tw();s9=I("ZodISODateTime",(J,W)=>{EU.init(J,W),w4.init(J,W)});e9=I("ZodISODate",(J,W)=>{RU.init(J,W),w4.init(J,W)});J$=I("ZodISOTime",(J,W)=>{CU.init(J,W),w4.init(J,W)});W$=I("ZodISODuration",(J,W)=>{IU.init(J,W),w4.init(J,W)})});var R2=(J,W)=>{m9.init(J,W),J.name="ZodError",Object.defineProperties(J,{format:{value:(X)=>_Y(J,X)},flatten:{value:(X)=>jY(J,X)},addIssue:{value:(X)=>{J.issues.push(X),J.message=JSON.stringify(J.issues,MY,2)}},addIssues:{value:(X)=>{J.issues.push(...X),J.message=JSON.stringify(J.issues,MY,2)}},isEmpty:{get(){return J.issues.length===0}}})},C2,h0;var wV=D(()=>{V8();V8();Y6();C2=I("ZodError",R2),h0=I("ZodError",R2,{Parent:Error})});var ow,sw,ew,J7,W7,X7,Y7,G7,$7,K7,w7,H7;var HV=D(()=>{V8();wV();ow=SY(h0),sw=TY(h0),ew=qY(h0),J7=BY(h0),W7=tK(h0),X7=oK(h0),Y7=sK(h0),G7=eK(h0),$7=Jw(h0),K7=Ww(h0),w7=Xw(h0),H7=Yw(h0)});function P(J){return PL(pY,J)}function D8(J){return Pw(F7,J)}function I2(J){return t9(Y$,J)}function b2(J){return jw(qJ,J)}function k2(J){return _w(qJ,J)}function h2(J){return Sw(qJ,J)}function f2(J){return Tw(qJ,J)}function g2(J){return o9(K$,J)}function m2(J){return o9(K$,{protocol:/^https?$/,hostname:Q8.domain,...d.normalizeParams(J)})}function y2(J){return qw(N7,J)}function x2(J){return Bw(U7,J)}function u2(J){return Aw(Q7,J)}function l2(J){return Ew(L7,J)}function c2(J){return Rw(V7,J)}function p2(J){return Cw(D7,J)}function d2(J){return Iw(v7,J)}function O7(J){return bw(M7,J)}function j7(J){return kw(P7,J)}function n2(J){return hw(_7,J)}function r2(J){return fw(S7,J)}function i2(J){return gw(T7,J)}function a2(J){return mw(q7,J)}function t2(J){return yw(B7,J)}function o2(J){return xw(A7,J)}function s2(J,W,X={}){return lY(dY,J,W,X)}function e2(J){return lY(dY,"hostname",Q8.hostname,J)}function Jq(J){return lY(dY,"hex",Q8.hex,J)}function Wq(J,W){let X=W?.enc??"hex",G=`${J}_${X}`,Y=Q8[G];if(!Y)throw Error(`Unrecognized hash format: ${G}`);return lY(dY,G,Y,W)}function O6(J){return BL(nY,J)}function Z7(J){return EL(rX,J)}function Xq(J){return RL(rX,J)}function Yq(J){return CL(rX,J)}function Gq(J){return IL(rX,J)}function $q(J){return bL(rX,J)}function d6(J){return kL(rY,J)}function Kq(J){return fL(iY,J)}function wq(J){return mL(E7,J)}function Hq(J){return yL(E7,J)}function Zq(J){return xL(ZV,J)}function tW(J){return uL(zV,J)}function NV(J){return lL(FV,J)}function E6(){return cL(UV)}function HW(){return pL(QV)}function R7(J){return dL(LV,J)}function zq(J){return nL(VV,J)}function V4(J){return rL(w$,J)}function v6(J,W){return tL(DV,J,W)}function Fq(J){let W=J._zod.def.shape;return H4(Object.keys(W))}function x(J,W){let X={type:"object",shape:J??{},...d.normalizeParams(W)};return new ZW(X)}function Nq(J,W){return new ZW({type:"object",shape:J,catchall:R7(),...d.normalizeParams(W)})}function C7(J,W){return new ZW({type:"object",shape:J,catchall:HW(),...d.normalizeParams(W)})}function a4(J,W){return new I7({type:"union",options:J,...d.normalizeParams(W)})}function Uq(J,W,X){return new vV({type:"union",options:W,discriminator:J,...d.normalizeParams(X)})}function OV(J,W){return new MV({type:"intersection",left:J,right:W})}function jV(J,W,X){let G=W instanceof N6,Y=G?X:W;return new PV({type:"tuple",items:J,rest:G?W:null,...d.normalizeParams(Y)})}function _6(J,W,X){return new b7({type:"record",keyType:J,valueType:W,...d.normalizeParams(X)})}function Qq(J,W,X){let G=v0(J);return G._zod.values=void 0,new b7({type:"record",keyType:G,valueType:W,...d.normalizeParams(X)})}function Lq(J,W,X){return new _V({type:"map",keyType:J,valueType:W,...d.normalizeParams(X)})}function Vq(J,W){return new SV({type:"set",valueType:J,...d.normalizeParams(W)})}function H4(J,W){let X=Array.isArray(J)?Object.fromEntries(J.map((G)=>[G,G])):J;return new cY({type:"enum",entries:X,...d.normalizeParams(W)})}function Dq(J,W){return new cY({type:"enum",entries:J,...d.normalizeParams(W)})}function qV(J,W){return new TV({type:"literal",values:Array.isArray(J)?J:[J],...d.normalizeParams(W)})}function vq(J){return oL(BV,J)}function k7(J){return new AV({type:"transform",transform:J})}function M0(J){return new BJ({type:"optional",innerType:J})}function G$(J){return new EV({type:"nullable",innerType:J})}function Mq(J){return M0(G$(J))}function CV(J,W){return new RV({type:"default",innerType:J,get defaultValue(){return typeof W==="function"?W():d.shallowClone(W)}})}function bV(J,W){return new IV({type:"prefault",innerType:J,get defaultValue(){return typeof W==="function"?W():d.shallowClone(W)}})}function kV(J,W){return new h7({type:"nonoptional",innerType:J,...d.normalizeParams(W)})}function Oq(J){return new hV({type:"success",innerType:J})}function gV(J,W){return new fV({type:"catch",innerType:J,catchValue:typeof W==="function"?W:()=>W})}function Pq(J){return aL(mV,J)}function $$(J,W){return new f7({type:"pipe",in:J,out:W})}function jq(J,W,X){return new g7({type:"pipe",in:J,out:W,transform:X.decode,reverseTransform:X.encode})}function xV(J){return new yV({type:"readonly",innerType:J})}function _q(J,W){return new uV({type:"template_literal",parts:J,...d.normalizeParams(W)})}function cV(J){return new lV({type:"lazy",getter:J})}function Sq(J){return new pV({type:"promise",innerType:J})}function Tq(J){return new dV({type:"function",input:Array.isArray(J?.input)?jV(J?.input):J?.input??v6(HW()),output:J?.output??HW()})}function qq(J){let W=new L4({check:"custom"});return W._zod.check=J,W}function zW(J,W){return sL(H$,J??(()=>!0),W)}function nV(J,W={}){return eL(H$,J,W)}function rV(J){return JV(J)}function Bq(J,W={error:`Input not instance of ${J.name}`}){let X=new H$({type:"custom",check:"custom",fn:(G)=>G instanceof J,abort:!0,...d.normalizeParams(W)});return X._zod.bag.Class=J,X}function Z$(J){let W=cV(()=>{return a4([P(J),O6(),d6(),NV(),v6(W),_6(P(),W)])});return W}function Eq(J,W){return $$(k7(J),W)}var Q6,z7,pY,w4,F7,Y$,qJ,K$,N7,U7,Q7,L7,V7,D7,v7,M7,P7,_7,S7,T7,q7,B7,A7,dY,nY,rX,rY,iY,E7,ZV,zV,FV,UV,QV,LV,VV,w$,DV,ZW,I7,vV,MV,PV,b7,_V,SV,cY,TV,BV,AV,BJ,EV,RV,IV,h7,hV,fV,mV,f7,g7,yV,uV,lV,pV,dV,H$,Aq=(...J)=>WV({Codec:g7,Boolean:rY,String:pY},...J);var tw=D(()=>{V8();V8();XV();aw();HV();Q6=I("ZodType",(J,W)=>{return N6.init(J,W),J.def=W,J.type=W.type,Object.defineProperty(J,"_def",{value:W}),J.check=(...X)=>{return J.clone(d.mergeDefs(W,{checks:[...W.checks??[],...X.map((G)=>typeof G==="function"?{_zod:{check:G,def:{check:"custom"},onattach:[]}}:G)]}))},J.clone=(X,G)=>v0(J,X,G),J.brand=()=>J,J.register=(X,G)=>{return X.add(J,G),J},J.parse=(X,G)=>ow(J,X,G,{callee:J.parse}),J.safeParse=(X,G)=>ew(J,X,G),J.parseAsync=async(X,G)=>sw(J,X,G,{callee:J.parseAsync}),J.safeParseAsync=async(X,G)=>J7(J,X,G),J.spa=J.safeParseAsync,J.encode=(X,G)=>W7(J,X,G),J.decode=(X,G)=>X7(J,X,G),J.encodeAsync=async(X,G)=>Y7(J,X,G),J.decodeAsync=async(X,G)=>G7(J,X,G),J.safeEncode=(X,G)=>$7(J,X,G),J.safeDecode=(X,G)=>K7(J,X,G),J.safeEncodeAsync=async(X,G)=>w7(J,X,G),J.safeDecodeAsync=async(X,G)=>H7(J,X,G),J.refine=(X,G)=>J.check(nV(X,G)),J.superRefine=(X)=>J.check(rV(X)),J.overwrite=(X)=>J.check(SJ(X)),J.optional=()=>M0(J),J.nullable=()=>G$(J),J.nullish=()=>M0(G$(J)),J.nonoptional=(X)=>kV(J,X),J.array=()=>v6(J),J.or=(X)=>a4([J,X]),J.and=(X)=>OV(J,X),J.transform=(X)=>$$(J,k7(X)),J.default=(X)=>CV(J,X),J.prefault=(X)=>bV(J,X),J.catch=(X)=>gV(J,X),J.pipe=(X)=>$$(J,X),J.readonly=()=>xV(J),J.describe=(X)=>{let G=J.clone();return YJ.add(G,{description:X}),G},Object.defineProperty(J,"description",{get(){return YJ.get(J)?.description},configurable:!0}),J.meta=(...X)=>{if(X.length===0)return YJ.get(J);let G=J.clone();return YJ.add(G,X[0]),G},J.isOptional=()=>J.safeParse(void 0).success,J.isNullable=()=>J.safeParse(null).success,J}),z7=I("_ZodString",(J,W)=>{cX.init(J,W),Q6.init(J,W);let X=J._zod.bag;J.format=X.format??null,J.minLength=X.minimum??null,J.maxLength=X.maximum??null,J.regex=(...G)=>J.check(CY(...G)),J.includes=(...G)=>J.check(kY(...G)),J.startsWith=(...G)=>J.check(hY(...G)),J.endsWith=(...G)=>J.check(fY(...G)),J.min=(...G)=>J.check(wW(...G)),J.max=(...G)=>J.check(dX(...G)),J.length=(...G)=>J.check(nX(...G)),J.nonempty=(...G)=>J.check(wW(1,...G)),J.lowercase=(G)=>J.check(IY(G)),J.uppercase=(G)=>J.check(bY(G)),J.trim=()=>J.check(yY()),J.normalize=(...G)=>J.check(mY(...G)),J.toLowerCase=()=>J.check(xY()),J.toUpperCase=()=>J.check(uY())}),pY=I("ZodString",(J,W)=>{cX.init(J,W),z7.init(J,W),J.email=(X)=>J.check(Pw(F7,X)),J.url=(X)=>J.check(o9(K$,X)),J.jwt=(X)=>J.check(xw(A7,X)),J.emoji=(X)=>J.check(qw(N7,X)),J.guid=(X)=>J.check(t9(Y$,X)),J.uuid=(X)=>J.check(jw(qJ,X)),J.uuidv4=(X)=>J.check(_w(qJ,X)),J.uuidv6=(X)=>J.check(Sw(qJ,X)),J.uuidv7=(X)=>J.check(Tw(qJ,X)),J.nanoid=(X)=>J.check(Bw(U7,X)),J.guid=(X)=>J.check(t9(Y$,X)),J.cuid=(X)=>J.check(Aw(Q7,X)),J.cuid2=(X)=>J.check(Ew(L7,X)),J.ulid=(X)=>J.check(Rw(V7,X)),J.base64=(X)=>J.check(gw(T7,X)),J.base64url=(X)=>J.check(mw(q7,X)),J.xid=(X)=>J.check(Cw(D7,X)),J.ksuid=(X)=>J.check(Iw(v7,X)),J.ipv4=(X)=>J.check(bw(M7,X)),J.ipv6=(X)=>J.check(kw(P7,X)),J.cidrv4=(X)=>J.check(hw(_7,X)),J.cidrv6=(X)=>J.check(fw(S7,X)),J.e164=(X)=>J.check(yw(B7,X)),J.datetime=(X)=>J.check(YV(X)),J.date=(X)=>J.check(GV(X)),J.time=(X)=>J.check($V(X)),J.duration=(X)=>J.check(KV(X))});w4=I("ZodStringFormat",(J,W)=>{K4.init(J,W),z7.init(J,W)}),F7=I("ZodEmail",(J,W)=>{OU.init(J,W),w4.init(J,W)});Y$=I("ZodGUID",(J,W)=>{vU.init(J,W),w4.init(J,W)});qJ=I("ZodUUID",(J,W)=>{MU.init(J,W),w4.init(J,W)});K$=I("ZodURL",(J,W)=>{PU.init(J,W),w4.init(J,W)});N7=I("ZodEmoji",(J,W)=>{jU.init(J,W),w4.init(J,W)});U7=I("ZodNanoID",(J,W)=>{_U.init(J,W),w4.init(J,W)});Q7=I("ZodCUID",(J,W)=>{SU.init(J,W),w4.init(J,W)});L7=I("ZodCUID2",(J,W)=>{TU.init(J,W),w4.init(J,W)});V7=I("ZodULID",(J,W)=>{qU.init(J,W),w4.init(J,W)});D7=I("ZodXID",(J,W)=>{BU.init(J,W),w4.init(J,W)});v7=I("ZodKSUID",(J,W)=>{AU.init(J,W),w4.init(J,W)});M7=I("ZodIPv4",(J,W)=>{bU.init(J,W),w4.init(J,W)});P7=I("ZodIPv6",(J,W)=>{kU.init(J,W),w4.init(J,W)});_7=I("ZodCIDRv4",(J,W)=>{hU.init(J,W),w4.init(J,W)});S7=I("ZodCIDRv6",(J,W)=>{fU.init(J,W),w4.init(J,W)});T7=I("ZodBase64",(J,W)=>{mU.init(J,W),w4.init(J,W)});q7=I("ZodBase64URL",(J,W)=>{yU.init(J,W),w4.init(J,W)});B7=I("ZodE164",(J,W)=>{xU.init(J,W),w4.init(J,W)});A7=I("ZodJWT",(J,W)=>{uU.init(J,W),w4.init(J,W)});dY=I("ZodCustomStringFormat",(J,W)=>{lU.init(J,W),w4.init(J,W)});nY=I("ZodNumber",(J,W)=>{Lw.init(J,W),Q6.init(J,W),J.gt=(G,Y)=>J.check(_J(G,Y)),J.gte=(G,Y)=>J.check(k0(G,Y)),J.min=(G,Y)=>J.check(k0(G,Y)),J.lt=(G,Y)=>J.check(jJ(G,Y)),J.lte=(G,Y)=>J.check(L8(G,Y)),J.max=(G,Y)=>J.check(L8(G,Y)),J.int=(G)=>J.check(Z7(G)),J.safe=(G)=>J.check(Z7(G)),J.positive=(G)=>J.check(_J(0,G)),J.nonnegative=(G)=>J.check(k0(0,G)),J.negative=(G)=>J.check(jJ(0,G)),J.nonpositive=(G)=>J.check(L8(0,G)),J.multipleOf=(G,Y)=>J.check(iW(G,Y)),J.step=(G,Y)=>J.check(iW(G,Y)),J.finite=()=>J;let X=J._zod.bag;J.minValue=Math.max(X.minimum??Number.NEGATIVE_INFINITY,X.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,J.maxValue=Math.min(X.maximum??Number.POSITIVE_INFINITY,X.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,J.isInt=(X.format??"").includes("int")||Number.isSafeInteger(X.multipleOf??0.5),J.isFinite=!0,J.format=X.format??null});rX=I("ZodNumberFormat",(J,W)=>{cU.init(J,W),nY.init(J,W)});rY=I("ZodBoolean",(J,W)=>{u9.init(J,W),Q6.init(J,W)});iY=I("ZodBigInt",(J,W)=>{Vw.init(J,W),Q6.init(J,W),J.gte=(G,Y)=>J.check(k0(G,Y)),J.min=(G,Y)=>J.check(k0(G,Y)),J.gt=(G,Y)=>J.check(_J(G,Y)),J.gte=(G,Y)=>J.check(k0(G,Y)),J.min=(G,Y)=>J.check(k0(G,Y)),J.lt=(G,Y)=>J.check(jJ(G,Y)),J.lte=(G,Y)=>J.check(L8(G,Y)),J.max=(G,Y)=>J.check(L8(G,Y)),J.positive=(G)=>J.check(_J(BigInt(0),G)),J.negative=(G)=>J.check(jJ(BigInt(0),G)),J.nonpositive=(G)=>J.check(L8(BigInt(0),G)),J.nonnegative=(G)=>J.check(k0(BigInt(0),G)),J.multipleOf=(G,Y)=>J.check(iW(G,Y));let X=J._zod.bag;J.minValue=X.minimum??null,J.maxValue=X.maximum??null,J.format=X.format??null});E7=I("ZodBigIntFormat",(J,W)=>{pU.init(J,W),iY.init(J,W)});ZV=I("ZodSymbol",(J,W)=>{dU.init(J,W),Q6.init(J,W)});zV=I("ZodUndefined",(J,W)=>{nU.init(J,W),Q6.init(J,W)});FV=I("ZodNull",(J,W)=>{rU.init(J,W),Q6.init(J,W)});UV=I("ZodAny",(J,W)=>{iU.init(J,W),Q6.init(J,W)});QV=I("ZodUnknown",(J,W)=>{aU.init(J,W),Q6.init(J,W)});LV=I("ZodNever",(J,W)=>{tU.init(J,W),Q6.init(J,W)});VV=I("ZodVoid",(J,W)=>{oU.init(J,W),Q6.init(J,W)});w$=I("ZodDate",(J,W)=>{sU.init(J,W),Q6.init(J,W),J.min=(G,Y)=>J.check(k0(G,Y)),J.max=(G,Y)=>J.check(L8(G,Y));let X=J._zod.bag;J.minDate=X.minimum?new Date(X.minimum):null,J.maxDate=X.maximum?new Date(X.maximum):null});DV=I("ZodArray",(J,W)=>{eU.init(J,W),Q6.init(J,W),J.element=W.element,J.min=(X,G)=>J.check(wW(X,G)),J.nonempty=(X)=>J.check(wW(1,X)),J.max=(X,G)=>J.check(dX(X,G)),J.length=(X,G)=>J.check(nX(X,G)),J.unwrap=()=>J.element});ZW=I("ZodObject",(J,W)=>{JQ.init(J,W),Q6.init(J,W),d.defineLazy(J,"shape",()=>{return W.shape}),J.keyof=()=>H4(Object.keys(J._zod.def.shape)),J.catchall=(X)=>J.clone({...J._zod.def,catchall:X}),J.passthrough=()=>J.clone({...J._zod.def,catchall:HW()}),J.loose=()=>J.clone({...J._zod.def,catchall:HW()}),J.strict=()=>J.clone({...J._zod.def,catchall:R7()}),J.strip=()=>J.clone({...J._zod.def,catchall:void 0}),J.extend=(X)=>{return d.extend(J,X)},J.safeExtend=(X)=>{return d.safeExtend(J,X)},J.merge=(X)=>d.merge(J,X),J.pick=(X)=>d.pick(J,X),J.omit=(X)=>d.omit(J,X),J.partial=(...X)=>d.partial(BJ,J,X[0]),J.required=(...X)=>d.required(h7,J,X[0])});I7=I("ZodUnion",(J,W)=>{Dw.init(J,W),Q6.init(J,W),J.options=W.options});vV=I("ZodDiscriminatedUnion",(J,W)=>{I7.init(J,W),WQ.init(J,W)});MV=I("ZodIntersection",(J,W)=>{XQ.init(J,W),Q6.init(J,W)});PV=I("ZodTuple",(J,W)=>{vw.init(J,W),Q6.init(J,W),J.rest=(X)=>J.clone({...J._zod.def,rest:X})});b7=I("ZodRecord",(J,W)=>{YQ.init(J,W),Q6.init(J,W),J.keyType=W.keyType,J.valueType=W.valueType});_V=I("ZodMap",(J,W)=>{GQ.init(J,W),Q6.init(J,W),J.keyType=W.keyType,J.valueType=W.valueType});SV=I("ZodSet",(J,W)=>{$Q.init(J,W),Q6.init(J,W),J.min=(...X)=>J.check(aW(...X)),J.nonempty=(X)=>J.check(aW(1,X)),J.max=(...X)=>J.check(pX(...X)),J.size=(...X)=>J.check(RY(...X))});cY=I("ZodEnum",(J,W)=>{KQ.init(J,W),Q6.init(J,W),J.enum=W.entries,J.options=Object.values(W.entries);let X=new Set(Object.keys(W.entries));J.extract=(G,Y)=>{let $={};for(let K of G)if(X.has(K))$[K]=W.entries[K];else throw Error(`Key ${K} not found in enum`);return new cY({...W,checks:[],...d.normalizeParams(Y),entries:$})},J.exclude=(G,Y)=>{let $={...W.entries};for(let K of G)if(X.has(K))delete $[K];else throw Error(`Key ${K} not found in enum`);return new cY({...W,checks:[],...d.normalizeParams(Y),entries:$})}});TV=I("ZodLiteral",(J,W)=>{wQ.init(J,W),Q6.init(J,W),J.values=new Set(W.values),Object.defineProperty(J,"value",{get(){if(W.values.length>1)throw Error("This schema contains multiple valid literal values. Use `.values` instead.");return W.values[0]}})});BV=I("ZodFile",(J,W)=>{HQ.init(J,W),Q6.init(J,W),J.min=(X,G)=>J.check(aW(X,G)),J.max=(X,G)=>J.check(pX(X,G)),J.mime=(X,G)=>J.check(gY(Array.isArray(X)?X:[X],G))});AV=I("ZodTransform",(J,W)=>{ZQ.init(J,W),Q6.init(J,W),J._zod.parse=(X,G)=>{if(G.direction==="backward")throw new xX(J.constructor.name);X.addIssue=($)=>{if(typeof $==="string")X.issues.push(d.issue($,X.value,W));else{let K=$;if(K.fatal)K.continue=!1;K.code??(K.code="custom"),K.input??(K.input=X.value),K.inst??(K.inst=J),X.issues.push(d.issue(K))}};let Y=W.transform(X.value,X);if(Y instanceof Promise)return Y.then(($)=>{return X.value=$,X});return X.value=Y,X}});BJ=I("ZodOptional",(J,W)=>{zQ.init(J,W),Q6.init(J,W),J.unwrap=()=>J._zod.def.innerType});EV=I("ZodNullable",(J,W)=>{FQ.init(J,W),Q6.init(J,W),J.unwrap=()=>J._zod.def.innerType});RV=I("ZodDefault",(J,W)=>{NQ.init(J,W),Q6.init(J,W),J.unwrap=()=>J._zod.def.innerType,J.removeDefault=J.unwrap});IV=I("ZodPrefault",(J,W)=>{UQ.init(J,W),Q6.init(J,W),J.unwrap=()=>J._zod.def.innerType});h7=I("ZodNonOptional",(J,W)=>{QQ.init(J,W),Q6.init(J,W),J.unwrap=()=>J._zod.def.innerType});hV=I("ZodSuccess",(J,W)=>{LQ.init(J,W),Q6.init(J,W),J.unwrap=()=>J._zod.def.innerType});fV=I("ZodCatch",(J,W)=>{VQ.init(J,W),Q6.init(J,W),J.unwrap=()=>J._zod.def.innerType,J.removeCatch=J.unwrap});mV=I("ZodNaN",(J,W)=>{DQ.init(J,W),Q6.init(J,W)});f7=I("ZodPipe",(J,W)=>{vQ.init(J,W),Q6.init(J,W),J.in=W.in,J.out=W.out});g7=I("ZodCodec",(J,W)=>{f7.init(J,W),l9.init(J,W)});yV=I("ZodReadonly",(J,W)=>{MQ.init(J,W),Q6.init(J,W),J.unwrap=()=>J._zod.def.innerType});uV=I("ZodTemplateLiteral",(J,W)=>{OQ.init(J,W),Q6.init(J,W)});lV=I("ZodLazy",(J,W)=>{_Q.init(J,W),Q6.init(J,W),J.unwrap=()=>J._zod.def.getter()});pV=I("ZodPromise",(J,W)=>{jQ.init(J,W),Q6.init(J,W),J.unwrap=()=>J._zod.def.innerType});dV=I("ZodFunction",(J,W)=>{PQ.init(J,W),Q6.init(J,W)});H$=I("ZodCustom",(J,W)=>{SQ.init(J,W),Q6.init(J,W)})});function Cq(J){I4({customError:J})}function Iq(){return I4().customError}var Rq,m7;var bq=D(()=>{V8();Rq={invalid_type:"invalid_type",too_big:"too_big",too_small:"too_small",invalid_format:"invalid_format",not_multiple_of:"not_multiple_of",unrecognized_keys:"unrecognized_keys",invalid_union:"invalid_union",invalid_key:"invalid_key",invalid_element:"invalid_element",invalid_value:"invalid_value",custom:"custom"};(function(J){})(m7||(m7={}))});var m6={};s0(m6,{string:()=>$x,number:()=>Kx,date:()=>Zx,boolean:()=>wx,bigint:()=>Hx});function $x(J){return jL(pY,J)}function Kx(J){return AL(nY,J)}function wx(J){return hL(rY,J)}function Hx(J){return gL(iY,J)}function Zx(J){return iL(w$,J)}var kq=D(()=>{V8();tw()});var y7={};s0(y7,{xid:()=>p2,void:()=>zq,uuidv7:()=>f2,uuidv6:()=>h2,uuidv4:()=>k2,uuid:()=>b2,util:()=>d,url:()=>g2,uppercase:()=>bY,unknown:()=>HW,union:()=>a4,undefined:()=>tW,ulid:()=>c2,uint64:()=>Hq,uint32:()=>$q,tuple:()=>jV,trim:()=>yY,treeifyError:()=>nK,transform:()=>k7,toUpperCase:()=>uY,toLowerCase:()=>xY,toJSONSchema:()=>iw,templateLiteral:()=>_q,symbol:()=>Zq,superRefine:()=>rV,success:()=>Oq,stringbool:()=>Aq,stringFormat:()=>s2,string:()=>P,strictObject:()=>Nq,startsWith:()=>hY,size:()=>RY,setErrorMap:()=>Cq,set:()=>Vq,safeParseAsync:()=>J7,safeParse:()=>ew,safeEncodeAsync:()=>w7,safeEncode:()=>$7,safeDecodeAsync:()=>H7,safeDecode:()=>K7,registry:()=>a9,regexes:()=>Q8,regex:()=>CY,refine:()=>nV,record:()=>_6,readonly:()=>xV,property:()=>nw,promise:()=>Sq,prettifyError:()=>rK,preprocess:()=>Eq,prefault:()=>bV,positive:()=>lw,pipe:()=>$$,partialRecord:()=>Qq,parseAsync:()=>sw,parse:()=>ow,overwrite:()=>SJ,optional:()=>M0,object:()=>x,number:()=>O6,nullish:()=>Mq,nullable:()=>G$,null:()=>NV,normalize:()=>mY,nonpositive:()=>pw,nonoptional:()=>kV,nonnegative:()=>dw,never:()=>R7,negative:()=>cw,nativeEnum:()=>Dq,nanoid:()=>x2,nan:()=>Pq,multipleOf:()=>iW,minSize:()=>aW,minLength:()=>wW,mime:()=>gY,maxSize:()=>pX,maxLength:()=>dX,map:()=>Lq,lte:()=>L8,lt:()=>jJ,lowercase:()=>IY,looseObject:()=>C7,locales:()=>EY,literal:()=>qV,length:()=>nX,lazy:()=>cV,ksuid:()=>d2,keyof:()=>Fq,jwt:()=>o2,json:()=>Z$,iso:()=>X$,ipv6:()=>j7,ipv4:()=>O7,intersection:()=>OV,int64:()=>wq,int32:()=>Gq,int:()=>Z7,instanceof:()=>Bq,includes:()=>kY,httpUrl:()=>m2,hostname:()=>e2,hex:()=>Jq,hash:()=>Wq,guid:()=>I2,gte:()=>k0,gt:()=>_J,globalRegistry:()=>YJ,getErrorMap:()=>Iq,function:()=>Tq,formatError:()=>_Y,float64:()=>Yq,float32:()=>Xq,flattenError:()=>jY,file:()=>vq,enum:()=>H4,endsWith:()=>fY,encodeAsync:()=>Y7,encode:()=>W7,emoji:()=>y2,email:()=>D8,e164:()=>t2,discriminatedUnion:()=>Uq,decodeAsync:()=>G7,decode:()=>X7,date:()=>V4,custom:()=>zW,cuid2:()=>l2,cuid:()=>u2,core:()=>TJ,config:()=>I4,coerce:()=>m6,codec:()=>jq,clone:()=>v0,cidrv6:()=>r2,cidrv4:()=>n2,check:()=>qq,catch:()=>gV,boolean:()=>d6,bigint:()=>Kq,base64url:()=>a2,base64:()=>i2,array:()=>v6,any:()=>E6,_function:()=>Tq,_default:()=>CV,_ZodString:()=>z7,ZodXID:()=>D7,ZodVoid:()=>VV,ZodUnknown:()=>QV,ZodUnion:()=>I7,ZodUndefined:()=>zV,ZodUUID:()=>qJ,ZodURL:()=>K$,ZodULID:()=>V7,ZodType:()=>Q6,ZodTuple:()=>PV,ZodTransform:()=>AV,ZodTemplateLiteral:()=>uV,ZodSymbol:()=>ZV,ZodSuccess:()=>hV,ZodStringFormat:()=>w4,ZodString:()=>pY,ZodSet:()=>SV,ZodRecord:()=>b7,ZodRealError:()=>h0,ZodReadonly:()=>yV,ZodPromise:()=>pV,ZodPrefault:()=>IV,ZodPipe:()=>f7,ZodOptional:()=>BJ,ZodObject:()=>ZW,ZodNumberFormat:()=>rX,ZodNumber:()=>nY,ZodNullable:()=>EV,ZodNull:()=>FV,ZodNonOptional:()=>h7,ZodNever:()=>LV,ZodNanoID:()=>U7,ZodNaN:()=>mV,ZodMap:()=>_V,ZodLiteral:()=>TV,ZodLazy:()=>lV,ZodKSUID:()=>v7,ZodJWT:()=>A7,ZodIssueCode:()=>Rq,ZodIntersection:()=>MV,ZodISOTime:()=>J$,ZodISODuration:()=>W$,ZodISODateTime:()=>s9,ZodISODate:()=>e9,ZodIPv6:()=>P7,ZodIPv4:()=>M7,ZodGUID:()=>Y$,ZodFunction:()=>dV,ZodFirstPartyTypeKind:()=>m7,ZodFile:()=>BV,ZodError:()=>C2,ZodEnum:()=>cY,ZodEmoji:()=>N7,ZodEmail:()=>F7,ZodE164:()=>B7,ZodDiscriminatedUnion:()=>vV,ZodDefault:()=>RV,ZodDate:()=>w$,ZodCustomStringFormat:()=>dY,ZodCustom:()=>H$,ZodCodec:()=>g7,ZodCatch:()=>fV,ZodCUID2:()=>L7,ZodCUID:()=>Q7,ZodCIDRv6:()=>S7,ZodCIDRv4:()=>_7,ZodBoolean:()=>rY,ZodBigIntFormat:()=>E7,ZodBigInt:()=>iY,ZodBase64URL:()=>q7,ZodBase64:()=>T7,ZodArray:()=>DV,ZodAny:()=>UV,TimePrecision:()=>uw,NEVER:()=>lK,$output:()=>Mw,$input:()=>Ow,$brand:()=>cK});var iV=D(()=>{V8();V8();kQ();V8();ML();aw();aw();kq();tw();XV();wV();HV();bq();I4(c9())});var z0={};s0(z0,{z:()=>y7,xid:()=>p2,void:()=>zq,uuidv7:()=>f2,uuidv6:()=>h2,uuidv4:()=>k2,uuid:()=>b2,util:()=>d,url:()=>g2,uppercase:()=>bY,unknown:()=>HW,union:()=>a4,undefined:()=>tW,ulid:()=>c2,uint64:()=>Hq,uint32:()=>$q,tuple:()=>jV,trim:()=>yY,treeifyError:()=>nK,transform:()=>k7,toUpperCase:()=>uY,toLowerCase:()=>xY,toJSONSchema:()=>iw,templateLiteral:()=>_q,symbol:()=>Zq,superRefine:()=>rV,success:()=>Oq,stringbool:()=>Aq,stringFormat:()=>s2,string:()=>P,strictObject:()=>Nq,startsWith:()=>hY,size:()=>RY,setErrorMap:()=>Cq,set:()=>Vq,safeParseAsync:()=>J7,safeParse:()=>ew,safeEncodeAsync:()=>w7,safeEncode:()=>$7,safeDecodeAsync:()=>H7,safeDecode:()=>K7,registry:()=>a9,regexes:()=>Q8,regex:()=>CY,refine:()=>nV,record:()=>_6,readonly:()=>xV,property:()=>nw,promise:()=>Sq,prettifyError:()=>rK,preprocess:()=>Eq,prefault:()=>bV,positive:()=>lw,pipe:()=>$$,partialRecord:()=>Qq,parseAsync:()=>sw,parse:()=>ow,overwrite:()=>SJ,optional:()=>M0,object:()=>x,number:()=>O6,nullish:()=>Mq,nullable:()=>G$,null:()=>NV,normalize:()=>mY,nonpositive:()=>pw,nonoptional:()=>kV,nonnegative:()=>dw,never:()=>R7,negative:()=>cw,nativeEnum:()=>Dq,nanoid:()=>x2,nan:()=>Pq,multipleOf:()=>iW,minSize:()=>aW,minLength:()=>wW,mime:()=>gY,maxSize:()=>pX,maxLength:()=>dX,map:()=>Lq,lte:()=>L8,lt:()=>jJ,lowercase:()=>IY,looseObject:()=>C7,locales:()=>EY,literal:()=>qV,length:()=>nX,lazy:()=>cV,ksuid:()=>d2,keyof:()=>Fq,jwt:()=>o2,json:()=>Z$,iso:()=>X$,ipv6:()=>j7,ipv4:()=>O7,intersection:()=>OV,int64:()=>wq,int32:()=>Gq,int:()=>Z7,instanceof:()=>Bq,includes:()=>kY,httpUrl:()=>m2,hostname:()=>e2,hex:()=>Jq,hash:()=>Wq,guid:()=>I2,gte:()=>k0,gt:()=>_J,globalRegistry:()=>YJ,getErrorMap:()=>Iq,function:()=>Tq,formatError:()=>_Y,float64:()=>Yq,float32:()=>Xq,flattenError:()=>jY,file:()=>vq,enum:()=>H4,endsWith:()=>fY,encodeAsync:()=>Y7,encode:()=>W7,emoji:()=>y2,email:()=>D8,e164:()=>t2,discriminatedUnion:()=>Uq,default:()=>zx,decodeAsync:()=>G7,decode:()=>X7,date:()=>V4,custom:()=>zW,cuid2:()=>l2,cuid:()=>u2,core:()=>TJ,config:()=>I4,coerce:()=>m6,codec:()=>jq,clone:()=>v0,cidrv6:()=>r2,cidrv4:()=>n2,check:()=>qq,catch:()=>gV,boolean:()=>d6,bigint:()=>Kq,base64url:()=>a2,base64:()=>i2,array:()=>v6,any:()=>E6,_function:()=>Tq,_default:()=>CV,_ZodString:()=>z7,ZodXID:()=>D7,ZodVoid:()=>VV,ZodUnknown:()=>QV,ZodUnion:()=>I7,ZodUndefined:()=>zV,ZodUUID:()=>qJ,ZodURL:()=>K$,ZodULID:()=>V7,ZodType:()=>Q6,ZodTuple:()=>PV,ZodTransform:()=>AV,ZodTemplateLiteral:()=>uV,ZodSymbol:()=>ZV,ZodSuccess:()=>hV,ZodStringFormat:()=>w4,ZodString:()=>pY,ZodSet:()=>SV,ZodRecord:()=>b7,ZodRealError:()=>h0,ZodReadonly:()=>yV,ZodPromise:()=>pV,ZodPrefault:()=>IV,ZodPipe:()=>f7,ZodOptional:()=>BJ,ZodObject:()=>ZW,ZodNumberFormat:()=>rX,ZodNumber:()=>nY,ZodNullable:()=>EV,ZodNull:()=>FV,ZodNonOptional:()=>h7,ZodNever:()=>LV,ZodNanoID:()=>U7,ZodNaN:()=>mV,ZodMap:()=>_V,ZodLiteral:()=>TV,ZodLazy:()=>lV,ZodKSUID:()=>v7,ZodJWT:()=>A7,ZodIssueCode:()=>Rq,ZodIntersection:()=>MV,ZodISOTime:()=>J$,ZodISODuration:()=>W$,ZodISODateTime:()=>s9,ZodISODate:()=>e9,ZodIPv6:()=>P7,ZodIPv4:()=>M7,ZodGUID:()=>Y$,ZodFunction:()=>dV,ZodFirstPartyTypeKind:()=>m7,ZodFile:()=>BV,ZodError:()=>C2,ZodEnum:()=>cY,ZodEmoji:()=>N7,ZodEmail:()=>F7,ZodE164:()=>B7,ZodDiscriminatedUnion:()=>vV,ZodDefault:()=>RV,ZodDate:()=>w$,ZodCustomStringFormat:()=>dY,ZodCustom:()=>H$,ZodCodec:()=>g7,ZodCatch:()=>fV,ZodCUID2:()=>L7,ZodCUID:()=>Q7,ZodCIDRv6:()=>S7,ZodCIDRv4:()=>_7,ZodBoolean:()=>rY,ZodBigIntFormat:()=>E7,ZodBigInt:()=>iY,ZodBase64URL:()=>q7,ZodBase64:()=>T7,ZodArray:()=>DV,ZodAny:()=>UV,TimePrecision:()=>uw,NEVER:()=>lK,$output:()=>Mw,$input:()=>Ow,$brand:()=>cK});var zx;var O0=D(()=>{iV();iV();zx=y7});async function z$(J,W,X){let G=J.body?.callbackURL||J.context.options.baseURL;if(!G)throw new L("BAD_REQUEST",{message:"callbackURL is required"});let Y=t6(128),$=t6(32),K=J.context.oauthConfig?.storeStateStrategy||"cookie",w={...X?X:{},callbackURL:G,codeVerifier:Y,errorURL:J.body?.errorCallbackURL,newUserURL:J.body?.newUserCallbackURL,link:W,expiresAt:Date.now()+600000,requestSignUp:J.body?.requestSignUp};if(await hq(w),K==="cookie"){let N=await JJ({key:J.context.secret,data:JSON.stringify(w)}),F=J.context.createAuthCookie("oauth_state",{maxAge:600000});return J.setCookie(F.name,N,F.attributes),{state:$,codeVerifier:Y}}let H=J.context.createAuthCookie("state",{maxAge:300000});await J.setSignedCookie(H.name,$,J.context.secret,H.attributes);let Z=new Date;Z.setMinutes(Z.getMinutes()+10);let z=await J.context.internalAdapter.createVerificationValue({value:JSON.stringify(w),identifier:$,expiresAt:Z});if(!z)throw J.context.logger.error("Unable to create verification. Make sure the database adapter is properly working and there is a verification table in the database"),new L("INTERNAL_SERVER_ERROR",{message:"Unable to create verification"});return{state:z.identifier,codeVerifier:Y}}async function x7(J){let W=J.query.state||J.body.state,X=J.context.oauthConfig.storeStateStrategy||"cookie",G=C7({callbackURL:P(),codeVerifier:P(),errorURL:P().optional(),newUserURL:P().optional(),expiresAt:O6(),link:x({email:P(),userId:m6.string()}).optional(),requestSignUp:d6().optional()}),Y;if(X==="cookie"){let $=J.context.createAuthCookie("oauth_state"),K=J.getCookie($.name);if(!K){J.context.logger.error("State Mismatch. OAuth state cookie not found",{state:W});let w=J.context.options.onAPIError?.errorURL||`${J.context.baseURL}/error`;throw J.redirect(`${w}?error=please_restart_the_process`)}try{let w=await WJ({key:J.context.secret,data:K});Y=G.parse(JSON.parse(w))}catch(w){J.context.logger.error("Failed to decrypt or parse OAuth state cookie",{error:w});let H=J.context.options.onAPIError?.errorURL||`${J.context.baseURL}/error`;throw J.redirect(`${H}?error=please_restart_the_process`)}J.setCookie($.name,"",{maxAge:0})}else{let $=await J.context.internalAdapter.findVerificationValue(W);if(!$){J.context.logger.error("State Mismatch. Verification not found",{state:W});let H=J.context.options.onAPIError?.errorURL||`${J.context.baseURL}/error`;throw J.redirect(`${H}?error=please_restart_the_process`)}Y=G.parse(JSON.parse($.value));let K=J.context.createAuthCookie("state"),w=await J.getSignedCookie(K.name,J.context.secret);if(!J.context.oauthConfig?.skipStateCookieCheck&&(!w||w!==W)){let H=J.context.options.onAPIError?.errorURL||`${J.context.baseURL}/error`;throw J.redirect(`${H}?error=state_mismatch`)}J.setCookie(K.name,"",{maxAge:0}),await J.context.internalAdapter.deleteVerificationValue($.id)}if(!Y.errorURL)Y.errorURL=J.context.options.onAPIError?.errorURL||`${J.context.baseURL}/error`;if(Y.expiresAt<Date.now()){let $=J.context.options.onAPIError?.errorURL||`${J.context.baseURL}/error`;throw J.redirect(`${$}?error=please_restart_the_process`)}if(Y)await hq(Y);return Y}var o36,hq,aY,f4=(J)=>{return QY("a-z","A-Z","0-9")(J||32)};var i0=D(()=>{r4();MJ();i4();O0();IK();({get:o36,set:hq}=pF(()=>null));aY={isAction:!1}});function Fx(J){return J?J!=="false":!1}function u6(J,W){if(typeof process<"u"&&process.env)return process.env[J]??W;if(typeof Deno<"u")return Deno.env.get(J)??W;if(typeof Bun<"u")return Bun.env[J]??W;return W}function d7(J,W=!0){let X=u6(J);if(!X)return W;return X!=="0"&&X.toLowerCase()!=="false"&&X!==""}function n7(){if(u6("FORCE_COLOR")!==void 0)switch(u6("FORCE_COLOR")){case"":case"1":case"true":return t4;case"2":return EJ;case"3":return M8;default:return N$}if(u6("NODE_DISABLE_COLORS")!==void 0&&u6("NODE_DISABLE_COLORS")!==""||u6("NO_COLOR")!==void 0&&u6("NO_COLOR")!==""||u6("TERM")==="dumb")return N$;if(u6("TMUX"))return M8;if("TF_BUILD"in R6&&"AGENT_NAME"in R6)return t4;if("CI"in R6){for(let{0:J,1:W}of Nx)if(J in R6)return W;if(u6("CI_NAME")==="codeship")return EJ;return N$}if("TEAMCITY_VERSION"in R6)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.exec(u6("TEAMCITY_VERSION"))!==null?t4:N$;switch(u6("TERM_PROGRAM")){case"iTerm.app":if(!u6("TERM_PROGRAM_VERSION")||/^[0-2]\./.exec(u6("TERM_PROGRAM_VERSION"))!==null)return EJ;return M8;case"HyperTerm":case"MacTerm":return M8;case"Apple_Terminal":return EJ}if(u6("COLORTERM")==="truecolor"||u6("COLORTERM")==="24bit")return M8;if(u6("TERM")){if(/truecolor/.exec(u6("TERM"))!==null)return M8;if(/^xterm-256/.exec(u6("TERM"))!==null)return EJ;let J=u6("TERM").toLowerCase();if(mq[J])return mq[J];if(Ux.some((W)=>W.exec(J)!==null))return t4}if(u6("COLORTERM"))return t4;return N$}function oY(J,W){return p7.indexOf(W)<=p7.indexOf(J)}var c7,F$=(J)=>globalThis.process?.env||globalThis.Deno?.env.toObject()||globalThis.__env__||(J?c7:globalThis),R6,U$,FW,tY=()=>U$==="dev"||U$==="development",oW=()=>U$==="test"||Fx(R6.TEST),tV,N$=1,t4=4,EJ=8,M8=24,mq,Nx,Ux,b4,p7,Qx,Lx=(J,W,X)=>{let G=new Date().toISOString();if(X)return`${b4.dim}${G}${b4.reset} ${Qx[J]}${J.toUpperCase()}${b4.reset} ${b4.bright}[Better Auth]:${b4.reset} ${W}`;return`${G} ${J.toUpperCase()} [Better Auth]: ${W}`},sY=(J)=>{let W=J?.disabled!==!0,X=J?.level??"error",G=J?.disableColors!==void 0?!J.disableColors:n7()!==1,Y=($,K,w=[])=>{if(!W||!oY(X,$))return;let H=Lx($,K,G);if(!J||typeof J.log!=="function"){if($==="error")console.error(H,...w);else if($==="warn")console.warn(H,...w);else console.log(H,...w);return}J.log($==="success"?"info":$,K,...w)};return{...Object.fromEntries(p7.map(($)=>[$,(...[K,...w])=>Y($,K,w)])),get level(){return X}}},G6;var oV=D(()=>{c7=Object.create(null),R6=new Proxy(c7,{get(J,W){return F$()[W]??c7[W]},has(J,W){return W in F$()||W in c7},set(J,W,X){let G=F$(!0);return G[W]=X,!0},deleteProperty(J,W){if(!W)return!1;let X=F$(!0);return delete X[W],!0},ownKeys(){let J=F$(!0);return Object.keys(J)}});U$=typeof process<"u"&&process.env&&"production"||"",FW=U$==="production";tV=Object.freeze({get BETTER_AUTH_SECRET(){return u6("BETTER_AUTH_SECRET")},get AUTH_SECRET(){return u6("AUTH_SECRET")},get BETTER_AUTH_TELEMETRY(){return u6("BETTER_AUTH_TELEMETRY")},get BETTER_AUTH_TELEMETRY_ID(){return u6("BETTER_AUTH_TELEMETRY_ID")},get NODE_ENV(){return u6("NODE_ENV","development")},get PACKAGE_VERSION(){return u6("PACKAGE_VERSION","0.0.0")},get BETTER_AUTH_TELEMETRY_ENDPOINT(){return u6("BETTER_AUTH_TELEMETRY_ENDPOINT","https://telemetry.better-auth.com/v1/track")}}),mq={eterm:t4,cons25:t4,console:t4,cygwin:t4,dtterm:t4,gnome:t4,hurd:t4,jfbterm:t4,konsole:t4,kterm:t4,mlterm:t4,mosh:M8,putty:t4,st:t4,"rxvt-unicode-24bit":M8,terminator:M8,"xterm-kitty":M8},Nx=new Map(Object.entries({APPVEYOR:EJ,BUILDKITE:EJ,CIRCLECI:M8,DRONE:EJ,GITEA_ACTIONS:M8,GITHUB_ACTIONS:M8,GITLAB_CI:EJ,TRAVIS:EJ})),Ux=[/ansi/,/color/,/linux/,/direct/,/^con[0-9]*x[0-9]/,/^rxvt/,/^screen/,/^xterm/,/^vt100/,/^vt220/];b4={reset:"\x1B[0m",bright:"\x1B[1m",dim:"\x1B[2m",undim:"\x1B[22m",underscore:"\x1B[4m",blink:"\x1B[5m",reverse:"\x1B[7m",hidden:"\x1B[8m",fg:{black:"\x1B[30m",red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",blue:"\x1B[34m",magenta:"\x1B[35m",cyan:"\x1B[36m",white:"\x1B[37m"},bg:{black:"\x1B[40m",red:"\x1B[41m",green:"\x1B[42m",yellow:"\x1B[43m",blue:"\x1B[44m",magenta:"\x1B[45m",cyan:"\x1B[46m",white:"\x1B[47m"}},p7=["info","success","warn","error","debug"];Qx={info:b4.fg.blue,success:b4.fg.green,warn:b4.fg.yellow,error:b4.fg.red,debug:b4.fg.magenta},G6=sY()});var t0=D(()=>{oV()});function l6(J){function W(X,G){if(typeof G==="string"){if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d+)?Z$/.test(G)){let Y=new Date(G);if(!isNaN(Y.getTime()))return Y}}return G}try{if(typeof J!=="string")return J;return JSON.parse(J,W)}catch(X){return G6.error("Error parsing JSON",{error:X}),null}}var O8=D(()=>{t0()});function vx(J,W,X){if(bX(J),X===void 0)X=new Uint8Array(J.outputLen);return NY(J,X,W)}function Mx(J,W,X,G=32){bX(J),I0(G,"length");let Y=J.outputLen;if(G>255*Y)throw Error("Length must be <= 255*HashLen");let $=Math.ceil(G/Y);if(X===void 0)X=yq;else GW(X,void 0,"info");let K=new Uint8Array($*Y),w=NY.create(J,W),H=w._cloneInto(),Z=new Uint8Array(w.outputLen);for(let z=0;z<$;z++)sV[0]=z+1,H.update(z===0?yq:Z).update(X).update(sV).digestInto(Z),K.set(Z,Y*z),w._cloneInto(H);return w.destroy(),H.destroy(),b0(Z,sV),K.slice(0,G)}var sV,yq,eV=(J,W,X,G,Y)=>Mx(J,vx(J,W,X),G,Y);var xq=D(()=>{EF();mW();sV=Uint8Array.of(0),yq=Uint8Array.of()});function o4(...J){let W=J.reduce((Y,{length:$})=>Y+$,0),X=new Uint8Array(W),G=0;for(let Y of J)X.set(Y,G),G+=Y.length;return X}function JD(J,W,X){if(W<0||W>=4294967296)throw RangeError(`value must be >= 0 and <= 4294967295. Received ${W}`);J.set([W>>>24,W>>>16,W>>>8,W&255],X)}function r7(J){let W=Math.floor(J/4294967296),X=J%4294967296,G=new Uint8Array(8);return JD(G,W,0),JD(G,X,4),G}function i7(J){let W=new Uint8Array(4);return JD(W,J),W}var o6,A4;var F0=D(()=>{o6=new TextEncoder,A4=new TextDecoder});function uq(J){if(Uint8Array.prototype.toBase64)return J.toBase64();let W=32768,X=[];for(let G=0;G<J.length;G+=W)X.push(String.fromCharCode.apply(null,J.subarray(G,G+W)));return btoa(X.join(""))}function lq(J){if(Uint8Array.fromBase64)return Uint8Array.fromBase64(J);let W=atob(J),X=new Uint8Array(W.length);for(let G=0;G<W.length;G++)X[G]=W.charCodeAt(G);return X}var Q$={};s0(Q$,{encode:()=>O4,decode:()=>N4});function N4(J){if(Uint8Array.fromBase64)return Uint8Array.fromBase64(typeof J==="string"?J:A4.decode(J),{alphabet:"base64url"});let W=J;if(W instanceof Uint8Array)W=A4.decode(W);W=W.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return lq(W)}catch{throw TypeError("The input to be decoded is not correctly encoded.")}}function O4(J){let W=J;if(typeof W==="string")W=o6.encode(W);if(Uint8Array.prototype.toBase64)return W.toBase64({alphabet:"base64url",omitPadding:!0});return uq(W).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}var P0=D(()=>{F0()});var s4,j0,eY,JG,V6,L$,J6,Z4,f0,WD,a7,V$,XD,YD,GD;var y6=D(()=>{s4=class s4 extends Error{static code="ERR_JOSE_GENERIC";code="ERR_JOSE_GENERIC";constructor(J,W){super(J,W);this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}};j0=class j0 extends s4{static code="ERR_JWT_CLAIM_VALIDATION_FAILED";code="ERR_JWT_CLAIM_VALIDATION_FAILED";claim;reason;payload;constructor(J,W,X="unspecified",G="unspecified"){super(J,{cause:{claim:X,reason:G,payload:W}});this.claim=X,this.reason=G,this.payload=W}};eY=class eY extends s4{static code="ERR_JWT_EXPIRED";code="ERR_JWT_EXPIRED";claim;reason;payload;constructor(J,W,X="unspecified",G="unspecified"){super(J,{cause:{claim:X,reason:G,payload:W}});this.claim=X,this.reason=G,this.payload=W}};JG=class JG extends s4{static code="ERR_JOSE_ALG_NOT_ALLOWED";code="ERR_JOSE_ALG_NOT_ALLOWED"};V6=class V6 extends s4{static code="ERR_JOSE_NOT_SUPPORTED";code="ERR_JOSE_NOT_SUPPORTED"};L$=class L$ extends s4{static code="ERR_JWE_DECRYPTION_FAILED";code="ERR_JWE_DECRYPTION_FAILED";constructor(J="decryption operation failed",W){super(J,W)}};J6=class J6 extends s4{static code="ERR_JWE_INVALID";code="ERR_JWE_INVALID"};Z4=class Z4 extends s4{static code="ERR_JWS_INVALID";code="ERR_JWS_INVALID"};f0=class f0 extends s4{static code="ERR_JWT_INVALID";code="ERR_JWT_INVALID"};WD=class WD extends s4{static code="ERR_JWK_INVALID";code="ERR_JWK_INVALID"};a7=class a7 extends s4{static code="ERR_JWKS_INVALID";code="ERR_JWKS_INVALID"};V$=class V$ extends s4{static code="ERR_JWKS_NO_MATCHING_KEY";code="ERR_JWKS_NO_MATCHING_KEY";constructor(J="no applicable key found in the JSON Web Key Set",W){super(J,W)}};XD=class XD extends s4{[Symbol.asyncIterator];static code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";constructor(J="multiple matching keys found in the JSON Web Key Set",W){super(J,W)}};YD=class YD extends s4{static code="ERR_JWKS_TIMEOUT";code="ERR_JWKS_TIMEOUT";constructor(J="request timed out",W){super(J,W)}};GD=class GD extends s4{static code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";constructor(J="signature verification failed",W){super(J,W)}}});function $D(J){switch(J){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new V6(`Unsupported JWE Algorithm: ${J}`)}}var cq=(J)=>crypto.getRandomValues(new Uint8Array($D(J)>>3));var KD=D(()=>{y6()});var t7=(J,W)=>{if(W.length<<3!==$D(J))throw new J6("Invalid Initialization Vector length")};var wD=D(()=>{y6();KD()});var WG=(J,W)=>{let X=J.byteLength<<3;if(X!==W)throw new J6(`Invalid Content Encryption Key length. Expected ${W} bits, got ${X} bits`)};var HD=D(()=>{y6()});function e4(J,W="algorithm.name"){return TypeError(`CryptoKey does not support this operation, its ${W} must be ${J}`)}function RJ(J,W){return J.name===W}function o7(J){return parseInt(J.name.slice(4),10)}function Px(J){switch(J){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw Error("unreachable")}}function pq(J,W){if(W&&!J.usages.includes(W))throw TypeError(`CryptoKey does not support this operation, its usages must include ${W}.`)}function dq(J,W,X){switch(W){case"HS256":case"HS384":case"HS512":{if(!RJ(J.algorithm,"HMAC"))throw e4("HMAC");let G=parseInt(W.slice(2),10);if(o7(J.algorithm.hash)!==G)throw e4(`SHA-${G}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!RJ(J.algorithm,"RSASSA-PKCS1-v1_5"))throw e4("RSASSA-PKCS1-v1_5");let G=parseInt(W.slice(2),10);if(o7(J.algorithm.hash)!==G)throw e4(`SHA-${G}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!RJ(J.algorithm,"RSA-PSS"))throw e4("RSA-PSS");let G=parseInt(W.slice(2),10);if(o7(J.algorithm.hash)!==G)throw e4(`SHA-${G}`,"algorithm.hash");break}case"Ed25519":case"EdDSA":{if(!RJ(J.algorithm,"Ed25519"))throw e4("Ed25519");break}case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":{if(!RJ(J.algorithm,W))throw e4(W);break}case"ES256":case"ES384":case"ES512":{if(!RJ(J.algorithm,"ECDSA"))throw e4("ECDSA");let G=Px(W);if(J.algorithm.namedCurve!==G)throw e4(G,"algorithm.namedCurve");break}default:throw TypeError("CryptoKey does not support this operation")}pq(J,X)}function o0(J,W,X){switch(W){case"A128GCM":case"A192GCM":case"A256GCM":{if(!RJ(J.algorithm,"AES-GCM"))throw e4("AES-GCM");let G=parseInt(W.slice(1,4),10);if(J.algorithm.length!==G)throw e4(G,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!RJ(J.algorithm,"AES-KW"))throw e4("AES-KW");let G=parseInt(W.slice(1,4),10);if(J.algorithm.length!==G)throw e4(G,"algorithm.length");break}case"ECDH":{switch(J.algorithm.name){case"ECDH":case"X25519":break;default:throw e4("ECDH or X25519")}break}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!RJ(J.algorithm,"PBKDF2"))throw e4("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!RJ(J.algorithm,"RSA-OAEP"))throw e4("RSA-OAEP");let G=parseInt(W.slice(9),10)||1;if(o7(J.algorithm.hash)!==G)throw e4(`SHA-${G}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}pq(J,X)}function nq(J,W,...X){if(X=X.filter(Boolean),X.length>2){let G=X.pop();J+=`one of type ${X.join(", ")}, or ${G}.`}else if(X.length===2)J+=`one of type ${X[0]} or ${X[1]}.`;else J+=`of type ${X[0]}.`;if(W==null)J+=` Received ${W}`;else if(typeof W==="function"&&W.name)J+=` Received function ${W.name}`;else if(typeof W==="object"&&W!=null){if(W.constructor?.name)J+=` Received an instance of ${W.constructor.name}`}return J}function ZD(J,W,...X){return nq(`Key for the ${J} algorithm must be `,W,...X)}var b8=(J,...W)=>{return nq("Key must be ",J,...W)};function aX(J){if(!CJ(J))throw Error("CryptoKey instance expected")}function CJ(J){return J?.[Symbol.toStringTag]==="CryptoKey"}function D$(J){return J?.[Symbol.toStringTag]==="KeyObject"}var v$=(J)=>{return CJ(J)||D$(J)};async function jx(J,W){if(!(J instanceof Uint8Array))throw TypeError("First argument must be a buffer");if(!(W instanceof Uint8Array))throw TypeError("Second argument must be a buffer");let X={name:"HMAC",hash:"SHA-256"},G=await crypto.subtle.generateKey(X,!1,["sign"]),Y=new Uint8Array(await crypto.subtle.sign(X,G,J)),$=new Uint8Array(await crypto.subtle.sign(X,G,W)),K=0,w=-1;while(++w<32)K|=Y[w]^$[w];return K===0}async function _x(J,W,X,G,Y,$){if(!(W instanceof Uint8Array))throw TypeError(b8(W,"Uint8Array"));let K=parseInt(J.slice(1,4),10),w=await crypto.subtle.importKey("raw",W.subarray(K>>3),"AES-CBC",!1,["decrypt"]),H=await crypto.subtle.importKey("raw",W.subarray(0,K>>3),{hash:`SHA-${K<<1}`,name:"HMAC"},!1,["sign"]),Z=o4($,G,X,r7($.length<<3)),z=new Uint8Array((await crypto.subtle.sign("HMAC",H,Z)).slice(0,K>>3)),N;try{N=await jx(Y,z)}catch{}if(!N)throw new L$;let F;try{F=new Uint8Array(await crypto.subtle.decrypt({iv:G,name:"AES-CBC"},w,X))}catch{}if(!F)throw new L$;return F}async function Sx(J,W,X,G,Y,$){let K;if(W instanceof Uint8Array)K=await crypto.subtle.importKey("raw",W,"AES-GCM",!1,["decrypt"]);else o0(W,J,"decrypt"),K=W;try{return new Uint8Array(await crypto.subtle.decrypt({additionalData:$,iv:G,name:"AES-GCM",tagLength:128},K,o4(X,Y)))}catch{throw new L$}}var s7=async(J,W,X,G,Y,$)=>{if(!CJ(W)&&!(W instanceof Uint8Array))throw TypeError(b8(W,"CryptoKey","KeyObject","Uint8Array","JSON Web Key"));if(!G)throw new J6("JWE Initialization Vector missing");if(!Y)throw new J6("JWE Authentication Tag missing");switch(t7(J,G),J){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":if(W instanceof Uint8Array)WG(W,parseInt(J.slice(-3),10));return _x(J,W,X,G,Y,$);case"A128GCM":case"A192GCM":case"A256GCM":if(W instanceof Uint8Array)WG(W,parseInt(J.slice(1,4),10));return Sx(J,W,X,G,Y,$);default:throw new V6("Unsupported JWE Content Encryption Algorithm")}};var zD=D(()=>{F0();wD();HD();y6()});var sW=(...J)=>{let W=J.filter(Boolean);if(W.length===0||W.length===1)return!0;let X;for(let G of W){let Y=Object.keys(G);if(!X||X.size===0){X=new Set(Y);continue}for(let $ of Y){if(X.has($))return!1;X.add($)}}return!0};function Tx(J){return typeof J==="object"&&J!==null}var D4=(J)=>{if(!Tx(J)||Object.prototype.toString.call(J)!=="[object Object]")return!1;if(Object.getPrototypeOf(J)===null)return!0;let W=J;while(Object.getPrototypeOf(W)!==null)W=Object.getPrototypeOf(W);return Object.getPrototypeOf(J)===W};function rq(J,W){if(J.algorithm.length!==parseInt(W.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${W}`)}function iq(J,W,X){if(J instanceof Uint8Array)return crypto.subtle.importKey("raw",J,"AES-KW",!0,[X]);return o0(J,W,X),J}async function M$(J,W,X){let G=await iq(W,J,"wrapKey");rq(G,J);let Y=await crypto.subtle.importKey("raw",X,{hash:"SHA-256",name:"HMAC"},!0,["sign"]);return new Uint8Array(await crypto.subtle.wrapKey("raw",Y,G,"AES-KW"))}async function O$(J,W,X){let G=await iq(W,J,"unwrapKey");rq(G,J);let Y=await crypto.subtle.unwrapKey("raw",X,G,"AES-KW",{hash:"SHA-256",name:"HMAC"},!0,["sign"]);return new Uint8Array(await crypto.subtle.exportKey("raw",Y))}var e7=()=>{};var JH=async(J,W)=>{let X=`SHA-${J.slice(-3)}`;return new Uint8Array(await crypto.subtle.digest(X,W))};function ND(J){return o4(i7(J.length),J)}async function qx(J,W,X){let G=W>>3,Y=32,$=Math.ceil(G/32),K=new Uint8Array($*32);for(let w=1;w<=$;w++){let H=new Uint8Array(4+J.length+X.length);H.set(i7(w),0),H.set(J,4),H.set(X,4+J.length);let Z=await JH("sha256",H);K.set(Z,(w-1)*32)}return K.slice(0,G)}async function WH(J,W,X,G,Y=new Uint8Array(0),$=new Uint8Array(0)){o0(J,"ECDH"),o0(W,"ECDH","deriveBits");let K=ND(o6.encode(X)),w=ND(Y),H=ND($),Z=i7(G),z=new Uint8Array(0),N=o4(K,w,H,Z,z),F=new Uint8Array(await crypto.subtle.deriveBits({name:J.algorithm.name,public:J},W,Bx(J)));return qx(F,G,N)}function Bx(J){if(J.algorithm.name==="X25519")return 256;return Math.ceil(parseInt(J.algorithm.namedCurve.slice(-3),10)/8)<<3}function XH(J){switch(J.algorithm.namedCurve){case"P-256":case"P-384":case"P-521":return!0;default:return J.algorithm.name==="X25519"}}var UD=D(()=>{F0()});function Ax(J,W){if(J instanceof Uint8Array)return crypto.subtle.importKey("raw",J,"PBKDF2",!1,["deriveBits"]);return o0(J,W,"deriveBits"),J}async function tq(J,W,X,G){if(!(J instanceof Uint8Array)||J.length<8)throw new J6("PBES2 Salt Input must be 8 or more octets");let Y=Ex(W,J),$=parseInt(W.slice(13,16),10),K={hash:`SHA-${W.slice(8,11)}`,iterations:X,name:"PBKDF2",salt:Y},w=await Ax(G,W);return new Uint8Array(await crypto.subtle.deriveBits(K,w,$))}async function oq(J,W,X,G=2048,Y=crypto.getRandomValues(new Uint8Array(16))){let $=await tq(Y,J,G,W);return{encryptedKey:await M$(J.slice(-6),$,X),p2c:G,p2s:O4(Y)}}async function sq(J,W,X,G,Y){let $=await tq(Y,J,G,W);return O$(J.slice(-6),$,X)}var Ex=(J,W)=>o4(o6.encode(J),new Uint8Array([0]),W);var QD=D(()=>{P0();e7();F0();y6()});var tX=(J,W)=>{if(J.startsWith("RS")||J.startsWith("PS")){let{modulusLength:X}=W.algorithm;if(typeof X!=="number"||X<2048)throw TypeError(`${J} requires key modulusLength to be 2048 bits or larger`)}};async function WB(J,W,X){return o0(W,J,"encrypt"),tX(J,W),new Uint8Array(await crypto.subtle.encrypt(JB(J),W,X))}async function XB(J,W,X){return o0(W,J,"decrypt"),tX(J,W),new Uint8Array(await crypto.subtle.decrypt(JB(J),W,X))}var JB=(J)=>{switch(J){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return"RSA-OAEP";default:throw new V6(`alg ${J} is not supported either by JOSE or your javascript runtime`)}};var LD=D(()=>{y6()});function P$(J){switch(J){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new V6(`Unsupported JWE Algorithm: ${J}`)}}var eW=(J)=>crypto.getRandomValues(new Uint8Array(P$(J)>>3));var YH=D(()=>{y6()});function Rx(J){let W,X;switch(J.kty){case"AKP":{switch(J.alg){case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":W={name:J.alg},X=J.priv?["sign"]:["verify"];break;default:throw new V6('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"RSA":{switch(J.alg){case"PS256":case"PS384":case"PS512":W={name:"RSA-PSS",hash:`SHA-${J.alg.slice(-3)}`},X=J.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":W={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${J.alg.slice(-3)}`},X=J.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":W={name:"RSA-OAEP",hash:`SHA-${parseInt(J.alg.slice(-3),10)||1}`},X=J.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new V6('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"EC":{switch(J.alg){case"ES256":W={name:"ECDSA",namedCurve:"P-256"},X=J.d?["sign"]:["verify"];break;case"ES384":W={name:"ECDSA",namedCurve:"P-384"},X=J.d?["sign"]:["verify"];break;case"ES512":W={name:"ECDSA",namedCurve:"P-521"},X=J.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":W={name:"ECDH",namedCurve:J.crv},X=J.d?["deriveBits"]:[];break;default:throw new V6('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"OKP":{switch(J.alg){case"Ed25519":case"EdDSA":W={name:"Ed25519"},X=J.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":W={name:J.crv},X=J.d?["deriveBits"]:[];break;default:throw new V6('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}default:throw new V6('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:W,keyUsages:X}}var XG=async(J)=>{if(!J.alg)throw TypeError('"alg" argument is required when "jwk.alg" is not present');let{algorithm:W,keyUsages:X}=Rx(J),G={...J};if(G.kty!=="AKP")delete G.alg;return delete G.use,crypto.subtle.importKey("jwk",G,W,J.ext??(J.d||J.priv?!1:!0),J.key_ops??X)};var VD=D(()=>{y6()});async function GJ(J,W,X){if(!D4(J))throw TypeError("JWK must be an object");let G;switch(W??=J.alg,G??=X?.extractable??J.ext,J.kty){case"oct":if(typeof J.k!=="string"||!J.k)throw TypeError('missing "k" (Key Value) Parameter value');return N4(J.k);case"RSA":if("oth"in J&&J.oth!==void 0)throw new V6('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');return XG({...J,alg:W,ext:G});case"AKP":{if(typeof J.alg!=="string"||!J.alg)throw TypeError('missing "alg" (Algorithm) Parameter value');if(W!==void 0&&W!==J.alg)throw TypeError("JWK alg and alg option value mismatch");return XG({...J,ext:G})}case"EC":case"OKP":return XG({...J,alg:W,ext:G});default:throw new V6('Unsupported "kty" (Key Type) Parameter value')}}var GH=D(()=>{P0();VD();y6()});async function Cx(J,W,X,G,Y){if(!(X instanceof Uint8Array))throw TypeError(b8(X,"Uint8Array"));let $=parseInt(J.slice(1,4),10),K=await crypto.subtle.importKey("raw",X.subarray($>>3),"AES-CBC",!1,["encrypt"]),w=await crypto.subtle.importKey("raw",X.subarray(0,$>>3),{hash:`SHA-${$<<1}`,name:"HMAC"},!1,["sign"]),H=new Uint8Array(await crypto.subtle.encrypt({iv:G,name:"AES-CBC"},K,W)),Z=o4(Y,G,H,r7(Y.length<<3)),z=new Uint8Array((await crypto.subtle.sign("HMAC",w,Z)).slice(0,$>>3));return{ciphertext:H,tag:z,iv:G}}async function Ix(J,W,X,G,Y){let $;if(X instanceof Uint8Array)$=await crypto.subtle.importKey("raw",X,"AES-GCM",!1,["encrypt"]);else o0(X,J,"encrypt"),$=X;let K=new Uint8Array(await crypto.subtle.encrypt({additionalData:Y,iv:G,name:"AES-GCM",tagLength:128},$,W)),w=K.slice(-16);return{ciphertext:K.slice(0,-16),tag:w,iv:G}}var $H=async(J,W,X,G,Y)=>{if(!CJ(X)&&!(X instanceof Uint8Array))throw TypeError(b8(X,"CryptoKey","KeyObject","Uint8Array","JSON Web Key"));if(G)t7(J,G);else G=cq(J);switch(J){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":if(X instanceof Uint8Array)WG(X,parseInt(J.slice(-3),10));return Cx(J,W,X,G,Y);case"A128GCM":case"A192GCM":case"A256GCM":if(X instanceof Uint8Array)WG(X,parseInt(J.slice(1,4),10));return Ix(J,W,X,G,Y);default:throw new V6("Unsupported JWE Content Encryption Algorithm")}};var DD=D(()=>{F0();wD();HD();KD();y6()});async function GB(J,W,X,G){let Y=J.slice(0,7),$=await $H(Y,X,W,G,new Uint8Array(0));return{encryptedKey:$.ciphertext,iv:O4($.iv),tag:O4($.tag)}}async function $B(J,W,X,G,Y){let $=J.slice(0,7);return s7($,W,X,G,Y,new Uint8Array(0))}var vD=D(()=>{DD();zD();P0()});var KB=async(J,W,X,G,Y)=>{switch(J){case"dir":{if(X!==void 0)throw new J6("Encountered unexpected JWE Encrypted Key");return W}case"ECDH-ES":if(X!==void 0)throw new J6("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!D4(G.epk))throw new J6('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(aX(W),!XH(W))throw new V6("ECDH with the provided key is not allowed or not supported by your javascript runtime");let $=await GJ(G.epk,J);aX($);let K,w;if(G.apu!==void 0){if(typeof G.apu!=="string")throw new J6('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{K=N4(G.apu)}catch{throw new J6("Failed to base64url decode the apu")}}if(G.apv!==void 0){if(typeof G.apv!=="string")throw new J6('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{w=N4(G.apv)}catch{throw new J6("Failed to base64url decode the apv")}}let H=await WH($,W,J==="ECDH-ES"?G.enc:J,J==="ECDH-ES"?P$(G.enc):parseInt(J.slice(-5,-2),10),K,w);if(J==="ECDH-ES")return H;if(X===void 0)throw new J6("JWE Encrypted Key missing");return O$(J.slice(-6),H,X)}case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(X===void 0)throw new J6("JWE Encrypted Key missing");return aX(W),XB(J,W,X)}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{if(X===void 0)throw new J6("JWE Encrypted Key missing");if(typeof G.p2c!=="number")throw new J6('JOSE Header "p2c" (PBES2 Count) missing or invalid');let $=Y?.maxPBES2Count||1e4;if(G.p2c>$)throw new J6('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if(typeof G.p2s!=="string")throw new J6('JOSE Header "p2s" (PBES2 Salt) missing or invalid');let K;try{K=N4(G.p2s)}catch{throw new J6("Failed to base64url decode the p2s")}return sq(J,W,X,G.p2c,K)}case"A128KW":case"A192KW":case"A256KW":{if(X===void 0)throw new J6("JWE Encrypted Key missing");return O$(J,W,X)}case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{if(X===void 0)throw new J6("JWE Encrypted Key missing");if(typeof G.iv!=="string")throw new J6('JOSE Header "iv" (Initialization Vector) missing or invalid');if(typeof G.tag!=="string")throw new J6('JOSE Header "tag" (Authentication Tag) missing or invalid');let $;try{$=N4(G.iv)}catch{throw new J6("Failed to base64url decode the iv")}let K;try{K=N4(G.tag)}catch{throw new J6("Failed to base64url decode the tag")}return $B(J,W,X,$,K)}default:throw new V6('Invalid or unsupported "alg" (JWE Algorithm) header value')}};var wB=D(()=>{e7();UD();QD();LD();P0();y6();YH();GH();vD()});var JX=(J,W,X,G,Y)=>{if(Y.crit!==void 0&&G?.crit===void 0)throw new J('"crit" (Critical) Header Parameter MUST be integrity protected');if(!G||G.crit===void 0)return new Set;if(!Array.isArray(G.crit)||G.crit.length===0||G.crit.some((K)=>typeof K!=="string"||K.length===0))throw new J('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let $;if(X!==void 0)$=new Map([...Object.entries(X),...W.entries()]);else $=W;for(let K of G.crit){if(!$.has(K))throw new V6(`Extension Header Parameter "${K}" is not recognized`);if(Y[K]===void 0)throw new J(`Extension Header Parameter "${K}" is missing`);if($.get(K)&&G[K]===void 0)throw new J(`Extension Header Parameter "${K}" MUST be integrity protected`)}return new Set(G.crit)};var j$=D(()=>{y6()});var _$=(J,W)=>{if(W!==void 0&&(!Array.isArray(W)||W.some((X)=>typeof X!=="string")))throw TypeError(`"${J}" option must be an array of strings`);if(!W)return;return new Set(W)};function oX(J){return D4(J)&&typeof J.kty==="string"}function HB(J){return J.kty!=="oct"&&(J.kty==="AKP"&&typeof J.priv==="string"||typeof J.d==="string")}function ZB(J){return J.kty!=="oct"&&typeof J.d>"u"&&typeof J.priv>"u"}function zB(J){return J.kty==="oct"&&typeof J.k==="string"}var KH=()=>{};var YG,FB=async(J,W,X,G=!1)=>{YG||=new WeakMap;let Y=YG.get(J);if(Y?.[X])return Y[X];let $=await XG({...W,alg:X});if(G)Object.freeze(J);if(!Y)YG.set(J,{[X]:$});else Y[X]=$;return $},kx=(J,W)=>{YG||=new WeakMap;let X=YG.get(J);if(X?.[W])return X[W];let G=J.type==="public",Y=G?!0:!1,$;if(J.asymmetricKeyType==="x25519"){switch(W){case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":break;default:throw TypeError("given KeyObject instance cannot be used for this algorithm")}$=J.toCryptoKey(J.asymmetricKeyType,Y,G?[]:["deriveBits"])}if(J.asymmetricKeyType==="ed25519"){if(W!=="EdDSA"&&W!=="Ed25519")throw TypeError("given KeyObject instance cannot be used for this algorithm");$=J.toCryptoKey(J.asymmetricKeyType,Y,[G?"verify":"sign"])}switch(J.asymmetricKeyType){case"ml-dsa-44":case"ml-dsa-65":case"ml-dsa-87":{if(W!==J.asymmetricKeyType.toUpperCase())throw TypeError("given KeyObject instance cannot be used for this algorithm");$=J.toCryptoKey(J.asymmetricKeyType,Y,[G?"verify":"sign"])}}if(J.asymmetricKeyType==="rsa"){let K;switch(W){case"RSA-OAEP":K="SHA-1";break;case"RS256":case"PS256":case"RSA-OAEP-256":K="SHA-256";break;case"RS384":case"PS384":case"RSA-OAEP-384":K="SHA-384";break;case"RS512":case"PS512":case"RSA-OAEP-512":K="SHA-512";break;default:throw TypeError("given KeyObject instance cannot be used for this algorithm")}if(W.startsWith("RSA-OAEP"))return J.toCryptoKey({name:"RSA-OAEP",hash:K},Y,G?["encrypt"]:["decrypt"]);$=J.toCryptoKey({name:W.startsWith("PS")?"RSA-PSS":"RSASSA-PKCS1-v1_5",hash:K},Y,[G?"verify":"sign"])}if(J.asymmetricKeyType==="ec"){let w=new Map([["prime256v1","P-256"],["secp384r1","P-384"],["secp521r1","P-521"]]).get(J.asymmetricKeyDetails?.namedCurve);if(!w)throw TypeError("given KeyObject instance cannot be used for this algorithm");if(W==="ES256"&&w==="P-256")$=J.toCryptoKey({name:"ECDSA",namedCurve:w},Y,[G?"verify":"sign"]);if(W==="ES384"&&w==="P-384")$=J.toCryptoKey({name:"ECDSA",namedCurve:w},Y,[G?"verify":"sign"]);if(W==="ES512"&&w==="P-521")$=J.toCryptoKey({name:"ECDSA",namedCurve:w},Y,[G?"verify":"sign"]);if(W.startsWith("ECDH-ES"))$=J.toCryptoKey({name:"ECDH",namedCurve:w},Y,G?[]:["deriveBits"])}if(!$)throw TypeError("given KeyObject instance cannot be used for this algorithm");if(!X)YG.set(J,{[W]:$});else X[W]=$;return $},IJ=async(J,W)=>{if(J instanceof Uint8Array)return J;if(CJ(J))return J;if(D$(J)){if(J.type==="secret")return J.export();if("toCryptoKey"in J&&typeof J.toCryptoKey==="function")try{return kx(J,W)}catch(G){if(G instanceof TypeError)throw G}let X=J.export({format:"jwk"});return FB(J,X,W)}if(oX(J)){if(J.k)return N4(J.k);return FB(J,J,W,!0)}throw Error("unreachable")};var GG=D(()=>{KH();P0();VD()});var $G=(J)=>J?.[Symbol.toStringTag],MD=(J,W,X)=>{if(W.use!==void 0){let G;switch(X){case"sign":case"verify":G="sig";break;case"encrypt":case"decrypt":G="enc";break}if(W.use!==G)throw TypeError(`Invalid key for this operation, its "use" must be "${G}" when present`)}if(W.alg!==void 0&&W.alg!==J)throw TypeError(`Invalid key for this operation, its "alg" must be "${J}" when present`);if(Array.isArray(W.key_ops)){let G;switch(!0){case(X==="sign"||X==="verify"):case J==="dir":case J.includes("CBC-HS"):G=X;break;case J.startsWith("PBES2"):G="deriveBits";break;case/^A\d{3}(?:GCM)?(?:KW)?$/.test(J):if(!J.includes("GCM")&&J.endsWith("KW"))G=X==="encrypt"?"wrapKey":"unwrapKey";else G=X;break;case(X==="encrypt"&&J.startsWith("RSA")):G="wrapKey";break;case X==="decrypt":G=J.startsWith("RSA")?"unwrapKey":"deriveBits";break}if(G&&W.key_ops?.includes?.(G)===!1)throw TypeError(`Invalid key for this operation, its "key_ops" must include "${G}" when present`)}return!0},hx=(J,W,X)=>{if(W instanceof Uint8Array)return;if(oX(W)){if(zB(W)&&MD(J,W,X))return;throw TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!v$(W))throw TypeError(ZD(J,W,"CryptoKey","KeyObject","JSON Web Key","Uint8Array"));if(W.type!=="secret")throw TypeError(`${$G(W)} instances for symmetric algorithms must be of type "secret"`)},fx=(J,W,X)=>{if(oX(W))switch(X){case"decrypt":case"sign":if(HB(W)&&MD(J,W,X))return;throw TypeError("JSON Web Key for this operation be a private JWK");case"encrypt":case"verify":if(ZB(W)&&MD(J,W,X))return;throw TypeError("JSON Web Key for this operation be a public JWK")}if(!v$(W))throw TypeError(ZD(J,W,"CryptoKey","KeyObject","JSON Web Key"));if(W.type==="secret")throw TypeError(`${$G(W)} instances for asymmetric algorithms must not be of type "secret"`);if(W.type==="public")switch(X){case"sign":throw TypeError(`${$G(W)} instances for asymmetric algorithm signing must be of type "private"`);case"decrypt":throw TypeError(`${$G(W)} instances for asymmetric algorithm decryption must be of type "private"`);default:break}if(W.type==="private")switch(X){case"verify":throw TypeError(`${$G(W)} instances for asymmetric algorithm verifying must be of type "public"`);case"encrypt":throw TypeError(`${$G(W)} instances for asymmetric algorithm encryption must be of type "public"`);default:break}},WX=(J,W,X)=>{if(J.startsWith("HS")||J==="dir"||J.startsWith("PBES2")||/^A(?:128|192|256)(?:GCM)?(?:KW)?$/.test(J)||/^A(?:128|192|256)CBC-HS(?:256|384|512)$/.test(J))hx(J,W,X);else fx(J,W,X)};var S$=D(()=>{KH()});async function NB(J,W,X){if(!D4(J))throw new J6("Flattened JWE must be an object");if(J.protected===void 0&&J.header===void 0&&J.unprotected===void 0)throw new J6("JOSE Header missing");if(J.iv!==void 0&&typeof J.iv!=="string")throw new J6("JWE Initialization Vector incorrect type");if(typeof J.ciphertext!=="string")throw new J6("JWE Ciphertext missing or incorrect type");if(J.tag!==void 0&&typeof J.tag!=="string")throw new J6("JWE Authentication Tag incorrect type");if(J.protected!==void 0&&typeof J.protected!=="string")throw new J6("JWE Protected Header incorrect type");if(J.encrypted_key!==void 0&&typeof J.encrypted_key!=="string")throw new J6("JWE Encrypted Key incorrect type");if(J.aad!==void 0&&typeof J.aad!=="string")throw new J6("JWE AAD incorrect type");if(J.header!==void 0&&!D4(J.header))throw new J6("JWE Shared Unprotected Header incorrect type");if(J.unprotected!==void 0&&!D4(J.unprotected))throw new J6("JWE Per-Recipient Unprotected Header incorrect type");let G;if(J.protected)try{let j=N4(J.protected);G=JSON.parse(A4.decode(j))}catch{throw new J6("JWE Protected Header is invalid")}if(!sW(G,J.header,J.unprotected))throw new J6("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let Y={...G,...J.header,...J.unprotected};if(JX(J6,new Map,X?.crit,G,Y),Y.zip!==void 0)throw new V6('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');let{alg:$,enc:K}=Y;if(typeof $!=="string"||!$)throw new J6("missing JWE Algorithm (alg) in JWE Header");if(typeof K!=="string"||!K)throw new J6("missing JWE Encryption Algorithm (enc) in JWE Header");let w=X&&_$("keyManagementAlgorithms",X.keyManagementAlgorithms),H=X&&_$("contentEncryptionAlgorithms",X.contentEncryptionAlgorithms);if(w&&!w.has($)||!w&&$.startsWith("PBES2"))throw new JG('"alg" (Algorithm) Header Parameter value not allowed');if(H&&!H.has(K))throw new JG('"enc" (Encryption Algorithm) Header Parameter value not allowed');let Z;if(J.encrypted_key!==void 0)try{Z=N4(J.encrypted_key)}catch{throw new J6("Failed to base64url decode the encrypted_key")}let z=!1;if(typeof W==="function")W=await W(G,J),z=!0;WX($==="dir"?K:$,W,"decrypt");let N=await IJ(W,$),F;try{F=await KB($,N,Z,Y,X)}catch(j){if(j instanceof TypeError||j instanceof J6||j instanceof V6)throw j;F=eW(K)}let Q,V;if(J.iv!==void 0)try{Q=N4(J.iv)}catch{throw new J6("Failed to base64url decode the iv")}if(J.tag!==void 0)try{V=N4(J.tag)}catch{throw new J6("Failed to base64url decode the tag")}let v=o6.encode(J.protected??""),M;if(J.aad!==void 0)M=o4(v,o6.encode("."),o6.encode(J.aad));else M=v;let O;try{O=N4(J.ciphertext)}catch{throw new J6("Failed to base64url decode the ciphertext")}let T={plaintext:await s7(K,F,O,Q,V,M)};if(J.protected!==void 0)T.protectedHeader=G;if(J.aad!==void 0)try{T.additionalAuthenticatedData=N4(J.aad)}catch{throw new J6("Failed to base64url decode the aad")}if(J.unprotected!==void 0)T.sharedUnprotectedHeader=J.unprotected;if(J.header!==void 0)T.unprotectedHeader=J.header;if(z)return{...T,key:N};return T}var UB=D(()=>{P0();zD();y6();wB();F0();YH();j$();GG();S$()});async function QB(J,W,X){if(J instanceof Uint8Array)J=A4.decode(J);if(typeof J!=="string")throw new J6("Compact JWE must be a string or Uint8Array");let{0:G,1:Y,2:$,3:K,4:w,length:H}=J.split(".");if(H!==5)throw new J6("Invalid Compact JWE");let Z=await NB({ciphertext:K,iv:$||void 0,protected:G,tag:w||void 0,encrypted_key:Y||void 0},W,X),z={plaintext:Z.plaintext,protectedHeader:Z.protectedHeader};if(typeof W==="function")return{...z,key:Z.key};return z}var LB=D(()=>{UB();y6();F0()});var VB;var DB=D(()=>{VB=Symbol()});async function OD(J){if(D$(J))if(J.type==="secret")J=J.export();else return J.export({format:"jwk"});if(J instanceof Uint8Array)return{kty:"oct",k:O4(J)};if(!CJ(J))throw TypeError(b8(J,"CryptoKey","KeyObject","Uint8Array"));if(!J.extractable)throw TypeError("non-extractable CryptoKey cannot be exported as a JWK");let{ext:W,key_ops:X,alg:G,use:Y,...$}=await crypto.subtle.exportKey("jwk",J);if($.kty==="AKP")$.alg=G;return $}var vB=D(()=>{P0()});async function XX(J){return OD(J)}var wH=D(()=>{vB()});var MB=async(J,W,X,G,Y={})=>{let $,K,w;switch(J){case"dir":{w=X;break}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(aX(X),!XH(X))throw new V6("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:H,apv:Z}=Y,z;if(Y.epk)z=await IJ(Y.epk,J);else z=(await crypto.subtle.generateKey(X.algorithm,!0,["deriveBits"])).privateKey;let{x:N,y:F,crv:Q,kty:V}=await XX(z),v=await WH(X,z,J==="ECDH-ES"?W:J,J==="ECDH-ES"?P$(W):parseInt(J.slice(-5,-2),10),H,Z);if(K={epk:{x:N,crv:Q,kty:V}},V==="EC")K.epk.y=F;if(H)K.apu=O4(H);if(Z)K.apv=O4(Z);if(J==="ECDH-ES"){w=v;break}w=G||eW(W);let M=J.slice(-6);$=await M$(M,v,w);break}case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{w=G||eW(W),aX(X),$=await WB(J,X,w);break}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{w=G||eW(W);let{p2c:H,p2s:Z}=Y;({encryptedKey:$,...K}=await oq(J,X,w,H,Z));break}case"A128KW":case"A192KW":case"A256KW":{w=G||eW(W),$=await M$(J,X,w);break}case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{w=G||eW(W);let{iv:H}=Y;({encryptedKey:$,...K}=await GB(J,X,w,H));break}default:throw new V6('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:w,encryptedKey:$,parameters:K}};var OB=D(()=>{e7();UD();QD();LD();P0();GG();YH();y6();wH();vD()});class PD{#J;#W;#X;#Y;#G;#w;#K;#$;constructor(J){if(!(J instanceof Uint8Array))throw TypeError("plaintext must be an instance of Uint8Array");this.#J=J}setKeyManagementParameters(J){if(this.#$)throw TypeError("setKeyManagementParameters can only be called once");return this.#$=J,this}setProtectedHeader(J){if(this.#W)throw TypeError("setProtectedHeader can only be called once");return this.#W=J,this}setSharedUnprotectedHeader(J){if(this.#X)throw TypeError("setSharedUnprotectedHeader can only be called once");return this.#X=J,this}setUnprotectedHeader(J){if(this.#Y)throw TypeError("setUnprotectedHeader can only be called once");return this.#Y=J,this}setAdditionalAuthenticatedData(J){return this.#G=J,this}setContentEncryptionKey(J){if(this.#w)throw TypeError("setContentEncryptionKey can only be called once");return this.#w=J,this}setInitializationVector(J){if(this.#K)throw TypeError("setInitializationVector can only be called once");return this.#K=J,this}async encrypt(J,W){if(!this.#W&&!this.#Y&&!this.#X)throw new J6("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!sW(this.#W,this.#Y,this.#X))throw new J6("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let X={...this.#W,...this.#Y,...this.#X};if(JX(J6,new Map,W?.crit,this.#W,X),X.zip!==void 0)throw new V6('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');let{alg:G,enc:Y}=X;if(typeof G!=="string"||!G)throw new J6('JWE "alg" (Algorithm) Header Parameter missing or invalid');if(typeof Y!=="string"||!Y)throw new J6('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');let $;if(this.#w&&(G==="dir"||G==="ECDH-ES"))throw TypeError(`setContentEncryptionKey cannot be called with JWE "alg" (Algorithm) Header ${G}`);WX(G==="dir"?Y:G,J,"encrypt");let K;{let V,v=await IJ(J,G);if({cek:K,encryptedKey:$,parameters:V}=await MB(G,Y,v,this.#w,this.#$),V)if(W&&VB in W)if(!this.#Y)this.setUnprotectedHeader(V);else this.#Y={...this.#Y,...V};else if(!this.#W)this.setProtectedHeader(V);else this.#W={...this.#W,...V}}let w,H,Z;if(this.#W)H=o6.encode(O4(JSON.stringify(this.#W)));else H=o6.encode("");if(this.#G)Z=O4(this.#G),w=o4(H,o6.encode("."),o6.encode(Z));else w=H;let{ciphertext:z,tag:N,iv:F}=await $H(Y,this.#J,K,this.#K,w),Q={ciphertext:O4(z)};if(F)Q.iv=O4(F);if(N)Q.tag=O4(N);if($)Q.encrypted_key=O4($);if(Z)Q.aad=Z;if(this.#W)Q.protected=A4.decode(H);if(this.#X)Q.unprotected=this.#X;if(this.#Y)Q.header=this.#Y;return Q}}var PB=D(()=>{P0();DB();DD();OB();y6();F0();j$();GG();S$()});var HH=(J,W)=>{let X=`SHA-${J.slice(-3)}`;switch(J){case"HS256":case"HS384":case"HS512":return{hash:X,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:X,name:"RSA-PSS",saltLength:parseInt(J.slice(-3),10)>>3};case"RS256":case"RS384":case"RS512":return{hash:X,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:X,name:"ECDSA",namedCurve:W.namedCurve};case"Ed25519":case"EdDSA":return{name:"Ed25519"};case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":return{name:J};default:throw new V6(`alg ${J} is not supported either by JOSE or your javascript runtime`)}};var jD=D(()=>{y6()});var ZH=async(J,W,X)=>{if(W instanceof Uint8Array){if(!J.startsWith("HS"))throw TypeError(b8(W,"CryptoKey","KeyObject","JSON Web Key"));return crypto.subtle.importKey("raw",W,{hash:`SHA-${J.slice(-3)}`,name:"HMAC"},!1,[X])}return dq(W,J,X),W};var _D=()=>{};var jB=async(J,W,X,G)=>{let Y=await ZH(J,W,"verify");tX(J,Y);let $=HH(J,Y.algorithm);try{return await crypto.subtle.verify($,Y,X,G)}catch{return!1}};var _B=D(()=>{jD();_D()});async function SB(J,W,X){if(!D4(J))throw new Z4("Flattened JWS must be an object");if(J.protected===void 0&&J.header===void 0)throw new Z4('Flattened JWS must have either of the "protected" or "header" members');if(J.protected!==void 0&&typeof J.protected!=="string")throw new Z4("JWS Protected Header incorrect type");if(J.payload===void 0)throw new Z4("JWS Payload missing");if(typeof J.signature!=="string")throw new Z4("JWS Signature missing or incorrect type");if(J.header!==void 0&&!D4(J.header))throw new Z4("JWS Unprotected Header incorrect type");let G={};if(J.protected)try{let M=N4(J.protected);G=JSON.parse(A4.decode(M))}catch{throw new Z4("JWS Protected Header is invalid")}if(!sW(G,J.header))throw new Z4("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let Y={...G,...J.header},$=JX(Z4,new Map([["b64",!0]]),X?.crit,G,Y),K=!0;if($.has("b64")){if(K=G.b64,typeof K!=="boolean")throw new Z4('The "b64" (base64url-encode payload) Header Parameter must be a boolean')}let{alg:w}=Y;if(typeof w!=="string"||!w)throw new Z4('JWS "alg" (Algorithm) Header Parameter missing or invalid');let H=X&&_$("algorithms",X.algorithms);if(H&&!H.has(w))throw new JG('"alg" (Algorithm) Header Parameter value not allowed');if(K){if(typeof J.payload!=="string")throw new Z4("JWS Payload must be a string")}else if(typeof J.payload!=="string"&&!(J.payload instanceof Uint8Array))throw new Z4("JWS Payload must be a string or an Uint8Array instance");let Z=!1;if(typeof W==="function")W=await W(G,J),Z=!0;WX(w,W,"verify");let z=o4(o6.encode(J.protected??""),o6.encode("."),typeof J.payload==="string"?o6.encode(J.payload):J.payload),N;try{N=N4(J.signature)}catch{throw new Z4("Failed to base64url decode the signature")}let F=await IJ(W,w);if(!await jB(w,F,N,z))throw new GD;let V;if(K)try{V=N4(J.payload)}catch{throw new Z4("Failed to base64url decode the payload")}else if(typeof J.payload==="string")V=o6.encode(J.payload);else V=J.payload;let v={payload:V};if(J.protected!==void 0)v.protectedHeader=G;if(J.header!==void 0)v.unprotectedHeader=J.header;if(Z)return{...v,key:F};return v}var TB=D(()=>{P0();_B();y6();F0();S$();j$();GG()});async function qB(J,W,X){if(J instanceof Uint8Array)J=A4.decode(J);if(typeof J!=="string")throw new Z4("Compact JWS must be a string or Uint8Array");let{0:G,1:Y,2:$,length:K}=J.split(".");if(K!==3)throw new Z4("Invalid Compact JWS");let w=await SB({payload:Y,protected:G,signature:$},W,X),H={payload:w.payload,protectedHeader:w.protectedHeader};if(typeof W==="function")return{...H,key:w.key};return H}var BB=D(()=>{TB();y6();F0()});var NW=(J)=>Math.floor(J.getTime()/1000);var gx,KG=(J)=>{let W=gx.exec(J);if(!W||W[4]&&W[1])throw TypeError("Invalid time period format");let X=parseFloat(W[2]),G=W[3].toLowerCase(),Y;switch(G){case"sec":case"secs":case"second":case"seconds":case"s":Y=Math.round(X);break;case"minute":case"minutes":case"min":case"mins":case"m":Y=Math.round(X*60);break;case"hour":case"hours":case"hr":case"hrs":case"h":Y=Math.round(X*3600);break;case"day":case"days":case"d":Y=Math.round(X*86400);break;case"week":case"weeks":case"w":Y=Math.round(X*604800);break;default:Y=Math.round(X*31557600);break}if(W[1]==="-"||W[4]==="ago")return-Y;return Y};var AB=D(()=>{gx=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i});function sX(J,W){if(!Number.isFinite(W))throw TypeError(`Invalid ${J} input`);return W}function zH(J,W,X={}){let G;try{G=JSON.parse(A4.decode(W))}catch{}if(!D4(G))throw new f0("JWT Claims Set must be a top-level JSON object");let{typ:Y}=X;if(Y&&(typeof J.typ!=="string"||EB(J.typ)!==EB(Y)))throw new j0('unexpected "typ" JWT header value',G,"typ","check_failed");let{requiredClaims:$=[],issuer:K,subject:w,audience:H,maxTokenAge:Z}=X,z=[...$];if(Z!==void 0)z.push("iat");if(H!==void 0)z.push("aud");if(w!==void 0)z.push("sub");if(K!==void 0)z.push("iss");for(let V of new Set(z.reverse()))if(!(V in G))throw new j0(`missing required "${V}" claim`,G,V,"missing");if(K&&!(Array.isArray(K)?K:[K]).includes(G.iss))throw new j0('unexpected "iss" claim value',G,"iss","check_failed");if(w&&G.sub!==w)throw new j0('unexpected "sub" claim value',G,"sub","check_failed");if(H&&!mx(G.aud,typeof H==="string"?[H]:H))throw new j0('unexpected "aud" claim value',G,"aud","check_failed");let N;switch(typeof X.clockTolerance){case"string":N=KG(X.clockTolerance);break;case"number":N=X.clockTolerance;break;case"undefined":N=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:F}=X,Q=NW(F||new Date);if((G.iat!==void 0||Z)&&typeof G.iat!=="number")throw new j0('"iat" claim must be a number',G,"iat","invalid");if(G.nbf!==void 0){if(typeof G.nbf!=="number")throw new j0('"nbf" claim must be a number',G,"nbf","invalid");if(G.nbf>Q+N)throw new j0('"nbf" claim timestamp check failed',G,"nbf","check_failed")}if(G.exp!==void 0){if(typeof G.exp!=="number")throw new j0('"exp" claim must be a number',G,"exp","invalid");if(G.exp<=Q-N)throw new eY('"exp" claim timestamp check failed',G,"exp","check_failed")}if(Z){let V=Q-G.iat,v=typeof Z==="number"?Z:KG(Z);if(V-N>v)throw new eY('"iat" claim timestamp check failed (too far in the past)',G,"iat","check_failed");if(V<0-N)throw new j0('"iat" claim timestamp check failed (it should be in the past)',G,"iat","check_failed")}return G}class T${#J;constructor(J){if(!D4(J))throw TypeError("JWT Claims Set MUST be an object");this.#J=structuredClone(J)}data(){return o6.encode(JSON.stringify(this.#J))}get iss(){return this.#J.iss}set iss(J){this.#J.iss=J}get sub(){return this.#J.sub}set sub(J){this.#J.sub=J}get aud(){return this.#J.aud}set aud(J){this.#J.aud=J}set jti(J){this.#J.jti=J}set nbf(J){if(typeof J==="number")this.#J.nbf=sX("setNotBefore",J);else if(J instanceof Date)this.#J.nbf=sX("setNotBefore",NW(J));else this.#J.nbf=NW(new Date)+KG(J)}set exp(J){if(typeof J==="number")this.#J.exp=sX("setExpirationTime",J);else if(J instanceof Date)this.#J.exp=sX("setExpirationTime",NW(J));else this.#J.exp=NW(new Date)+KG(J)}set iat(J){if(typeof J>"u")this.#J.iat=NW(new Date);else if(J instanceof Date)this.#J.iat=sX("setIssuedAt",NW(J));else if(typeof J==="string")this.#J.iat=sX("setIssuedAt",NW(new Date)+KG(J));else this.#J.iat=sX("setIssuedAt",J)}}var EB=(J)=>{if(J.includes("/"))return J.toLowerCase();return`application/${J.toLowerCase()}`},mx=(J,W)=>{if(typeof J==="string")return W.includes(J);if(Array.isArray(J))return W.some(Set.prototype.has.bind(new Set(J)));return!1};var q$=D(()=>{y6();F0();AB();F0()});async function P8(J,W,X){let G=await qB(J,W,X);if(G.protectedHeader.crit?.includes("b64")&&G.protectedHeader.b64===!1)throw new f0("JWTs MUST NOT use unencoded payload");let $={payload:zH(G.protectedHeader,G.payload,X),protectedHeader:G.protectedHeader};if(typeof W==="function")return{...$,key:G.key};return $}var RB=D(()=>{BB();q$();y6()});async function SD(J,W,X){let G=await QB(J,W,X),Y=zH(G.protectedHeader,G.plaintext,X),{protectedHeader:$}=G;if($.iss!==void 0&&$.iss!==Y.iss)throw new j0('replicated "iss" claim header parameter mismatch',Y,"iss","mismatch");if($.sub!==void 0&&$.sub!==Y.sub)throw new j0('replicated "sub" claim header parameter mismatch',Y,"sub","mismatch");if($.aud!==void 0&&JSON.stringify($.aud)!==JSON.stringify(Y.aud))throw new j0('replicated "aud" claim header parameter mismatch',Y,"aud","mismatch");let K={payload:Y,protectedHeader:$};if(typeof W==="function")return{...K,key:G.key};return K}var CB=D(()=>{LB();q$();y6()});class TD{#J;constructor(J){this.#J=new PD(J)}setContentEncryptionKey(J){return this.#J.setContentEncryptionKey(J),this}setInitializationVector(J){return this.#J.setInitializationVector(J),this}setProtectedHeader(J){return this.#J.setProtectedHeader(J),this}setKeyManagementParameters(J){return this.#J.setKeyManagementParameters(J),this}async encrypt(J,W){let X=await this.#J.encrypt(J,W);return[X.protected,X.encrypted_key,X.iv,X.ciphertext,X.tag].join(".")}}var IB=D(()=>{PB()});var bB=async(J,W,X)=>{let G=await ZH(J,W,"sign");tX(J,G);let Y=await crypto.subtle.sign(HH(J,G.algorithm),G,X);return new Uint8Array(Y)};var kB=D(()=>{jD();_D()});class qD{#J;#W;#X;constructor(J){if(!(J instanceof Uint8Array))throw TypeError("payload must be an instance of Uint8Array");this.#J=J}setProtectedHeader(J){if(this.#W)throw TypeError("setProtectedHeader can only be called once");return this.#W=J,this}setUnprotectedHeader(J){if(this.#X)throw TypeError("setUnprotectedHeader can only be called once");return this.#X=J,this}async sign(J,W){if(!this.#W&&!this.#X)throw new Z4("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!sW(this.#W,this.#X))throw new Z4("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");let X={...this.#W,...this.#X},G=JX(Z4,new Map([["b64",!0]]),W?.crit,this.#W,X),Y=!0;if(G.has("b64")){if(Y=this.#W.b64,typeof Y!=="boolean")throw new Z4('The "b64" (base64url-encode payload) Header Parameter must be a boolean')}let{alg:$}=X;if(typeof $!=="string"||!$)throw new Z4('JWS "alg" (Algorithm) Header Parameter missing or invalid');WX($,J,"sign");let K=this.#J;if(Y)K=o6.encode(O4(K));let w;if(this.#W)w=o6.encode(O4(JSON.stringify(this.#W)));else w=o6.encode("");let H=o4(w,o6.encode("."),K),Z=await IJ(J,$),z=await bB($,Z,H),N={signature:O4(z),payload:""};if(Y)N.payload=A4.decode(K);if(this.#X)N.header=this.#X;if(this.#W)N.protected=A4.decode(w);return N}}var hB=D(()=>{P0();kB();y6();F0();S$();j$();GG()});class BD{#J;constructor(J){this.#J=new qD(J)}setProtectedHeader(J){return this.#J.setProtectedHeader(J),this}async sign(J,W){let X=await this.#J.sign(J,W);if(X.payload===void 0)throw TypeError("use the flattened module for creating JWS with b64: false");return`${X.protected}.${X.payload}.${X.signature}`}}var fB=D(()=>{hB()});class bJ{#J;#W;constructor(J={}){this.#W=new T$(J)}setIssuer(J){return this.#W.iss=J,this}setSubject(J){return this.#W.sub=J,this}setAudience(J){return this.#W.aud=J,this}setJti(J){return this.#W.jti=J,this}setNotBefore(J){return this.#W.nbf=J,this}setExpirationTime(J){return this.#W.exp=J,this}setIssuedAt(J){return this.#W.iat=J,this}setProtectedHeader(J){return this.#J=J,this}async sign(J,W){let X=new BD(this.#W.data());if(X.setProtectedHeader(this.#J),Array.isArray(this.#J?.crit)&&this.#J.crit.includes("b64")&&this.#J.b64===!1)throw new f0("JWTs MUST NOT use unencoded payload");return X.sign(J,W)}}var gB=D(()=>{fB();y6();q$()});class FH{#J;#W;#X;#Y;#G;#w;#K;#$;constructor(J={}){this.#$=new T$(J)}setIssuer(J){return this.#$.iss=J,this}setSubject(J){return this.#$.sub=J,this}setAudience(J){return this.#$.aud=J,this}setJti(J){return this.#$.jti=J,this}setNotBefore(J){return this.#$.nbf=J,this}setExpirationTime(J){return this.#$.exp=J,this}setIssuedAt(J){return this.#$.iat=J,this}setProtectedHeader(J){if(this.#Y)throw TypeError("setProtectedHeader can only be called once");return this.#Y=J,this}setKeyManagementParameters(J){if(this.#X)throw TypeError("setKeyManagementParameters can only be called once");return this.#X=J,this}setContentEncryptionKey(J){if(this.#J)throw TypeError("setContentEncryptionKey can only be called once");return this.#J=J,this}setInitializationVector(J){if(this.#W)throw TypeError("setInitializationVector can only be called once");return this.#W=J,this}replicateIssuerAsHeader(){return this.#G=!0,this}replicateSubjectAsHeader(){return this.#w=!0,this}replicateAudienceAsHeader(){return this.#K=!0,this}async encrypt(J,W){let X=new TD(this.#$.data());if(this.#Y&&(this.#G||this.#w||this.#K))this.#Y={...this.#Y,iss:this.#G?this.#$.iss:void 0,sub:this.#w?this.#$.sub:void 0,aud:this.#K?this.#$.aud:void 0};if(X.setProtectedHeader(this.#Y),this.#W)X.setInitializationVector(this.#W);if(this.#J)X.setContentEncryptionKey(this.#J);if(this.#X)X.setKeyManagementParameters(this.#X);return X.encrypt(J,W)}}var mB=D(()=>{IB();q$()});async function NH(J,W){let X;if(oX(J))X=J;else if(v$(J))X=await XX(J);else throw TypeError(b8(J,"CryptoKey","KeyObject","JSON Web Key"));if(W??="sha256",W!=="sha256"&&W!=="sha384"&&W!=="sha512")throw TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');let G;switch(X.kty){case"AKP":kJ(X.alg,'"alg" (Algorithm) Parameter'),kJ(X.pub,'"pub" (Public key) Parameter'),G={alg:X.alg,kty:X.kty,pub:X.pub};break;case"EC":kJ(X.crv,'"crv" (Curve) Parameter'),kJ(X.x,'"x" (X Coordinate) Parameter'),kJ(X.y,'"y" (Y Coordinate) Parameter'),G={crv:X.crv,kty:X.kty,x:X.x,y:X.y};break;case"OKP":kJ(X.crv,'"crv" (Subtype of Key Pair) Parameter'),kJ(X.x,'"x" (Public Key) Parameter'),G={crv:X.crv,kty:X.kty,x:X.x};break;case"RSA":kJ(X.e,'"e" (Exponent) Parameter'),kJ(X.n,'"n" (Modulus) Parameter'),G={e:X.e,kty:X.kty,n:X.n};break;case"oct":kJ(X.k,'"k" (Key Value) Parameter'),G={k:X.k,kty:X.kty};break;default:throw new V6('"kty" (Key Type) Parameter missing or unsupported')}let Y=o6.encode(JSON.stringify(G));return O4(await JH(W,Y))}var kJ=(J,W)=>{if(typeof J!=="string"||!J)throw new WD(`${W} missing or invalid`)};var yB=D(()=>{P0();y6();F0();KH();wH()});function yx(J){switch(typeof J==="string"&&J.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";case"ML":return"AKP";default:throw new V6('Unsupported "alg" value for a JSON Web Key Set')}}function xx(J){return J&&typeof J==="object"&&Array.isArray(J.keys)&&J.keys.every(ux)}function ux(J){return D4(J)}class uB{#J;#W=new WeakMap;constructor(J){if(!xx(J))throw new a7("JSON Web Key Set malformed");this.#J=structuredClone(J)}jwks(){return this.#J}async getKey(J,W){let{alg:X,kid:G}={...J,...W?.header},Y=yx(X),$=this.#J.keys.filter((H)=>{let Z=Y===H.kty;if(Z&&typeof G==="string")Z=G===H.kid;if(Z&&(typeof H.alg==="string"||Y==="AKP"))Z=X===H.alg;if(Z&&typeof H.use==="string")Z=H.use==="sig";if(Z&&Array.isArray(H.key_ops))Z=H.key_ops.includes("verify");if(Z)switch(X){case"ES256":Z=H.crv==="P-256";break;case"ES384":Z=H.crv==="P-384";break;case"ES512":Z=H.crv==="P-521";break;case"Ed25519":case"EdDSA":Z=H.crv==="Ed25519";break}return Z}),{0:K,length:w}=$;if(w===0)throw new V$;if(w!==1){let H=new XD,Z=this.#W;throw H[Symbol.asyncIterator]=async function*(){for(let z of $)try{yield await xB(Z,z,X)}catch{}},H}return xB(this.#W,K,X)}}async function xB(J,W,X){let G=J.get(W)||J.set(W,{}).get(W);if(G[X]===void 0){let Y=await GJ({...W,ext:!0},X);if(Y instanceof Uint8Array||Y.type!=="public")throw new a7("JSON Web Key Set members must be public keys");G[X]=Y}return G[X]}function AD(J){let W=new uB(J),X=async(G,Y)=>W.getKey(G,Y);return Object.defineProperties(X,{jwks:{value:()=>structuredClone(W.jwks()),enumerable:!1,configurable:!1,writable:!1}}),X}var lB=D(()=>{GH();y6()});function lx(){return typeof WebSocketPair<"u"||typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"||typeof EdgeRuntime<"u"&&EdgeRuntime==="vercel"}async function cx(J,W,X,G=fetch){let Y=await G(J,{method:"GET",signal:X,redirect:"manual",headers:W}).catch(($)=>{if($.name==="TimeoutError")throw new YD;throw $});if(Y.status!==200)throw new s4("Expected 200 OK from the JSON Web Key Set HTTP response");try{return await Y.json()}catch{throw new s4("Failed to parse the JSON Web Key Set HTTP response as JSON")}}function px(J,W){if(typeof J!=="object"||J===null)return!1;if(!("uat"in J)||typeof J.uat!=="number"||Date.now()-J.uat>=W)return!1;if(!("jwks"in J)||!D4(J.jwks)||!Array.isArray(J.jwks.keys)||!Array.prototype.every.call(J.jwks.keys,D4))return!1;return!0}class pB{#J;#W;#X;#Y;#G;#w;#K;#$;#H;#Z;constructor(J,W){if(!(J instanceof URL))throw TypeError("url must be an instance of URL");if(this.#J=new URL(J.href),this.#W=typeof W?.timeoutDuration==="number"?W?.timeoutDuration:5000,this.#X=typeof W?.cooldownDuration==="number"?W?.cooldownDuration:30000,this.#Y=typeof W?.cacheMaxAge==="number"?W?.cacheMaxAge:600000,this.#K=new Headers(W?.headers),ED&&!this.#K.has("User-Agent"))this.#K.set("User-Agent",ED);if(!this.#K.has("accept"))this.#K.set("accept","application/json"),this.#K.append("accept","application/jwk-set+json");if(this.#$=W?.[cB],W?.[UH]!==void 0){if(this.#Z=W?.[UH],px(W?.[UH],this.#Y))this.#G=this.#Z.uat,this.#H=AD(this.#Z.jwks)}}pendingFetch(){return!!this.#w}coolingDown(){return typeof this.#G==="number"?Date.now()<this.#G+this.#X:!1}fresh(){return typeof this.#G==="number"?Date.now()<this.#G+this.#Y:!1}jwks(){return this.#H?.jwks()}async getKey(J,W){if(!this.#H||!this.fresh())await this.reload();try{return await this.#H(J,W)}catch(X){if(X instanceof V$){if(this.coolingDown()===!1)return await this.reload(),this.#H(J,W)}throw X}}async reload(){if(this.#w&&lx())this.#w=void 0;this.#w||=cx(this.#J.href,this.#K,AbortSignal.timeout(this.#W),this.#$).then((J)=>{if(this.#H=AD(J),this.#Z)this.#Z.uat=Date.now(),this.#Z.jwks=J;this.#G=Date.now(),this.#w=void 0}).catch((J)=>{throw this.#w=void 0,J}),await this.#w}}function RD(J,W){let X=new pB(J,W),G=async(Y,$)=>X.getKey(Y,$);return Object.defineProperties(G,{coolingDown:{get:()=>X.coolingDown(),enumerable:!0,configurable:!1},fresh:{get:()=>X.fresh(),enumerable:!0,configurable:!1},reload:{value:()=>X.reload(),enumerable:!0,configurable:!1,writable:!1},reloading:{get:()=>X.pendingFetch(),enumerable:!0,configurable:!1},jwks:{value:()=>X.jwks(),enumerable:!0,configurable:!1,writable:!1}}),G}var ED,cB,UH;var dB=D(()=>{y6();lB();if(typeof navigator>"u"||!navigator.userAgent?.startsWith?.("Mozilla/5.0 "))ED="jose/v6.1.0";cB=Symbol();UH=Symbol()});function QH(J){let W;if(typeof J==="string"){let X=J.split(".");if(X.length===3||X.length===5)[W]=X}else if(typeof J==="object"&&J)if("protected"in J)W=J.protected;else throw TypeError("Token does not contain a Protected Header");try{if(typeof W!=="string"||!W)throw Error();let X=JSON.parse(A4.decode(N4(W)));if(!D4(X))throw Error();return X}catch{throw TypeError("Invalid Token or Protected Header formatting")}}var nB=D(()=>{P0();F0()});function $J(J){if(typeof J!=="string")throw new f0("JWTs must use Compact JWS serialization, JWT must be a string");let{1:W,length:X}=J.split(".");if(X===5)throw new f0("Only JWTs using Compact JWS serialization can be decoded");if(X!==3)throw new f0("Invalid JWT");if(!W)throw new f0("JWTs must contain a payload");let G;try{G=N4(W)}catch{throw new f0("Failed to base64url decode the payload")}let Y;try{Y=JSON.parse(A4.decode(G))}catch{throw new f0("Failed to parse the decoded payload as JSON")}if(!D4(Y))throw new f0("Invalid JWT Claims Set");return Y}var rB=D(()=>{P0();F0();y6()});function CD(J){let W=J?.modulusLength??2048;if(typeof W!=="number"||W<2048)throw new V6("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");return W}async function ID(J,W){let X,G;switch(J){case"PS256":case"PS384":case"PS512":X={name:"RSA-PSS",hash:`SHA-${J.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:CD(W)},G=["sign","verify"];break;case"RS256":case"RS384":case"RS512":X={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${J.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:CD(W)},G=["sign","verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":X={name:"RSA-OAEP",hash:`SHA-${parseInt(J.slice(-3),10)||1}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:CD(W)},G=["decrypt","unwrapKey","encrypt","wrapKey"];break;case"ES256":X={name:"ECDSA",namedCurve:"P-256"},G=["sign","verify"];break;case"ES384":X={name:"ECDSA",namedCurve:"P-384"},G=["sign","verify"];break;case"ES512":X={name:"ECDSA",namedCurve:"P-521"},G=["sign","verify"];break;case"Ed25519":case"EdDSA":{G=["sign","verify"],X={name:"Ed25519"};break}case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":{G=["sign","verify"],X={name:J};break}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{G=["deriveBits"];let Y=W?.crv??"P-256";switch(Y){case"P-256":case"P-384":case"P-521":{X={name:"ECDH",namedCurve:Y};break}case"X25519":X={name:"X25519"};break;default:throw new V6("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, and X25519")}break}default:throw new V6('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}return crypto.subtle.generateKey(X,W?.extractable??!1,G)}var iB=D(()=>{y6()});var eX=D(()=>{RB();CB();gB();mB();yB();dB();wH();GH();nB();rB();y6();iB();P0()});async function LH(J,W,X=3600){return await new bJ(J).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime(Math.floor(Date.now()/1000)+X).sign(new TextEncoder().encode(W))}async function bD(J,W){try{return(await P8(J,new TextEncoder().encode(W))).payload}catch(X){return null}}async function sB(J,W,X,G=3600){let Y=eV(UY,new TextEncoder().encode(W),new TextEncoder().encode(X),aB,64),$=await NH({kty:"oct",k:Q$.encode(Y)},"sha256");return await new FH(J).setProtectedHeader({alg:tB,enc:oB,kid:$}).setIssuedAt().setExpirationTime(dx()+G).setJti(crypto.randomUUID()).encrypt(Y)}async function kD(J,W,X){if(!J)return null;try{let{payload:G}=await SD(J,async({kid:Y})=>{let $=eV(UY,new TextEncoder().encode(W),new TextEncoder().encode(X),aB,64);if(Y===void 0)return $;if(Y===await NH({kty:"oct",k:Q$.encode($)},"sha256"))return $;throw Error("no matching decryption secret")},{clockTolerance:15,keyManagementAlgorithms:[tB],contentEncryptionAlgorithms:[oB,"A256GCM"]});return G}catch(G){return null}}var aB,dx=()=>Date.now()/1000|0,tB="dir",oB="A256CBC-HS512";var UW=D(()=>{xq();kF();eX();aB=new Uint8Array([66,101,116,116,101,114,65,117,116,104,46,106,115,32,71,101,110,101,114,97,116,101,100,32,69,110,99,114,121,112,116,105,111,110,32,75,101,121])});var wG=()=>{};function nx(J,W,X){if(X==="update"){if(J===void 0&&W.onUpdate!==void 0){if(typeof W.onUpdate==="function")return W.onUpdate();return W.onUpdate}return J}if(X==="create"){if(J===void 0||W.required===!0&&J===null){if(W.defaultValue!==void 0){if(typeof W.defaultValue==="function")return W.defaultValue();return W.defaultValue}}}return J}function P4(J){if(n7()<8)return`#${J}`;return`${b4.fg.magenta}#${J}${b4.reset}`}function j4(J,W){return`${b4.bg.black}${b4.fg.yellow}[${J}/${W}]${b4.reset}`}function _4(J){return`${b4.bright}${J}${b4.reset}`}function x4(J){return`${b4.dim}(${J})${b4.reset}`}var eB=({usePlural:J,schema:W,disableIdGeneration:X,options:G,customIdGenerator:Y,supportsUUIDs:$})=>{let K=CX({usePlural:J,schema:W});return({customModelName:H,forceAllowId:Z})=>{let z=G.advanced?.database?.useNumberId||G.advanced?.database?.generateId==="serial",N=G.advanced?.database?.generateId==="uuid",F=(()=>{if(X)return!1;else if(z&&!Z)return!1;else if(N)return!$;else return!0})(),Q=K(H??"id");return{type:z?"number":"string",required:F?!0:!1,...F?{defaultValue(){if(X)return;let V=G.advanced?.database?.generateId;if(V===!1||z)return;if(typeof V==="function")return V({model:Q});if(Y)return Y({model:Q});if(V==="uuid")return crypto.randomUUID();return f4()}}:{},transform:{input:(V)=>{if(!V)return;if(z){let v=Number(V);if(isNaN(v))return;return v}if(N){if(F&&!Z)return V;if(X)return;if($)return;if(Z&&typeof V==="string")if(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(V))return V;else{let v=Error().stack?.split(`
`).filter((M,O)=>O!==1).join(`
`).replace("Error:","");G6.warn("[Adapter Factory] - Invalid UUID value for field `id` provided when `forceAllowId` is true. Generating a new UUID.",v)}if(typeof V!=="string"&&!$)return crypto.randomUUID();return}return V},output:(V)=>{if(!V)return;return String(V)}}}}},rx=({usePlural:J,schema:W,options:X,customIdGenerator:G,disableIdGeneration:Y})=>{let $=CX({usePlural:J,schema:W}),K=OK({usePlural:J,schema:W}),w=eB({usePlural:J,schema:W,options:X,customIdGenerator:G,disableIdGeneration:Y});return({model:Z,field:z})=>{let N=$(Z),F=K({field:z,model:N}),Q=W[N].fields;Q.id=w({customModelName:N});let V=Q[F];if(!V)throw new W6(`Field ${z} not found in model ${Z}`);return V}},VH,_0=-1,ix=(J)=>(W)=>W(J),B$=({adapter:J,config:W})=>(X)=>{let G=Math.random().toString(36).substring(2,15),Y={...W,supportsBooleans:W.supportsBooleans??!0,supportsDates:W.supportsDates??!0,supportsJSON:W.supportsJSON??!1,adapterName:W.adapterName??W.adapterId,supportsNumericIds:W.supportsNumericIds??!0,supportsUUIDs:W.supportsUUIDs??!1,transaction:W.transaction??!1,disableTransformInput:W.disableTransformInput??!1,disableTransformOutput:W.disableTransformOutput??!1,disableTransformJoin:W.disableTransformJoin??!1};if((X.advanced?.database?.useNumberId===!0||X.advanced?.database?.generateId==="serial")&&Y.supportsNumericIds===!1)throw new W6(`[${Y.adapterName}] Your database or database adapter does not support numeric ids. Please disable "useNumberId" in your config.`);let $=Z8(X),K=(...q)=>{if(Y.debugLogs===!0||typeof Y.debugLogs==="object"){if(typeof Y.debugLogs==="object"&&"isRunningAdapterTests"in Y.debugLogs){if(Y.debugLogs.isRunningAdapterTests)q.shift(),VH.push({instance:G,args:q});return}if(typeof Y.debugLogs==="object"&&Y.debugLogs.logCondition&&!Y.debugLogs.logCondition?.())return;if(typeof q[0]==="object"&&"method"in q[0]){let _=q.shift().method;if(typeof Y.debugLogs==="object"){if(_==="create"&&!Y.debugLogs.create)return;else if(_==="update"&&!Y.debugLogs.update)return;else if(_==="updateMany"&&!Y.debugLogs.updateMany)return;else if(_==="findOne"&&!Y.debugLogs.findOne)return;else if(_==="findMany"&&!Y.debugLogs.findMany)return;else if(_==="delete"&&!Y.debugLogs.delete)return;else if(_==="deleteMany"&&!Y.debugLogs.deleteMany)return;else if(_==="count"&&!Y.debugLogs.count)return}G6.info(`[${Y.adapterName}]`,...q)}else G6.info(`[${Y.adapterName}]`,...q)}},w=CX({usePlural:Y.usePlural,schema:$}),H=OK({usePlural:Y.usePlural,schema:$}),Z=jK({usePlural:Y.usePlural,schema:$}),z=PK({schema:$,usePlural:Y.usePlural}),N=eB({schema:$,options:X,usePlural:Y.usePlural,disableIdGeneration:Y.disableIdGeneration,customIdGenerator:Y.customIdGenerator,supportsUUIDs:Y.supportsUUIDs}),F=rx({schema:$,options:X,usePlural:Y.usePlural,disableIdGeneration:Y.disableIdGeneration,customIdGenerator:Y.customIdGenerator}),Q=async(q,_,B,A)=>{let E={},R=$[_].fields,g=Y.mapKeysTransformInput??{},u=X.advanced?.database?.useNumberId||X.advanced?.database?.generateId==="serial";R.id=N({customModelName:_,forceAllowId:A&&"id"in q});for(let b in R){let f=q[b],m=R[b],c=g[b]||R[b].fieldName||b;if(f===void 0&&(m.defaultValue===void 0&&!m.transform?.input&&!(B==="update"&&m.onUpdate)||B==="update"&&!m.onUpdate))continue;if(m&&m.type==="date"&&!(f instanceof Date)&&typeof f==="string")try{f=new Date(f)}catch{G6.error("[Adapter Factory] Failed to convert string to date",{value:f,field:b})}let l=nx(f,m,B);if(m.transform?.input)l=await m.transform.input(l);if(m.references?.field==="id"&&u)if(Array.isArray(l))l=l.map((i)=>i!==null?Number(i):null);else l=l!==null?Number(l):null;else if(Y.supportsJSON===!1&&typeof l==="object"&&m.type==="json")l=JSON.stringify(l);else if(Y.supportsDates===!1&&l instanceof Date&&m.type==="date")l=l.toISOString();else if(Y.supportsBooleans===!1&&typeof l==="boolean")l=l?1:0;if(Y.customTransformInput)l=Y.customTransformInput({data:l,action:B,field:c,fieldAttributes:m,model:Z(_),schema:$,options:X});if(l!==void 0)E[c]=l}return E},V=async(q,_,B=[],A)=>{let E=async(u,b,f=[])=>{if(!u)return null;let m=Y.mapKeysTransformOutput??{},c={},l=$[w(b)].fields,i=Object.entries(m).find(([t,$6])=>$6==="id")?.[0];l[i??"id"]={type:X.advanced?.database?.useNumberId||X.advanced?.database?.generateId==="serial"?"number":"string"};for(let t in l){if(f.length&&!f.includes(t))continue;let $6=l[t];if($6){let D6=$6.fieldName||t,K6=u[Object.entries(m).find(([zX,LW])=>LW===D6)?.[0]||D6];if($6.transform?.output)K6=await $6.transform.output(K6);let u4=m[t]||t;if(D6==="id"||$6.references?.field==="id"){if(typeof K6<"u"&&K6!==null)K6=String(K6)}else if(Y.supportsJSON===!1&&typeof K6==="string"&&$6.type==="json")K6=l6(K6);else if(Y.supportsDates===!1&&typeof K6==="string"&&$6.type==="date")K6=new Date(K6);else if(Y.supportsBooleans===!1&&typeof K6==="number"&&$6.type==="boolean")K6=K6===1;if(Y.customTransformOutput)K6=Y.customTransformOutput({data:K6,field:u4,fieldAttributes:$6,select:f,model:Z(b),schema:$,options:X});c[u4]=K6}}return c};if(!A||Object.keys(A).length===0)return await E(q,_,B);_=w(_);let R=await E(q,_,B),g=Object.entries(A).map(([u,b])=>({modelName:Z(u),defaultModelName:w(u),joinConfig:b}));if(!q)return null;for(let{modelName:u,defaultModelName:b,joinConfig:f}of g){let m=await(async()=>{if(X.experimental?.joins)return q[u];else return await O({baseModel:_,baseData:R,joinModel:u,specificJoinConfig:f})})();if(m===void 0||m===null)m=f.relation==="one-to-one"?null:[];if(f.relation==="one-to-many"&&!Array.isArray(m))m=[m];let c=[];if(Array.isArray(m))for(let l of m){let i=await E(l,u,[]);c.push(i)}else{let l=await E(m,u,[]);c.push(l)}R[b]=(f.relation==="one-to-one"?c[0]:c)??null}return R},v=({model:q,where:_})=>{if(!_)return;let B=Y.mapKeysTransformInput??{};return _.map((A)=>{let{field:E,value:R,operator:g="eq",connector:u="AND"}=A;if(g==="in"){if(!Array.isArray(R))throw new W6("Value must be an array")}let b=R,f=w(q),m=H({field:E,model:q}),c=B[m]||z({field:m,model:f}),l=F({field:m,model:f}),i=X.advanced?.database?.useNumberId||X.advanced?.database?.generateId==="serial";if(m==="id"||l.references?.field==="id"){if(i)if(Array.isArray(R))b=R.map(Number);else b=Number(R)}if(l.type==="date"&&R instanceof Date&&!Y.supportsDates)b=R.toISOString();if(l.type==="boolean"&&typeof R==="boolean"&&!Y.supportsBooleans)b=R?1:0;if(l.type==="json"&&typeof R==="object"&&!Y.supportsJSON)try{b=JSON.stringify(R)}catch(t){throw Error(`Failed to stringify JSON value for field ${c}`,{cause:t})}return{operator:g,connector:u,field:c,value:b}})},M=(q,_,B)=>{if(!_)return;if(Object.keys(_).length===0)return;let A={};for(let[E,R]of Object.entries(_)){if(!R)continue;let g=w(E),u=w(q),b=Object.entries($[g].fields).filter(([K6,u4])=>u4.references&&w(u4.references.model)===u),f=!0;if(!b.length)b=Object.entries($[u].fields).filter(([K6,u4])=>u4.references&&w(u4.references.model)===g),f=!1;if(!b.length)throw new W6(`No foreign key found for model ${E} and base model ${q} while performing join operation.`);else if(b.length>1)throw new W6(`Multiple foreign keys found for model ${E} and base model ${q} while performing join operation. Only one foreign key is supported.`);let[m,c]=b[0];if(!c.references)throw new W6(`No references found for foreign key ${m} on model ${E} while performing join operation.`);let l,i,t;if(f)t=c.references.field,l=z({model:q,field:t}),i=z({model:E,field:m});else t=m,l=z({model:q,field:t}),i=z({model:E,field:c.references.field});if(B&&!B.includes(t))B.push(t);let $6=i==="id"?!0:c.unique??!1,D6=X.advanced?.database?.defaultFindManyLimit??100;if($6)D6=1;else if(typeof R==="object"&&typeof R.limit==="number")D6=R.limit;A[Z(E)]={on:{from:l,to:i},limit:D6,relation:$6?"one-to-one":"one-to-many"}}return{join:A,select:B}},O=async({baseModel:q,baseData:_,joinModel:B,specificJoinConfig:A})=>{if(!_)return _;let E=Z(B),R=A.on.to,g=_[H({field:A.on.from,model:q})];if(g===null||g===void 0)return A.relation==="one-to-one"?null:[];let u,b=v({model:E,where:[{field:R,value:g,operator:"eq",connector:"AND"}]});try{if(A.relation==="one-to-one")u=await S.findOne({model:E,where:b});else{let f=A.limit??X.advanced?.database?.defaultFindManyLimit??100;u=await S.findMany({model:E,where:b,limit:f})}}catch(f){throw G6.error(`Failed to query fallback join for model ${E}:`,{where:b,limit:A.limit}),console.error(f),f}return u},S=J({options:X,schema:$,debugLog:K,getFieldName:z,getModelName:Z,getDefaultModelName:w,getDefaultFieldName:H,getFieldAttributes:F,transformInput:Q,transformOutput:V,transformWhereClause:v}),T=null,j={transaction:async(q)=>{if(!T)if(!Y.transaction)T=ix(j);else G6.debug(`[${Y.adapterName}] - Using provided transaction implementation.`),T=Y.transaction;return T(q)},create:async({data:q,model:_,select:B,forceAllowId:A=!1})=>{_0++;let E=_0,R=Z(_);if(_=w(_),"id"in q&&typeof q.id<"u"&&!A){G6.warn(`[${Y.adapterName}] - You are trying to create a record with an id. This is not allowed as we handle id generation for you, unless you pass in the \`forceAllowId\` parameter. The id will be ignored.`);let f=Error().stack?.split(`
`).filter((m,c)=>c!==1).join(`
`).replace("Error:","Create method with `id` being called at:");console.log(f),q.id=void 0}K({method:"create"},`${P4(E)} ${j4(1,4)}`,`${_4("create")} ${x4("Unsafe Input")}:`,{model:R,data:q});let g=q;if(!Y.disableTransformInput)g=await Q(q,_,"create",A);K({method:"create"},`${P4(E)} ${j4(2,4)}`,`${_4("create")} ${x4("Parsed Input")}:`,{model:R,data:g});let u=await S.create({data:g,model:R});K({method:"create"},`${P4(E)} ${j4(3,4)}`,`${_4("create")} ${x4("DB Result")}:`,{model:R,res:u});let b=u;if(!Y.disableTransformOutput)b=await V(u,_,B,void 0);return K({method:"create"},`${P4(E)} ${j4(4,4)}`,`${_4("create")} ${x4("Parsed Result")}:`,{model:R,data:b}),b},update:async({model:q,where:_,update:B})=>{_0++;let A=_0;q=w(q);let E=Z(q),R=v({model:q,where:_});K({method:"update"},`${P4(A)} ${j4(1,4)}`,`${_4("update")} ${x4("Unsafe Input")}:`,{model:E,data:B});let g=B;if(!Y.disableTransformInput)g=await Q(B,q,"update");K({method:"update"},`${P4(A)} ${j4(2,4)}`,`${_4("update")} ${x4("Parsed Input")}:`,{model:E,data:g});let u=await S.update({model:E,where:R,update:g});K({method:"update"},`${P4(A)} ${j4(3,4)}`,`${_4("update")} ${x4("DB Result")}:`,{model:E,data:u});let b=u;if(!Y.disableTransformOutput)b=await V(u,q,void 0,void 0);return K({method:"update"},`${P4(A)} ${j4(4,4)}`,`${_4("update")} ${x4("Parsed Result")}:`,{model:E,data:b}),b},updateMany:async({model:q,where:_,update:B})=>{_0++;let A=_0,E=Z(q),R=v({model:q,where:_});q=w(q),K({method:"updateMany"},`${P4(A)} ${j4(1,4)}`,`${_4("updateMany")} ${x4("Unsafe Input")}:`,{model:E,data:B});let g=B;if(!Y.disableTransformInput)g=await Q(B,q,"update");K({method:"updateMany"},`${P4(A)} ${j4(2,4)}`,`${_4("updateMany")} ${x4("Parsed Input")}:`,{model:E,data:g});let u=await S.updateMany({model:E,where:R,update:g});return K({method:"updateMany"},`${P4(A)} ${j4(3,4)}`,`${_4("updateMany")} ${x4("DB Result")}:`,{model:E,data:u}),K({method:"updateMany"},`${P4(A)} ${j4(4,4)}`,`${_4("updateMany")} ${x4("Parsed Result")}:`,{model:E,data:u}),u},findOne:async({model:q,where:_,select:B,join:A})=>{_0++;let E=_0,R=Z(q),g=v({model:q,where:_});q=w(q);let u,b=!0;if(!Y.disableTransformJoin){let c=M(q,A,B);if(c)u=c.join,B=c.select;if(!X.experimental?.joins&&u&&Object.keys(u).length>0)b=!1}else u=A;K({method:"findOne"},`${P4(E)} ${j4(1,3)}`,`${_4("findOne")}:`,{model:R,where:g,select:B,join:u});let f=await S.findOne({model:R,where:g,select:B,join:b?u:void 0});K({method:"findOne"},`${P4(E)} ${j4(2,3)}`,`${_4("findOne")} ${x4("DB Result")}:`,{model:R,data:f});let m=f;if(!Y.disableTransformOutput)m=await V(f,q,B,u);return K({method:"findOne"},`${P4(E)} ${j4(3,3)}`,`${_4("findOne")} ${x4("Parsed Result")}:`,{model:R,data:m}),m},findMany:async({model:q,where:_,limit:B,sortBy:A,offset:E,join:R})=>{_0++;let g=_0,u=B??X.advanced?.database?.defaultFindManyLimit??100,b=Z(q),f=v({model:q,where:_});q=w(q);let m,c=!0;if(!Y.disableTransformJoin){let t=M(q,R,void 0);if(t)m=t.join;if(!X.experimental?.joins&&m&&Object.keys(m).length>0)c=!1}else m=R;K({method:"findMany"},`${P4(g)} ${j4(1,3)}`,`${_4("findMany")}:`,{model:b,where:f,limit:u,sortBy:A,offset:E,join:m});let l=await S.findMany({model:b,where:f,limit:u,sortBy:A,offset:E,join:c?m:void 0});K({method:"findMany"},`${P4(g)} ${j4(2,3)}`,`${_4("findMany")} ${x4("DB Result")}:`,{model:b,data:l});let i=l;if(!Y.disableTransformOutput)i=await Promise.all(l.map(async(t)=>{return await V(t,q,void 0,m)}));return K({method:"findMany"},`${P4(g)} ${j4(3,3)}`,`${_4("findMany")} ${x4("Parsed Result")}:`,{model:b,data:i}),i},delete:async({model:q,where:_})=>{_0++;let B=_0,A=Z(q),E=v({model:q,where:_});q=w(q),K({method:"delete"},`${P4(B)} ${j4(1,2)}`,`${_4("delete")}:`,{model:A,where:E}),await S.delete({model:A,where:E}),K({method:"delete"},`${P4(B)} ${j4(2,2)}`,`${_4("delete")} ${x4("DB Result")}:`,{model:A})},deleteMany:async({model:q,where:_})=>{_0++;let B=_0,A=Z(q),E=v({model:q,where:_});q=w(q),K({method:"deleteMany"},`${P4(B)} ${j4(1,2)}`,`${_4("deleteMany")} ${x4("DeleteMany")}:`,{model:A,where:E});let R=await S.deleteMany({model:A,where:E});return K({method:"deleteMany"},`${P4(B)} ${j4(2,2)}`,`${_4("deleteMany")} ${x4("DB Result")}:`,{model:A,data:R}),R},count:async({model:q,where:_})=>{_0++;let B=_0,A=Z(q),E=v({model:q,where:_});q=w(q),K({method:"count"},`${P4(B)} ${j4(1,2)}`,`${_4("count")}:`,{model:A,where:E});let R=await S.count({model:A,where:E});return K({method:"count"},`${P4(B)} ${j4(2,2)}`,`${_4("count")}:`,{model:A,data:R}),R},createSchema:S.createSchema?async(q,_)=>{let B=Z8(X);if(X.secondaryStorage&&!X.session?.storeSessionInDatabase)delete B.session;if(X.rateLimit&&X.rateLimit.storage==="database"&&(typeof X.rateLimit.enabled>"u"||X.rateLimit.enabled===!0))B.ratelimit={modelName:X.rateLimit.modelName??"ratelimit",fields:{key:{type:"string",unique:!0,required:!0,fieldName:X.rateLimit.fields?.key??"key"},count:{type:"number",required:!0,fieldName:X.rateLimit.fields?.count??"count"},lastRequest:{type:"number",required:!0,bigint:!0,defaultValue:()=>Date.now(),fieldName:X.rateLimit.fields?.lastRequest??"lastRequest"}}};return S.createSchema({file:_,tables:B})}:void 0,options:{adapterConfig:Y,...S.options??{}},id:Y.adapterId,...Y.debugLogs?.isRunningAdapterTests?{adapterTestDebugLogs:{resetDebugLogs(){VH=VH.filter((q)=>q.instance!==G)},printDebugLogs(){let q="\u2500".repeat(80),_=VH.filter((A)=>A.instance===G);if(_.length===0)return;let B=_.reverse().map((A)=>{return A.args[0]=`
${A.args[0]}`,[...A.args,`
`]}).reduce((A,E)=>{return[...E,...A]},[`
${q}`]);console.log(...B)}}}:{}};return j};var hD=D(()=>{DJ();i0();O8();t0();R4();VH=[]});var JA={};s0(JA,{memoryAdapter:()=>ax});var ax=(J,W)=>{let X=null,G=B$({config:{adapterId:"memory",adapterName:"Memory Adapter",usePlural:!1,debugLogs:W?.debugLogs||!1,customTransformInput(Y){if((Y.options.advanced?.database?.useNumberId||Y.options.advanced?.database?.generateId==="serial")&&Y.field==="id"&&Y.action==="create")return J[Y.model].length+1;return Y.data},transaction:async(Y)=>{let $=structuredClone(J);try{return await Y(G(X))}catch(K){throw Object.keys(J).forEach((w)=>{J[w]=$[w]}),K}}},adapter:({getFieldName:Y,options:$,getModelName:K})=>{let w=(Z,z,N)=>{if(!z)return Z;return Z.sort((F,Q)=>{let V=Y({model:N,field:z.field}),v=F[V],M=Q[V],O=0;if(v==null&&M==null)O=0;else if(v==null)O=-1;else if(M==null)O=1;else if(typeof v==="string"&&typeof M==="string")O=v.localeCompare(M);else if(v instanceof Date&&M instanceof Date)O=v.getTime()-M.getTime();else if(typeof v==="number"&&typeof M==="number")O=v-M;else if(typeof v==="boolean"&&typeof M==="boolean")O=v===M?0:v?1:-1;else O=String(v).localeCompare(String(M));return z.direction==="asc"?O:-O})};function H(Z,z,N){let F=(M,O)=>{let S=J[O];if(!S)throw G6.error(`[MemoryAdapter] Model ${O} not found in the DB`,Object.keys(J)),Error(`Model ${O} not found`);let T=(j,q)=>{let{field:_,value:B,operator:A}=q;switch(A){case"in":if(!Array.isArray(B))throw Error("Value must be an array");return B.includes(j[_]);case"not_in":if(!Array.isArray(B))throw Error("Value must be an array");return!B.includes(j[_]);case"contains":return j[_].includes(B);case"starts_with":return j[_].startsWith(B);case"ends_with":return j[_].endsWith(B);case"ne":return j[_]!==B;case"gt":return B!=null&&Boolean(j[_]>B);case"gte":return B!=null&&Boolean(j[_]>=B);case"lt":return B!=null&&Boolean(j[_]<B);case"lte":return B!=null&&Boolean(j[_]<=B);default:return j[_]===B}};return S.filter((j)=>{if(!M.length||M.length===0)return!0;let q=T(j,M[0]);for(let _ of M){let B=T(j,_);if(_.connector==="OR")q=q||B;else q=q&&B}return q})};if(!N)return F(Z,z);let Q=F(Z,z),V=new Map,v=new Map;for(let M of Q){let O=String(M.id);if(!V.has(O)){let T={...M};for(let[j,q]of Object.entries(N)){let _=K(j);if(q.relation==="one-to-one")T[_]=null;else T[_]=[],v.set(`${O}-${j}`,new Set)}V.set(O,T)}let S=V.get(O);for(let[T,j]of Object.entries(N)){let q=K(T),_=J[q];if(!_)throw G6.error(`[MemoryAdapter] JoinOption model ${q} not found in the DB`,Object.keys(J)),Error(`JoinOption model ${q} not found`);let B=_.filter((A)=>A[j.on.to]===M[j.on.from]);if(j.relation==="one-to-one")S[q]=B[0]||null;else{let A=v.get(`${O}-${T}`),E=j.limit??100,R=0;for(let g of B){if(R>=E)break;if(!A.has(g.id))S[q].push(g),A.add(g.id),R++}}}}return Array.from(V.values())}return{create:async({model:Z,data:z})=>{if($.advanced?.database?.useNumberId||$.advanced?.database?.generateId==="serial")z.id=J[K(Z)].length+1;if(!J[Z])J[Z]=[];return J[Z].push(z),z},findOne:async({model:Z,where:z,join:N})=>{let F=H(z,Z,N);if(N){let Q=F;if(!Q.length)return null;return Q[0]}return F[0]||null},findMany:async({model:Z,where:z,sortBy:N,limit:F,offset:Q,join:V})=>{let v=H(z||[],Z,V);if(V){let O=v;if(!O.length)return[];w(O,N,Z);let S=O;if(Q!==void 0)S=S.slice(Q);if(F!==void 0)S=S.slice(0,F);return S}let M=w(v,N,Z);if(Q!==void 0)M=M.slice(Q);if(F!==void 0)M=M.slice(0,F);return M||[]},count:async({model:Z,where:z})=>{if(z)return H(z,Z).length;return J[Z].length},update:async({model:Z,where:z,update:N})=>{let F=H(z,Z);return F.forEach((Q)=>{Object.assign(Q,N)}),F[0]||null},delete:async({model:Z,where:z})=>{let N=J[Z],F=H(z,Z);J[Z]=N.filter((Q)=>!F.includes(Q))},deleteMany:async({model:Z,where:z})=>{let N=J[Z],F=H(z,Z),Q=0;return J[Z]=N.filter((V)=>{if(F.includes(V))return Q++,!1;return!F.includes(V)}),Q},updateMany({model:Z,where:z,update:N}){let F=H(z,Z);return F.forEach((Q)=>{Object.assign(Q,N)}),F[0]||null}}}});return(Y)=>{return X=Y,G(Y)}};var WA=D(()=>{DJ();i0();r4();UW();wG();O8();hD();t0()});var fD={};s0(fD,{kyselyAdapter:()=>tx,getKyselyDatabaseType:()=>wY,createKyselyAdapter:()=>MK});var tx=(J,W)=>{let X=null,G=(K)=>{return({getFieldName:w,schema:H,getDefaultFieldName:Z,getDefaultModelName:z,getFieldAttributes:N,getModelName:F})=>{let Q=(O)=>{let S=[],T=[];if(O)for(let[j,q]of Object.entries(O)){let _=H[z(j)]?.fields,[B,A]=j.includes(".")?j.split("."):[void 0,j];if(!_)continue;_.id={type:"string"};for(let[E,R]of Object.entries(_))S.push(F6`${F6.ref(`join_${A}`)}.${F6.ref(R.fieldName||E)} as ${F6.ref(`_joined_${A}_${R.fieldName||E}`)}`),T.push({joinModel:j,joinModelRef:A,fieldName:R.fieldName||E})}return{allSelectsStr:T,allSelects:S}},V=async(O,S,T,j)=>{let q;if(W?.type==="mysql"){await S.execute();let _=O.id?"id":j.length>0&&j[0]?.field?j[0].field:"id";if(!O.id&&j.length===0)return q=await K.selectFrom(T).selectAll().orderBy(w({model:T,field:_}),"desc").limit(1).executeTakeFirst(),q;let B=O[_]||j[0]?.value;return q=await K.selectFrom(T).selectAll().orderBy(w({model:T,field:_}),"desc").where(w({model:T,field:_}),"=",B).limit(1).executeTakeFirst(),q}if(W?.type==="mssql")return q=await S.outputAll("inserted").executeTakeFirst(),q;return q=await S.returningAll().executeTakeFirst(),q};function v(O,S){if(!S)return{and:null,or:null};let T={and:[],or:[]};return S.forEach((j)=>{let{field:q,value:_,operator:B="=",connector:A="AND"}=j,E=_,R=w({model:O,field:q}),g=(u)=>{let b=`${O}.${R}`;if(B.toLowerCase()==="in")return u(b,"in",Array.isArray(E)?E:[E]);if(B.toLowerCase()==="not_in")return u(b,"not in",Array.isArray(E)?E:[E]);if(B==="contains")return u(b,"like",`%${E}%`);if(B==="starts_with")return u(b,"like",`${E}%`);if(B==="ends_with")return u(b,"like",`%${E}`);if(B==="eq")return u(b,"=",E);if(B==="ne")return u(b,"<>",E);if(B==="gt")return u(b,">",E);if(B==="gte")return u(b,">=",E);if(B==="lt")return u(b,"<",E);if(B==="lte")return u(b,"<=",E);return u(b,B,E)};if(A==="OR")T.or.push(g);else T.and.push(g)}),{and:T.and.length?T.and:null,or:T.or.length?T.or:null}}function M(O,S,T){if(!S||!O.length)return O;let j=new Map;for(let _ of O){let B={},A={};for(let[g]of Object.entries(S))A[F(g)]={};for(let[g,u]of Object.entries(_)){let b=String(g),f=!1;for(let{joinModel:m,fieldName:c,joinModelRef:l}of T)if(b===`_joined_${l}_${c}`){A[F(m)][w({model:m,field:c})]=u,f=!0;break}if(!f)B[g]=u}let E=B.id;if(!E)continue;if(!j.has(E)){let g={...B};for(let[u,b]of Object.entries(S))g[F(u)]=b.relation==="one-to-one"?null:[];j.set(E,g)}let R=j.get(E);for(let[g,u]of Object.entries(S)){let b=u.relation==="one-to-one",f=u.limit??100,m=A[F(g)],c=m&&Object.keys(m).length>0&&Object.values(m).some((l)=>l!==null&&l!==void 0);if(b)R[F(g)]=c?m:null;else{let l=F(g);if(Array.isArray(R[l])&&c){if(R[l].length>=f)continue;let i=w({model:g,field:"id"}),t=m[i];if(t){if(!R[l].some(($6)=>$6[i]===t)&&R[l].length<f)R[l].push(m)}else if(R[l].length<f)R[l].push(m)}}}}let q=Array.from(j.values());for(let _ of q)for(let[B,A]of Object.entries(S))if(A.relation!=="one-to-one"){let E=F(B);if(Array.isArray(_[E])){let R=A.limit??100;if(_[E].length>R)_[E]=_[E].slice(0,R)}}return q}return{async create({data:O,model:S}){return await V(O,K.insertInto(S).values(O),S,[])},async findOne({model:O,where:S,select:T,join:j}){let{and:q,or:_}=v(O,S),B=K.selectFrom((u)=>{let b=u.selectFrom(O);if(q)b=b.where((f)=>f.and(q.map((m)=>m(f))));if(_)b=b.where((f)=>f.or(_.map((m)=>m(f))));return b.selectAll().as("primary")}).selectAll("primary");if(j)for(let[u,b]of Object.entries(j)){let[f,m]=u.includes(".")?u.split("."):[void 0,u];B=B.leftJoin(`${u} as join_${m}`,(c)=>c.onRef(`join_${m}.${b.on.to}`,"=",`primary.${b.on.from}`))}let{allSelectsStr:A,allSelects:E}=Q(j);B=B.select(E);let R=await B.execute();if(!R||!Array.isArray(R)||R.length===0)return null;let g=R[0];if(j)return M(R,j,A)[0];return g},async findMany({model:O,where:S,limit:T,offset:j,sortBy:q,join:_}){let{and:B,or:A}=v(O,S),E=K.selectFrom((b)=>{let f=b.selectFrom(O);if(W?.type==="mssql"){if(j!==void 0){if(!q)f=f.orderBy(w({model:O,field:"id"}));f=f.offset(j).fetch(T||100)}else if(T!==void 0)f=f.top(T)}else{if(T!==void 0)f=f.limit(T);if(j!==void 0)f=f.offset(j)}if(q?.field)f=f.orderBy(`${w({model:O,field:q.field})}`,q.direction);if(B)f=f.where((m)=>m.and(B.map((c)=>c(m))));if(A)f=f.where((m)=>m.or(A.map((c)=>c(m))));return f.selectAll().as("primary")}).selectAll("primary");if(_)for(let[b,f]of Object.entries(_)){let[m,c]=b.includes(".")?b.split("."):[void 0,b];E=E.leftJoin(`${b} as join_${c}`,(l)=>l.onRef(`join_${c}.${f.on.to}`,"=",`primary.${f.on.from}`))}let{allSelectsStr:R,allSelects:g}=Q(_);if(E=E.select(g),q?.field)E=E.orderBy(`${w({model:O,field:q.field})}`,q.direction);let u=await E.execute();if(!u)return[];if(_)return M(u,_,R);return u},async update({model:O,where:S,update:T}){let{and:j,or:q}=v(O,S),_=K.updateTable(O).set(T);if(j)_=_.where((B)=>B.and(j.map((A)=>A(B))));if(q)_=_.where((B)=>B.or(q.map((A)=>A(B))));return await V(T,_,O,S)},async updateMany({model:O,where:S,update:T}){let{and:j,or:q}=v(O,S),_=K.updateTable(O).set(T);if(j)_=_.where((B)=>B.and(j.map((A)=>A(B))));if(q)_=_.where((B)=>B.or(q.map((A)=>A(B))));return(await _.execute()).length},async count({model:O,where:S}){let{and:T,or:j}=v(O,S),q=K.selectFrom(O).select(K.fn.count("id").as("count"));if(T)q=q.where((B)=>B.and(T.map((A)=>A(B))));if(j)q=q.where((B)=>B.or(j.map((A)=>A(B))));let _=await q.execute();if(typeof _[0].count==="number")return _[0].count;if(typeof _[0].count==="bigint")return Number(_[0].count);return parseInt(_[0].count)},async delete({model:O,where:S}){let{and:T,or:j}=v(O,S),q=K.deleteFrom(O);if(T)q=q.where((_)=>_.and(T.map((B)=>B(_))));if(j)q=q.where((_)=>_.or(j.map((B)=>B(_))));await q.execute()},async deleteMany({model:O,where:S}){let{and:T,or:j}=v(O,S),q=K.deleteFrom(O);if(T)q=q.where((_)=>_.and(T.map((B)=>B(_))));if(j)q=q.where((_)=>_.or(j.map((B)=>B(_))));return(await q.execute()).length},options:W}}},Y=null;Y={config:{adapterId:"kysely",adapterName:"Kysely Adapter",usePlural:W?.usePlural,debugLogs:W?.debugLogs,supportsBooleans:W?.type==="sqlite"||W?.type==="mssql"||W?.type==="mysql"||!W?.type?!1:!0,supportsDates:W?.type==="sqlite"||W?.type==="mssql"||!W?.type?!1:!0,supportsJSON:!1,supportsUUIDs:W?.type==="postgres"?!0:!1,transaction:W?.transaction?(K)=>J.transaction().execute((w)=>{return K(B$({config:Y.config,adapter:G(w)})(X))}):!1},adapter:G(J)};let $=B$(Y);return(K)=>{return X=K,$(K)}};var gD=D(()=>{RX();DJ();i0();r4();UW();wG();O8();hD();oJ()});oJ();import{promises as rp}from"fs";import*as Sv from"path";oJ();import{existsSync as Ik,mkdirSync as bk}from"fs";oJ();import{EventEmitter as mR}from"events";var yR=class{config;worker;connection;connectionMutex=new xR;mitt;constructor(J){this.config=J}async init(){this.worker=this.config?.worker??new Worker(new URL("./worker",import.meta.url),{type:"module"}),this.mitt=new mR,this.worker.onmessage=({data:[J,W,X]})=>{this.mitt?.emit(J,W,X)},this.worker.postMessage([0,this.config?.url,this.config?.cacheStatment]),await new Promise((J,W)=>{this.mitt?.once(0,(X,G)=>G?W(G):J())}),this.connection=new uR(this.worker,this.mitt),await this.config?.onCreateConnection?.(this.connection)}async acquireConnection(){return await this.connectionMutex.lock(),this.connection}async beginTransaction(J){await J.executeQuery(W4.raw("begin"))}async commitTransaction(J){await J.executeQuery(W4.raw("commit"))}async rollbackTransaction(J){await J.executeQuery(W4.raw("rollback"))}async releaseConnection(){this.connectionMutex.unlock()}async destroy(){if(!this.worker)return;return this.worker.postMessage([2]),new Promise((J,W)=>{this.mitt?.once(2,(X,G)=>{if(G)W(G);else this.worker?.terminate(),this.mitt?.removeAllListeners(),this.mitt=void 0,J()})})}},xR=class{promise;resolve;async lock(){while(this.promise)await this.promise;this.promise=new Promise((J)=>{this.resolve=J})}unlock(){let J=this.resolve;this.promise=void 0,this.resolve=void 0,J?.()}},uR=class{constructor(J,W){this.worker=J,this.mitt=W}streamQuery(){throw Error("Bun:sqlite-worker driver doesn't support streaming")}async executeQuery(J){let{parameters:W,sql:X,query:G}=J,Y=T6.is(G);return this.worker.postMessage([1,Y,X,W]),new Promise(($,K)=>{if(!this.mitt)K(Error("kysely instance has been destroyed"));this.mitt.once(1,(w,H)=>!H&&w?$(w):K(H))})}},wK=class{config;constructor(J){this.config=J}createDriver(){return new yR(this.config)}createQueryCompiler(){return new $9}createAdapter(){return new w9}createIntrospector(J){return new K9(J)}};var I8=yH(NF(),1),Dw6=I8.default.Client,Q_=I8.default.Pool,vw6=I8.default.Connection,Mw6=I8.default.types,Ow6=I8.default.Query,Pw6=I8.default.DatabaseError,jw6=I8.default.escapeIdentifier,_w6=I8.default.escapeLiteral,Sw6=I8.default.Result,Tw6=I8.default.TypeOverrides,qw6=I8.default.defaults;import*as V_ from"path";function kk(){return process.env.DATABASE_URL||`file:${V_.join(process.cwd(),"data/mesh.db")}`}function hk(J){let W=J||"file:./data/mesh.db";if(W===":memory:")return L_(":memory:");W=W.startsWith("/")?`file://${W}`:W;let X=new URL(W),G=X.protocol.replace(":","");switch(G){case"postgres":case"postgresql":return fk(W);case"sqlite":case"file":return L_(X.pathname);default:throw Error(`Unsupported database protocol: ${G}. Supported protocols: postgres://, postgresql://, sqlite://, file://`)}}function fk(J){let W=new o1({pool:new Q_({connectionString:J,max:10})});return new w8({dialect:W})}function L_(J){if(J!==":memory:"&&J!=="/"&&J){let G=J.substring(0,J.lastIndexOf("/"));if(G&&G!=="/"&&!Ik(G))try{bk(G,{recursive:!0})}catch{console.warn(`Failed to create directory ${G}, using in-memory database`),J=":memory:"}}let W=new wK({url:J||":memory:"}),X=new w8({dialect:W});if(J!==":memory:")F6`PRAGMA journal_mode = WAL;`.execute(X).catch(()=>{}),F6`PRAGMA busy_timeout = 5000;`.execute(X).catch(()=>{});return X}var VF=null;function D_(){if(!VF)VF=hk(kk());return VF}RX();DJ();RX();DJ();i0();i4();var F4=(J,W="ms")=>{return new Date(Date.now()+(W==="sec"?J*1000:J))},u7=new WeakMap;function fq(J,W){let X=W.fields,G={};for(let Y in J){let $=X[Y];if(!$){G[Y]=J[Y];continue}if($.returned===!1)continue;G[Y]=J[Y]}return G}function aV(J,W){if(!u7.has(J))u7.set(J,new Map);let X=u7.get(J);if(X.has(W))return X.get(W);let G={...W==="user"?J.user?.additionalFields:{},...W==="session"?J.session?.additionalFields:{}};for(let Y of J.plugins||[])if(Y.schema&&Y.schema[W])G={...G,...Y.schema[W].fields};return u7.get(J).set(W,G),G}function v8(J,W){return fq(W,{fields:aV(J,"user")})}function AJ(J,W){return fq(W,{fields:aV(J,"session")})}function gq(J,W){let X=W.action||"create",G=W.fields,Y=Object.assign(Object.create(null),null);for(let $ in G){if($ in J){if(G[$].input===!1){if(G[$].defaultValue!==void 0){if(X!=="update"){Y[$]=G[$].defaultValue;continue}}if(J[$])throw new L("BAD_REQUEST",{message:`${$} is not allowed to be set`});continue}if(G[$].validator?.input&&J[$]!==void 0){Y[$]=G[$].validator.input["~standard"].validate(J[$]);continue}if(G[$].transform?.input&&J[$]!==void 0){Y[$]=G[$].transform?.input(J[$]);continue}Y[$]=J[$];continue}if(G[$].defaultValue!==void 0&&X==="create"){if(typeof G[$].defaultValue==="function"){Y[$]=G[$].defaultValue();continue}Y[$]=G[$].defaultValue;continue}if(G[$].required&&X==="create")throw new L("BAD_REQUEST",{message:`${$} is required`})}return Y}function l7(J,W={},X){return gq(W,{fields:aV(J,"user"),action:X})}function a0(J,W){if(!W)return J;for(let X in W){let G=W[X]?.modelName;if(G)J[X].modelName=G;for(let Y in J[X].fields){let $=W[X]?.fields?.[Y];if(!$)continue;J[X].fields[Y].fieldName=$}}return J}t0();O0();var Vx="127.0.0.1";function iX(J,W){if(W.advanced?.ipAddress?.disableIpTracking)return null;if(oW()||tY())return Vx;let X="headers"in J?J.headers:J,G=W.advanced?.ipAddress?.ipAddressHeaders||["x-forwarded-for"];for(let Y of G){let $="get"in X?X.get(Y):X[Y];if(typeof $==="string"){let K=$.split(",")[0].trim();if(Dx(K))return K}}return null}function Dx(J){if(O7().safeParse(J).success)return!0;if(j7().safeParse(J).success)return!0;return!1}O8();MJ();t0();R4();oJ();O0();async function XA(J,W){let X;if(!J.database){let G=Z8(J),Y=Object.keys(G).reduce((K,w)=>{return K[w]=[],K},{}),{memoryAdapter:$}=await Promise.resolve().then(() => (WA(),JA));X=$(Y)(J)}else if(typeof J.database==="function")X=J.database(J);else X=await W(J);if(!X.transaction)G6.warn("Adapter does not correctly implement transaction function, patching it automatically. Please update your adapter implementation."),X.transaction=async(G)=>{return G(X)};return X}async function mD(J){return XA(J,async(W)=>{let{createKyselyAdapter:X}=await Promise.resolve().then(() => (gD(),fD)),{kysely:G,databaseType:Y,transaction:$}=await X(W);if(!G)throw new W6("Failed to initialize database adapter");let{kyselyAdapter:K}=await Promise.resolve().then(() => (gD(),fD));return K(G,{type:Y||"sqlite",debugLogs:W.database&&"debugLogs"in W.database?W.database.debugLogs:!1,transaction:$})(W)})}function YA(J,W){let X=W.hooks;async function G(H,Z,z){let N=await F8(),F=H;for(let v of X||[]){let M=v[Z]?.create?.before;if(M){let O=await M(F,N);if(O===!1)return null;if(typeof O==="object"&&"data"in O)F={...F,...O.data}}}let Q=z?await z.fn(F):null,V=!z||z.executeMainFn?await(await s(J)).create({model:Z,data:F,forceAllowId:!0}):Q;for(let v of X||[]){let M=v[Z]?.create?.after;if(M)await M(V,N)}return V}async function Y(H,Z,z,N){let F=await F8(),Q=H;for(let M of X||[]){let O=M[z]?.update?.before;if(O){let S=await O(H,F);if(S===!1)return null;if(typeof S==="object"&&"data"in S)Q={...Q,...S.data}}}let V=N?await N.fn(Q):null,v=!N||N.executeMainFn?await(await s(J)).update({model:z,update:Q,where:Z}):V;for(let M of X||[]){let O=M[z]?.update?.after;if(O)await O(v,F)}return v}async function $(H,Z,z,N){let F=await F8(),Q=H;for(let M of X||[]){let O=M[z]?.update?.before;if(O){let S=await O(H,F);if(S===!1)return null;if(typeof S==="object"&&"data"in S)Q={...Q,...S.data}}}let V=N?await N.fn(Q):null,v=!N||N.executeMainFn?await(await s(J)).updateMany({model:z,update:Q,where:Z}):V;for(let M of X||[]){let O=M[z]?.update?.after;if(O)await O(v,F)}return v}async function K(H,Z,z){let N=await F8(),F=null;try{F=(await(await s(J)).findMany({model:Z,where:H,limit:1}))[0]||null}catch(v){}if(F)for(let v of X||[]){let M=v[Z]?.delete?.before;if(M){if(await M(F,N)===!1)return null}}let Q=z?await z.fn(H):null,V=!z||z.executeMainFn?await(await s(J)).delete({model:Z,where:H}):Q;if(F)for(let v of X||[]){let M=v[Z]?.delete?.after;if(M)await M(F,N)}return V}async function w(H,Z,z){let N=await F8(),F=[];try{F=await(await s(J)).findMany({model:Z,where:H})}catch(v){}for(let v of F)for(let M of X||[]){let O=M[Z]?.delete?.before;if(O){if(await O(v,N)===!1)return null}}let Q=z?await z.fn(H):null,V=!z||z.executeMainFn?await(await s(J)).deleteMany({model:Z,where:H}):Q;for(let v of F)for(let M of X||[]){let O=M[Z]?.delete?.after;if(O)await O(v,N)}return V}return{createWithHooks:G,updateWithHooks:Y,updateManyWithHooks:$,deleteWithHooks:K,deleteManyWithHooks:w}}var DH=(J,W)=>{let{logger:X,options:G}=W,Y=G.secondaryStorage,$=G.session?.expiresIn||604800,{createWithHooks:K,updateWithHooks:w,updateManyWithHooks:H,deleteWithHooks:Z,deleteManyWithHooks:z}=YA(J,W);async function N(F){if(!Y)return;let Q=await Y.get(`active-sessions-${F.id}`);if(!Q)return;let V=Date.now(),v=(l6(Q)||[]).filter((M)=>M.expiresAt>V);await Promise.all(v.map(async({token:M})=>{let O=await Y.get(M);if(!O)return;let S=l6(O);if(!S)return;let T=Math.max(Math.floor(new Date(S.session.expiresAt).getTime()-V)/1000,0);await Y.set(M,JSON.stringify({session:S.session,user:F}),Math.floor(T))}))}return{createOAuthUser:async(F,Q)=>{return S9(J,async()=>{let V=await K({createdAt:new Date,updatedAt:new Date,...F},"user",void 0);return{user:V,account:await K({...Q,userId:V.id,createdAt:new Date,updatedAt:new Date},"account",void 0)}})},createUser:async(F)=>{return await K({createdAt:new Date,updatedAt:new Date,...F,email:F.email?.toLowerCase()},"user",void 0)},createAccount:async(F)=>{return await K({createdAt:new Date,updatedAt:new Date,...F},"account",void 0)},listSessions:async(F)=>{if(Y){let Q=await Y.get(`active-sessions-${F}`);if(!Q)return[];let V=l6(Q)||[],v=Date.now(),M=V.filter((S)=>S.expiresAt>v),O=[];for(let S of M){let T=await Y.get(S.token);if(T){let j=l6(T);if(!j)return[];let q=AJ(W.options,{...j.session,expiresAt:new Date(j.session.expiresAt)});O.push(q)}}return O}return await(await s(J)).findMany({model:"session",where:[{field:"userId",value:F}]})},listUsers:async(F,Q,V,v)=>{return await(await s(J)).findMany({model:"user",limit:F,offset:Q,sortBy:V,where:v})},countTotalUsers:async(F)=>{let Q=await(await s(J)).count({model:"user",where:F});if(typeof Q==="string")return parseInt(Q);return Q},deleteUser:async(F)=>{if(Y)await Y.delete(`active-sessions-${F}`);if(!Y||G.session?.storeSessionInDatabase)await z([{field:"userId",value:F}],"session",void 0);await z([{field:"userId",value:F}],"account",void 0),await Z([{field:"id",value:F}],"user",void 0)},createSession:async(F,Q,V,v)=>{let M=await F8(),O=M.headers||M.request?.headers,{id:S,...T}=V||{},j={ipAddress:M.request||M.headers?iX(M.request||M.headers,M.context.options)||"":"",userAgent:O?.get("user-agent")||"",...T,expiresAt:Q?F4(86400,"sec"):F4($,"sec"),userId:F,token:f4(32),createdAt:new Date,updatedAt:new Date,...v?T:{}};return await K(j,"session",Y?{fn:async(q)=>{let _=await Y.get(`active-sessions-${F}`),B=[],A=Date.now();if(_)B=l6(_)||[],B=B.filter((f)=>f.expiresAt>A);let E=B.sort((f,m)=>f.expiresAt-m.expiresAt),R=E.at(-1)?.expiresAt;if(E.push({token:j.token,expiresAt:j.expiresAt.getTime()}),!R||R<j.expiresAt.getTime())R=j.expiresAt.getTime();let g=Math.max(Math.floor((R-A)/1000),0);if(g>0)await Y.set(`active-sessions-${F}`,JSON.stringify(E),g);let u=await J.findOne({model:"user",where:[{field:"id",value:F}]}),b=Math.max(Math.floor((j.expiresAt.getTime()-A)/1000),0);if(b>0)await Y.set(j.token,JSON.stringify({session:q,user:u}),b);return q},executeMainFn:G.session?.storeSessionInDatabase}:void 0)},findSession:async(F)=>{if(Y){let M=await Y.get(F);if(!M&&!G.session?.storeSessionInDatabase)return null;if(M){let O=l6(M);if(!O)return null;return{session:AJ(W.options,{...O.session,expiresAt:new Date(O.session.expiresAt),createdAt:new Date(O.session.createdAt),updatedAt:new Date(O.session.updatedAt)}),user:v8(W.options,{...O.user,createdAt:new Date(O.user.createdAt),updatedAt:new Date(O.user.updatedAt)})}}}let Q=await(await s(J)).findOne({model:"session",where:[{value:F,field:"token"}],join:{user:!0}});if(!Q)return null;let{user:V,...v}=Q;if(!V)return null;return{session:AJ(W.options,v),user:v8(W.options,V)}},findSessions:async(F)=>{if(Y){let V=[];for(let v of F){let M=await Y.get(v);if(M){let O=l6(M);if(!O)return[];let S={session:{...O.session,expiresAt:new Date(O.session.expiresAt)},user:{...O.user,createdAt:new Date(O.user.createdAt),updatedAt:new Date(O.user.updatedAt)}};V.push(S)}}return V}let Q=await(await s(J)).findMany({model:"session",where:[{field:"token",value:F,operator:"in"}],join:{user:!0}});if(!Q.length)return[];if(Q.some((V)=>!V.user))return[];return Q.map((V)=>{let{user:v,...M}=V;return{session:M,user:v}})},updateSession:async(F,Q)=>{return await w(Q,[{field:"token",value:F}],"session",Y?{async fn(V){let v=await Y.get(F),M=null;if(v){let O=l6(v);if(!O)return null;return M={...O.session,...V},M}else return null},executeMainFn:G.session?.storeSessionInDatabase}:void 0)},deleteSession:async(F)=>{if(Y){let Q=await Y.get(F);if(Q){let{session:V}=l6(Q)??{};if(!V){X.error("Session not found in secondary storage");return}let v=V.userId,M=await Y.get(`active-sessions-${v}`);if(M){let O=l6(M)||[],S=Date.now(),T=O.filter((q)=>q.expiresAt>S&&q.token!==F),j=T.sort((q,_)=>q.expiresAt-_.expiresAt).at(-1)?.expiresAt;if(T.length>0&&j&&j>Date.now())await Y.set(`active-sessions-${v}`,JSON.stringify(T),Math.floor((j-S)/1000));else await Y.delete(`active-sessions-${v}`)}else X.error("Active sessions list not found in secondary storage")}if(await Y.delete(F),!G.session?.storeSessionInDatabase||W.options.session?.preserveSessionInDatabase)return}await(await s(J)).delete({model:"session",where:[{field:"token",value:F}]})},deleteAccounts:async(F)=>{await z([{field:"userId",value:F}],"account",void 0)},deleteAccount:async(F)=>{await Z([{field:"id",value:F}],"account",void 0)},deleteSessions:async(F)=>{if(Y){if(typeof F==="string"){let Q=await Y.get(`active-sessions-${F}`),V=Q?l6(Q):[];if(!V)return;for(let v of V)await Y.delete(v.token)}else for(let Q of F)if(await Y.get(Q))await Y.delete(Q);if(!G.session?.storeSessionInDatabase||W.options.session?.preserveSessionInDatabase)return}await z([{field:Array.isArray(F)?"token":"userId",value:F,operator:Array.isArray(F)?"in":void 0}],"session",void 0)},findOAuthUser:async(F,Q,V)=>{let v=await(await s(J)).findMany({model:"account",where:[{value:Q,field:"accountId"}],join:{user:!0}}).then((M)=>{return M.find((O)=>O.providerId===V)});if(v)if(v.user)return{user:v.user,accounts:[v]};else{let M=await(await s(J)).findOne({model:"user",where:[{value:F.toLowerCase(),field:"email"}]});if(M)return{user:M,accounts:[v]};return null}else{let M=await(await s(J)).findOne({model:"user",where:[{value:F.toLowerCase(),field:"email"}]});if(M)return{user:M,accounts:await(await s(J)).findMany({model:"account",where:[{value:M.id,field:"userId"}]})||[]};else return null}},findUserByEmail:async(F,Q)=>{let V=await(await s(J)).findOne({model:"user",where:[{value:F.toLowerCase(),field:"email"}],join:{...Q?.includeAccounts?{account:!0}:{}}});if(!V)return null;let{account:v,...M}=V;return{user:M,accounts:v??[]}},findUserById:async(F)=>{return await(await s(J)).findOne({model:"user",where:[{field:"id",value:F}]})},linkAccount:async(F)=>{return await K({createdAt:new Date,updatedAt:new Date,...F},"account",void 0)},updateUser:async(F,Q)=>{let V=await w(Q,[{field:"id",value:F}],"user",void 0);return await N(V),await N(V),V},updateUserByEmail:async(F,Q)=>{let V=await w(Q,[{field:"email",value:F.toLowerCase()}],"user",void 0);return await N(V),await N(V),V},updatePassword:async(F,Q)=>{await H({password:Q},[{field:"userId",value:F},{field:"providerId",value:"credential"}],"account",void 0)},findAccounts:async(F)=>{return await(await s(J)).findMany({model:"account",where:[{field:"userId",value:F}]})},findAccount:async(F)=>{return await(await s(J)).findOne({model:"account",where:[{field:"accountId",value:F}]})},findAccountByProviderId:async(F,Q)=>{return await(await s(J)).findOne({model:"account",where:[{field:"accountId",value:F},{field:"providerId",value:Q}]})},findAccountByUserId:async(F)=>{return await(await s(J)).findMany({model:"account",where:[{field:"userId",value:F}]})},updateAccount:async(F,Q)=>{return await w(Q,[{field:"id",value:F}],"account",void 0)},createVerificationValue:async(F)=>{return await K({createdAt:new Date,updatedAt:new Date,...F},"verification",void 0)},findVerificationValue:async(F)=>{let Q=await(await s(J)).findMany({model:"verification",where:[{field:"identifier",value:F}],sortBy:{field:"createdAt",direction:"desc"},limit:1});if(!G.verification?.disableCleanup)await(await s(J)).deleteMany({model:"verification",where:[{field:"expiresAt",value:new Date,operator:"lt"}]});return Q[0]},deleteVerificationValue:async(F)=>{await(await s(J)).delete({model:"verification",where:[{field:"id",value:F}]})},deleteVerificationByIdentifier:async(F)=>{await(await s(J)).delete({model:"verification",where:[{field:"identifier",value:F}]})},updateVerificationValue:async(F,Q)=>{return await w(Q,[{field:"id",value:F}],"verification",void 0)}}};function QW({fields:J,isClientSide:W}){let X=Object.keys(J).reduce((G,Y)=>{let $=J[Y];if(!$)return G;if(W&&$.input===!1)return G;let K;if($.type==="json")K=Z$?Z$():E6();else if($.type==="string[]"||$.type==="number[]")K=v6($.type==="string[]"?P():O6());else if(Array.isArray($.type))K=E6();else K=z0[$.type]();if($?.required===!1)K=K.optional();if($?.returned===!1)return G;return{...G,[Y]:K}},{});return x(X)}function GA(J){let W=Z8(J),X={};for(let G in W){let Y=W[G],$=Y.fields,K={};if(Object.entries($).forEach(([w,H])=>{if(K[H.fieldName||w]=H,H.references){let Z=W[H.references.model];if(Z)K[H.fieldName||w].references={...H.references,model:Z.modelName,field:H.references.field}}}),X[Y.modelName]){X[Y.modelName].fields={...X[Y.modelName].fields,...K};continue}X[Y.modelName]={fields:K,order:Y.order||1/0}}return X}var ox={postgres:{string:["character varying","varchar","text","uuid"],number:["int4","integer","bigint","smallint","numeric","real","double precision"],boolean:["bool","boolean"],date:["timestamptz","timestamp","date"],json:["json","jsonb"]},mysql:{string:["varchar","text","uuid"],number:["integer","int","bigint","smallint","decimal","float","double"],boolean:["boolean","tinyint"],date:["timestamp","datetime","date"],json:["json"]},sqlite:{string:["TEXT"],number:["INTEGER","REAL"],boolean:["INTEGER","BOOLEAN"],date:["DATE","INTEGER"],json:["TEXT"]},mssql:{string:["varchar","nvarchar","uniqueidentifier"],number:["int","bigint","smallint","decimal","float","double"],boolean:["bit","smallint"],date:["datetime2","date","datetime"],json:["varchar","nvarchar"]}};function $A(J,W,X){function G($){return $.toLowerCase().split("(")[0].trim()}if(W==="string[]"||W==="number[]")return J.toLowerCase().includes("json");let Y=ox[X];return(Array.isArray(W)?Y.string.map(($)=>$.toLowerCase()):Y[W].map(($)=>$.toLowerCase())).includes(G(J))}async function sx(J){try{let W=await F6`SHOW search_path`.execute(J);if(W.rows[0]?.search_path)return W.rows[0].search_path.split(",").map((X)=>X.trim()).map((X)=>X.replace(/^["']|["']$/g,"")).filter((X)=>!X.startsWith("$"))[0]||"public"}catch(W){}return"public"}async function A$(J){let W=GA(J),X=sY(J.logger),{kysely:G,databaseType:Y}=await MK(J);if(!Y)X.warn("Could not determine database type, defaulting to sqlite. Please provide a type in the database options to avoid this."),Y="sqlite";if(!G)X.error("Only kysely adapter is supported for migrations. You can use `generate` command to generate the schema, if you're using a different adapter."),process.exit(1);let $="public";if(Y==="postgres"){$=await sx(G),X.debug(`PostgreSQL migration: Using schema '${$}' (from search_path)`);try{if(!(await F6`
				SELECT schema_name 
				FROM information_schema.schemata 
				WHERE schema_name = ${$}
			`.execute(G)).rows[0])X.warn(`Schema '${$}' does not exist. Tables will be inspected from available schemas. Consider creating the schema first or checking your database configuration.`)}catch(j){X.debug(`Could not verify schema existence: ${j instanceof Error?j.message:String(j)}`)}}let K=await G.introspection.getTables(),w=K;if(Y==="postgres")try{let j=await F6`
				SELECT table_name 
				FROM information_schema.tables 
				WHERE table_schema = ${$}
				AND table_type = 'BASE TABLE'
			`.execute(G),q=new Set(j.rows.map((_)=>_.table_name));w=K.filter((_)=>_.schema===$&&q.has(_.name)),X.debug(`Found ${w.length} table(s) in schema '${$}': ${w.map((_)=>_.name).join(", ")||"(none)"}`)}catch(j){X.warn(`Could not filter tables by schema. Using all discovered tables. Error: ${j instanceof Error?j.message:String(j)}`)}let H=[],Z=[];for(let[j,q]of Object.entries(W)){let _=w.find((A)=>A.name===j);if(!_){let A=H.findIndex((g)=>g.table===j),E={table:j,fields:q.fields,order:q.order||1/0},R=H.findIndex((g)=>(g.order||1/0)>E.order);if(R===-1)if(A===-1)H.push(E);else H[A].fields={...H[A].fields,...q.fields};else H.splice(R,0,E);continue}let B={};for(let[A,E]of Object.entries(q.fields)){let R=_.columns.find((g)=>g.name===A);if(!R){B[A]=E;continue}if($A(R.dataType,E.type,Y))continue;else X.warn(`Field ${A} in table ${j} has a different type in the database. Expected ${E.type} but got ${R.dataType}.`)}if(Object.keys(B).length>0)Z.push({table:j,fields:B,order:q.order||1/0})}let z=[],N=J.advanced?.database?.generateId==="uuid",F=J.advanced?.database?.useNumberId||J.advanced?.database?.generateId==="serial";function Q(j,q){let _=j.type,B={string:{sqlite:"text",postgres:"text",mysql:j.unique?"varchar(255)":j.references?"varchar(36)":j.sortable?"varchar(255)":j.index?"varchar(255)":"text",mssql:j.unique||j.sortable?"varchar(255)":j.references?"varchar(36)":"varchar(8000)"},boolean:{sqlite:"integer",postgres:"boolean",mysql:"boolean",mssql:"smallint"},number:{sqlite:j.bigint?"bigint":"integer",postgres:j.bigint?"bigint":"integer",mysql:j.bigint?"bigint":"integer",mssql:j.bigint?"bigint":"integer"},date:{sqlite:"date",postgres:"timestamptz",mysql:"timestamp(3)",mssql:F6`datetime2(3)`},json:{sqlite:"text",postgres:"jsonb",mysql:"json",mssql:"varchar(8000)"},id:{postgres:F?F6`integer GENERATED BY DEFAULT AS IDENTITY`:N?"uuid":"text",mysql:F?"integer":N?"varchar(36)":"varchar(36)",mssql:F?"integer":N?"varchar(36)":"varchar(36)",sqlite:F?"integer":"text"},foreignKeyId:{postgres:F?"integer":N?"uuid":"text",mysql:F?"integer":N?"varchar(36)":"varchar(36)",mssql:F?"integer":N?"varchar(36)":"varchar(36)",sqlite:F?"integer":"text"}};if(q==="id"||j.references?.field==="id"){if(q==="id")return B.id[Y];return B.foreignKeyId[Y]}if(Y==="sqlite"&&(_==="string[]"||_==="number[]"))return"text";if(_==="string[]"||_==="number[]")return"jsonb";if(Array.isArray(_))return"text";return B[_][Y||"sqlite"]}let V=jK({schema:Z8(J),usePlural:!1}),v=PK({schema:Z8(J),usePlural:!1});function M(j,q){try{return`${V(j)}.${v({model:j,field:q})}`}catch{return`${j}.${q}`}}if(Z.length)for(let j of Z)for(let[q,_]of Object.entries(j.fields)){let B=Q(_,q),A=G.schema.alterTable(j.table);if(_.index)A=A.addIndex(`${j.table}_${q}_idx`);let E=A.addColumn(q,B,(R)=>{if(R=_.required!==!1?R.notNull():R,_.references)R=R.references(M(_.references.model,_.references.field)).onDelete(_.references.onDelete||"cascade");if(_.unique)R=R.unique();if(_.type==="date"&&typeof _.defaultValue==="function"&&(Y==="postgres"||Y==="mysql"||Y==="mssql"))if(Y==="mysql")R=R.defaultTo(F6`CURRENT_TIMESTAMP(3)`);else R=R.defaultTo(F6`CURRENT_TIMESTAMP`);return R});z.push(E)}let O=[];if(J.advanced?.database?.useNumberId)X.warn("`useNumberId` is deprecated. Please use `generateId` with `serial` instead.");if(H.length)for(let j of H){let q=Q({type:F?"number":"string"},"id"),_=G.schema.createTable(j.table).addColumn("id",q,(B)=>{if(F){if(Y==="postgres")return B.primaryKey().notNull();else if(Y==="sqlite")return B.primaryKey().notNull();else if(Y==="mssql")return B.identity().primaryKey().notNull();return B.autoIncrement().primaryKey().notNull()}if(N){if(Y==="postgres")return B.primaryKey().defaultTo(F6`pg_catalog.gen_random_uuid()`).notNull();return B.primaryKey().notNull()}return B.primaryKey().notNull()});for(let[B,A]of Object.entries(j.fields)){let E=Q(A,B);if(_=_.addColumn(B,E,(R)=>{if(R=A.required!==!1?R.notNull():R,A.references)R=R.references(M(A.references.model,A.references.field)).onDelete(A.references.onDelete||"cascade");if(A.unique)R=R.unique();if(A.type==="date"&&typeof A.defaultValue==="function"&&(Y==="postgres"||Y==="mysql"||Y==="mssql"))if(Y==="mysql")R=R.defaultTo(F6`CURRENT_TIMESTAMP(3)`);else R=R.defaultTo(F6`CURRENT_TIMESTAMP`);return R}),A.index){let R=G.schema.createIndex(`${j.table}_${B}_${A.unique?"uidx":"idx"}`).on(j.table).columns([B]);O.push(A.unique?R.unique():R)}}z.push(_)}if(O.length)for(let j of O)z.push(j);async function S(){for(let j of z)await j.execute()}async function T(){return z.map((j)=>j.compile().sql).join(`;

`)+";"}return{toBeCreated:H,toBeAdded:Z,runMigrations:S,compileMigrations:T}}i0();r4();UW();wG();O8();O0();var vH=x({id:P(),createdAt:V4().default(()=>new Date),updatedAt:V4().default(()=>new Date)}),UL6=vH.extend({providerId:P(),accountId:P(),userId:m6.string(),accessToken:P().nullish(),refreshToken:P().nullish(),idToken:P().nullish(),accessTokenExpiresAt:V4().nullish(),refreshTokenExpiresAt:V4().nullish(),scope:P().nullish(),password:P().nullish()}),QL6=x({key:P(),count:O6(),lastRequest:O6()}),LL6=vH.extend({userId:m6.string(),expiresAt:V4(),token:P(),ipAddress:P().nullish(),userAgent:P().nullish()}),VL6=vH.extend({email:P().transform((J)=>J.toLowerCase()),emailVerified:d6().default(!1),name:P(),image:P().nullish()}),DL6=vH.extend({value:P(),expiresAt:V4(),identifier:P()});RX();DJ();i0();r4();UW();wG();O8();t0();R4();function ex(J){try{return(new URL(J).pathname.replace(/\/+$/,"")||"/")!=="/"}catch(W){throw new W6(`Invalid base URL: ${J}. Please provide a valid base URL.`)}}function Ju(J){try{let W=new URL(J);if(W.protocol!=="http:"&&W.protocol!=="https:")throw new W6(`Invalid base URL: ${J}. URL must include 'http://' or 'https://'`)}catch(W){if(W instanceof W6)throw W;throw new W6(`Invalid base URL: ${J}. Please provide a valid base URL.`,String(W))}}function E$(J,W="/api/auth"){if(Ju(J),ex(J))return J;let X=J.replace(/\/+$/,"");if(!W||W==="/")return X;return W=W.startsWith("/")?W:`/${W}`,`${X}${W}`}function HG(J,W,X,G){if(J)return E$(J,W);if(G!==!1){let K=R6.BETTER_AUTH_URL||R6.NEXT_PUBLIC_BETTER_AUTH_URL||R6.PUBLIC_BETTER_AUTH_URL||R6.NUXT_PUBLIC_BETTER_AUTH_URL||R6.NUXT_PUBLIC_AUTH_URL||(R6.BASE_URL!=="/"?R6.BASE_URL:void 0);if(K)return E$(K,W)}let Y=X?.headers.get("x-forwarded-host"),$=X?.headers.get("x-forwarded-proto");if(Y&&$)return E$(`${$}://${Y}`,W);if(X){let K=hJ(X.url);if(!K)throw new W6("Could not get origin from request. Please provide a valid base URL.");return E$(K,W)}if(typeof window<"u"&&window.location)return E$(window.location.origin,W)}function hJ(J){try{let W=new URL(J);return W.origin==="null"?null:W.origin}catch(W){return null}}function yD(J){try{return new URL(J).protocol}catch(W){return null}}function xD(J){try{return new URL(J).host}catch(W){return null}}i0();r4();UW();O8();UW();O8();t0();R4();O0();R0();var uD=new Map,Wu=new TextEncoder,lD={decode:(J,W="utf-8")=>{if(!uD.has(W))uD.set(W,new TextDecoder(W));return uD.get(W).decode(J)},encode:Wu.encode};qK();R0();IX();var J1=(J="SHA-256",W="none")=>{let X={importKey:async(G,Y)=>{return z8().importKey("raw",typeof G==="string"?new TextEncoder().encode(G):G,{name:"HMAC",hash:{name:J}},!1,[Y])},sign:async(G,Y)=>{if(typeof G==="string")G=await X.importKey(G,"sign");let $=await z8().sign("HMAC",G,typeof Y==="string"?new TextEncoder().encode(Y):Y);if(W==="hex")return ZY.encode($);if(W==="base64"||W==="base64url"||W==="base64urlnopad")return $0.encode($,{padding:W!=="base64urlnopad"});return $},verify:async(G,Y,$)=>{if(typeof G==="string")G=await X.importKey(G,"verify");if(W==="hex")$=ZY.decode($);if(W==="base64"||W==="base64url"||W==="base64urlnopad")$=await C4.decode($);return z8().verify("HMAC",G,typeof $==="string"?new TextEncoder().encode($):$,typeof Y==="string"?new TextEncoder().encode(Y):Y)}};return X};var ZG=1000,zG=ZG*60,FG=zG*60,X1=FG*24,R$=X1*7,NG=X1*365.25,C$=NG/12;function nD(J,W){if(typeof J==="string")return Xu(J);else if(typeof J==="number")return $u(J,W);throw Error(`Value provided to ms() must be a string or number. value=${JSON.stringify(J)}`)}function Xu(J){if(typeof J!=="string"||J.length===0||J.length>100)throw Error(`Value provided to ms.parse() must be a string with length between 1 and 99. value=${JSON.stringify(J)}`);let W=/^(?<value>-?\d*\.?\d+) *(?<unit>milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|months?|mo|years?|yrs?|y)?$/i.exec(J);if(!W?.groups)return NaN;let{value:X,unit:G="ms"}=W.groups,Y=parseFloat(X),$=G.toLowerCase();switch($){case"years":case"year":case"yrs":case"yr":case"y":return Y*NG;case"months":case"month":case"mo":return Y*C$;case"weeks":case"week":case"w":return Y*R$;case"days":case"day":case"d":return Y*X1;case"hours":case"hour":case"hrs":case"hr":case"h":return Y*FG;case"minutes":case"minute":case"mins":case"min":case"m":return Y*zG;case"seconds":case"second":case"secs":case"sec":case"s":return Y*ZG;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return Y;default:throw Error(`Unknown unit "${$}" provided to ms.parse(). value=${JSON.stringify(J)}`)}}function Yu(J){let W=Math.abs(J);if(W>=NG)return`${Math.round(J/NG)}y`;if(W>=C$)return`${Math.round(J/C$)}mo`;if(W>=R$)return`${Math.round(J/R$)}w`;if(W>=X1)return`${Math.round(J/X1)}d`;if(W>=FG)return`${Math.round(J/FG)}h`;if(W>=zG)return`${Math.round(J/zG)}m`;if(W>=ZG)return`${Math.round(J/ZG)}s`;return`${J}ms`}function Gu(J){let W=Math.abs(J);if(W>=NG)return W1(J,W,NG,"year");if(W>=C$)return W1(J,W,C$,"month");if(W>=R$)return W1(J,W,R$,"week");if(W>=X1)return W1(J,W,X1,"day");if(W>=FG)return W1(J,W,FG,"hour");if(W>=zG)return W1(J,W,zG,"minute");if(W>=ZG)return W1(J,W,ZG,"second");return`${J} ms`}function $u(J,W){if(typeof J!=="number"||!Number.isFinite(J))throw Error("Value provided to ms.format() must be of type number.");return W?.long?Gu(J):Yu(J)}function W1(J,W,X,G){let Y=W>=X*1.5;return`${Math.round(J/X)} ${G}${Y?"s":""}`}var HA=4096,pD=200,cD=HA-pD;function Ku(J){let W=J.headers?.get("cookie");if(!W)return{};let X={},G=W.split("; ");for(let Y of G){let[$,...K]=Y.split("=");if($&&K.length>0)X[$]=K.join("=")}return X}function KA(J){let W=J.split("."),X=W[W.length-1],G=parseInt(X||"0",10);return isNaN(G)?0:G}function wu(J,W){let X={},G=Ku(W);for(let[Y,$]of Object.entries(G))if(Y.startsWith(J))X[Y]=$;return X}function Hu(J){return Object.keys(J).sort((W,X)=>{return KA(W)-KA(X)}).map((W)=>J[W]).join("")}function Zu(J,W,X){let G=Math.ceil(J.value.length/cD);if(G===1)return W[J.name]=J.value,[J];let Y=[];for(let $=0;$<G;$++){let K=`${J.name}.${$}`,w=$*cD,H=J.value.substring(w,w+cD);Y.push({...J,name:K,value:H}),W[K]=H}return X.debug("CHUNKING_SESSION_COOKIE",{message:`Session cookie exceeds allowed ${HA} bytes.`,emptyCookieSize:pD,valueSize:J.value.length,chunkCount:G,chunks:Y.map(($)=>$.value.length+pD)}),Y}function wA(J,W){let X={};for(let G in J)X[G]={name:G,value:"",options:{...W,maxAge:0}};return X}function dD(J,W,X){let G=wu(J,X),Y=X.context.logger;return{getValue(){return Hu(G)},hasChunks(){return Object.keys(G).length>0},chunk($,K){let w=wA(G,W);for(let z in G)delete G[z];let H=w,Z=Zu({name:J,value:$,options:{...W,...K}},G,Y);for(let z of Z)H[z.name]=z;return Object.values(H)},clean(){let $=wA(G,W);for(let K in G)delete G[K];return Object.values($)},setCookies($){for(let K of $)X.setCookie(K.name,K.value,K.options)}}}function ZA(J,W){let X=J.getCookie(W);if(X)return X;let G=[],Y=J.headers?.get("cookie");if(!Y)return null;let $={},K=Y.split("; ");for(let w of K){let[H,...Z]=w.split("=");if(H&&Z.length>0)$[H]=Z.join("=")}for(let[w,H]of Object.entries($))if(w.startsWith(W+".")){let Z=w.split(".").at(-1),z=parseInt(Z||"0",10);if(!isNaN(z))G.push({index:z,value:H})}if(G.length>0)return G.sort((w,H)=>w.index-H.index),G.map((w)=>w.value).join("");return null}var zA=M0(x({disableCookieCache:m6.boolean().meta({description:"Disable cookie cache and fetch session from database"}).optional(),disableRefresh:m6.boolean().meta({description:"Disable session refresh. Useful for checking session status, without updating the session"}).optional()}));function YX(J){let W=new Map;return J.split(", ").forEach((X)=>{let[G,...Y]=X.split(";").map((Z)=>Z.trim()),[$,...K]=(G||"").split("="),w=K.join("=");if(!$||w===void 0)return;let H={value:w};Y.forEach((Z)=>{let[z,...N]=Z.split("="),F=N.join("="),Q=z.trim().toLowerCase();switch(Q){case"max-age":H["max-age"]=F?parseInt(F.trim(),10):void 0;break;case"expires":H.expires=F?new Date(F.trim()):void 0;break;case"domain":H.domain=F?F.trim():void 0;break;case"path":H.path=F?F.trim():void 0;break;case"secure":H.secure=!0;break;case"httponly":H.httponly=!0;break;case"samesite":H.samesite=F?F.trim().toLowerCase():void 0;break;default:H[Q]=F?F.trim():!0;break}}),W.set($,H)}),W}function rD(J){let W=(J.advanced?.useSecureCookies!==void 0?J.advanced?.useSecureCookies:J.baseURL!==void 0?J.baseURL.startsWith("https://")?!0:!1:FW)?"__Secure-":"",X=!!J.advanced?.crossSubDomainCookies?.enabled,G=X?J.advanced?.crossSubDomainCookies?.domain||(J.baseURL?new URL(J.baseURL).hostname:void 0):void 0;if(X&&!G)throw new W6("baseURL is required when crossSubdomainCookies are enabled");function Y($,K={}){let w=J.advanced?.cookiePrefix||"better-auth",H=J.advanced?.cookies?.[$]?.name||`${w}.${$}`,Z=J.advanced?.cookies?.[$]?.attributes;return{name:`${W}${H}`,attributes:{secure:!!W,sameSite:"lax",path:"/",httpOnly:!0,...X?{domain:G}:{},...J.advanced?.defaultCookieAttributes,...K,...Z}}}return Y}function FA(J){let W=rD(J),X=W("session_token",{maxAge:J.session?.expiresIn||nD("7d")/1000}),G=W("session_data",{maxAge:J.session?.cookieCache?.maxAge||300}),Y=W("account_data",{maxAge:J.session?.cookieCache?.maxAge||300}),$=W("dont_remember");return{sessionToken:{name:X.name,options:X.attributes},sessionData:{name:G.name,options:G.attributes},dontRememberToken:{name:$.name,options:$.attributes},accountData:{name:Y.name,options:Y.attributes}}}async function I$(J,W,X){if(J.context.options.session?.cookieCache?.enabled){let G=Object.entries(W.session).reduce((F,[Q,V])=>{let v=J.context.options.session?.additionalFields?.[Q];if(!v||v.returned!==!1)F[Q]=V;return F},{}),Y=v8(J.context.options,W.user),$=J.context.options.session?.cookieCache?.version,K="1";if($){if(typeof $==="string")K=$;else if(typeof $==="function"){let F=$(W.session,W.user);K=F instanceof Promise?await F:F}}let w={session:G,user:Y,updatedAt:Date.now(),version:K},H={...J.context.authCookies.sessionData.options,maxAge:X?void 0:J.context.authCookies.sessionData.options.maxAge},Z=F4(H.maxAge||60,"sec").getTime(),z=J.context.options.session?.cookieCache?.strategy||"compact",N;if(z==="jwe")N=await sB(w,J.context.secret,"better-auth-session",H.maxAge||300);else if(z==="jwt")N=await LH(w,J.context.secret,H.maxAge||300);else N=$0.encode(JSON.stringify({session:w,expiresAt:Z,signature:await J1("SHA-256","base64urlnopad").sign(J.context.secret,JSON.stringify({...w,expiresAt:Z}))}),{padding:!1});if(N.length>4093){let F=dD(J.context.authCookies.sessionData.name,H,J),Q=F.chunk(N,H);F.setCookies(Q)}else{let F=dD(J.context.authCookies.sessionData.name,H,J);if(F.hasChunks()){let Q=F.clean();F.setCookies(Q)}J.setCookie(J.context.authCookies.sessionData.name,N,H)}}}async function I6(J,W,X,G){let Y=await J.getSignedCookie(J.context.authCookies.dontRememberToken.name,J.context.secret);X=X!==void 0?X:!!Y;let $=J.context.authCookies.sessionToken.options,K=X?void 0:J.context.sessionConfig.expiresIn;if(await J.setSignedCookie(J.context.authCookies.sessionToken.name,W.session.token,J.context.secret,{...$,maxAge:K,...G}),X)await J.setSignedCookie(J.context.authCookies.dontRememberToken.name,"true",J.context.secret,J.context.authCookies.dontRememberToken.options);if(await I$(J,W,X),J.context.setNewSession(W),J.context.options.secondaryStorage)await J.context.secondaryStorage?.set(W.session.token,JSON.stringify({user:W.user,session:W.session}),Math.floor((new Date(W.session.expiresAt).getTime()-Date.now())/1000))}function KJ(J,W){J.setCookie(J.context.authCookies.sessionToken.name,"",{...J.context.authCookies.sessionToken.options,maxAge:0});let X=dD(J.context.authCookies.sessionData.name,J.context.authCookies.sessionData.options,J),G=X.clean();if(X.setCookies(G),!W)J.setCookie(J.context.authCookies.dontRememberToken.name,"",{...J.context.authCookies.dontRememberToken.options,maxAge:0})}UW();O8();R4();i4();O0();kK();rF();i4();var b$=fX(async()=>{return{}}),x6=fX.create({use:[b$,fX(async()=>{return{}})]}),zu=[b$],y=(J,W,X)=>{return A9(J,{...W,use:[...W?.use||[],...zu]},async(G)=>VY(G,()=>X(G)))};R0();var MH=()=>y("/get-session",{method:"GET",operationId:"getSession",query:zA,requireHeaders:!0,metadata:{openapi:{operationId:"getSession",description:"Get the current session",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{session:{$ref:"#/components/schemas/Session"},user:{$ref:"#/components/schemas/User"}},required:["session","user"]}}}}}}}},async(J)=>{try{let W=await J.getSignedCookie(J.context.authCookies.sessionToken.name,J.context.secret);if(!W)return null;let X=ZA(J,J.context.authCookies.sessionData.name),G=null;if(X){let H=J.context.options.session?.cookieCache?.strategy||"compact";if(H==="jwe"){let Z=await kD(X,J.context.secret,"better-auth-session");if(Z&&Z.session&&Z.user)G={session:{session:Z.session,user:Z.user,updatedAt:Z.updatedAt,version:Z.version},expiresAt:Z.exp?Z.exp*1000:Date.now()};else{let z=J.context.authCookies.sessionData.name;return J.setCookie(z,"",{maxAge:0}),J.json(null)}}else if(H==="jwt"){let Z=await bD(X,J.context.secret);if(Z&&Z.session&&Z.user)G={session:{session:Z.session,user:Z.user,updatedAt:Z.updatedAt,version:Z.version},expiresAt:Z.exp?Z.exp*1000:Date.now()};else{let z=J.context.authCookies.sessionData.name;return J.setCookie(z,"",{maxAge:0}),J.json(null)}}else{let Z=l6(lD.decode($0.decode(X)));if(Z)if(await J1("SHA-256","base64urlnopad").verify(J.context.secret,JSON.stringify({...Z.session,expiresAt:Z.expiresAt}),Z.signature))G=Z;else{let z=J.context.authCookies.sessionData.name;return J.setCookie(z,"",{maxAge:0}),J.json(null)}}}let Y=await J.getSignedCookie(J.context.authCookies.dontRememberToken.name,J.context.secret);if(G?.session&&J.context.options.session?.cookieCache?.enabled&&!J.query?.disableCookieCache){let H=G.session,Z=J.context.options.session?.cookieCache?.version,z="1";if(Z){if(typeof Z==="string")z=Z;else if(typeof Z==="function"){let N=Z(H.session,H.user);z=N instanceof Promise?await N:N}}if((H.version||"1")!==z){let N=J.context.authCookies.sessionData.name;J.setCookie(N,"",{maxAge:0})}else if(G.expiresAt<Date.now()||H.session.expiresAt<new Date){let N=J.context.authCookies.sessionData.name;J.setCookie(N,"",{maxAge:0})}else{let N=J.context.sessionConfig.cookieRefreshCache;if(N===!1)return J.context.session=H,J.json({session:H.session,user:H.user});if(G.expiresAt-Date.now()<N.updateAge*1000){let V=F4(J.context.options.session?.cookieCache?.maxAge||300,"sec"),v={session:{...H.session,expiresAt:V},user:H.user,updatedAt:Date.now()};await I$(J,v,!1);let M=AJ(J.context.options,{...v.session,expiresAt:new Date(v.session.expiresAt),createdAt:new Date(v.session.createdAt),updatedAt:new Date(v.session.updatedAt)}),O=v8(J.context.options,{...v.user,createdAt:new Date(v.user.createdAt),updatedAt:new Date(v.user.updatedAt)});return J.context.session={session:M,user:O},J.json({session:M,user:O})}let F=AJ(J.context.options,{...H.session,expiresAt:new Date(H.session.expiresAt),createdAt:new Date(H.session.createdAt),updatedAt:new Date(H.session.updatedAt)}),Q=v8(J.context.options,{...H.user,createdAt:new Date(H.user.createdAt),updatedAt:new Date(H.user.updatedAt)});return J.context.session={session:F,user:Q},J.json({session:F,user:Q})}}let $=await J.context.internalAdapter.findSession(W);if(J.context.session=$,!$||$.session.expiresAt<new Date){if(KJ(J),$)await J.context.internalAdapter.deleteSession($.session.token);return J.json(null)}if(Y||J.query?.disableRefresh){let H=AJ(J.context.options,$.session),Z=v8(J.context.options,$.user);return J.json({session:H,user:Z})}let K=J.context.sessionConfig.expiresIn,w=J.context.sessionConfig.updateAge;if($.session.expiresAt.valueOf()-K*1000+w*1000<=Date.now()&&(!J.query?.disableRefresh||!J.context.options.session?.disableSessionRefresh)){let H=await J.context.internalAdapter.updateSession($.session.token,{expiresAt:F4(J.context.sessionConfig.expiresIn,"sec"),updatedAt:new Date});if(!H)return KJ(J),J.json(null,{status:401});let Z=(H.expiresAt.valueOf()-Date.now())/1000;await I6(J,{session:H,user:$.user},!1,{maxAge:Z});let z=AJ(J.context.options,H),N=v8(J.context.options,$.user);return J.json({session:z,user:N})}return await I$(J,$,!!Y),J.json($)}catch(W){throw J.context.logger.error("INTERNAL_SERVER_ERROR",W),new L("INTERNAL_SERVER_ERROR",{message:o.FAILED_TO_GET_SESSION})}}),P6=async(J,W)=>{if(J.context.session)return J.context.session;let X=await MH()({...J,asResponse:!1,headers:J.headers,returnHeaders:!1,returnStatus:!1,query:{...W,...J.query}}).catch((G)=>{return null});return J.context.session=X,X},k4=x6(async(J)=>{let W=await P6(J);if(!W?.session)throw new L("UNAUTHORIZED");return{session:W}}),GX=x6(async(J)=>{let W=await P6(J,{disableCookieCache:!0});if(!W?.session)throw new L("UNAUTHORIZED");return{session:W}}),NA=x6(async(J)=>{let W=await P6(J);if(!W?.session&&(J.request||J.headers))throw new L("UNAUTHORIZED");return{session:W}}),UA=x6(async(J)=>{let W=await P6(J);if(!W?.session)throw new L("UNAUTHORIZED");if(J.context.sessionConfig.freshAge===0)return{session:W};let X=J.context.sessionConfig.freshAge,G=new Date(W.session.updatedAt||W.session.createdAt).getTime();if(!(Date.now()-G<X*1000))throw new L("FORBIDDEN",{message:"Session is not fresh"});return{session:W}}),QA=()=>y("/list-sessions",{method:"GET",operationId:"listUserSessions",use:[k4],requireHeaders:!0,metadata:{openapi:{operationId:"listUserSessions",description:"List all active sessions for the user",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"array",items:{$ref:"#/components/schemas/Session"}}}}}}}}},async(J)=>{try{let W=(await J.context.internalAdapter.listSessions(J.context.session.user.id)).filter((X)=>{return X.expiresAt>new Date});return J.json(W)}catch(W){throw J.context.logger.error(W),J.error("INTERNAL_SERVER_ERROR")}}),LA=y("/revoke-session",{method:"POST",body:x({token:P().meta({description:"The token to revoke"})}),use:[GX],requireHeaders:!0,metadata:{openapi:{description:"Revoke a single session",requestBody:{content:{"application/json":{schema:{type:"object",properties:{token:{type:"string",description:"The token to revoke"}},required:["token"]}}}},responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean",description:"Indicates if the session was revoked successfully"}},required:["status"]}}}}}}}},async(J)=>{let W=J.body.token;if((await J.context.internalAdapter.findSession(W))?.session.userId===J.context.session.user.id)try{await J.context.internalAdapter.deleteSession(W)}catch(X){throw J.context.logger.error(X&&typeof X==="object"&&"name"in X?X.name:"",X),new L("INTERNAL_SERVER_ERROR")}return J.json({status:!0})}),VA=y("/revoke-sessions",{method:"POST",use:[GX],requireHeaders:!0,metadata:{openapi:{description:"Revoke all sessions for the user",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean",description:"Indicates if all sessions were revoked successfully"}},required:["status"]}}}}}}}},async(J)=>{try{await J.context.internalAdapter.deleteSessions(J.context.session.user.id)}catch(W){throw J.context.logger.error(W&&typeof W==="object"&&"name"in W?W.name:"",W),new L("INTERNAL_SERVER_ERROR")}return J.json({status:!0})}),DA=y("/revoke-other-sessions",{method:"POST",requireHeaders:!0,use:[GX],metadata:{openapi:{description:"Revoke all other sessions for the user except the current one",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean",description:"Indicates if all other sessions were revoked successfully"}},required:["status"]}}}}}}}},async(J)=>{let W=J.context.session;if(!W.user)throw new L("UNAUTHORIZED");let X=(await J.context.internalAdapter.listSessions(W.user.id)).filter((G)=>{return G.expiresAt>new Date}).filter((G)=>G.token!==J.context.session.session.token);return await Promise.all(X.map((G)=>J.context.internalAdapter.deleteSession(G.token))),J.json({status:!0})});MJ();t0();R4();i4();O0();eX();oV();R0();var{defineProperty:Fu,defineProperties:Nu,getOwnPropertyDescriptors:Uu,getOwnPropertySymbols:vA}=Object,Qu=Object.prototype.hasOwnProperty,Lu=Object.prototype.propertyIsEnumerable,MA=(J,W,X)=>(W in J)?Fu(J,W,{enumerable:!0,configurable:!0,writable:!0,value:X}):J[W]=X,Y1=(J,W)=>{for(var X in W||(W={}))if(Qu.call(W,X))MA(J,X,W[X]);if(vA){for(var X of vA(W))if(Lu.call(W,X))MA(J,X,W[X])}return J},G1=(J,W)=>Nu(J,Uu(W)),Vu=class extends Error{constructor(J,W,X){super(W||J.toString(),{cause:X});this.status=J,this.statusText=W,this.error=X}},Du=async(J,W)=>{var X,G,Y,$,K,w;let H=W||{},Z={onRequest:[W==null?void 0:W.onRequest],onResponse:[W==null?void 0:W.onResponse],onSuccess:[W==null?void 0:W.onSuccess],onError:[W==null?void 0:W.onError],onRetry:[W==null?void 0:W.onRetry]};if(!W||!(W==null?void 0:W.plugins))return{url:J,options:H,hooks:Z};for(let z of(W==null?void 0:W.plugins)||[]){if(z.init){let N=await((X=z.init)==null?void 0:X.call(z,J.toString(),W));H=N.options||H,J=N.url}Z.onRequest.push((G=z.hooks)==null?void 0:G.onRequest),Z.onResponse.push((Y=z.hooks)==null?void 0:Y.onResponse),Z.onSuccess.push(($=z.hooks)==null?void 0:$.onSuccess),Z.onError.push((K=z.hooks)==null?void 0:K.onError),Z.onRetry.push((w=z.hooks)==null?void 0:w.onRetry)}return{url:J,options:H,hooks:Z}},OA=class{constructor(J){this.options=J}shouldAttemptRetry(J,W){if(this.options.shouldRetry)return Promise.resolve(J<this.options.attempts&&this.options.shouldRetry(W));return Promise.resolve(J<this.options.attempts)}getDelay(){return this.options.delay}},vu=class{constructor(J){this.options=J}shouldAttemptRetry(J,W){if(this.options.shouldRetry)return Promise.resolve(J<this.options.attempts&&this.options.shouldRetry(W));return Promise.resolve(J<this.options.attempts)}getDelay(J){return Math.min(this.options.maxDelay,this.options.baseDelay*2**J)}};function Mu(J){if(typeof J==="number")return new OA({type:"linear",attempts:J,delay:1000});switch(J.type){case"linear":return new OA(J);case"exponential":return new vu(J);default:throw Error("Invalid retry strategy")}}var Ou=async(J)=>{let W={},X=async(G)=>typeof G==="function"?await G():G;if(J==null?void 0:J.auth){if(J.auth.type==="Bearer"){let G=await X(J.auth.token);if(!G)return W;W.authorization=`Bearer ${G}`}else if(J.auth.type==="Basic"){let G=X(J.auth.username),Y=X(J.auth.password);if(!G||!Y)return W;W.authorization=`Basic ${btoa(`${G}:${Y}`)}`}else if(J.auth.type==="Custom"){let G=X(J.auth.value);if(!G)return W;W.authorization=`${X(J.auth.prefix)} ${G}`}}return W},Pu=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function ju(J){let W=J.headers.get("content-type"),X=new Set(["image/svg","application/xml","application/xhtml","application/html"]);if(!W)return"json";let G=W.split(";").shift()||"";if(Pu.test(G))return"json";if(X.has(G)||G.startsWith("text/"))return"text";return"blob"}function _u(J){try{return JSON.parse(J),!0}catch(W){return!1}}function _A(J){if(J===void 0)return!1;let W=typeof J;if(W==="string"||W==="number"||W==="boolean"||W===null)return!0;if(W!=="object")return!1;if(Array.isArray(J))return!0;if(J.buffer)return!1;return J.constructor&&J.constructor.name==="Object"||typeof J.toJSON==="function"}function PA(J){try{return JSON.parse(J)}catch(W){return J}}function jA(J){return typeof J==="function"}function Su(J){if(J==null?void 0:J.customFetchImpl)return J.customFetchImpl;if(typeof globalThis<"u"&&jA(globalThis.fetch))return globalThis.fetch;if(typeof window<"u"&&jA(window.fetch))return window.fetch;throw Error("No fetch implementation found")}async function Tu(J){let W=new Headers(J==null?void 0:J.headers),X=await Ou(J);for(let[G,Y]of Object.entries(X||{}))W.set(G,Y);if(!W.has("content-type")){let G=qu(J==null?void 0:J.body);if(G)W.set("content-type",G)}return W}function qu(J){if(_A(J))return"application/json";return null}function Bu(J){if(!(J==null?void 0:J.body))return null;let W=new Headers(J==null?void 0:J.headers);if(_A(J.body)&&!W.has("content-type")){for(let[X,G]of Object.entries(J==null?void 0:J.body))if(G instanceof Date)J.body[X]=G.toISOString();return JSON.stringify(J.body)}return J.body}function Au(J,W){var X;if(W==null?void 0:W.method)return W.method.toUpperCase();if(J.startsWith("@")){let G=(X=J.split("@")[1])==null?void 0:X.split("/")[0];if(!SA.includes(G))return(W==null?void 0:W.body)?"POST":"GET";return G.toUpperCase()}return(W==null?void 0:W.body)?"POST":"GET"}function Eu(J,W){let X;if(!(J==null?void 0:J.signal)&&(J==null?void 0:J.timeout))X=setTimeout(()=>W==null?void 0:W.abort(),J==null?void 0:J.timeout);return{abortTimeout:X,clearTimeout:()=>{if(X)clearTimeout(X)}}}var Ru=class J extends Error{constructor(W,X){super(X||JSON.stringify(W,null,2));this.issues=W,Object.setPrototypeOf(this,J.prototype)}};async function Cu(J,W){let X=await J["~standard"].validate(W);if(X.issues)throw new Ru(X.issues);return X.value}var SA=["get","post","put","patch","delete"];function Iu(J,W){let{baseURL:X,params:G,query:Y}=W||{query:{},params:{},baseURL:""},$=J.startsWith("http")?J.split("/").slice(0,3).join("/"):X||"";if(J.startsWith("@")){let N=J.toString().split("@")[1].split("/")[0];if(SA.includes(N))J=J.replace(`@${N}/`,"/")}if(!$.endsWith("/"))$+="/";let[K,w]=J.replace($,"").split("?"),H=new URLSearchParams(w);for(let[N,F]of Object.entries(Y||{})){if(F==null)continue;H.set(N,String(F))}if(G)if(Array.isArray(G)){let N=K.split("/").filter((F)=>F.startsWith(":"));for(let[F,Q]of N.entries()){let V=G[F];K=K.replace(Q,V)}}else for(let[N,F]of Object.entries(G))K=K.replace(`:${N}`,String(F));if(K=K.split("/").map(encodeURIComponent).join("/"),K.startsWith("/"))K=K.slice(1);let Z=H.toString();if(Z=Z.length>0?`?${Z}`.replace(/\+/g,"%20"):"",!$.startsWith("http"))return`${$}${K}${Z}`;return new URL(`${K}${Z}`,$)}var z6=async(J,W)=>{var X,G,Y,$,K,w,H,Z;let{hooks:z,url:N,options:F}=await Du(J,W),Q=Su(F),V=new AbortController,v=(X=F.signal)!=null?X:V.signal,M=Iu(N,F),O=Bu(F),S=await Tu(F),T=Au(N,F),j=G1(Y1({},F),{url:M,headers:S,body:O,method:T,signal:v});for(let b of z.onRequest)if(b){let f=await b(j);if(f instanceof Object)j=f}if("pipeTo"in j&&typeof j.pipeTo==="function"||typeof((G=W==null?void 0:W.body)==null?void 0:G.pipe)==="function"){if(!("duplex"in j))j.duplex="half"}let{clearTimeout:q}=Eu(F,V),_=await Q(j.url,j);q();let B={response:_,request:j};for(let b of z.onResponse)if(b){let f=await b(G1(Y1({},B),{response:((Y=W==null?void 0:W.hookOptions)==null?void 0:Y.cloneResponse)?_.clone():_}));if(f instanceof Response)_=f;else if(f instanceof Object)_=f.response}if(_.ok){if(j.method==="HEAD")return{data:"",error:null};let f=ju(_),m={data:"",response:_,request:j};if(f==="json"||f==="text"){let c=await _.text(),i=await(($=j.jsonParser)!=null?$:PA)(c);m.data=i}else m.data=await _[f]();if(j==null?void 0:j.output){if(j.output&&!j.disableValidation)m.data=await Cu(j.output,m.data)}for(let c of z.onSuccess)if(c)await c(G1(Y1({},m),{response:((K=W==null?void 0:W.hookOptions)==null?void 0:K.cloneResponse)?_.clone():_}));if(W==null?void 0:W.throw)return m.data;return{data:m.data,error:null}}let A=(w=W==null?void 0:W.jsonParser)!=null?w:PA,E=await _.text(),R=_u(E),g=R?await A(E):null,u={response:_,responseText:E,request:j,error:G1(Y1({},g),{status:_.status,statusText:_.statusText})};for(let b of z.onError)if(b)await b(G1(Y1({},u),{response:((H=W==null?void 0:W.hookOptions)==null?void 0:H.cloneResponse)?_.clone():_}));if(W==null?void 0:W.retry){let b=Mu(W.retry),f=(Z=W.retryAttempt)!=null?Z:0;if(await b.shouldAttemptRetry(f,_)){for(let c of z.onRetry)if(c)await c(B);let m=b.getDelay(f);return await new Promise((c)=>setTimeout(c,m)),await z6(J,G1(Y1({},W),{retryAttempt:f+1}))}}if(W==null?void 0:W.throw)throw new Vu(_.status,_.statusText,R?g:E);return{data:null,error:G1(Y1({},g),{status:_.status,statusText:_.statusText})}};function OH(J){let W=(X)=>{return new Date(new Date().getTime()+X*1000)};return{tokenType:J.token_type,accessToken:J.access_token,refreshToken:J.refresh_token,accessTokenExpiresAt:J.expires_in?W(J.expires_in):void 0,refreshTokenExpiresAt:J.refresh_token_expires_in?W(J.refresh_token_expires_in):void 0,scopes:J?.scope?typeof J.scope==="string"?J.scope.split(" "):J.scope:[],idToken:J.id_token,raw:J}}async function PH(J){let W=new TextEncoder().encode(J),X=await crypto.subtle.digest("SHA-256",W);return $0.encode(new Uint8Array(X),{padding:!1})}async function n6({id:J,options:W,authorizationEndpoint:X,state:G,codeVerifier:Y,scopes:$,claims:K,redirectURI:w,duration:H,prompt:Z,accessType:z,responseType:N,display:F,loginHint:Q,hd:V,responseMode:v,additionalParams:M,scopeJoiner:O}){let S=new URL(X);S.searchParams.set("response_type",N||"code");let T=Array.isArray(W.clientId)?W.clientId[0]:W.clientId;if(S.searchParams.set("client_id",T),S.searchParams.set("state",G),S.searchParams.set("scope",$.join(O||" ")),S.searchParams.set("redirect_uri",W.redirectURI||w),H&&S.searchParams.set("duration",H),F&&S.searchParams.set("display",F),Q&&S.searchParams.set("login_hint",Q),Z&&S.searchParams.set("prompt",Z),V&&S.searchParams.set("hd",V),z&&S.searchParams.set("access_type",z),v&&S.searchParams.set("response_mode",v),Y){let j=await PH(Y);S.searchParams.set("code_challenge_method","S256"),S.searchParams.set("code_challenge",j)}if(K){let j=K.reduce((q,_)=>{return q[_]=null,q},{});S.searchParams.set("claims",JSON.stringify({id_token:{email:null,email_verified:null,...j}}))}if(M)Object.entries(M).forEach(([j,q])=>{S.searchParams.set(j,q)});return S}function TA({refreshToken:J,options:W,authentication:X,extraParams:G,resource:Y}){let $=new URLSearchParams,K={"content-type":"application/x-www-form-urlencoded",accept:"application/json"};if($.set("grant_type","refresh_token"),$.set("refresh_token",J),X==="basic"){let w=Array.isArray(W.clientId)?W.clientId[0]:W.clientId;if(w)K.authorization="Basic "+C4.encode(`${w}:${W.clientSecret??""}`);else K.authorization="Basic "+C4.encode(`:${W.clientSecret??""}`)}else{let w=Array.isArray(W.clientId)?W.clientId[0]:W.clientId;if($.set("client_id",w),W.clientSecret)$.set("client_secret",W.clientSecret)}if(Y)if(typeof Y==="string")$.append("resource",Y);else for(let w of Y)$.append("resource",w);if(G)for(let[w,H]of Object.entries(G))$.set(w,H);return{body:$,headers:K}}async function b6({refreshToken:J,options:W,tokenEndpoint:X,authentication:G,extraParams:Y}){let{body:$,headers:K}=TA({refreshToken:J,options:W,authentication:G,extraParams:Y}),{data:w,error:H}=await z6(X,{method:"POST",body:$,headers:K});if(H)throw H;let Z={accessToken:w.access_token,refreshToken:w.refresh_token,tokenType:w.token_type,scopes:w.scope?.split(" "),idToken:w.id_token};if(w.expires_in){let z=new Date;Z.accessTokenExpiresAt=new Date(z.getTime()+w.expires_in*1000)}return Z}function qA({code:J,codeVerifier:W,redirectURI:X,options:G,authentication:Y,deviceId:$,headers:K,additionalParams:w={},resource:H}){let Z=new URLSearchParams,z={"content-type":"application/x-www-form-urlencoded",accept:"application/json",...K};if(Z.set("grant_type","authorization_code"),Z.set("code",J),W&&Z.set("code_verifier",W),G.clientKey&&Z.set("client_key",G.clientKey),$&&Z.set("device_id",$),Z.set("redirect_uri",G.redirectURI||X),H)if(typeof H==="string")Z.append("resource",H);else for(let N of H)Z.append("resource",N);if(Y==="basic"){let N=Array.isArray(G.clientId)?G.clientId[0]:G.clientId;z.authorization=`Basic ${C4.encode(`${N}:${G.clientSecret??""}`)}`}else{let N=Array.isArray(G.clientId)?G.clientId[0]:G.clientId;if(Z.set("client_id",N),G.clientSecret)Z.set("client_secret",G.clientSecret)}for(let[N,F]of Object.entries(w))if(!Z.has(N))Z.append(N,F);return{body:Z,headers:z}}async function k6({code:J,codeVerifier:W,redirectURI:X,options:G,tokenEndpoint:Y,authentication:$,deviceId:K,headers:w,additionalParams:H={},resource:Z}){let{body:z,headers:N}=qA({code:J,codeVerifier:W,redirectURI:X,options:G,authentication:$,deviceId:K,headers:w,additionalParams:H,resource:Z}),{data:F,error:Q}=await z6(Y,{method:"POST",body:z,headers:N});if(Q)throw Q;return OH(F)}v9();DF();O0();R0();eX();i4();var bu=(J)=>{return{id:"apple",name:"Apple",async createAuthorizationURL({state:X,scopes:G,redirectURI:Y}){let $=J.disableDefaultScope?[]:["email","name"];if(J.scope)$.push(...J.scope);if(G)$.push(...G);return await n6({id:"apple",options:J,authorizationEndpoint:"https://appleid.apple.com/auth/authorize",scopes:$,state:X,redirectURI:Y,responseMode:"form_post",responseType:"code id_token"})},validateAuthorizationCode:async({code:X,codeVerifier:G,redirectURI:Y})=>{return k6({code:X,codeVerifier:G,redirectURI:Y,options:J,tokenEndpoint:"https://appleid.apple.com/auth/token"})},async verifyIdToken(X,G){if(J.disableIdTokenSignIn)return!1;if(J.verifyIdToken)return J.verifyIdToken(X,G);let{kid:Y,alg:$}=QH(X);if(!Y||!$)return!1;let{payload:K}=await P8(X,await ku(Y),{algorithms:[$],issuer:"https://appleid.apple.com",audience:J.audience&&J.audience.length?J.audience:J.appBundleIdentifier?J.appBundleIdentifier:J.clientId,maxTokenAge:"1h"});if(["email_verified","is_private_email"].forEach((w)=>{if(K[w]!==void 0)K[w]=Boolean(K[w])}),G&&K.nonce!==G)return!1;return!!K},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(X)=>{return b6({refreshToken:X,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},tokenEndpoint:"https://appleid.apple.com/auth/token"})},async getUserInfo(X){if(J.getUserInfo)return J.getUserInfo(X);if(!X.idToken)return null;let G=$J(X.idToken);if(!G)return null;let Y=X.user?`${X.user.name?.firstName} ${X.user.name?.lastName}`:G.name||G.email,$=typeof G.email_verified==="boolean"?G.email_verified:G.email_verified==="true",K={...G,name:Y},w=await J.mapProfileToUser?.(K);return{user:{id:G.sub,name:K.name,emailVerified:$,email:G.email,...w},data:K}},options:J}},ku=async(J)=>{let{data:W}=await z6("https://appleid.apple.com/auth/keys");if(!W?.keys)throw new L("BAD_REQUEST",{message:"Keys not found"});let X=W.keys.find((G)=>G.kid===J);if(!X)throw Error(`JWK with kid ${J} not found`);return await GJ(X,X.alg)},hu=(J)=>{return{id:"atlassian",name:"Atlassian",async createAuthorizationURL({state:W,scopes:X,codeVerifier:G,redirectURI:Y}){if(!J.clientId||!J.clientSecret)throw G6.error("Client Id and Secret are required for Atlassian"),new W6("CLIENT_ID_AND_SECRET_REQUIRED");if(!G)throw new W6("codeVerifier is required for Atlassian");let $=J.disableDefaultScope?[]:["read:jira-user","offline_access"];if(J.scope)$.push(...J.scope);if(X)$.push(...X);return n6({id:"atlassian",options:J,authorizationEndpoint:"https://auth.atlassian.com/authorize",scopes:$,state:W,codeVerifier:G,redirectURI:Y,additionalParams:{audience:"api.atlassian.com"},prompt:J.prompt})},validateAuthorizationCode:async({code:W,codeVerifier:X,redirectURI:G})=>{return k6({code:W,codeVerifier:X,redirectURI:G,options:J,tokenEndpoint:"https://auth.atlassian.com/oauth/token"})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(W)=>{return b6({refreshToken:W,options:{clientId:J.clientId,clientSecret:J.clientSecret},tokenEndpoint:"https://auth.atlassian.com/oauth/token"})},async getUserInfo(W){if(J.getUserInfo)return J.getUserInfo(W);if(!W.accessToken)return null;try{let{data:X}=await z6("https://api.atlassian.com/me",{headers:{Authorization:`Bearer ${W.accessToken}`}});if(!X)return null;let G=await J.mapProfileToUser?.(X);return{user:{id:X.account_id,name:X.name,email:X.email,image:X.picture,emailVerified:!1,...G},data:X}}catch(X){return G6.error("Failed to fetch user info from Figma:",X),null}},options:J}},fu=(J)=>{if(!J.domain||!J.region||!J.userPoolId)throw G6.error("Domain, region and userPoolId are required for Amazon Cognito. Make sure to provide them in the options."),new W6("DOMAIN_AND_REGION_REQUIRED");let W=J.domain.replace(/^https?:\/\//,""),X=`https://${W}/oauth2/authorize`,G=`https://${W}/oauth2/token`,Y=`https://${W}/oauth2/userinfo`;return{id:"cognito",name:"Cognito",async createAuthorizationURL({state:$,scopes:K,codeVerifier:w,redirectURI:H}){if(!J.clientId)throw G6.error("ClientId is required for Amazon Cognito. Make sure to provide them in the options."),new W6("CLIENT_ID_AND_SECRET_REQUIRED");if(J.requireClientSecret&&!J.clientSecret)throw G6.error("Client Secret is required when requireClientSecret is true. Make sure to provide it in the options."),new W6("CLIENT_SECRET_REQUIRED");let Z=J.disableDefaultScope?[]:["openid","profile","email"];if(J.scope)Z.push(...J.scope);if(K)Z.push(...K);return await n6({id:"cognito",options:{...J},authorizationEndpoint:X,scopes:Z,state:$,codeVerifier:w,redirectURI:H,prompt:J.prompt})},validateAuthorizationCode:async({code:$,codeVerifier:K,redirectURI:w})=>{return k6({code:$,codeVerifier:K,redirectURI:w,options:J,tokenEndpoint:G})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async($)=>{return b6({refreshToken:$,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},tokenEndpoint:G})},async verifyIdToken($,K){if(J.disableIdTokenSignIn)return!1;if(J.verifyIdToken)return J.verifyIdToken($,K);try{let{kid:w,alg:H}=QH($);if(!w||!H)return!1;let Z=await gu(w,J.region,J.userPoolId),z=`https://cognito-idp.${J.region}.amazonaws.com/${J.userPoolId}`,{payload:N}=await P8($,Z,{algorithms:[H],issuer:z,audience:J.clientId,maxTokenAge:"1h"});if(K&&N.nonce!==K)return!1;return!0}catch(w){return G6.error("Failed to verify ID token:",w),!1}},async getUserInfo($){if(J.getUserInfo)return J.getUserInfo($);if($.idToken)try{let K=$J($.idToken);if(!K)return null;let w=K.name||K.given_name||K.username||K.email,H={...K,name:w},Z=await J.mapProfileToUser?.(H);return{user:{id:K.sub,name:H.name,email:K.email,image:K.picture,emailVerified:K.email_verified,...Z},data:H}}catch(K){G6.error("Failed to decode ID token:",K)}if($.accessToken)try{let{data:K}=await z6(Y,{headers:{Authorization:`Bearer ${$.accessToken}`}});if(K){let w=await J.mapProfileToUser?.(K);return{user:{id:K.sub,name:K.name||K.given_name||K.username,email:K.email,image:K.picture,emailVerified:K.email_verified,...w},data:K}}}catch(K){G6.error("Failed to fetch user info from Cognito:",K)}return null},options:J}},gu=async(J,W,X)=>{let G=`https://cognito-idp.${W}.amazonaws.com/${X}/.well-known/jwks.json`;try{let{data:Y}=await z6(G);if(!Y?.keys)throw new L("BAD_REQUEST",{message:"Keys not found"});let $=Y.keys.find((K)=>K.kid===J);if(!$)throw Error(`JWK with kid ${J} not found`);return await GJ($,$.alg)}catch(Y){throw G6.error("Failed to fetch Cognito public key:",Y),Y}},mu=(J)=>{return{id:"discord",name:"Discord",createAuthorizationURL({state:W,scopes:X,redirectURI:G}){let Y=J.disableDefaultScope?[]:["identify","email"];if(X)Y.push(...X);if(J.scope)Y.push(...J.scope);let $=Y.includes("bot")&&J.permissions!==void 0?`&permissions=${J.permissions}`:"";return new URL(`https://discord.com/api/oauth2/authorize?scope=${Y.join("+")}&response_type=code&client_id=${J.clientId}&redirect_uri=${encodeURIComponent(J.redirectURI||G)}&state=${W}&prompt=${J.prompt||"none"}${$}`)},validateAuthorizationCode:async({code:W,redirectURI:X})=>{return k6({code:W,redirectURI:X,options:J,tokenEndpoint:"https://discord.com/api/oauth2/token"})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(W)=>{return b6({refreshToken:W,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},tokenEndpoint:"https://discord.com/api/oauth2/token"})},async getUserInfo(W){if(J.getUserInfo)return J.getUserInfo(W);let{data:X,error:G}=await z6("https://discord.com/api/users/@me",{headers:{authorization:`Bearer ${W.accessToken}`}});if(G)return null;if(X.avatar===null)X.image_url=`https://cdn.discordapp.com/embed/avatars/${X.discriminator==="0"?Number(BigInt(X.id)>>BigInt(22))%6:parseInt(X.discriminator)%5}.png`;else{let $=X.avatar.startsWith("a_")?"gif":"png";X.image_url=`https://cdn.discordapp.com/avatars/${X.id}/${X.avatar}.${$}`}let Y=await J.mapProfileToUser?.(X);return{user:{id:X.id,name:X.global_name||X.username||"",email:X.email,emailVerified:X.verified,image:X.image_url,...Y},data:X}},options:J}},yu=(J)=>{return{id:"dropbox",name:"Dropbox",createAuthorizationURL:async({state:X,scopes:G,codeVerifier:Y,redirectURI:$})=>{let K=J.disableDefaultScope?[]:["account_info.read"];if(J.scope)K.push(...J.scope);if(G)K.push(...G);let w={};if(J.accessType)w.token_access_type=J.accessType;return await n6({id:"dropbox",options:J,authorizationEndpoint:"https://www.dropbox.com/oauth2/authorize",scopes:K,state:X,redirectURI:$,codeVerifier:Y,additionalParams:w})},validateAuthorizationCode:async({code:X,codeVerifier:G,redirectURI:Y})=>{return await k6({code:X,codeVerifier:G,redirectURI:Y,options:J,tokenEndpoint:"https://api.dropboxapi.com/oauth2/token"})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(X)=>{return b6({refreshToken:X,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},tokenEndpoint:"https://api.dropbox.com/oauth2/token"})},async getUserInfo(X){if(J.getUserInfo)return J.getUserInfo(X);let{data:G,error:Y}=await z6("https://api.dropboxapi.com/2/users/get_current_account",{method:"POST",headers:{Authorization:`Bearer ${X.accessToken}`}});if(Y)return null;let $=await J.mapProfileToUser?.(G);return{user:{id:G.account_id,name:G.name?.display_name,email:G.email,emailVerified:G.email_verified||!1,image:G.profile_photo_url,...$},data:G}},options:J}},xu=(J)=>{return{id:"facebook",name:"Facebook",async createAuthorizationURL({state:W,scopes:X,redirectURI:G,loginHint:Y}){let $=J.disableDefaultScope?[]:["email","public_profile"];if(J.scope)$.push(...J.scope);if(X)$.push(...X);return await n6({id:"facebook",options:J,authorizationEndpoint:"https://www.facebook.com/v21.0/dialog/oauth",scopes:$,state:W,redirectURI:G,loginHint:Y,additionalParams:J.configId?{config_id:J.configId}:{}})},validateAuthorizationCode:async({code:W,redirectURI:X})=>{return k6({code:W,redirectURI:X,options:J,tokenEndpoint:"https://graph.facebook.com/oauth/access_token"})},async verifyIdToken(W,X){if(J.disableIdTokenSignIn)return!1;if(J.verifyIdToken)return J.verifyIdToken(W,X);if(W.split(".").length===3)try{let{payload:G}=await P8(W,RD(new URL("https://limited.facebook.com/.well-known/oauth/openid/jwks/")),{algorithms:["RS256"],audience:J.clientId,issuer:"https://www.facebook.com"});if(X&&G.nonce!==X)return!1;return!!G}catch(G){return!1}return!0},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(W)=>{return b6({refreshToken:W,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},tokenEndpoint:"https://graph.facebook.com/v18.0/oauth/access_token"})},async getUserInfo(W){if(J.getUserInfo)return J.getUserInfo(W);if(W.idToken&&W.idToken.split(".").length===3){let $=$J(W.idToken),K={id:$.sub,name:$.name,email:$.email,picture:{data:{url:$.picture,height:100,width:100,is_silhouette:!1}}},w=await J.mapProfileToUser?.({...K,email_verified:!1});return{user:{...K,emailVerified:!1,...w},data:$}}let{data:X,error:G}=await z6("https://graph.facebook.com/me?fields="+["id","name","email","picture",...J?.fields||[]].join(","),{auth:{type:"Bearer",token:W.accessToken}});if(G)return null;let Y=await J.mapProfileToUser?.(X);return{user:{id:X.id,name:X.name,email:X.email,image:X.picture.data.url,emailVerified:X.email_verified,...Y},data:X}},options:J}},uu=(J)=>{return{id:"figma",name:"Figma",async createAuthorizationURL({state:W,scopes:X,codeVerifier:G,redirectURI:Y}){if(!J.clientId||!J.clientSecret)throw G6.error("Client Id and Client Secret are required for Figma. Make sure to provide them in the options."),new W6("CLIENT_ID_AND_SECRET_REQUIRED");if(!G)throw new W6("codeVerifier is required for Figma");let $=J.disableDefaultScope?[]:["file_read"];if(J.scope)$.push(...J.scope);if(X)$.push(...X);return await n6({id:"figma",options:J,authorizationEndpoint:"https://www.figma.com/oauth",scopes:$,state:W,codeVerifier:G,redirectURI:Y})},validateAuthorizationCode:async({code:W,codeVerifier:X,redirectURI:G})=>{return k6({code:W,codeVerifier:X,redirectURI:G,options:J,tokenEndpoint:"https://www.figma.com/api/oauth/token"})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(W)=>{return b6({refreshToken:W,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},tokenEndpoint:"https://www.figma.com/api/oauth/token"})},async getUserInfo(W){if(J.getUserInfo)return J.getUserInfo(W);try{let{data:X}=await z6("https://api.figma.com/v1/me",{headers:{Authorization:`Bearer ${W.accessToken}`}});if(!X)return G6.error("Failed to fetch user from Figma"),null;let G=await J.mapProfileToUser?.(X);return{user:{id:X.id,name:X.handle,email:X.email,image:X.img_url,emailVerified:!!X.email,...G},data:X}}catch(X){return G6.error("Failed to fetch user info from Figma:",X),null}},options:J}},lu=(J)=>{return{id:"github",name:"GitHub",createAuthorizationURL({state:X,scopes:G,loginHint:Y,redirectURI:$}){let K=J.disableDefaultScope?[]:["read:user","user:email"];if(J.scope)K.push(...J.scope);if(G)K.push(...G);return n6({id:"github",options:J,authorizationEndpoint:"https://github.com/login/oauth/authorize",scopes:K,state:X,redirectURI:$,loginHint:Y,prompt:J.prompt})},validateAuthorizationCode:async({code:X,redirectURI:G})=>{return k6({code:X,redirectURI:G,options:J,tokenEndpoint:"https://github.com/login/oauth/access_token"})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(X)=>{return b6({refreshToken:X,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},tokenEndpoint:"https://github.com/login/oauth/access_token"})},async getUserInfo(X){if(J.getUserInfo)return J.getUserInfo(X);let{data:G,error:Y}=await z6("https://api.github.com/user",{headers:{"User-Agent":"better-auth",authorization:`Bearer ${X.accessToken}`}});if(Y)return null;let{data:$}=await z6("https://api.github.com/user/emails",{headers:{Authorization:`Bearer ${X.accessToken}`,"User-Agent":"better-auth"}});if(!G.email&&$)G.email=($.find((H)=>H.primary)??$[0])?.email;let K=$?.find((H)=>H.email===G.email)?.verified??!1,w=await J.mapProfileToUser?.(G);return{user:{id:G.id,name:G.name||G.login,email:G.email,image:G.avatar_url,emailVerified:K,...w},data:G}},options:J}},iD=(J="")=>{return J.split("://").map((W)=>W.replace(/\/{2,}/g,"/")).join("://")},cu=(J)=>{let W=J||"https://gitlab.com";return{authorizationEndpoint:iD(`${W}/oauth/authorize`),tokenEndpoint:iD(`${W}/oauth/token`),userinfoEndpoint:iD(`${W}/api/v4/user`)}},pu=(J)=>{let{authorizationEndpoint:W,tokenEndpoint:X,userinfoEndpoint:G}=cu(J.issuer),Y="gitlab";return{id:"gitlab",name:"Gitlab",createAuthorizationURL:async({state:$,scopes:K,codeVerifier:w,loginHint:H,redirectURI:Z})=>{let z=J.disableDefaultScope?[]:["read_user"];if(J.scope)z.push(...J.scope);if(K)z.push(...K);return await n6({id:"gitlab",options:J,authorizationEndpoint:W,scopes:z,state:$,redirectURI:Z,codeVerifier:w,loginHint:H})},validateAuthorizationCode:async({code:$,redirectURI:K,codeVerifier:w})=>{return k6({code:$,redirectURI:K,options:J,codeVerifier:w,tokenEndpoint:X})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async($)=>{return b6({refreshToken:$,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},tokenEndpoint:X})},async getUserInfo($){if(J.getUserInfo)return J.getUserInfo($);let{data:K,error:w}=await z6(G,{headers:{authorization:`Bearer ${$.accessToken}`}});if(w||K.state!=="active"||K.locked)return null;let H=await J.mapProfileToUser?.(K);return{user:{id:K.id,name:K.name??K.username,email:K.email,image:K.avatar_url,emailVerified:K.email_verified??!1,...H},data:K}},options:J}},du=(J)=>{return{id:"google",name:"Google",async createAuthorizationURL({state:W,scopes:X,codeVerifier:G,redirectURI:Y,loginHint:$,display:K}){if(!J.clientId||!J.clientSecret)throw G6.error("Client Id and Client Secret is required for Google. Make sure to provide them in the options."),new W6("CLIENT_ID_AND_SECRET_REQUIRED");if(!G)throw new W6("codeVerifier is required for Google");let w=J.disableDefaultScope?[]:["email","profile","openid"];if(J.scope)w.push(...J.scope);if(X)w.push(...X);return await n6({id:"google",options:J,authorizationEndpoint:"https://accounts.google.com/o/oauth2/auth",scopes:w,state:W,codeVerifier:G,redirectURI:Y,prompt:J.prompt,accessType:J.accessType,display:K||J.display,loginHint:$,hd:J.hd,additionalParams:{include_granted_scopes:"true"}})},validateAuthorizationCode:async({code:W,codeVerifier:X,redirectURI:G})=>{return k6({code:W,codeVerifier:X,redirectURI:G,options:J,tokenEndpoint:"https://oauth2.googleapis.com/token"})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(W)=>{return b6({refreshToken:W,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},tokenEndpoint:"https://www.googleapis.com/oauth2/v4/token"})},async verifyIdToken(W,X){if(J.disableIdTokenSignIn)return!1;if(J.verifyIdToken)return J.verifyIdToken(W,X);let{data:G}=await z6(`https://www.googleapis.com/oauth2/v3/tokeninfo?id_token=${W}`);if(!G)return!1;return G.aud===J.clientId&&(G.iss==="https://accounts.google.com"||G.iss==="accounts.google.com")},async getUserInfo(W){if(J.getUserInfo)return J.getUserInfo(W);if(!W.idToken)return null;let X=$J(W.idToken),G=await J.mapProfileToUser?.(X);return{user:{id:X.sub,name:X.name,email:X.email,image:X.picture,emailVerified:X.email_verified,...G},data:X}},options:J}},nu=(J)=>{return{id:"huggingface",name:"Hugging Face",createAuthorizationURL({state:W,scopes:X,codeVerifier:G,redirectURI:Y}){let $=J.disableDefaultScope?[]:["openid","profile","email"];if(J.scope)$.push(...J.scope);if(X)$.push(...X);return n6({id:"huggingface",options:J,authorizationEndpoint:"https://huggingface.co/oauth/authorize",scopes:$,state:W,codeVerifier:G,redirectURI:Y})},validateAuthorizationCode:async({code:W,codeVerifier:X,redirectURI:G})=>{return k6({code:W,codeVerifier:X,redirectURI:G,options:J,tokenEndpoint:"https://huggingface.co/oauth/token"})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(W)=>{return b6({refreshToken:W,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},tokenEndpoint:"https://huggingface.co/oauth/token"})},async getUserInfo(W){if(J.getUserInfo)return J.getUserInfo(W);let{data:X,error:G}=await z6("https://huggingface.co/oauth/userinfo",{method:"GET",headers:{Authorization:`Bearer ${W.accessToken}`}});if(G)return null;let Y=await J.mapProfileToUser?.(X);return{user:{id:X.sub,name:X.name||X.preferred_username,email:X.email,image:X.picture,emailVerified:X.email_verified??!1,...Y},data:X}},options:J}},ru=(J)=>{return{id:"kakao",name:"Kakao",createAuthorizationURL({state:W,scopes:X,redirectURI:G}){let Y=J.disableDefaultScope?[]:["account_email","profile_image","profile_nickname"];if(J.scope)Y.push(...J.scope);if(X)Y.push(...X);return n6({id:"kakao",options:J,authorizationEndpoint:"https://kauth.kakao.com/oauth/authorize",scopes:Y,state:W,redirectURI:G})},validateAuthorizationCode:async({code:W,redirectURI:X})=>{return k6({code:W,redirectURI:X,options:J,tokenEndpoint:"https://kauth.kakao.com/oauth/token"})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(W)=>{return b6({refreshToken:W,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},tokenEndpoint:"https://kauth.kakao.com/oauth/token"})},async getUserInfo(W){if(J.getUserInfo)return J.getUserInfo(W);let{data:X,error:G}=await z6("https://kapi.kakao.com/v2/user/me",{headers:{Authorization:`Bearer ${W.accessToken}`}});if(G||!X)return null;let Y=await J.mapProfileToUser?.(X),$=X.kakao_account||{},K=$.profile||{};return{user:{id:String(X.id),name:K.nickname||$.name||void 0,email:$.email,image:K.profile_image_url||K.thumbnail_image_url,emailVerified:!!$.is_email_valid&&!!$.is_email_verified,...Y},data:X}},options:J}},iu=(J)=>{return{id:"kick",name:"Kick",createAuthorizationURL({state:W,scopes:X,redirectURI:G,codeVerifier:Y}){let $=J.disableDefaultScope?[]:["user:read"];if(J.scope)$.push(...J.scope);if(X)$.push(...X);return n6({id:"kick",redirectURI:G,options:J,authorizationEndpoint:"https://id.kick.com/oauth/authorize",scopes:$,codeVerifier:Y,state:W})},async validateAuthorizationCode({code:W,redirectURI:X,codeVerifier:G}){return k6({code:W,redirectURI:X,options:J,tokenEndpoint:"https://id.kick.com/oauth/token",codeVerifier:G})},async getUserInfo(W){if(J.getUserInfo)return J.getUserInfo(W);let{data:X,error:G}=await z6("https://api.kick.com/public/v1/users",{method:"GET",headers:{Authorization:`Bearer ${W.accessToken}`}});if(G)return null;let Y=X.data[0],$=await J.mapProfileToUser?.(Y);return{user:{id:Y.user_id,name:Y.name,email:Y.email,image:Y.profile_picture,emailVerified:!1,...$},data:Y}},options:J}},au=(J)=>{return{id:"line",name:"LINE",async createAuthorizationURL({state:$,scopes:K,codeVerifier:w,redirectURI:H,loginHint:Z}){let z=J.disableDefaultScope?[]:["openid","profile","email"];if(J.scope)z.push(...J.scope);if(K)z.push(...K);return await n6({id:"line",options:J,authorizationEndpoint:"https://access.line.me/oauth2/v2.1/authorize",scopes:z,state:$,codeVerifier:w,redirectURI:H,loginHint:Z})},validateAuthorizationCode:async({code:$,codeVerifier:K,redirectURI:w})=>{return k6({code:$,codeVerifier:K,redirectURI:w,options:J,tokenEndpoint:"https://api.line.me/oauth2/v2.1/token"})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async($)=>{return b6({refreshToken:$,options:{clientId:J.clientId,clientSecret:J.clientSecret},tokenEndpoint:"https://api.line.me/oauth2/v2.1/token"})},async verifyIdToken($,K){if(J.disableIdTokenSignIn)return!1;if(J.verifyIdToken)return J.verifyIdToken($,K);let w=new URLSearchParams;if(w.set("id_token",$),w.set("client_id",J.clientId),K)w.set("nonce",K);let{data:H,error:Z}=await z6("https://api.line.me/oauth2/v2.1/verify",{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded"},body:w});if(Z||!H)return!1;if(H.aud!==J.clientId)return!1;if(K&&H.nonce&&H.nonce!==K)return!1;return!0},async getUserInfo($){if(J.getUserInfo)return J.getUserInfo($);let K=null;if($.idToken)try{K=$J($.idToken)}catch{}if(!K){let{data:N}=await z6("https://api.line.me/oauth2/v2.1/userinfo",{headers:{authorization:`Bearer ${$.accessToken}`}});K=N||null}if(!K)return null;let w=await J.mapProfileToUser?.(K),H=K.sub||K.userId,Z=K.name||K.displayName,z=K.picture||K.pictureUrl||void 0;return{user:{id:H,name:Z,email:K.email,image:z,emailVerified:!1,...w},data:K}},options:J}},tu=(J)=>{return{id:"linear",name:"Linear",createAuthorizationURL({state:X,scopes:G,loginHint:Y,redirectURI:$}){let K=J.disableDefaultScope?[]:["read"];if(J.scope)K.push(...J.scope);if(G)K.push(...G);return n6({id:"linear",options:J,authorizationEndpoint:"https://linear.app/oauth/authorize",scopes:K,state:X,redirectURI:$,loginHint:Y})},validateAuthorizationCode:async({code:X,redirectURI:G})=>{return k6({code:X,redirectURI:G,options:J,tokenEndpoint:"https://api.linear.app/oauth/token"})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(X)=>{return b6({refreshToken:X,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},tokenEndpoint:"https://api.linear.app/oauth/token"})},async getUserInfo(X){if(J.getUserInfo)return J.getUserInfo(X);let{data:G,error:Y}=await z6("https://api.linear.app/graphql",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${X.accessToken}`},body:JSON.stringify({query:`
							query {
								viewer {
									id
									name
									email
									avatarUrl
									active
									createdAt
									updatedAt
								}
							}
						`})});if(Y||!G?.data?.viewer)return null;let $=G.data.viewer,K=await J.mapProfileToUser?.($);return{user:{id:G.data.viewer.id,name:G.data.viewer.name,email:G.data.viewer.email,image:G.data.viewer.avatarUrl,emailVerified:!1,...K},data:$}},options:J}},ou=(J)=>{return{id:"linkedin",name:"Linkedin",createAuthorizationURL:async({state:G,scopes:Y,redirectURI:$,loginHint:K})=>{let w=J.disableDefaultScope?[]:["profile","email","openid"];if(J.scope)w.push(...J.scope);if(Y)w.push(...Y);return await n6({id:"linkedin",options:J,authorizationEndpoint:"https://www.linkedin.com/oauth/v2/authorization",scopes:w,state:G,loginHint:K,redirectURI:$})},validateAuthorizationCode:async({code:G,redirectURI:Y})=>{return await k6({code:G,redirectURI:Y,options:J,tokenEndpoint:"https://www.linkedin.com/oauth/v2/accessToken"})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(G)=>{return b6({refreshToken:G,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},tokenEndpoint:"https://www.linkedin.com/oauth/v2/accessToken"})},async getUserInfo(G){if(J.getUserInfo)return J.getUserInfo(G);let{data:Y,error:$}=await z6("https://api.linkedin.com/v2/userinfo",{method:"GET",headers:{Authorization:`Bearer ${G.accessToken}`}});if($)return null;let K=await J.mapProfileToUser?.(Y);return{user:{id:Y.sub,name:Y.name,email:Y.email,emailVerified:Y.email_verified||!1,image:Y.picture,...K},data:Y}},options:J}},su=(J)=>{let W=J.tenantId||"common",X=J.authority||"https://login.microsoftonline.com",G=`${X}/${W}/oauth2/v2.0/authorize`,Y=`${X}/${W}/oauth2/v2.0/token`;return{id:"microsoft",name:"Microsoft EntraID",createAuthorizationURL($){let K=J.disableDefaultScope?[]:["openid","profile","email","User.Read","offline_access"];if(J.scope)K.push(...J.scope);if($.scopes)K.push(...$.scopes);return n6({id:"microsoft",options:J,authorizationEndpoint:G,state:$.state,codeVerifier:$.codeVerifier,scopes:K,redirectURI:$.redirectURI,prompt:J.prompt,loginHint:$.loginHint})},validateAuthorizationCode({code:$,codeVerifier:K,redirectURI:w}){return k6({code:$,codeVerifier:K,redirectURI:w,options:J,tokenEndpoint:Y})},async getUserInfo($){if(J.getUserInfo)return J.getUserInfo($);if(!$.idToken)return null;let K=$J($.idToken),w=J.profilePhotoSize||48;await z6(`https://graph.microsoft.com/v1.0/me/photos/${w}x${w}/$value`,{headers:{Authorization:`Bearer ${$.accessToken}`},async onResponse(z){if(J.disableProfilePhoto||!z.response.ok)return;try{let N=await z.response.clone().arrayBuffer();K.picture=`data:image/jpeg;base64, ${C4.encode(N)}`}catch(N){G6.error(N&&typeof N==="object"&&"name"in N?N.name:"",N)}}});let H=await J.mapProfileToUser?.(K),Z=K.email_verified!==void 0?K.email_verified:K.email&&(K.verified_primary_email?.includes(K.email)||K.verified_secondary_email?.includes(K.email))?!0:!1;return{user:{id:K.sub,name:K.name,email:K.email,image:K.picture,emailVerified:Z,...H},data:K}},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async($)=>{let K=J.disableDefaultScope?[]:["openid","profile","email","User.Read","offline_access"];if(J.scope)K.push(...J.scope);return b6({refreshToken:$,options:{clientId:J.clientId,clientSecret:J.clientSecret},extraParams:{scope:K.join(" ")},tokenEndpoint:Y})},options:J}},eu=(J)=>{return{id:"naver",name:"Naver",createAuthorizationURL({state:W,scopes:X,redirectURI:G}){let Y=J.disableDefaultScope?[]:["profile","email"];if(J.scope)Y.push(...J.scope);if(X)Y.push(...X);return n6({id:"naver",options:J,authorizationEndpoint:"https://nid.naver.com/oauth2.0/authorize",scopes:Y,state:W,redirectURI:G})},validateAuthorizationCode:async({code:W,redirectURI:X})=>{return k6({code:W,redirectURI:X,options:J,tokenEndpoint:"https://nid.naver.com/oauth2.0/token"})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(W)=>{return b6({refreshToken:W,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},tokenEndpoint:"https://nid.naver.com/oauth2.0/token"})},async getUserInfo(W){if(J.getUserInfo)return J.getUserInfo(W);let{data:X,error:G}=await z6("https://openapi.naver.com/v1/nid/me",{headers:{Authorization:`Bearer ${W.accessToken}`}});if(G||!X||X.resultcode!=="00")return null;let Y=await J.mapProfileToUser?.(X),$=X.response||{};return{user:{id:$.id,name:$.name||$.nickname,email:$.email,image:$.profile_image,emailVerified:!1,...Y},data:X}},options:J}},Jl=(J)=>{return{id:"notion",name:"Notion",createAuthorizationURL({state:X,scopes:G,loginHint:Y,redirectURI:$}){let K=J.disableDefaultScope?[]:[];if(J.scope)K.push(...J.scope);if(G)K.push(...G);return n6({id:"notion",options:J,authorizationEndpoint:"https://api.notion.com/v1/oauth/authorize",scopes:K,state:X,redirectURI:$,loginHint:Y,additionalParams:{owner:"user"}})},validateAuthorizationCode:async({code:X,redirectURI:G})=>{return k6({code:X,redirectURI:G,options:J,tokenEndpoint:"https://api.notion.com/v1/oauth/token",authentication:"basic"})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(X)=>{return b6({refreshToken:X,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},tokenEndpoint:"https://api.notion.com/v1/oauth/token"})},async getUserInfo(X){if(J.getUserInfo)return J.getUserInfo(X);let{data:G,error:Y}=await z6("https://api.notion.com/v1/users/me",{headers:{Authorization:`Bearer ${X.accessToken}`,"Notion-Version":"2022-06-28"}});if(Y||!G)return null;let $=G.bot?.owner?.user;if(!$)return null;let K=await J.mapProfileToUser?.($);return{user:{id:$.id,name:$.name||"Notion User",email:$.person?.email||null,image:$.avatar_url,emailVerified:!!$.person?.email,...K},data:$}},options:J}},Wl=(J)=>{let W=J.issuer||"https://idp.paybin.io",X=`${W}/oauth2/authorize`,G=`${W}/oauth2/token`;return{id:"paybin",name:"Paybin",async createAuthorizationURL({state:Y,scopes:$,codeVerifier:K,redirectURI:w,loginHint:H}){if(!J.clientId||!J.clientSecret)throw G6.error("Client Id and Client Secret is required for Paybin. Make sure to provide them in the options."),new W6("CLIENT_ID_AND_SECRET_REQUIRED");if(!K)throw new W6("codeVerifier is required for Paybin");let Z=J.disableDefaultScope?[]:["openid","email","profile"];if(J.scope)Z.push(...J.scope);if($)Z.push(...$);return await n6({id:"paybin",options:J,authorizationEndpoint:X,scopes:Z,state:Y,codeVerifier:K,redirectURI:w,prompt:J.prompt,loginHint:H})},validateAuthorizationCode:async({code:Y,codeVerifier:$,redirectURI:K})=>{return k6({code:Y,codeVerifier:$,redirectURI:K,options:J,tokenEndpoint:G})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(Y)=>{return b6({refreshToken:Y,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},tokenEndpoint:G})},async getUserInfo(Y){if(J.getUserInfo)return J.getUserInfo(Y);if(!Y.idToken)return null;let $=$J(Y.idToken),K=await J.mapProfileToUser?.($);return{user:{id:$.sub,name:$.name||$.preferred_username||($.email?$.email.split("@")[0]:"User")||"User",email:$.email,image:$.picture,emailVerified:$.email_verified||!1,...K},data:$}},options:J}},Xl=(J)=>{let W=(J.environment||"sandbox")==="sandbox",X=W?"https://www.sandbox.paypal.com/signin/authorize":"https://www.paypal.com/signin/authorize",G=W?"https://api-m.sandbox.paypal.com/v1/oauth2/token":"https://api-m.paypal.com/v1/oauth2/token",Y=W?"https://api-m.sandbox.paypal.com/v1/identity/oauth2/userinfo":"https://api-m.paypal.com/v1/identity/oauth2/userinfo";return{id:"paypal",name:"PayPal",async createAuthorizationURL({state:$,codeVerifier:K,redirectURI:w}){if(!J.clientId||!J.clientSecret)throw G6.error("Client Id and Client Secret is required for PayPal. Make sure to provide them in the options."),new W6("CLIENT_ID_AND_SECRET_REQUIRED");return await n6({id:"paypal",options:J,authorizationEndpoint:X,scopes:[],state:$,codeVerifier:K,redirectURI:w,prompt:J.prompt})},validateAuthorizationCode:async({code:$,redirectURI:K})=>{let w=C4.encode(`${J.clientId}:${J.clientSecret}`);try{let H=await z6(G,{method:"POST",headers:{Authorization:`Basic ${w}`,Accept:"application/json","Accept-Language":"en_US","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"authorization_code",code:$,redirect_uri:K}).toString()});if(!H.data)throw new W6("FAILED_TO_GET_ACCESS_TOKEN");let Z=H.data;return{accessToken:Z.access_token,refreshToken:Z.refresh_token,accessTokenExpiresAt:Z.expires_in?new Date(Date.now()+Z.expires_in*1000):void 0,idToken:Z.id_token}}catch(H){throw G6.error("PayPal token exchange failed:",H),new W6("FAILED_TO_GET_ACCESS_TOKEN")}},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async($)=>{let K=C4.encode(`${J.clientId}:${J.clientSecret}`);try{let w=await z6(G,{method:"POST",headers:{Authorization:`Basic ${K}`,Accept:"application/json","Accept-Language":"en_US","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"refresh_token",refresh_token:$}).toString()});if(!w.data)throw new W6("FAILED_TO_REFRESH_ACCESS_TOKEN");let H=w.data;return{accessToken:H.access_token,refreshToken:H.refresh_token,accessTokenExpiresAt:H.expires_in?new Date(Date.now()+H.expires_in*1000):void 0}}catch(w){throw G6.error("PayPal token refresh failed:",w),new W6("FAILED_TO_REFRESH_ACCESS_TOKEN")}},async verifyIdToken($,K){if(J.disableIdTokenSignIn)return!1;if(J.verifyIdToken)return J.verifyIdToken($,K);try{return!!$J($).sub}catch(w){return G6.error("Failed to verify PayPal ID token:",w),!1}},async getUserInfo($){if(J.getUserInfo)return J.getUserInfo($);if(!$.accessToken)return G6.error("Access token is required to fetch PayPal user info"),null;try{let K=await z6(`${Y}?schema=paypalv1.1`,{headers:{Authorization:`Bearer ${$.accessToken}`,Accept:"application/json"}});if(!K.data)return G6.error("Failed to fetch user info from PayPal"),null;let w=K.data,H=await J.mapProfileToUser?.(w);return{user:{id:w.user_id,name:w.name,email:w.email,image:w.picture,emailVerified:w.email_verified,...H},data:w}}catch(K){return G6.error("Failed to fetch user info from PayPal:",K),null}},options:J}},Yl=(J)=>{return{id:"polar",name:"Polar",createAuthorizationURL({state:W,scopes:X,codeVerifier:G,redirectURI:Y}){let $=J.disableDefaultScope?[]:["openid","profile","email"];if(J.scope)$.push(...J.scope);if(X)$.push(...X);return n6({id:"polar",options:J,authorizationEndpoint:"https://polar.sh/oauth2/authorize",scopes:$,state:W,codeVerifier:G,redirectURI:Y,prompt:J.prompt})},validateAuthorizationCode:async({code:W,codeVerifier:X,redirectURI:G})=>{return k6({code:W,codeVerifier:X,redirectURI:G,options:J,tokenEndpoint:"https://api.polar.sh/v1/oauth2/token"})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(W)=>{return b6({refreshToken:W,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},tokenEndpoint:"https://api.polar.sh/v1/oauth2/token"})},async getUserInfo(W){if(J.getUserInfo)return J.getUserInfo(W);let{data:X,error:G}=await z6("https://api.polar.sh/v1/oauth2/userinfo",{headers:{Authorization:`Bearer ${W.accessToken}`}});if(G)return null;let Y=await J.mapProfileToUser?.(X);return{user:{id:X.id,name:X.public_name||X.username,email:X.email,image:X.avatar_url,emailVerified:X.email_verified??!1,...Y},data:X}},options:J}},Gl=(J)=>{return{id:"reddit",name:"Reddit",createAuthorizationURL({state:W,scopes:X,redirectURI:G}){let Y=J.disableDefaultScope?[]:["identity"];if(J.scope)Y.push(...J.scope);if(X)Y.push(...X);return n6({id:"reddit",options:J,authorizationEndpoint:"https://www.reddit.com/api/v1/authorize",scopes:Y,state:W,redirectURI:G,duration:J.duration})},validateAuthorizationCode:async({code:W,redirectURI:X})=>{let G=new URLSearchParams({grant_type:"authorization_code",code:W,redirect_uri:J.redirectURI||X}),{data:Y,error:$}=await z6("https://www.reddit.com/api/v1/access_token",{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded",accept:"text/plain","user-agent":"better-auth",Authorization:`Basic ${C4.encode(`${J.clientId}:${J.clientSecret}`)}`},body:G.toString()});if($)throw $;return OH(Y)},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(W)=>{return b6({refreshToken:W,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},authentication:"basic",tokenEndpoint:"https://www.reddit.com/api/v1/access_token"})},async getUserInfo(W){if(J.getUserInfo)return J.getUserInfo(W);let{data:X,error:G}=await z6("https://oauth.reddit.com/api/v1/me",{headers:{Authorization:`Bearer ${W.accessToken}`,"User-Agent":"better-auth"}});if(G)return null;let Y=await J.mapProfileToUser?.(X);return{user:{id:X.id,name:X.name,email:X.oauth_client_id,emailVerified:X.has_verified_email,image:X.icon_img?.split("?")[0],...Y},data:X}},options:J}},$l=(J)=>{return{id:"roblox",name:"Roblox",createAuthorizationURL({state:W,scopes:X,redirectURI:G}){let Y=J.disableDefaultScope?[]:["openid","profile"];if(J.scope)Y.push(...J.scope);if(X)Y.push(...X);return new URL(`https://apis.roblox.com/oauth/v1/authorize?scope=${Y.join("+")}&response_type=code&client_id=${J.clientId}&redirect_uri=${encodeURIComponent(J.redirectURI||G)}&state=${W}&prompt=${J.prompt||"select_account consent"}`)},validateAuthorizationCode:async({code:W,redirectURI:X})=>{return k6({code:W,redirectURI:J.redirectURI||X,options:J,tokenEndpoint:"https://apis.roblox.com/oauth/v1/token",authentication:"post"})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(W)=>{return b6({refreshToken:W,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},tokenEndpoint:"https://apis.roblox.com/oauth/v1/token"})},async getUserInfo(W){if(J.getUserInfo)return J.getUserInfo(W);let{data:X,error:G}=await z6("https://apis.roblox.com/oauth/v1/userinfo",{headers:{authorization:`Bearer ${W.accessToken}`}});if(G)return null;let Y=await J.mapProfileToUser?.(X);return{user:{id:X.sub,name:X.nickname||X.preferred_username||"",image:X.picture,email:X.preferred_username||null,emailVerified:!1,...Y},data:{...X}}},options:J}},Kl=(J)=>{let W=(J.environment??"production")==="sandbox",X=J.loginUrl?`https://${J.loginUrl}/services/oauth2/authorize`:W?"https://test.salesforce.com/services/oauth2/authorize":"https://login.salesforce.com/services/oauth2/authorize",G=J.loginUrl?`https://${J.loginUrl}/services/oauth2/token`:W?"https://test.salesforce.com/services/oauth2/token":"https://login.salesforce.com/services/oauth2/token",Y=J.loginUrl?`https://${J.loginUrl}/services/oauth2/userinfo`:W?"https://test.salesforce.com/services/oauth2/userinfo":"https://login.salesforce.com/services/oauth2/userinfo";return{id:"salesforce",name:"Salesforce",async createAuthorizationURL({state:$,scopes:K,codeVerifier:w,redirectURI:H}){if(!J.clientId||!J.clientSecret)throw G6.error("Client Id and Client Secret are required for Salesforce. Make sure to provide them in the options."),new W6("CLIENT_ID_AND_SECRET_REQUIRED");if(!w)throw new W6("codeVerifier is required for Salesforce");let Z=J.disableDefaultScope?[]:["openid","email","profile"];if(J.scope)Z.push(...J.scope);if(K)Z.push(...K);return n6({id:"salesforce",options:J,authorizationEndpoint:X,scopes:Z,state:$,codeVerifier:w,redirectURI:J.redirectURI||H})},validateAuthorizationCode:async({code:$,codeVerifier:K,redirectURI:w})=>{return k6({code:$,codeVerifier:K,redirectURI:J.redirectURI||w,options:J,tokenEndpoint:G})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async($)=>{return b6({refreshToken:$,options:{clientId:J.clientId,clientSecret:J.clientSecret},tokenEndpoint:G})},async getUserInfo($){if(J.getUserInfo)return J.getUserInfo($);try{let{data:K}=await z6(Y,{headers:{Authorization:`Bearer ${$.accessToken}`}});if(!K)return G6.error("Failed to fetch user info from Salesforce"),null;let w=await J.mapProfileToUser?.(K);return{user:{id:K.user_id,name:K.name,email:K.email,image:K.photos?.picture||K.photos?.thumbnail,emailVerified:K.email_verified??!1,...w},data:K}}catch(K){return G6.error("Failed to fetch user info from Salesforce:",K),null}},options:J}},wl=(J)=>{return{id:"slack",name:"Slack",createAuthorizationURL({state:W,scopes:X,redirectURI:G}){let Y=J.disableDefaultScope?[]:["openid","profile","email"];if(X)Y.push(...X);if(J.scope)Y.push(...J.scope);let $=new URL("https://slack.com/openid/connect/authorize");return $.searchParams.set("scope",Y.join(" ")),$.searchParams.set("response_type","code"),$.searchParams.set("client_id",J.clientId),$.searchParams.set("redirect_uri",J.redirectURI||G),$.searchParams.set("state",W),$},validateAuthorizationCode:async({code:W,redirectURI:X})=>{return k6({code:W,redirectURI:X,options:J,tokenEndpoint:"https://slack.com/api/openid.connect.token"})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(W)=>{return b6({refreshToken:W,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},tokenEndpoint:"https://slack.com/api/openid.connect.token"})},async getUserInfo(W){if(J.getUserInfo)return J.getUserInfo(W);let{data:X,error:G}=await z6("https://slack.com/api/openid.connect.userInfo",{headers:{authorization:`Bearer ${W.accessToken}`}});if(G)return null;let Y=await J.mapProfileToUser?.(X);return{user:{id:X["https://slack.com/user_id"],name:X.name||"",email:X.email,emailVerified:X.email_verified,image:X.picture||X["https://slack.com/user_image_512"],...Y},data:X}},options:J}},Hl=(J)=>{return{id:"spotify",name:"Spotify",createAuthorizationURL({state:W,scopes:X,codeVerifier:G,redirectURI:Y}){let $=J.disableDefaultScope?[]:["user-read-email"];if(J.scope)$.push(...J.scope);if(X)$.push(...X);return n6({id:"spotify",options:J,authorizationEndpoint:"https://accounts.spotify.com/authorize",scopes:$,state:W,codeVerifier:G,redirectURI:Y})},validateAuthorizationCode:async({code:W,codeVerifier:X,redirectURI:G})=>{return k6({code:W,codeVerifier:X,redirectURI:G,options:J,tokenEndpoint:"https://accounts.spotify.com/api/token"})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(W)=>{return b6({refreshToken:W,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},tokenEndpoint:"https://accounts.spotify.com/api/token"})},async getUserInfo(W){if(J.getUserInfo)return J.getUserInfo(W);let{data:X,error:G}=await z6("https://api.spotify.com/v1/me",{method:"GET",headers:{Authorization:`Bearer ${W.accessToken}`}});if(G)return null;let Y=await J.mapProfileToUser?.(X);return{user:{id:X.id,name:X.display_name,email:X.email,image:X.images[0]?.url,emailVerified:!1,...Y},data:X}},options:J}},Zl=(J)=>{return{id:"tiktok",name:"TikTok",createAuthorizationURL({state:W,scopes:X,redirectURI:G}){let Y=J.disableDefaultScope?[]:["user.info.profile"];if(J.scope)Y.push(...J.scope);if(X)Y.push(...X);return new URL(`https://www.tiktok.com/v2/auth/authorize?scope=${Y.join(",")}&response_type=code&client_key=${J.clientKey}&redirect_uri=${encodeURIComponent(J.redirectURI||G)}&state=${W}`)},validateAuthorizationCode:async({code:W,redirectURI:X})=>{return k6({code:W,redirectURI:J.redirectURI||X,options:{clientKey:J.clientKey,clientSecret:J.clientSecret},tokenEndpoint:"https://open.tiktokapis.com/v2/oauth/token/"})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(W)=>{return b6({refreshToken:W,options:{clientSecret:J.clientSecret},tokenEndpoint:"https://open.tiktokapis.com/v2/oauth/token/",authentication:"post",extraParams:{client_key:J.clientKey}})},async getUserInfo(W){if(J.getUserInfo)return J.getUserInfo(W);let{data:X,error:G}=await z6(`https://open.tiktokapis.com/v2/user/info/?fields=${["open_id","avatar_large_url","display_name","username"].join(",")}`,{headers:{authorization:`Bearer ${W.accessToken}`}});if(G)return null;return{user:{email:X.data.user.email||X.data.user.username,id:X.data.user.open_id,name:X.data.user.display_name||X.data.user.username,image:X.data.user.avatar_large_url,emailVerified:X.data.user.email?!0:!1},data:X}},options:J}},zl=(J)=>{return{id:"twitch",name:"Twitch",createAuthorizationURL({state:W,scopes:X,redirectURI:G}){let Y=J.disableDefaultScope?[]:["user:read:email","openid"];if(J.scope)Y.push(...J.scope);if(X)Y.push(...X);return n6({id:"twitch",redirectURI:G,options:J,authorizationEndpoint:"https://id.twitch.tv/oauth2/authorize",scopes:Y,state:W,claims:J.claims||["email","email_verified","preferred_username","picture"]})},validateAuthorizationCode:async({code:W,redirectURI:X})=>{return k6({code:W,redirectURI:X,options:J,tokenEndpoint:"https://id.twitch.tv/oauth2/token"})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(W)=>{return b6({refreshToken:W,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},tokenEndpoint:"https://id.twitch.tv/oauth2/token"})},async getUserInfo(W){if(J.getUserInfo)return J.getUserInfo(W);let X=W.idToken;if(!X)return G6.error("No idToken found in token"),null;let G=$J(X),Y=await J.mapProfileToUser?.(G);return{user:{id:G.sub,name:G.preferred_username,email:G.email,image:G.picture,emailVerified:G.email_verified,...Y},data:G}},options:J}},Fl=(J)=>{return{id:"twitter",name:"Twitter",createAuthorizationURL(W){let X=J.disableDefaultScope?[]:["users.read","tweet.read","offline.access","users.email"];if(J.scope)X.push(...J.scope);if(W.scopes)X.push(...W.scopes);return n6({id:"twitter",options:J,authorizationEndpoint:"https://x.com/i/oauth2/authorize",scopes:X,state:W.state,codeVerifier:W.codeVerifier,redirectURI:W.redirectURI})},validateAuthorizationCode:async({code:W,codeVerifier:X,redirectURI:G})=>{return k6({code:W,codeVerifier:X,authentication:"basic",redirectURI:G,options:J,tokenEndpoint:"https://api.x.com/2/oauth2/token"})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(W)=>{return b6({refreshToken:W,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},authentication:"basic",tokenEndpoint:"https://api.x.com/2/oauth2/token"})},async getUserInfo(W){if(J.getUserInfo)return J.getUserInfo(W);let{data:X,error:G}=await z6("https://api.x.com/2/users/me?user.fields=profile_image_url",{method:"GET",headers:{Authorization:`Bearer ${W.accessToken}`}});if(G)return null;let{data:Y,error:$}=await z6("https://api.x.com/2/users/me?user.fields=confirmed_email",{method:"GET",headers:{Authorization:`Bearer ${W.accessToken}`}}),K=!1;if(!$&&Y?.data?.confirmed_email)X.data.email=Y.data.confirmed_email,K=!0;let w=await J.mapProfileToUser?.(X);return{user:{id:X.data.id,name:X.data.name,email:X.data.email||X.data.username||null,image:X.data.profile_image_url,emailVerified:K,...w},data:X}},options:J}},Nl=(J)=>{return{id:"vk",name:"VK",async createAuthorizationURL({state:W,scopes:X,codeVerifier:G,redirectURI:Y}){let $=J.disableDefaultScope?[]:["email","phone"];if(J.scope)$.push(...J.scope);if(X)$.push(...X);return n6({id:"vk",options:J,authorizationEndpoint:"https://id.vk.com/authorize",scopes:$,state:W,redirectURI:Y,codeVerifier:G})},validateAuthorizationCode:async({code:W,codeVerifier:X,redirectURI:G,deviceId:Y})=>{return k6({code:W,codeVerifier:X,redirectURI:J.redirectURI||G,options:J,deviceId:Y,tokenEndpoint:"https://id.vk.com/oauth2/auth"})},refreshAccessToken:J.refreshAccessToken?J.refreshAccessToken:async(W)=>{return b6({refreshToken:W,options:{clientId:J.clientId,clientKey:J.clientKey,clientSecret:J.clientSecret},tokenEndpoint:"https://id.vk.com/oauth2/auth"})},async getUserInfo(W){if(J.getUserInfo)return J.getUserInfo(W);if(!W.accessToken)return null;let X=new URLSearchParams({access_token:W.accessToken,client_id:J.clientId}).toString(),{data:G,error:Y}=await z6("https://id.vk.com/oauth2/user_info",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:X});if(Y)return null;let $=await J.mapProfileToUser?.(G);if(!G.user.email&&!$?.email)return null;return{user:{id:G.user.user_id,first_name:G.user.first_name,last_name:G.user.last_name,email:G.user.email,image:G.user.avatar,emailVerified:!!G.user.email,birthday:G.user.birthday,sex:G.user.sex,name:`${G.user.first_name} ${G.user.last_name}`,...$},data:G}},options:J}},Ul=(J)=>{let W={pkce:!0,...J};return{id:"zoom",name:"Zoom",createAuthorizationURL:async({state:X,redirectURI:G,codeVerifier:Y})=>{let $=new URLSearchParams({response_type:"code",redirect_uri:W.redirectURI?W.redirectURI:G,client_id:W.clientId,state:X});if(W.pkce){let w=await PH(Y);$.set("code_challenge_method","S256"),$.set("code_challenge",w)}let K=new URL("https://zoom.us/oauth/authorize");return K.search=$.toString(),K},validateAuthorizationCode:async({code:X,redirectURI:G,codeVerifier:Y})=>{return k6({code:X,redirectURI:W.redirectURI||G,codeVerifier:Y,options:W,tokenEndpoint:"https://zoom.us/oauth/token",authentication:"post"})},refreshAccessToken:W.refreshAccessToken?W.refreshAccessToken:async(X)=>b6({refreshToken:X,options:{clientId:W.clientId,clientKey:W.clientKey,clientSecret:W.clientSecret},tokenEndpoint:"https://zoom.us/oauth/token"}),async getUserInfo(X){if(W.getUserInfo)return W.getUserInfo(X);let{data:G,error:Y}=await z6("https://api.zoom.us/v2/users/me",{headers:{authorization:`Bearer ${X.accessToken}`}});if(Y)return null;let $=await W.mapProfileToUser?.(G);return{user:{id:G.id,name:G.display_name,image:G.pic_url,email:G.email,emailVerified:Boolean(G.verified),...$},data:{...G}}}}},aD={apple:bu,atlassian:hu,cognito:fu,discord:mu,facebook:xu,figma:uu,github:lu,microsoft:su,google:du,huggingface:nu,slack:wl,spotify:Hl,twitch:zl,twitter:Fl,dropbox:yu,kick:iu,linear:tu,linkedin:ou,gitlab:pu,tiktok:Zl,reddit:Gl,roblox:$l,salesforce:Kl,vk:Nl,zoom:Ul,notion:Jl,kakao:ru,naver:eu,line:au,paybin:Wl,paypal:Xl,polar:Yl},Ql=Object.keys(aD),tD=H4(Ql).or(P());function oD(J){if(J===null||typeof J!=="object")return!1;let W=Object.getPrototypeOf(J);if(W!==null&&W!==Object.prototype&&Object.getPrototypeOf(W)!==null)return!1;if(Symbol.iterator in J)return!1;if(Symbol.toStringTag in J)return Object.prototype.toString.call(J)==="[object Module]";return!0}function sD(J,W,X=".",G){if(!oD(W))return sD(J,{},X,G);let Y=Object.assign({},W);for(let $ in J){if($==="__proto__"||$==="constructor")continue;let K=J[$];if(K===null||K===void 0)continue;if(G&&G(Y,$,K,X))continue;if(Array.isArray(K)&&Array.isArray(Y[$]))Y[$]=[...K,...Y[$]];else if(oD(K)&&oD(Y[$]))Y[$]=sD(K,Y[$],(X?`${X}.`:"")+$.toString(),G);else Y[$]=K}return Y}function k$(J){return(...W)=>W.reduce((X,G)=>sD(X,G,"",J),{})}var jH=k$(),bV6=k$((J,W,X)=>{if(J[W]!==void 0&&typeof X==="function")return J[W]=X(J[W]),!0}),kV6=k$((J,W,X)=>{if(Array.isArray(J[W])&&typeof X==="function")return J[W]=X(J[W]),!0});y6();function eD(J){if(J==="-"||J==="^"||J==="$"||J==="+"||J==="."||J==="("||J===")"||J==="|"||J==="["||J==="]"||J==="{"||J==="}"||J==="*"||J==="?"||J==="\\")return`\\${J}`;else return J}function Ll(J){let W="";for(let X=0;X<J.length;X++)W+=eD(J[X]);return W}function CA(J,W=!0){if(Array.isArray(J))return`(?:${J.map((Z)=>`^${CA(Z,W)}$`).join("|")})`;let X="",G="",Y=".";if(W===!0)X="/",G="[/\\\\]",Y="[^/\\\\]";else if(W)if(X=W,G=Ll(X),G.length>1)G=`(?:${G})`,Y=`((?!${G}).)`;else Y=`[^${G}]`;let $=W?`${G}+?`:"",K=W?`${G}*?`:"",w=W?J.split(X):[J],H="";for(let Z=0;Z<w.length;Z++){let z=w[Z],N=w[Z+1],F="";if(!z&&Z>0)continue;if(W)if(Z===w.length-1)F=K;else if(N!=="**")F=$;else F="";if(W&&z==="**"){if(F)H+=Z===0?"":F,H+=`(?:${Y}*?${F})*?`;continue}for(let Q=0;Q<z.length;Q++){let V=z[Q];if(V==="\\"){if(Q<z.length-1)H+=eD(z[Q+1]),Q++}else if(V==="?")H+=Y;else if(V==="*")H+=`${Y}*?`;else H+=eD(V)}H+=F}return H}function Vl(J,W){if(typeof W!=="string")throw TypeError(`Sample must be a string, but ${typeof W} given`);return J.test(W)}function h$(J,W){if(typeof J!=="string"&&!Array.isArray(J))throw TypeError(`The first argument must be a single pattern string or an array of patterns, but ${typeof J} given`);if(typeof W==="string"||typeof W==="boolean")W={separator:W};if(arguments.length===2&&!(typeof W>"u"||typeof W==="object"&&W!==null&&!Array.isArray(W)))throw TypeError(`The second argument must be an options object or a string/boolean separator, but ${typeof W} given`);if(W=W||{},W.separator==="\\")throw Error("\\ is not a valid separator because it is used for escaping. Try setting the separator to `true` instead");let X=CA(J,W.separator),G=new RegExp(`^${X}$`,W.flags),Y=Vl.bind(null,G);return Y.options=W,Y.pattern=J,Y.regexp=G,Y}var Dl=x6(async(J)=>{if(J.request?.method==="GET"||J.request?.method==="OPTIONS"||J.request?.method==="HEAD"||!J.request)return;let W=J.request?.headers,X=J.request,{body:G,query:Y,context:$}=J,K=W?.get("origin")||W?.get("referer")||"",w=G?.callbackURL||Y?.callbackURL,H=G?.redirectTo,Z=G?.errorCallbackURL,z=G?.newUserCallbackURL,N=Array.isArray($.options.trustedOrigins)?$.trustedOrigins:[...$.trustedOrigins,...await $.options.trustedOrigins?.(X)||[]],F=W?.has("cookie"),Q=(v,M)=>{if(v.startsWith("/"))return!1;if(M.includes("*")){if(M.includes("://"))return h$(M)(hJ(v)||v);let S=xD(v);if(!S)return!1;return h$(M)(S)}let O=yD(v);return O==="http:"||O==="https:"||!O?M===hJ(v):v.startsWith(M)},V=(v,M)=>{if(!v)return;if(!N.some((O)=>Q(v,O)||v?.startsWith("/")&&M!=="origin"&&/^\/(?!\/|\\|%2f|%5c)[\w\-.\+/@]*(?:\?[\w\-.\+/=&%@]*)?$/.test(v)))throw J.context.logger.error(`Invalid ${M}: ${v}`),J.context.logger.info(`If it's a valid URL, please add ${v} to trustedOrigins in your auth config
`,`Current list of trustedOrigins: ${N}`),new L("FORBIDDEN",{message:`Invalid ${M}`})};if(F&&!J.context.skipCSRFCheck&&!J.context.skipOriginCheck){if(!K||K==="null")throw new L("FORBIDDEN",{message:"Missing or null Origin"});V(K,"origin")}w&&V(w,"callbackURL"),H&&V(H,"redirectURL"),Z&&V(Z,"errorCallbackURL"),z&&V(z,"newUserCallbackURL")}),f$=(J)=>x6(async(W)=>{if(!W.request)return;let{context:X}=W,G=J(W),Y=Array.isArray(X.options.trustedOrigins)?X.trustedOrigins:[...X.trustedOrigins,...await X.options.trustedOrigins?.(W.request)||[]],$=(H,Z)=>{if(H.startsWith("/"))return!1;if(Z.includes("*")){if(Z.includes("://"))return h$(Z)(hJ(H)||H);let N=xD(H);if(!N)return!1;return h$(Z)(N)}let z=yD(H);return z==="http:"||z==="https:"||!z?Z===hJ(H):H.startsWith(Z)},K=(H,Z)=>{if(!H)return;if(!Y.some((z)=>$(H,z)||H?.startsWith("/")&&Z!=="origin"&&/^\/(?!\/|\\|%2f|%5c)[\w\-.\+/@]*(?:\?[\w\-.\+/=&%@]*)?$/.test(H)))throw W.context.logger.error(`Invalid ${Z}: ${H}`),W.context.logger.info(`If it's a valid URL, please add ${H} to trustedOrigins in your auth config
`,`Current list of trustedOrigins: ${Y}`),new L("FORBIDDEN",{message:`Invalid ${Z}`})},w=Array.isArray(G)?G:[G];for(let H of w)K(H,"callbackURL")});function vl(J,W,X){let G=Date.now(),Y=W*1000;return G-X.lastRequest<Y&&X.count>=J}function Ml(J){return new Response(JSON.stringify({message:"Too many requests. Please try again later."}),{status:429,statusText:"Too Many Requests",headers:{"X-Retry-After":J.toString()}})}function Ol(J,W){let X=Date.now(),G=W*1000;return Math.ceil((J+G-X)/1000)}function Pl(J){let X=J.adapter;return{get:async(G)=>{let Y=(await X.findMany({model:"rateLimit",where:[{field:"key",value:G}]}))[0];if(typeof Y?.lastRequest==="bigint")Y.lastRequest=Number(Y.lastRequest);return Y},set:async(G,Y,$)=>{try{if($)await X.updateMany({model:"rateLimit",where:[{field:"key",value:G}],update:{count:Y.count,lastRequest:Y.lastRequest}});else await X.create({model:"rateLimit",data:{key:G,count:Y.count,lastRequest:Y.lastRequest}})}catch(K){J.logger.error("Error setting rate limit",K)}}}}var BA=new Map;function jl(J,W){if(J.options.rateLimit?.customStorage)return J.options.rateLimit.customStorage;let X=J.rateLimit.storage;if(X==="secondary-storage")return{get:async(G)=>{let Y=await J.options.secondaryStorage?.get(G);return Y?l6(Y):void 0},set:async(G,Y,$)=>{let K=W?.window??J.options.rateLimit?.window??10;await J.options.secondaryStorage?.set?.(G,JSON.stringify(Y),K)}};else if(X==="memory")return{async get(G){return BA.get(G)},async set(G,Y,$){BA.set(G,Y)}};return Pl(J)}async function AA(J,W){if(!W.rateLimit.enabled)return;let X=new URL(J.url).pathname.replace(W.options.basePath||"/api/auth",""),G=W.rateLimit.window,Y=W.rateLimit.max,$=iX(J,W.options);if(!$)return;let K=$+X,w=_l().find((N)=>N.pathMatcher(X));if(w)G=w.window,Y=w.max;for(let N of W.options.plugins||[])if(N.rateLimit){let F=N.rateLimit.find((Q)=>Q.pathMatcher(X));if(F){G=F.window,Y=F.max;break}}if(W.rateLimit.customRules){let N=Object.keys(W.rateLimit.customRules).find((F)=>{if(F.includes("*"))return h$(F)(X);return F===X});if(N){let F=W.rateLimit.customRules[N],Q=typeof F==="function"?await F(J):F;if(Q)G=Q.window,Y=Q.max;if(Q===!1)return}}let H=jl(W,{window:G}),Z=await H.get(K),z=Date.now();if(!Z)await H.set(K,{key:K,count:1,lastRequest:z});else{let N=z-Z.lastRequest;if(vl(Y,G,Z))return Ml(Ol(Z.lastRequest,G));else if(N>G*1000)await H.set(K,{...Z,count:1,lastRequest:z},!0);else await H.set(K,{...Z,count:Z.count+1,lastRequest:z},!0)}}function _l(){return[{pathMatcher(J){return J.startsWith("/sign-in")||J.startsWith("/sign-up")||J.startsWith("/change-password")||J.startsWith("/change-email")},window:10,max:3}]}function Jv(J,W){if(!J)return J;if(W.options.account?.encryptOAuthTokens)return WJ({key:W.secret,data:J});return J}function S0(J,W){if(W.options.account?.encryptOAuthTokens&&J)return JJ({key:W.secret,data:J});return J}var Sl=y("/list-accounts",{method:"GET",use:[k4],metadata:{openapi:{operationId:"listUserAccounts",description:"List all accounts linked to the user",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"array",items:{type:"object",properties:{id:{type:"string"},providerId:{type:"string"},createdAt:{type:"string",format:"date-time"},updatedAt:{type:"string",format:"date-time"},accountId:{type:"string"},userId:{type:"string"},scopes:{type:"array",items:{type:"string"}}},required:["id","providerId","createdAt","updatedAt","accountId","userId","scopes"]}}}}}}}}},async(J)=>{let W=J.context.session,X=await J.context.internalAdapter.findAccounts(W.user.id);return J.json(X.map((G)=>({id:G.id,providerId:G.providerId,createdAt:G.createdAt,updatedAt:G.updatedAt,accountId:G.accountId,userId:G.userId,scopes:G.scope?.split(",")||[]})))}),Tl=y("/link-social",{method:"POST",requireHeaders:!0,body:x({callbackURL:P().meta({description:"The URL to redirect to after the user has signed in"}).optional(),provider:tD,idToken:x({token:P(),nonce:P().optional(),accessToken:P().optional(),refreshToken:P().optional(),scopes:v6(P()).optional()}).optional(),requestSignUp:d6().optional(),scopes:v6(P()).meta({description:"Additional scopes to request from the provider"}).optional(),errorCallbackURL:P().meta({description:"The URL to redirect to if there is an error during the link process"}).optional(),disableRedirect:d6().meta({description:"Disable automatic redirection to the provider. Useful for handling the redirection yourself"}).optional(),additionalData:_6(P(),E6()).optional()}),use:[k4],metadata:{openapi:{description:"Link a social account to the user",operationId:"linkSocialAccount",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{url:{type:"string",description:"The authorization URL to redirect the user to"},redirect:{type:"boolean",description:"Indicates if the user should be redirected to the authorization URL"},status:{type:"boolean"}},required:["redirect"]}}}}}}}},async(J)=>{let W=J.context.session,X=J.context.socialProviders.find(($)=>$.id===J.body.provider);if(!X)throw J.context.logger.error("Provider not found. Make sure to add the provider in your auth config",{provider:J.body.provider}),new L("NOT_FOUND",{message:o.PROVIDER_NOT_FOUND});if(J.body.idToken){if(!X.verifyIdToken)throw J.context.logger.error("Provider does not support id token verification",{provider:J.body.provider}),new L("NOT_FOUND",{message:o.ID_TOKEN_NOT_SUPPORTED});let{token:$,nonce:K}=J.body.idToken;if(!await X.verifyIdToken($,K))throw J.context.logger.error("Invalid id token",{provider:J.body.provider}),new L("UNAUTHORIZED",{message:o.INVALID_TOKEN});let w=await X.getUserInfo({idToken:$,accessToken:J.body.idToken.accessToken,refreshToken:J.body.idToken.refreshToken});if(!w||!w?.user)throw J.context.logger.error("Failed to get user info",{provider:J.body.provider}),new L("UNAUTHORIZED",{message:o.FAILED_TO_GET_USER_INFO});let H=String(w.user.id);if(!w.user.email)throw J.context.logger.error("User email not found",{provider:J.body.provider}),new L("UNAUTHORIZED",{message:o.USER_EMAIL_NOT_FOUND});if((await J.context.internalAdapter.findAccounts(W.user.id)).find((Z)=>Z.providerId===X.id&&Z.accountId===H))return J.json({url:"",status:!0,redirect:!1});if(!J.context.options.account?.accountLinking?.trustedProviders?.includes(X.id)&&!w.user.emailVerified||J.context.options.account?.accountLinking?.enabled===!1)throw new L("UNAUTHORIZED",{message:"Account not linked - linking not allowed"});if(w.user.email!==W.user.email&&J.context.options.account?.accountLinking?.allowDifferentEmails!==!0)throw new L("UNAUTHORIZED",{message:"Account not linked - different emails not allowed"});try{await J.context.internalAdapter.createAccount({userId:W.user.id,providerId:X.id,accountId:H,accessToken:J.body.idToken.accessToken,idToken:$,refreshToken:J.body.idToken.refreshToken,scope:J.body.idToken.scopes?.join(",")})}catch(Z){throw new L("EXPECTATION_FAILED",{message:"Account not linked - unable to create account"})}if(J.context.options.account?.accountLinking?.updateUserInfoOnLink===!0)try{await J.context.internalAdapter.updateUser(W.user.id,{name:w.user?.name,image:w.user?.image})}catch(Z){console.warn("Could not update user - "+Z.toString())}return J.json({url:"",status:!0,redirect:!1})}let G=await z$(J,{userId:W.user.id,email:W.user.email},J.body.additionalData),Y=await X.createAuthorizationURL({state:G.state,codeVerifier:G.codeVerifier,redirectURI:`${J.context.baseURL}/callback/${X.id}`,scopes:J.body.scopes});return J.json({url:Y.toString(),redirect:!J.body.disableRedirect})}),ql=y("/unlink-account",{method:"POST",body:x({providerId:P(),accountId:P().optional()}),use:[UA],metadata:{openapi:{description:"Unlink an account",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean"}}}}}}}}}},async(J)=>{let{providerId:W,accountId:X}=J.body,G=await J.context.internalAdapter.findAccounts(J.context.session.user.id);if(G.length===1&&!J.context.options.account?.accountLinking?.allowUnlinkingAll)throw new L("BAD_REQUEST",{message:o.FAILED_TO_UNLINK_LAST_ACCOUNT});let Y=G.find(($)=>X?$.accountId===X&&$.providerId===W:$.providerId===W);if(!Y)throw new L("BAD_REQUEST",{message:o.ACCOUNT_NOT_FOUND});return await J.context.internalAdapter.deleteAccount(Y.id),J.json({status:!0})}),IA=y("/get-access-token",{method:"POST",body:x({providerId:P().meta({description:"The provider ID for the OAuth provider"}),accountId:P().meta({description:"The account ID associated with the refresh token"}).optional(),userId:P().meta({description:"The user ID associated with the account"}).optional()}),metadata:{openapi:{description:"Get a valid access token, doing a refresh if needed",responses:{200:{description:"A Valid access token",content:{"application/json":{schema:{type:"object",properties:{tokenType:{type:"string"},idToken:{type:"string"},accessToken:{type:"string"},refreshToken:{type:"string"},accessTokenExpiresAt:{type:"string",format:"date-time"},refreshTokenExpiresAt:{type:"string",format:"date-time"}}}}}},400:{description:"Invalid refresh token or provider configuration"}}}}},async(J)=>{let{providerId:W,accountId:X,userId:G}=J.body||{},Y=J.request,$=await P6(J);if(Y&&!$)throw J.error("UNAUTHORIZED");let K=$?.user?.id||G;if(!K)throw J.error("UNAUTHORIZED");if(!J.context.socialProviders.find((F)=>F.id===W))throw new L("BAD_REQUEST",{message:`Provider ${W} is not supported.`});let w=J.context.authCookies.accountData.name,H=await J.getSignedCookie(w,J.context.secret),Z=H?l6(H):null,z=void 0;if(Z&&W===Z.providerId&&(!X||Z.id===X))z=Z;else z=(await J.context.internalAdapter.findAccounts(K)).find((F)=>X?F.id===X&&F.providerId===W:F.providerId===W);if(!z)throw new L("BAD_REQUEST",{message:"Account not found"});let N=J.context.socialProviders.find((F)=>F.id===W);if(!N)throw new L("BAD_REQUEST",{message:`Provider ${W} not found.`});try{let F=null,Q=z.accessTokenExpiresAt&&new Date(z.accessTokenExpiresAt).getTime()-Date.now()<5000;if(z.refreshToken&&Q&&N.refreshAccessToken){let v=await Jv(z.refreshToken,J.context);F=await N.refreshAccessToken(v);let M=await J.context.internalAdapter.updateAccount(z.id,{accessToken:await S0(F.accessToken,J.context),accessTokenExpiresAt:F.accessTokenExpiresAt,refreshToken:await S0(F.refreshToken,J.context),refreshTokenExpiresAt:F.refreshTokenExpiresAt});if(J.context.options.account?.storeAccountCookie&&M)await J.setSignedCookie(w,JSON.stringify(M),J.context.secret,J.context.authCookies.accountData.options)}let V={accessToken:F?.accessToken??await Jv(z.accessToken??"",J.context),accessTokenExpiresAt:F?.accessTokenExpiresAt??z.accessTokenExpiresAt??void 0,scopes:z.scope?.split(",")??[],idToken:F?.idToken??z.idToken??void 0};return J.json(V)}catch(F){throw new L("BAD_REQUEST",{message:"Failed to get a valid access token",cause:F})}}),Bl=y("/refresh-token",{method:"POST",body:x({providerId:P().meta({description:"The provider ID for the OAuth provider"}),accountId:P().meta({description:"The account ID associated with the refresh token"}).optional(),userId:P().meta({description:"The user ID associated with the account"}).optional()}),metadata:{openapi:{description:"Refresh the access token using a refresh token",responses:{200:{description:"Access token refreshed successfully",content:{"application/json":{schema:{type:"object",properties:{tokenType:{type:"string"},idToken:{type:"string"},accessToken:{type:"string"},refreshToken:{type:"string"},accessTokenExpiresAt:{type:"string",format:"date-time"},refreshTokenExpiresAt:{type:"string",format:"date-time"}}}}}},400:{description:"Invalid refresh token or provider configuration"}}}}},async(J)=>{let{providerId:W,accountId:X,userId:G}=J.body,Y=J.request,$=await P6(J);if(Y&&!$)throw J.error("UNAUTHORIZED");let K=$?.user?.id||G;if(!K)throw new L("BAD_REQUEST",{message:"Either userId or session is required"});let w=J.context.socialProviders.find((Q)=>Q.id===W);if(!w)throw new L("BAD_REQUEST",{message:`Provider ${W} not found.`});if(!w.refreshAccessToken)throw new L("BAD_REQUEST",{message:`Provider ${W} does not support token refreshing.`});let H=J.context.authCookies.accountData.name,Z=await J.getSignedCookie(H,J.context.secret),z=void 0,N=Z?l6(Z):null;if(N&&(!W||W===N?.providerId))z=N;else z=(await J.context.internalAdapter.findAccounts(K)).find((Q)=>X?Q.id===X&&Q.providerId===W:Q.providerId===W);if(!z)throw new L("BAD_REQUEST",{message:"Account not found"});let F=void 0;if(N&&W===N.providerId)F=N.refreshToken??void 0;else F=z.refreshToken??void 0;if(!F)throw new L("BAD_REQUEST",{message:"Refresh token not found"});try{let Q=await Jv(F,J.context),V=await w.refreshAccessToken(Q);if(z.id){let v={...z||{},accessToken:await S0(V.accessToken,J.context),refreshToken:await S0(V.refreshToken,J.context),accessTokenExpiresAt:V.accessTokenExpiresAt,refreshTokenExpiresAt:V.refreshTokenExpiresAt,scope:V.scopes?.join(",")||z.scope,idToken:V.idToken||z.idToken};await J.context.internalAdapter.updateAccount(z.id,v)}if(N&&W===N.providerId&&J.context.options.account?.storeAccountCookie){let v={...N,accessToken:await S0(V.accessToken,J.context),refreshToken:await S0(V.refreshToken,J.context),accessTokenExpiresAt:V.accessTokenExpiresAt,refreshTokenExpiresAt:V.refreshTokenExpiresAt,scope:V.scopes?.join(",")||N.scope,idToken:V.idToken||N.idToken};await J.setSignedCookie(H,JSON.stringify(v),J.context.secret,J.context.authCookies.accountData.options)}return J.json({accessToken:V.accessToken,refreshToken:V.refreshToken,accessTokenExpiresAt:V.accessTokenExpiresAt,refreshTokenExpiresAt:V.refreshTokenExpiresAt,scope:V.scopes?.join(",")||z.scope,idToken:V.idToken||z.idToken,providerId:z.providerId,accountId:z.accountId})}catch(Q){throw new L("BAD_REQUEST",{message:"Failed to refresh access token",cause:Q})}}),Al=M0(x({accountId:P().meta({description:"The provider given account id for which to get the account info"}).optional()})),El=y("/account-info",{method:"GET",use:[k4],metadata:{openapi:{description:"Get the account info provided by the provider",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{user:{type:"object",properties:{id:{type:"string"},name:{type:"string"},email:{type:"string"},image:{type:"string"},emailVerified:{type:"boolean"}},required:["id","emailVerified"]},data:{type:"object",properties:{},additionalProperties:!0}},required:["user","data"],additionalProperties:!1}}}}}}},query:Al},async(J)=>{let W=J.query?.accountId,X=void 0;if(!W){if(J.context.options.account?.storeAccountCookie){let K=J.context.authCookies.accountData.name,w=await J.getSignedCookie(K,J.context.secret);if(w){let H=l6(w);if(H)X=H}}}else{let K=await J.context.internalAdapter.findAccount(W);if(K)X=K}if(!X||X.userId!==J.context.session.user.id)throw new L("BAD_REQUEST",{message:"Account not found"});let G=J.context.socialProviders.find((K)=>K.id===X.providerId);if(!G)throw new L("INTERNAL_SERVER_ERROR",{message:`Provider account provider is ${X.providerId} but it is not configured`});let Y=await IA({...J,method:"POST",body:{accountId:X.id,providerId:X.providerId},returnHeaders:!1,returnStatus:!1});if(!Y.accessToken)throw new L("BAD_REQUEST",{message:"Access token not found"});let $=await G.getUserInfo({...Y,accessToken:Y.accessToken});return J.json($)});async function Wv(J,{userInfo:W,account:X,callbackURL:G,disableSignUp:Y,overrideUserInfo:$}){let K=await J.context.internalAdapter.findOAuthUser(W.email.toLowerCase(),X.accountId,X.providerId).catch((z)=>{G6.error(`Better auth was unable to query your database.
Error: `,z);let N=J.context.options.onAPIError?.errorURL||`${J.context.baseURL}/error`;throw J.redirect(`${N}?error=internal_server_error`)}),w=K?.user,H=!w;if(K){let z=K.accounts.find((N)=>N.providerId===X.providerId&&N.accountId===X.accountId);if(!z){if(!J.context.options.account?.accountLinking?.trustedProviders?.includes(X.providerId)&&!W.emailVerified||J.context.options.account?.accountLinking?.enabled===!1){if(tY())G6.warn(`User already exist but account isn't linked to ${X.providerId}. To read more about how account linking works in Better Auth see https://www.better-auth.com/docs/concepts/users-accounts#account-linking.`);return{error:"account not linked",data:null}}try{await J.context.internalAdapter.linkAccount({providerId:X.providerId,accountId:W.id.toString(),userId:K.user.id,accessToken:await S0(X.accessToken,J.context),refreshToken:await S0(X.refreshToken,J.context),idToken:X.idToken,accessTokenExpiresAt:X.accessTokenExpiresAt,refreshTokenExpiresAt:X.refreshTokenExpiresAt,scope:X.scope})}catch(N){return G6.error("Unable to link account",N),{error:"unable to link account",data:null}}if(W.emailVerified&&!K.user.emailVerified&&W.email.toLowerCase()===K.user.email)await J.context.internalAdapter.updateUser(K.user.id,{emailVerified:!0})}else{if(J.context.options.account?.updateAccountOnSignIn!==!1){let N=Object.fromEntries(Object.entries({idToken:X.idToken,accessToken:await S0(X.accessToken,J.context),refreshToken:await S0(X.refreshToken,J.context),accessTokenExpiresAt:X.accessTokenExpiresAt,refreshTokenExpiresAt:X.refreshTokenExpiresAt,scope:X.scope}).filter(([F,Q])=>Q!==void 0));if(J.context.options.account?.storeAccountCookie){let F=J.context.authCookies.accountData;await J.setSignedCookie(F.name,JSON.stringify(N),J.context.secret,F.options)}if(Object.keys(N).length>0)await J.context.internalAdapter.updateAccount(z.id,N)}if(W.emailVerified&&!K.user.emailVerified&&W.email.toLowerCase()===K.user.email)await J.context.internalAdapter.updateUser(K.user.id,{emailVerified:!0})}if($){let{id:N,...F}=W;w=await J.context.internalAdapter.updateUser(K.user.id,{...F,email:W.email.toLowerCase(),emailVerified:W.email.toLowerCase()===K.user.email?K.user.emailVerified||W.emailVerified:W.emailVerified})}}else{if(Y)return{error:"signup disabled",data:null,isRegister:!1};try{let{id:z,...N}=W,F={accessToken:await S0(X.accessToken,J.context),refreshToken:await S0(X.refreshToken,J.context),idToken:X.idToken,accessTokenExpiresAt:X.accessTokenExpiresAt,refreshTokenExpiresAt:X.refreshTokenExpiresAt,scope:X.scope,providerId:X.providerId,accountId:W.id.toString()},{user:Q,account:V}=await J.context.internalAdapter.createOAuthUser({...N,email:W.email.toLowerCase()},F);if(w=Q,J.context.options.account?.storeAccountCookie){let v=J.context.authCookies.accountData;await J.setSignedCookie(v.name,JSON.stringify(V),J.context.secret,v.options)}if(!W.emailVerified&&w&&J.context.options.emailVerification?.sendOnSignUp){let v=await wJ(J.context.secret,w.email,void 0,J.context.options.emailVerification?.expiresIn),M=`${J.context.baseURL}/verify-email?token=${v}&callbackURL=${G}`;await J.context.options.emailVerification?.sendVerificationEmail?.({user:w,url:M,token:v},J.request)}}catch(z){if(G6.error(z),z instanceof L)return{error:z.message,data:null,isRegister:!1};return{error:"unable to create user",data:null,isRegister:!1}}}if(!w)return{error:"unable to create user",data:null,isRegister:!1};let Z=await J.context.internalAdapter.createSession(w.id);if(!Z)return{error:"unable to create session",data:null,isRegister:!1};return{data:{session:Z,user:w},error:null,isRegister:H}}var $1=x({code:P().optional(),error:P().optional(),device_id:P().optional(),error_description:P().optional(),state:P().optional(),user:P().optional()}),Rl=y("/callback/:id",{method:["GET","POST"],operationId:"handleOAuthCallback",body:$1.optional(),query:$1.optional(),metadata:{...aY,allowedMediaTypes:["application/x-www-form-urlencoded","application/json"]}},async(J)=>{let W,X=J.context.options.onAPIError?.errorURL||`${J.context.baseURL}/error`;if(J.method==="POST"){let B=J.body?$1.parse(J.body):{},A=J.query?$1.parse(J.query):{},E=$1.parse({...B,...A}),R=new URLSearchParams;for(let[u,b]of Object.entries(E))if(b!==void 0&&b!==null)R.set(u,String(b));let g=`${J.context.baseURL}/callback/${J.params.id}?${R.toString()}`;throw J.redirect(g)}try{if(J.method==="GET")W=$1.parse(J.query);else if(J.method==="POST")W=$1.parse(J.body);else throw Error("Unsupported method")}catch(B){throw J.context.logger.error("INVALID_CALLBACK_REQUEST",B),J.redirect(`${X}?error=invalid_callback_request`)}let{code:G,error:Y,state:$,error_description:K,device_id:w}=W;if(!$){J.context.logger.error("State not found",Y);let B=`${X}${X.includes("?")?"&":"?"}state=state_not_found`;throw J.redirect(B)}let{codeVerifier:H,callbackURL:Z,link:z,errorURL:N,newUserURL:F,requestSignUp:Q}=await x7(J);function V(B,A){let E=N??X,R=new URLSearchParams({error:B});if(A)R.set("error_description",A);let g=`${E}${E.includes("?")?"&":"?"}${R.toString()}`;throw J.redirect(g)}if(Y)V(Y,K);if(!G)throw J.context.logger.error("Code not found"),V("no_code");let v=J.context.socialProviders.find((B)=>B.id===J.params.id);if(!v)throw J.context.logger.error("Oauth provider with id",J.params.id,"not found"),V("oauth_provider_not_found");let M;try{M=await v.validateAuthorizationCode({code:G,codeVerifier:H,deviceId:w,redirectURI:`${J.context.baseURL}/callback/${v.id}`})}catch(B){throw J.context.logger.error("",B),V("invalid_code")}let O=await v.getUserInfo({...M,user:J.body?.user?l6(J.body.user):void 0}).then((B)=>B?.user);if(!O)return J.context.logger.error("Unable to get user info"),V("unable_to_get_user_info");if(!Z)throw J.context.logger.error("No callback URL found"),V("no_callback_url");if(z){if(!J.context.options.account?.accountLinking?.trustedProviders?.includes(v.id)&&!O.emailVerified||J.context.options.account?.accountLinking?.enabled===!1)return J.context.logger.error("Unable to link account - untrusted provider"),V("unable_to_link_account");if(O.email!==z.email&&J.context.options.account?.accountLinking?.allowDifferentEmails!==!0)return V("email_doesn't_match");let B=await J.context.internalAdapter.findAccount(String(O.id));if(B){if(B.userId.toString()!==z.userId.toString())return V("account_already_linked_to_different_user");let E=Object.fromEntries(Object.entries({accessToken:await S0(M.accessToken,J.context),refreshToken:await S0(M.refreshToken,J.context),idToken:M.idToken,accessTokenExpiresAt:M.accessTokenExpiresAt,refreshTokenExpiresAt:M.refreshTokenExpiresAt,scope:M.scopes?.join(",")}).filter(([R,g])=>g!==void 0));await J.context.internalAdapter.updateAccount(B.id,E)}else if(!await J.context.internalAdapter.createAccount({userId:z.userId,providerId:v.id,accountId:String(O.id),...M,accessToken:await S0(M.accessToken,J.context),refreshToken:await S0(M.refreshToken,J.context),scope:M.scopes?.join(",")}))return V("unable_to_link_account");let A;try{A=Z.toString()}catch{A=Z}throw J.redirect(A)}if(!O.email)return J.context.logger.error("Provider did not return email. This could be due to misconfiguration in the provider settings."),V("email_not_found");let S={providerId:v.id,accountId:String(O.id),...M,scope:M.scopes?.join(",")},T=await Wv(J,{userInfo:{...O,id:String(O.id),email:O.email,name:O.name||O.email},account:S,callbackURL:Z,disableSignUp:v.disableImplicitSignUp&&!Q||v.options?.disableSignUp,overrideUserInfo:v.options?.overrideUserInfoOnSignIn});if(T.error)return J.context.logger.error(T.error.split(" ").join("_")),V(T.error.split(" ").join("_"));let{session:j,user:q}=T.data;await I6(J,{session:j,user:q});let _;try{_=(T.isRegister?F||Z:Z).toString()}catch{_=T.isRegister?F||Z:Z}throw J.redirect(_)});async function wJ(J,W,X,G=3600,Y){return await LH({email:W.toLowerCase(),updateTo:X,...Y},J,G)}async function EA(J,W){if(!J.context.options.emailVerification?.sendVerificationEmail)throw J.context.logger.error("Verification email isn't enabled."),new L("BAD_REQUEST",{message:"Verification email isn't enabled"});let X=await wJ(J.context.secret,W.email,void 0,J.context.options.emailVerification?.expiresIn),G=J.body.callbackURL?encodeURIComponent(J.body.callbackURL):encodeURIComponent("/"),Y=`${J.context.baseURL}/verify-email?token=${X}&callbackURL=${G}`;await J.context.options.emailVerification.sendVerificationEmail({user:W,url:Y,token:X},J.request)}var Cl=y("/send-verification-email",{method:"POST",operationId:"sendVerificationEmail",body:x({email:D8().meta({description:"The email to send the verification email to"}),callbackURL:P().meta({description:"The URL to use for email verification callback"}).optional()}),metadata:{openapi:{operationId:"sendVerificationEmail",description:"Send a verification email to the user",requestBody:{content:{"application/json":{schema:{type:"object",properties:{email:{type:"string",description:"The email to send the verification email to",example:"user@example.com"},callbackURL:{type:"string",description:"The URL to use for email verification callback",example:"https://example.com/callback",nullable:!0}},required:["email"]}}}},responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean",description:"Indicates if the email was sent successfully",example:!0}}}}}},"400":{description:"Bad Request",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",description:"Error message",example:"Verification email isn't enabled"}}}}}}}}}},async(J)=>{if(!J.context.options.emailVerification?.sendVerificationEmail)throw J.context.logger.error("Verification email isn't enabled."),new L("BAD_REQUEST",{message:"Verification email isn't enabled"});let{email:W}=J.body,X=await P6(J);if(!X){let G=await J.context.internalAdapter.findUserByEmail(W);if(!G)return await wJ(J.context.secret,W,void 0,J.context.options.emailVerification?.expiresIn),J.json({status:!0});return await EA(J,G.user),J.json({status:!0})}if(X?.user.emailVerified)throw new L("BAD_REQUEST",{message:"You can only send a verification email to an unverified email"});if(X?.user.email!==W)throw new L("BAD_REQUEST",{message:"You can only send a verification email to your own email"});return await EA(J,X.user),J.json({status:!0})}),Il=y("/verify-email",{method:"GET",operationId:"verifyEmail",query:x({token:P().meta({description:"The token to verify the email"}),callbackURL:P().meta({description:"The URL to redirect to after email verification"}).optional()}),use:[f$((J)=>J.query.callbackURL)],metadata:{openapi:{description:"Verify the email of the user",parameters:[{name:"token",in:"query",description:"The token to verify the email",required:!0,schema:{type:"string"}},{name:"callbackURL",in:"query",description:"The URL to redirect to after email verification",required:!1,schema:{type:"string"}}],responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{user:{type:"object",$ref:"#/components/schemas/User"},status:{type:"boolean",description:"Indicates if the email was verified successfully"}},required:["user","status"]}}}}}}}},async(J)=>{function W(w){if(J.query.callbackURL){if(J.query.callbackURL.includes("?"))throw J.redirect(`${J.query.callbackURL}&error=${w}`);throw J.redirect(`${J.query.callbackURL}?error=${w}`)}throw new L("UNAUTHORIZED",{message:w})}let{token:X}=J.query,G;try{G=await P8(X,new TextEncoder().encode(J.context.secret),{algorithms:["HS256"]})}catch(w){if(w instanceof eY)return W("token_expired");return W("invalid_token")}let Y=x({email:D8(),updateTo:P().optional(),requestType:P().optional()}).parse(G.payload),$=await J.context.internalAdapter.findUserByEmail(Y.email);if(!$)return W("user_not_found");if(Y.updateTo){let w=await P6(J);if(w&&w.user.email!==Y.email)return W("unauthorized");if(Y.requestType==="change-email-confirmation"){let N=await wJ(J.context.secret,Y.email,Y.updateTo,J.context.options.emailVerification?.expiresIn,{requestType:"change-email-verification"}),F=J.query.callbackURL?encodeURIComponent(J.query.callbackURL):encodeURIComponent("/"),Q=`${J.context.baseURL}/verify-email?token=${N}&callbackURL=${F}`;if(await J.context.options.emailVerification?.sendVerificationEmail?.({user:{...$.user,email:Y.updateTo},url:Q,token:N},J.request),J.query.callbackURL)throw J.redirect(J.query.callbackURL);return J.json({status:!0})}if(!w){let N=await J.context.internalAdapter.createSession($.user.id);if(!N)throw new L("INTERNAL_SERVER_ERROR",{message:"Failed to create session"});w={session:N,user:$.user}}if(Y.requestType==="change-email-verification"){let N=await J.context.internalAdapter.updateUserByEmail(Y.email,{email:Y.updateTo,emailVerified:!0});if(await I6(J,{session:w.session,user:{...w.user,email:Y.updateTo,emailVerified:!0}}),J.query.callbackURL)throw J.redirect(J.query.callbackURL);return J.json({status:!0,user:N})}let H=await J.context.internalAdapter.updateUserByEmail(Y.email,{email:Y.updateTo,emailVerified:!1}),Z=await wJ(J.context.secret,Y.updateTo),z=J.query.callbackURL?encodeURIComponent(J.query.callbackURL):encodeURIComponent("/");if(await J.context.options.emailVerification?.sendVerificationEmail?.({user:H,url:`${J.context.baseURL}/verify-email?token=${Z}&callbackURL=${z}`,token:Z},J.request),await I6(J,{session:w.session,user:{...w.user,email:Y.updateTo,emailVerified:!1}}),J.query.callbackURL)throw J.redirect(J.query.callbackURL);return J.json({status:!0,user:{id:H.id,email:H.email,name:H.name,image:H.image,emailVerified:H.emailVerified,createdAt:H.createdAt,updatedAt:H.updatedAt}})}if($.user.emailVerified){if(J.query.callbackURL)throw J.redirect(J.query.callbackURL);return J.json({status:!0,user:null})}if(J.context.options.emailVerification?.onEmailVerification)await J.context.options.emailVerification.onEmailVerification($.user,J.request);let K=await J.context.internalAdapter.updateUserByEmail(Y.email,{emailVerified:!0});if(J.context.options.emailVerification?.afterEmailVerification)await J.context.options.emailVerification.afterEmailVerification(K,J.request);if(J.context.options.emailVerification?.autoSignInAfterVerification){let w=await P6(J);if(!w||w.user.email!==Y.email){let H=await J.context.internalAdapter.createSession($.user.id);if(!H)throw new L("INTERNAL_SERVER_ERROR",{message:"Failed to create session"});await I6(J,{session:H,user:{...$.user,emailVerified:!0}})}else await I6(J,{session:w.session,user:{...w.user,emailVerified:!0}})}if(J.query.callbackURL)throw J.redirect(J.query.callbackURL);return J.json({status:!0,user:null})});function bA(J){return J.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/&(?!amp;|lt;|gt;|quot;|#39;|#x[0-9a-fA-F]+;|#[0-9]+;)/g,"&amp;")}var bl=(J,W="Unknown",X=null)=>{let G=J.onAPIError?.customizeDefaultErrorPage;return`<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Error</title>
    <style>
      * {
        box-sizing: border-box;
      }
      body {
        font-family: ${G?.font?.defaultFamily||"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif"};
        background: ${G?.colors?.background||"var(--background)"};
        color: var(--foreground);
        margin: 0;
      }
      :root,
      :host {
        --spacing: 0.25rem;
        --container-md: 28rem;
        --text-sm: ${G?.size?.textSm||"0.875rem"};
        --text-sm--line-height: calc(1.25 / 0.875);
        --text-2xl: ${G?.size?.text2xl||"1.5rem"};
        --text-2xl--line-height: calc(2 / 1.5);
        --text-4xl: ${G?.size?.text4xl||"2.25rem"};
        --text-4xl--line-height: calc(2.5 / 2.25);
        --text-6xl: ${G?.size?.text6xl||"3rem"};
        --text-6xl--line-height: 1;
        --font-weight-medium: 500;
        --font-weight-semibold: 600;
        --font-weight-bold: 700;
        --default-transition-duration: 150ms;
        --default-transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        --radius: ${G?.size?.radiusSm||"0.625rem"};
        --default-mono-font-family: ${G?.font?.monoFamily||"var(--font-geist-mono)"};
        --primary: ${G?.colors?.primary||"black"};
        --primary-foreground: ${G?.colors?.primaryForeground||"white"};
        --background: ${G?.colors?.background||"white"};
        --foreground: ${G?.colors?.foreground||"oklch(0.271 0 0)"};
        --border: ${G?.colors?.border||"oklch(0.89 0 0)"};
        --destructive: ${G?.colors?.destructive||"oklch(0.55 0.15 25.723)"};
        --muted-foreground: ${G?.colors?.mutedForeground||"oklch(0.545 0 0)"};
        --corner-border: ${G?.colors?.cornerBorder||"#404040"};
      }

      button, .btn {
        cursor: pointer;
        background: none;
        border: none;
        color: inherit;
        font: inherit;
        transition: all var(--default-transition-duration)
          var(--default-transition-timing-function);
      }
      button:hover, .btn:hover {
        opacity: 0.8;
      }

      @media (prefers-color-scheme: dark) {
        :root,
        :host {
          --primary: ${G?.colors?.primary||"white"};
          --primary-foreground: ${G?.colors?.primaryForeground||"black"};
          --background: ${G?.colors?.background||"oklch(0.15 0 0)"};
          --foreground: ${G?.colors?.foreground||"oklch(0.98 0 0)"};
          --border: ${G?.colors?.border||"oklch(0.27 0 0)"};
          --destructive: ${G?.colors?.destructive||"oklch(0.65 0.15 25.723)"};
          --muted-foreground: ${G?.colors?.mutedForeground||"oklch(0.65 0 0)"};
          --corner-border: ${G?.colors?.cornerBorder||"#a0a0a0"};
        }
      }
      @media (max-width: 640px) {
        :root, :host {
          --text-6xl: 2.5rem;
          --text-2xl: 1.25rem;
          --text-sm: 0.8125rem;
        }
      }
      @media (max-width: 480px) {
        :root, :host {
          --text-6xl: 2rem;
          --text-2xl: 1.125rem;
        }
      }
    </style>
  </head>
  <body style="width: 100vw; min-height: 100vh; overflow-x: hidden; overflow-y: auto;">
    <div
        style="
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 1.5rem;
            position: relative;
            width: 100%;
            min-height: 100vh;
            padding: 1rem;
        "
        >
${G?.disableBackgroundGrid?"":`
      <div
        style="
          position: absolute;
          inset: 0;
          background-image: linear-gradient(to right, ${G?.colors?.gridColor||"var(--border)"} 1px, transparent 1px),
            linear-gradient(to bottom, ${G?.colors?.gridColor||"var(--border)"} 1px, transparent 1px);
          background-size: 40px 40px;
          opacity: 0.6;
          pointer-events: none;
          width: 100vw;
          height: 100vh;
        "
      ></div>
      <div
        style="
          position: absolute;
          inset: 0;
          display: flex;
          align-items: center;
          justify-content: center;
          background: ${G?.colors?.background||"var(--background)"};
          mask-image: radial-gradient(ellipse at center, transparent 20%, black);
          -webkit-mask-image: radial-gradient(ellipse at center, transparent 20%, black);
          pointer-events: none;
        "
      ></div>
`}

<div
  style="
    position: relative;
    z-index: 10;
    border: 2px solid var(--border);
    background: ${G?.colors?.cardBackground||"var(--background)"};
    padding: 1.5rem;
    max-width: 42rem;
    width: 100%;
  "
>
    ${G?.disableCornerDecorations?"":`
        <!-- Corner decorations -->
        <div
          style="
            position: absolute;
            top: -2px;
            left: -2px;
            width: 2rem;
            height: 2rem;
            border-top: 4px solid var(--corner-border);
            border-left: 4px solid var(--corner-border);
          "
        ></div>
        <div
          style="
            position: absolute;
            top: -2px;
            right: -2px;
            width: 2rem;
            height: 2rem;
            border-top: 4px solid var(--corner-border);
            border-right: 4px solid var(--corner-border);
          "
        ></div>
  
        <div
          style="
            position: absolute;
            bottom: -2px;
            left: -2px;
            width: 2rem;
            height: 2rem;
            border-bottom: 4px solid var(--corner-border);
            border-left: 4px solid var(--corner-border);
          "
        ></div>
        <div
          style="
            position: absolute;
            bottom: -2px;
            right: -2px;
            width: 2rem;
            height: 2rem;
            border-bottom: 4px solid var(--corner-border);
            border-right: 4px solid var(--corner-border);
          "
        ></div>`}

        <div style="text-align: center; margin-bottom: 1.5rem;">
          <div style="margin-bottom: 1.5rem;">
            <div
              style="
                display: inline-block;
                border: 2px solid ${G?.disableTitleBorder?"transparent":G?.colors?.titleBorder||"var(--destructive)"};
                padding: 0.375rem 1rem;
              "
            >
              <h1
                style="
                  font-size: var(--text-6xl);
                  font-weight: var(--font-weight-semibold);
                  color: ${G?.colors?.titleColor||"var(--foreground)"};
                  letter-spacing: -0.02em;
                  margin: 0;
                "
              >
                ERROR
              </h1>
            </div>
            <div
              style="
                height: 2px;
                background-color: var(--border);
                width: calc(100% + 3rem);
                margin-left: -1.5rem;
                margin-top: 1.5rem;
              "
            ></div>
          </div>

          <h2
            style="
              font-size: var(--text-2xl);
              font-weight: var(--font-weight-semibold);
              color: var(--foreground);
              margin: 0 0 1rem;
            "
          >
            Something went wrong
          </h2>

          <div
            style="
                display: inline-flex;
                align-items: center;
                gap: 0.5rem;
                border: 2px solid var(--border);
                background-color: var(--muted);
                padding: 0.375rem 0.75rem;
                margin: 0 0 1rem;
                flex-wrap: wrap;
                justify-content: center;
            "
            >
            <span
                style="
                font-size: 0.75rem;
                color: var(--muted-foreground);
                font-weight: var(--font-weight-semibold);
                "
            >
                CODE:
            </span>
            <span
                style="
                font-size: var(--text-sm);
                font-family: var(--default-mono-font-family, monospace);
                color: var(--foreground);
                word-break: break-all;
                "
            >
                ${bA(W)}
            </span>
            </div>

          <p
            style="
              color: var(--muted-foreground);
              max-width: 28rem;
              margin: 0 auto;
              font-size: var(--text-sm);
              line-height: 1.5;
              text-wrap: pretty;
            "
          >
            ${!X?`We encountered an unexpected error. Please try again or return to the home page. If you're a developer, you can find more information about the error <a href='https://better-auth.com/docs/errors/${encodeURIComponent(W)}' target='_blank' rel="noopener noreferrer" style='color: var(--foreground); text-decoration: underline;'>here</a>.`:X}
          </p>
        </div>

        <div
          style="
            display: flex;
            gap: 0.75rem;
            margin-top: 1.5rem;
            justify-content: center;
            flex-wrap: wrap;
          "
        >
          <a
            href="/"
            style="
              text-decoration: none;
            "
          >
            <div
              style="
                border: 2px solid var(--border);
                background: var(--primary);
                color: var(--primary-foreground);
                padding: 0.5rem 1rem;
                border-radius: 0;
                white-space: nowrap;
              "
              class="btn"
            >
              Go Home
            </div>
          </a>
          <a
            href="https://better-auth.com/docs/errors/${encodeURIComponent(W)}?askai=${encodeURIComponent(`What does the error code ${W} mean?`)}"
            target="_blank"
            rel="noopener noreferrer"
            style="
              text-decoration: none;
            "
          >
            <div
              style="
                border: 2px solid var(--border);
                background: transparent;
                color: var(--foreground);
                padding: 0.5rem 1rem;
                border-radius: 0;
                white-space: nowrap;
              "
              class="btn"
            >
              Ask AI
            </div>
          </a>
        </div>
      </div>
    </div>
  </body>
</html>`},kl=y("/error",{method:"GET",metadata:{...aY,openapi:{description:"Displays an error page",responses:{"200":{description:"Success",content:{"text/html":{schema:{type:"string",description:"The HTML content of the error page"}}}}}}}},async(J)=>{let W=new URL(J.request?.url||""),X=W.searchParams.get("error")||"UNKNOWN",G=W.searchParams.get("error_description")||null,Y=/^[\'A-Za-z0-9_-]+$/.test(X||"")?X:"UNKNOWN",$=G?bA(G):null,K=new URLSearchParams;if(K.set("error",Y),G)K.set("error_description",G);let w=J.context.options,H=w.onAPIError?.errorURL;if(H)return new Response(null,{status:302,headers:{Location:`${H}${H.includes("?")?"&":"?"}${K.toString()}`}});if(FW&&!w.onAPIError?.customizeDefaultErrorPage)return new Response(null,{status:302,headers:{Location:`/?${K.toString()}`}});return new Response(bl(J.context.options,Y,$),{headers:{"Content-Type":"text/html"}})}),hl=y("/ok",{method:"GET",metadata:{...aY,openapi:{description:"Check if the API is working",responses:{"200":{description:"API is working",content:{"application/json":{schema:{type:"object",properties:{ok:{type:"boolean",description:"Indicates if the API is working"}},required:["ok"]}}}}}}}},async(J)=>{return J.json({ok:!0})});function RA(J,W,X){let G=W?new URL(W,J.baseURL):new URL(`${J.baseURL}/error`);if(X)Object.entries(X).forEach(([Y,$])=>G.searchParams.set(Y,$));return G.href}function fl(J,W,X){let G=new URL(W,J.baseURL);if(X)Object.entries(X).forEach(([Y,$])=>G.searchParams.set(Y,$));return G.href}var gl=y("/request-password-reset",{method:"POST",operationId:"forgetPassword",body:x({email:D8().meta({description:"The email address of the user to send a password reset email to"}),redirectTo:P().meta({description:"The URL to redirect the user to reset their password. If the token isn't valid or expired, it'll be redirected with a query parameter `?error=INVALID_TOKEN`. If the token is valid, it'll be redirected with a query parameter `?token=VALID_TOKEN"}).optional()}),metadata:{openapi:{operationId:"forgetPassword",description:"Send a password reset email to the user",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean"},message:{type:"string"}}}}}}}}}},async(J)=>{if(!J.context.options.emailAndPassword?.sendResetPassword)throw J.context.logger.error("Reset password isn't enabled.Please pass an emailAndPassword.sendResetPassword function in your auth config!"),new L("BAD_REQUEST",{message:"Reset password isn't enabled"});let{email:W,redirectTo:X}=J.body,G=await J.context.internalAdapter.findUserByEmail(W,{includeAccounts:!0});if(!G)return f4(24),await J.context.internalAdapter.findVerificationValue("dummy-verification-token"),J.context.logger.error("Reset Password: User not found",{email:W}),J.json({status:!0,message:"If this email exists in our system, check your email for the reset link"});let Y=F4(J.context.options.emailAndPassword.resetPasswordTokenExpiresIn||3600,"sec"),$=f4(24);await J.context.internalAdapter.createVerificationValue({value:G.user.id,identifier:`reset-password:${$}`,expiresAt:Y});let K=X?encodeURIComponent(X):"",w=`${J.context.baseURL}/reset-password/${$}?callbackURL=${K}`;return J.context.options.emailAndPassword.sendResetPassword({user:G.user,url:w,token:$},J.request).catch((H)=>{J.context.logger.error("Failed to send reset password email",H)}),J.json({status:!0,message:"If this email exists in our system, check your email for the reset link"})}),ml=y("/reset-password/:token",{method:"GET",operationId:"forgetPasswordCallback",query:x({callbackURL:P().meta({description:"The URL to redirect the user to reset their password"})}),use:[f$((J)=>J.query.callbackURL)],metadata:{openapi:{operationId:"resetPasswordCallback",description:"Redirects the user to the callback URL with the token",parameters:[{name:"token",in:"path",required:!0,description:"The token to reset the password",schema:{type:"string"}},{name:"callbackURL",in:"query",required:!0,description:"The URL to redirect the user to reset their password",schema:{type:"string"}}],responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{token:{type:"string"}}}}}}}}}},async(J)=>{let{token:W}=J.params,{callbackURL:X}=J.query;if(!W||!X)throw J.redirect(RA(J.context,X,{error:"INVALID_TOKEN"}));let G=await J.context.internalAdapter.findVerificationValue(`reset-password:${W}`);if(!G||G.expiresAt<new Date)throw J.redirect(RA(J.context,X,{error:"INVALID_TOKEN"}));throw J.redirect(fl(J.context,X,{token:W}))}),yl=y("/reset-password",{method:"POST",operationId:"resetPassword",query:x({token:P().optional()}).optional(),body:x({newPassword:P().meta({description:"The new password to set"}),token:P().meta({description:"The token to reset the password"}).optional()}),metadata:{openapi:{operationId:"resetPassword",description:"Reset the password for a user",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean"}}}}}}}}}},async(J)=>{let W=J.body.token||J.query?.token;if(!W)throw new L("BAD_REQUEST",{message:o.INVALID_TOKEN});let{newPassword:X}=J.body,G=J.context.password?.config.minPasswordLength,Y=J.context.password?.config.maxPasswordLength;if(X.length<G)throw new L("BAD_REQUEST",{message:o.PASSWORD_TOO_SHORT});if(X.length>Y)throw new L("BAD_REQUEST",{message:o.PASSWORD_TOO_LONG});let $=`reset-password:${W}`,K=await J.context.internalAdapter.findVerificationValue($);if(!K||K.expiresAt<new Date)throw new L("BAD_REQUEST",{message:o.INVALID_TOKEN});let w=K.value,H=await J.context.password.hash(X);if(!(await J.context.internalAdapter.findAccounts(w)).find((Z)=>Z.providerId==="credential"))await J.context.internalAdapter.createAccount({userId:w,providerId:"credential",password:H,accountId:w});else await J.context.internalAdapter.updatePassword(w,H);if(await J.context.internalAdapter.deleteVerificationValue(K.id),J.context.options.emailAndPassword?.onPasswordReset){let Z=await J.context.internalAdapter.findUserById(w);if(Z)await J.context.options.emailAndPassword.onPasswordReset({user:Z},J.request)}if(J.context.options.emailAndPassword?.revokeSessionsOnPasswordReset)await J.context.internalAdapter.deleteSessions(w);return J.json({status:!0})}),xl=y("/sign-in/social",{method:"POST",operationId:"socialSignIn",body:x({callbackURL:P().meta({description:"Callback URL to redirect to after the user has signed in"}).optional(),newUserCallbackURL:P().optional(),errorCallbackURL:P().meta({description:"Callback URL to redirect to if an error happens"}).optional(),provider:tD,disableRedirect:d6().meta({description:"Disable automatic redirection to the provider. Useful for handling the redirection yourself"}).optional(),idToken:M0(x({token:P().meta({description:"ID token from the provider"}),nonce:P().meta({description:"Nonce used to generate the token"}).optional(),accessToken:P().meta({description:"Access token from the provider"}).optional(),refreshToken:P().meta({description:"Refresh token from the provider"}).optional(),expiresAt:O6().meta({description:"Expiry date of the token"}).optional()})),scopes:v6(P()).meta({description:"Array of scopes to request from the provider. This will override the default scopes passed."}).optional(),requestSignUp:d6().meta({description:"Explicitly request sign-up. Useful when disableImplicitSignUp is true for this provider"}).optional(),loginHint:P().meta({description:"The login hint to use for the authorization code request"}).optional(),additionalData:_6(P(),E6()).optional().meta({description:"Additional data to be passed through the OAuth flow"})}),metadata:{openapi:{description:"Sign in with a social provider",operationId:"socialSignIn",responses:{"200":{description:"Success - Returns either session details or redirect URL",content:{"application/json":{schema:{type:"object",description:"Session response when idToken is provided",properties:{token:{type:"string"},user:{type:"object",$ref:"#/components/schemas/User"},url:{type:"string"},redirect:{type:"boolean",enum:[!1]}},required:["redirect","token","user"]}}}}}}}},async(J)=>{let W=J.context.socialProviders.find(($)=>$.id===J.body.provider);if(!W)throw J.context.logger.error("Provider not found. Make sure to add the provider in your auth config",{provider:J.body.provider}),new L("NOT_FOUND",{message:o.PROVIDER_NOT_FOUND});if(J.body.idToken){if(!W.verifyIdToken)throw J.context.logger.error("Provider does not support id token verification",{provider:J.body.provider}),new L("NOT_FOUND",{message:o.ID_TOKEN_NOT_SUPPORTED});let{token:$,nonce:K}=J.body.idToken;if(!await W.verifyIdToken($,K))throw J.context.logger.error("Invalid id token",{provider:J.body.provider}),new L("UNAUTHORIZED",{message:o.INVALID_TOKEN});let w=await W.getUserInfo({idToken:$,accessToken:J.body.idToken.accessToken,refreshToken:J.body.idToken.refreshToken});if(!w||!w?.user)throw J.context.logger.error("Failed to get user info",{provider:J.body.provider}),new L("UNAUTHORIZED",{message:o.FAILED_TO_GET_USER_INFO});if(!w.user.email)throw J.context.logger.error("User email not found",{provider:J.body.provider}),new L("UNAUTHORIZED",{message:o.USER_EMAIL_NOT_FOUND});let H=await Wv(J,{userInfo:{...w.user,email:w.user.email,id:String(w.user.id),name:w.user.name||"",image:w.user.image,emailVerified:w.user.emailVerified||!1},account:{providerId:W.id,accountId:String(w.user.id),accessToken:J.body.idToken.accessToken},callbackURL:J.body.callbackURL,disableSignUp:W.disableImplicitSignUp&&!J.body.requestSignUp||W.disableSignUp});if(H.error)throw new L("UNAUTHORIZED",{message:H.error});return await I6(J,H.data),J.json({redirect:!1,token:H.data.session.token,url:void 0,user:{id:H.data.user.id,email:H.data.user.email,name:H.data.user.name,image:H.data.user.image,emailVerified:H.data.user.emailVerified,createdAt:H.data.user.createdAt,updatedAt:H.data.user.updatedAt}})}let{codeVerifier:X,state:G}=await z$(J,void 0,J.body.additionalData),Y=await W.createAuthorizationURL({state:G,codeVerifier:X,redirectURI:`${J.context.baseURL}/callback/${W.id}`,scopes:J.body.scopes,loginHint:J.body.loginHint});return J.json({url:Y.toString(),redirect:!J.body.disableRedirect})}),ul=y("/sign-in/email",{method:"POST",operationId:"signInEmail",body:x({email:P().meta({description:"Email of the user"}),password:P().meta({description:"Password of the user"}),callbackURL:P().meta({description:"Callback URL to use as a redirect for email verification"}).optional(),rememberMe:d6().meta({description:"If this is false, the session will not be remembered. Default is `true`."}).default(!0).optional()}),metadata:{openapi:{operationId:"signInEmail",description:"Sign in with email and password",responses:{"200":{description:"Success - Returns either session details or redirect URL",content:{"application/json":{schema:{type:"object",description:"Session response when idToken is provided",properties:{redirect:{type:"boolean",enum:[!1]},token:{type:"string",description:"Session token"},url:{type:"null",nullable:!0},user:{type:"object",$ref:"#/components/schemas/User"}},required:["redirect","token","user"]}}}}}}}},async(J)=>{if(!J.context.options?.emailAndPassword?.enabled)throw J.context.logger.error("Email and password is not enabled. Make sure to enable it in the options on you `auth.ts` file. Check `https://better-auth.com/docs/authentication/email-password` for more!"),new L("BAD_REQUEST",{message:"Email and password is not enabled"});let{email:W,password:X}=J.body;if(!D8().safeParse(W).success)throw new L("BAD_REQUEST",{message:o.INVALID_EMAIL});let G=await J.context.internalAdapter.findUserByEmail(W,{includeAccounts:!0});if(!G)throw await J.context.password.hash(X),J.context.logger.error("User not found",{email:W}),new L("UNAUTHORIZED",{message:o.INVALID_EMAIL_OR_PASSWORD});let Y=G.accounts.find((w)=>w.providerId==="credential");if(!Y)throw await J.context.password.hash(X),J.context.logger.error("Credential account not found",{email:W}),new L("UNAUTHORIZED",{message:o.INVALID_EMAIL_OR_PASSWORD});let $=Y?.password;if(!$)throw await J.context.password.hash(X),J.context.logger.error("Password not found",{email:W}),new L("UNAUTHORIZED",{message:o.INVALID_EMAIL_OR_PASSWORD});if(!await J.context.password.verify({hash:$,password:X}))throw J.context.logger.error("Invalid password"),new L("UNAUTHORIZED",{message:o.INVALID_EMAIL_OR_PASSWORD});if(J.context.options?.emailAndPassword?.requireEmailVerification&&!G.user.emailVerified){if(!J.context.options?.emailVerification?.sendVerificationEmail)throw new L("FORBIDDEN",{message:o.EMAIL_NOT_VERIFIED});if(J.context.options?.emailVerification?.sendOnSignIn){let w=await wJ(J.context.secret,G.user.email,void 0,J.context.options.emailVerification?.expiresIn),H=J.body.callbackURL?encodeURIComponent(J.body.callbackURL):encodeURIComponent("/"),Z=`${J.context.baseURL}/verify-email?token=${w}&callbackURL=${H}`;await J.context.options.emailVerification.sendVerificationEmail({user:G.user,url:Z,token:w},J.request)}throw new L("FORBIDDEN",{message:o.EMAIL_NOT_VERIFIED})}let K=await J.context.internalAdapter.createSession(G.user.id,J.body.rememberMe===!1);if(!K)throw J.context.logger.error("Failed to create session"),new L("UNAUTHORIZED",{message:o.FAILED_TO_CREATE_SESSION});return await I6(J,{session:K,user:G.user},J.body.rememberMe===!1),J.json({redirect:!!J.body.callbackURL,token:K.token,url:J.body.callbackURL,user:{id:G.user.id,email:G.user.email,name:G.user.name,image:G.user.image,emailVerified:G.user.emailVerified,createdAt:G.user.createdAt,updatedAt:G.user.updatedAt}})}),ll=y("/sign-out",{method:"POST",operationId:"signOut",requireHeaders:!0,metadata:{openapi:{operationId:"signOut",description:"Sign out the current user",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean"}}}}}}}}}},async(J)=>{let W=await J.getSignedCookie(J.context.authCookies.sessionToken.name,J.context.secret);if(W)try{await J.context.internalAdapter.deleteSession(W)}catch(X){J.context.logger.error("Failed to delete session from database",X)}return KJ(J),J.json({success:!0})}),cl=()=>y("/sign-up/email",{method:"POST",operationId:"signUpWithEmailAndPassword",body:_6(P(),E6()),metadata:{$Infer:{body:{}},openapi:{operationId:"signUpWithEmailAndPassword",description:"Sign up a user using email and password",requestBody:{content:{"application/json":{schema:{type:"object",properties:{name:{type:"string",description:"The name of the user"},email:{type:"string",description:"The email of the user"},password:{type:"string",description:"The password of the user"},image:{type:"string",description:"The profile image URL of the user"},callbackURL:{type:"string",description:"The URL to use for email verification callback"},rememberMe:{type:"boolean",description:"If this is false, the session will not be remembered. Default is `true`."}},required:["name","email","password"]}}}},responses:{"200":{description:"Successfully created user",content:{"application/json":{schema:{type:"object",properties:{token:{type:"string",nullable:!0,description:"Authentication token for the session"},user:{type:"object",properties:{id:{type:"string",description:"The unique identifier of the user"},email:{type:"string",format:"email",description:"The email address of the user"},name:{type:"string",description:"The name of the user"},image:{type:"string",format:"uri",nullable:!0,description:"The profile image URL of the user"},emailVerified:{type:"boolean",description:"Whether the email has been verified"},createdAt:{type:"string",format:"date-time",description:"When the user was created"},updatedAt:{type:"string",format:"date-time",description:"When the user was last updated"}},required:["id","email","name","emailVerified","createdAt","updatedAt"]}},required:["user"]}}}},"422":{description:"Unprocessable Entity. User already exists or failed to create user.",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}}}}}}}}}},async(J)=>{return S9(J.context.adapter,async()=>{if(!J.context.options.emailAndPassword?.enabled||J.context.options.emailAndPassword?.disableSignUp)throw new L("BAD_REQUEST",{message:"Email and password sign up is not enabled"});let W=J.body,{name:X,email:G,password:Y,image:$,callbackURL:K,rememberMe:w,...H}=W;if(!D8().safeParse(G).success)throw new L("BAD_REQUEST",{message:o.INVALID_EMAIL});let Z=J.context.password.config.minPasswordLength;if(Y.length<Z)throw J.context.logger.error("Password is too short"),new L("BAD_REQUEST",{message:o.PASSWORD_TOO_SHORT});let z=J.context.password.config.maxPasswordLength;if(Y.length>z)throw J.context.logger.error("Password is too long"),new L("BAD_REQUEST",{message:o.PASSWORD_TOO_LONG});if((await J.context.internalAdapter.findUserByEmail(G))?.user)throw J.context.logger.info(`Sign-up attempt for existing email: ${G}`),new L("UNPROCESSABLE_ENTITY",{message:o.USER_ALREADY_EXISTS_USE_ANOTHER_EMAIL});let N=await J.context.password.hash(Y),F;try{let V=l7(J.context.options,H,"create");if(F=await J.context.internalAdapter.createUser({email:G.toLowerCase(),name:X,image:$,...V,emailVerified:!1}),!F)throw new L("BAD_REQUEST",{message:o.FAILED_TO_CREATE_USER})}catch(V){if(tY())J.context.logger.error("Failed to create user",V);if(V instanceof L)throw V;throw J.context.logger?.error("Failed to create user",V),new L("UNPROCESSABLE_ENTITY",{message:o.FAILED_TO_CREATE_USER,details:V})}if(!F)throw new L("UNPROCESSABLE_ENTITY",{message:o.FAILED_TO_CREATE_USER});if(await J.context.internalAdapter.linkAccount({userId:F.id,providerId:"credential",accountId:F.id,password:N}),J.context.options.emailVerification?.sendOnSignUp||J.context.options.emailAndPassword.requireEmailVerification){let V=await wJ(J.context.secret,F.email,void 0,J.context.options.emailVerification?.expiresIn),v=W.callbackURL?encodeURIComponent(W.callbackURL):encodeURIComponent("/"),M=`${J.context.baseURL}/verify-email?token=${V}&callbackURL=${v}`,O=J.request?[{user:F,url:M,token:V},J.request]:[{user:F,url:M,token:V}];await J.context.options.emailVerification?.sendVerificationEmail?.(...O)}if(J.context.options.emailAndPassword.autoSignIn===!1||J.context.options.emailAndPassword.requireEmailVerification)return J.json({token:null,user:{id:F.id,email:F.email,name:F.name,image:F.image,emailVerified:F.emailVerified,createdAt:F.createdAt,updatedAt:F.updatedAt}});let Q=await J.context.internalAdapter.createSession(F.id,w===!1);if(!Q)throw new L("BAD_REQUEST",{message:o.FAILED_TO_CREATE_SESSION});return await I6(J,{session:Q,user:F},w===!1),J.json({token:Q.token,user:{id:F.id,email:F.email,name:F.name,image:F.image,emailVerified:F.emailVerified,createdAt:F.createdAt,updatedAt:F.updatedAt}})})}),pl=()=>y("/update-user",{method:"POST",operationId:"updateUser",body:_6(P().meta({description:"Field name must be a string"}),E6()),use:[k4],metadata:{$Infer:{body:{}},openapi:{operationId:"updateUser",description:"Update the current user",requestBody:{content:{"application/json":{schema:{type:"object",properties:{name:{type:"string",description:"The name of the user"},image:{type:"string",description:"The image of the user"}}}}}},responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{user:{type:"object",$ref:"#/components/schemas/User"}}}}}}}}}},async(J)=>{let W=J.body;if(W.email)throw new L("BAD_REQUEST",{message:o.EMAIL_CAN_NOT_BE_UPDATED});let{name:X,image:G,...Y}=W,$=J.context.session,K=l7(J.context.options,Y,"update");if(G===void 0&&X===void 0&&Object.keys(K).length===0)throw new L("BAD_REQUEST",{message:"No fields to update"});let w=await J.context.internalAdapter.updateUser($.user.id,{name:X,image:G,...K});return await I6(J,{session:$.session,user:w}),J.json({status:!0})}),dl=y("/change-password",{method:"POST",operationId:"changePassword",body:x({newPassword:P().meta({description:"The new password to set"}),currentPassword:P().meta({description:"The current password is required"}),revokeOtherSessions:d6().meta({description:"Must be a boolean value"}).optional()}),use:[GX],metadata:{openapi:{operationId:"changePassword",description:"Change the password of the user",responses:{"200":{description:"Password successfully changed",content:{"application/json":{schema:{type:"object",properties:{token:{type:"string",nullable:!0,description:"New session token if other sessions were revoked"},user:{type:"object",properties:{id:{type:"string",description:"The unique identifier of the user"},email:{type:"string",format:"email",description:"The email address of the user"},name:{type:"string",description:"The name of the user"},image:{type:"string",format:"uri",nullable:!0,description:"The profile image URL of the user"},emailVerified:{type:"boolean",description:"Whether the email has been verified"},createdAt:{type:"string",format:"date-time",description:"When the user was created"},updatedAt:{type:"string",format:"date-time",description:"When the user was last updated"}},required:["id","email","name","emailVerified","createdAt","updatedAt"]}},required:["user"]}}}}}}}},async(J)=>{let{newPassword:W,currentPassword:X,revokeOtherSessions:G}=J.body,Y=J.context.session,$=J.context.password.config.minPasswordLength;if(W.length<$)throw J.context.logger.error("Password is too short"),new L("BAD_REQUEST",{message:o.PASSWORD_TOO_SHORT});let K=J.context.password.config.maxPasswordLength;if(W.length>K)throw J.context.logger.error("Password is too long"),new L("BAD_REQUEST",{message:o.PASSWORD_TOO_LONG});let w=(await J.context.internalAdapter.findAccounts(Y.user.id)).find((z)=>z.providerId==="credential"&&z.password);if(!w||!w.password)throw new L("BAD_REQUEST",{message:o.CREDENTIAL_ACCOUNT_NOT_FOUND});let H=await J.context.password.hash(W);if(!await J.context.password.verify({hash:w.password,password:X}))throw new L("BAD_REQUEST",{message:o.INVALID_PASSWORD});await J.context.internalAdapter.updateAccount(w.id,{password:H});let Z=null;if(G){await J.context.internalAdapter.deleteSessions(Y.user.id);let z=await J.context.internalAdapter.createSession(Y.user.id);if(!z)throw new L("INTERNAL_SERVER_ERROR",{message:o.FAILED_TO_GET_SESSION});await I6(J,{session:z,user:Y.user}),Z=z.token}return J.json({token:Z,user:{id:Y.user.id,email:Y.user.email,name:Y.user.name,image:Y.user.image,emailVerified:Y.user.emailVerified,createdAt:Y.user.createdAt,updatedAt:Y.user.updatedAt}})}),nl=y("/set-password",{method:"POST",body:x({newPassword:P().meta({description:"The new password to set is required"})}),metadata:{SERVER_ONLY:!0},use:[GX]},async(J)=>{let{newPassword:W}=J.body,X=J.context.session,G=J.context.password.config.minPasswordLength;if(W.length<G)throw J.context.logger.error("Password is too short"),new L("BAD_REQUEST",{message:o.PASSWORD_TOO_SHORT});let Y=J.context.password.config.maxPasswordLength;if(W.length>Y)throw J.context.logger.error("Password is too long"),new L("BAD_REQUEST",{message:o.PASSWORD_TOO_LONG});let $=(await J.context.internalAdapter.findAccounts(X.user.id)).find((w)=>w.providerId==="credential"&&w.password),K=await J.context.password.hash(W);if(!$)return await J.context.internalAdapter.linkAccount({userId:X.user.id,providerId:"credential",accountId:X.user.id,password:K}),J.json({status:!0});throw new L("BAD_REQUEST",{message:"user already has a password"})}),rl=y("/delete-user",{method:"POST",use:[GX],body:x({callbackURL:P().meta({description:"The callback URL to redirect to after the user is deleted"}).optional(),password:P().meta({description:"The password of the user is required to delete the user"}).optional(),token:P().meta({description:"The token to delete the user is required"}).optional()}),metadata:{openapi:{operationId:"deleteUser",description:"Delete the user",requestBody:{content:{"application/json":{schema:{type:"object",properties:{callbackURL:{type:"string",description:"The callback URL to redirect to after the user is deleted"},password:{type:"string",description:"The user's password. Required if session is not fresh"},token:{type:"string",description:"The deletion verification token"}}}}}},responses:{"200":{description:"User deletion processed successfully",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",description:"Indicates if the operation was successful"},message:{type:"string",enum:["User deleted","Verification email sent"],description:"Status message of the deletion process"}},required:["success","message"]}}}}}}}},async(J)=>{if(!J.context.options.user?.deleteUser?.enabled)throw J.context.logger.error("Delete user is disabled. Enable it in the options"),new L("NOT_FOUND");let W=J.context.session;if(J.body.password){let Y=(await J.context.internalAdapter.findAccounts(W.user.id)).find(($)=>$.providerId==="credential"&&$.password);if(!Y||!Y.password)throw new L("BAD_REQUEST",{message:o.CREDENTIAL_ACCOUNT_NOT_FOUND});if(!await J.context.password.verify({hash:Y.password,password:J.body.password}))throw new L("BAD_REQUEST",{message:o.INVALID_PASSWORD})}if(J.body.token)return await kA({...J,query:{token:J.body.token}}),J.json({success:!0,message:"User deleted"});if(J.context.options.user.deleteUser?.sendDeleteAccountVerification){let Y=t6(32,"0-9","a-z");await J.context.internalAdapter.createVerificationValue({value:W.user.id,identifier:`delete-account-${Y}`,expiresAt:new Date(Date.now()+(J.context.options.user.deleteUser?.deleteTokenExpiresIn||86400)*1000)});let $=`${J.context.baseURL}/delete-user/callback?token=${Y}&callbackURL=${J.body.callbackURL||"/"}`;return await J.context.options.user.deleteUser.sendDeleteAccountVerification({user:W.user,url:$,token:Y},J.request),J.json({success:!0,message:"Verification email sent"})}if(!J.body.password&&J.context.sessionConfig.freshAge!==0){let Y=new Date(W.session.createdAt).getTime(),$=J.context.sessionConfig.freshAge*1000;if(Date.now()-Y>$*1000)throw new L("BAD_REQUEST",{message:o.SESSION_EXPIRED})}let X=J.context.options.user.deleteUser?.beforeDelete;if(X)await X(W.user,J.request);await J.context.internalAdapter.deleteUser(W.user.id),await J.context.internalAdapter.deleteSessions(W.user.id),KJ(J);let G=J.context.options.user.deleteUser?.afterDelete;if(G)await G(W.user,J.request);return J.json({success:!0,message:"User deleted"})}),kA=y("/delete-user/callback",{method:"GET",query:x({token:P().meta({description:"The token to verify the deletion request"}),callbackURL:P().meta({description:"The URL to redirect to after deletion"}).optional()}),use:[f$((J)=>J.query.callbackURL)],metadata:{openapi:{description:"Callback to complete user deletion with verification token",responses:{"200":{description:"User successfully deleted",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",description:"Indicates if the deletion was successful"},message:{type:"string",enum:["User deleted"],description:"Confirmation message"}},required:["success","message"]}}}}}}}},async(J)=>{if(!J.context.options.user?.deleteUser?.enabled)throw J.context.logger.error("Delete user is disabled. Enable it in the options"),new L("NOT_FOUND");let W=await P6(J);if(!W)throw new L("NOT_FOUND",{message:o.FAILED_TO_GET_USER_INFO});let X=await J.context.internalAdapter.findVerificationValue(`delete-account-${J.query.token}`);if(!X||X.expiresAt<new Date)throw new L("NOT_FOUND",{message:o.INVALID_TOKEN});if(X.value!==W.user.id)throw new L("NOT_FOUND",{message:o.INVALID_TOKEN});let G=J.context.options.user.deleteUser?.beforeDelete;if(G)await G(W.user,J.request);await J.context.internalAdapter.deleteUser(W.user.id),await J.context.internalAdapter.deleteSessions(W.user.id),await J.context.internalAdapter.deleteAccounts(W.user.id),await J.context.internalAdapter.deleteVerificationValue(X.id),KJ(J);let Y=J.context.options.user.deleteUser?.afterDelete;if(Y)await Y(W.user,J.request);if(J.query.callbackURL)throw J.redirect(J.query.callbackURL||"/");return J.json({success:!0,message:"User deleted"})}),il=y("/change-email",{method:"POST",body:x({newEmail:D8().meta({description:"The new email address to set must be a valid email address"}),callbackURL:P().meta({description:"The URL to redirect to after email verification"}).optional()}),use:[GX],metadata:{openapi:{operationId:"changeEmail",responses:{"200":{description:"Email change request processed successfully",content:{"application/json":{schema:{type:"object",properties:{user:{type:"object",$ref:"#/components/schemas/User"},status:{type:"boolean",description:"Indicates if the request was successful"},message:{type:"string",enum:["Email updated","Verification email sent"],description:"Status message of the email change process",nullable:!0}},required:["status"]}}}},"422":{description:"Unprocessable Entity. Email already exists",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}}}}}}}}}},async(J)=>{if(!J.context.options.user?.changeEmail?.enabled)throw J.context.logger.error("Change email is disabled."),new L("BAD_REQUEST",{message:"Change email is disabled"});let W=J.body.newEmail.toLowerCase();if(W===J.context.session.user.email)throw J.context.logger.error("Email is the same"),new L("BAD_REQUEST",{message:"Email is the same"});if(await J.context.internalAdapter.findUserByEmail(W))throw J.context.logger.error("Email already exists"),new L("UNPROCESSABLE_ENTITY",{message:o.USER_ALREADY_EXISTS_USE_ANOTHER_EMAIL});if(J.context.session.user.emailVerified!==!0&&J.context.options.user.changeEmail.updateEmailWithoutVerification){if(await J.context.internalAdapter.updateUserByEmail(J.context.session.user.email,{email:W}),await I6(J,{session:J.context.session.session,user:{...J.context.session.user,email:W}}),J.context.options.emailVerification?.sendVerificationEmail){let Y=await wJ(J.context.secret,W,void 0,J.context.options.emailVerification?.expiresIn),$=`${J.context.baseURL}/verify-email?token=${Y}&callbackURL=${J.body.callbackURL||"/"}`;await J.context.options.emailVerification.sendVerificationEmail({user:{...J.context.session.user,email:W},url:$,token:Y},J.request)}return J.json({status:!0})}if(J.context.session.user.emailVerified&&(J.context.options.user.changeEmail.sendChangeEmailConfirmation||J.context.options.user.changeEmail.sendChangeEmailVerification)){let Y=await wJ(J.context.secret,J.context.session.user.email,W,J.context.options.emailVerification?.expiresIn,{requestType:"change-email-confirmation"}),$=`${J.context.baseURL}/verify-email?token=${Y}&callbackURL=${J.body.callbackURL||"/"}`,K=J.context.options.user.changeEmail.sendChangeEmailConfirmation||J.context.options.user.changeEmail.sendChangeEmailVerification;if(K)await K({user:J.context.session.user,newEmail:W,url:$,token:Y},J.request);return J.json({status:!0})}if(!J.context.options.emailVerification?.sendVerificationEmail)throw J.context.logger.error("Verification email isn't enabled."),new L("BAD_REQUEST",{message:"Verification email isn't enabled"});let X=await wJ(J.context.secret,J.context.session.user.email,W,J.context.options.emailVerification?.expiresIn,{requestType:"change-email-verification"}),G=`${J.context.baseURL}/verify-email?token=${X}&callbackURL=${J.body.callbackURL||"/"}`;return await J.context.options.emailVerification.sendVerificationEmail({user:{...J.context.session.user,email:W},url:G,token:X},J.request),J.json({status:!0})}),hA=k$((J,W,X)=>{if(Array.isArray(J[W])&&Array.isArray(X))return J[W]=X,!0});function al(J,W){let X={};for(let[G,Y]of Object.entries(J))X[G]=async($)=>{let K=async()=>{let w=await W,H={...$,context:{...w,returned:void 0,responseHeaders:void 0,session:null},path:Y.path,headers:$?.headers?new Headers($?.headers):void 0};return VY(H,async()=>{let{beforeHooks:Z,afterHooks:z}=sl(w),N=await tl(H,Z);if("context"in N&&N.context&&typeof N.context==="object"){let{headers:V,...v}=N.context;if(V)V.forEach((M,O)=>{H.headers.set(O,M)});H=hA(v,H)}else if(N)return $?.asResponse?lW(N,{headers:$?.headers}):$?.returnHeaders?{headers:$?.headers,response:N}:N;H.asResponse=!1,H.returnHeaders=!0,H.returnStatus=!0;let F=await VY(H,()=>Y(H)).catch((V)=>{if(V instanceof L)return{response:V,status:V.statusCode,headers:V.headers?new Headers(V.headers):null};throw V});if(F&&F instanceof Response)return F;H.context.returned=F.response,H.context.responseHeaders=F.headers;let Q=await ol(H,z);if(Q.response)F.response=Q.response;if(F.response instanceof L&&oY(w.logger.level,"debug"))F.response.stack=F.response.errorStack;if(F.response instanceof L&&!$?.asResponse)throw F.response;return $?.asResponse?lW(F.response,{headers:F.headers,status:F.status}):$?.returnHeaders?$?.returnStatus?{headers:F.headers,response:F.response,status:F.status}:{headers:F.headers,response:F.response}:$?.returnStatus?{response:F.response,status:F.status}:F.response})};if(await lF())return K();else return cF(new WeakMap,K)},X[G].path=Y.path,X[G].options=Y.options;return X}async function tl(J,W){let X={};for(let G of W)if(G.matcher(J)){let Y=await G.handler({...J,returnHeaders:!1}).catch(($)=>{if($ instanceof L&&oY(J.context.logger.level,"debug"))$.stack=$.errorStack;throw $});if(Y&&typeof Y==="object"){if("context"in Y&&typeof Y.context==="object"){let{headers:$,...K}=Y.context;if($ instanceof Headers)if(X.headers)$.forEach((w,H)=>{X.headers?.set(H,w)});else X.headers=$;X=hA(K,X);continue}return Y}}return{context:X}}async function ol(J,W){for(let X of W)if(X.matcher(J)){let G=await X.handler(J).catch((Y)=>{if(Y instanceof L){if(oY(J.context.logger.level,"debug"))Y.stack=Y.errorStack;return{response:Y,headers:Y.headers?new Headers(Y.headers):null}}throw Y});if(G.headers)G.headers.forEach((Y,$)=>{if(!J.context.responseHeaders)J.context.responseHeaders=new Headers({[$]:Y});else if($.toLowerCase()==="set-cookie")J.context.responseHeaders.append($,Y);else J.context.responseHeaders.set($,Y)});if(G.response)J.context.returned=G.response}return{response:J.context.returned,headers:J.context.responseHeaders}}function sl(J){let W=J.options.plugins||[],X=[],G=[];if(J.options.hooks?.before)X.push({matcher:()=>!0,handler:J.options.hooks.before});if(J.options.hooks?.after)G.push({matcher:()=>!0,handler:J.options.hooks.after});let Y=W.map((K)=>{if(K.hooks?.before)return K.hooks.before}).filter((K)=>K!==void 0).flat(),$=W.map((K)=>{if(K.hooks?.after)return K.hooks.after}).filter((K)=>K!==void 0).flat();if(Y.length)X.push(...Y);if($.length)G.push(...$);return{beforeHooks:X,afterHooks:G}}function fA(J,W){let X=new Map;J.plugins?.forEach((Y)=>{if(Y.endpoints){for(let[$,K]of Object.entries(Y.endpoints))if(K&&"path"in K){let w=K.path,H=[];if(K.options&&"method"in K.options){if(Array.isArray(K.options.method))H=K.options.method;else if(typeof K.options.method==="string")H=[K.options.method]}if(H.length===0)H=["*"];if(!X.has(w))X.set(w,[]);X.get(w).push({pluginId:Y.id,endpointKey:$,methods:H})}}});let G=[];for(let[Y,$]of X.entries())if($.length>1){let K=new Map,w=!1;for(let H of $)for(let Z of H.methods){if(!K.has(Z))K.set(Z,[]);if(K.get(Z).push(H.pluginId),K.get(Z).length>1)w=!0;if(Z==="*"&&$.length>1)w=!0;else if(Z!=="*"&&K.has("*"))w=!0}if(w){let H=[...new Set($.map((z)=>z.pluginId))],Z=[];for(let[z,N]of K.entries())if(N.length>1||z==="*"&&$.length>1||z!=="*"&&K.has("*"))Z.push(z);G.push({path:Y,plugins:H,conflictingMethods:Z})}}if(G.length>0){let Y=G.map(($)=>`  - "${$.path}" [${$.conflictingMethods.join(", ")}] used by plugins: ${$.plugins.join(", ")}`).join(`
`);W.error(`Endpoint path conflicts detected! Multiple plugins are trying to use the same endpoint paths with conflicting HTTP methods:
${Y}

To resolve this, you can:
	1. Use only one of the conflicting plugins
	2. Configure the plugins to use different paths (if supported)
	3. Ensure plugins use different HTTP methods for the same path
`)}}function UG(J,W){let X=W.plugins?.reduce((Y,$)=>{return{...Y,...$.endpoints}},{})??{},G=W.plugins?.map((Y)=>Y.middlewares?.map(($)=>{let K=async(w)=>{let H=await J;return $.middleware({...w,context:{...H,...w.context}})};return K.options=$.middleware.options,{path:$.path,middleware:K}})).filter((Y)=>Y!==void 0).flat()||[];return{api:al({signInSocial:xl,callbackOAuth:Rl,getSession:MH(),signOut:ll,signUpEmail:cl(),signInEmail:ul,resetPassword:yl,verifyEmail:Il,sendVerificationEmail:Cl,changeEmail:il,changePassword:dl,setPassword:nl,updateUser:pl(),deleteUser:rl,requestPasswordReset:gl,requestPasswordResetCallback:ml,listSessions:QA(),revokeSession:LA,revokeSessions:VA,revokeOtherSessions:DA,linkSocialAccount:Tl,listUserAccounts:Sl,deleteUserCallback:kA,unlinkAccount:ql,refreshToken:Bl,getAccessToken:IA,accountInfo:El,...X,ok:hl,error:kl},J),middlewares:G}}var gA=(J,W)=>{let{api:X,middlewares:G}=UG(J,W),Y=new URL(J.baseURL).pathname;return YT(X,{routerContext:J,openapi:{disabled:!0},basePath:Y,routerMiddleware:[{path:"/**",middleware:Dl},...G],allowedMediaTypes:["application/json"],async onRequest($){let K=J.options.disabledPaths||[],w=new URL($.url).pathname.replace(Y,"");if(K.includes(w))return new Response("Not Found",{status:404});for(let H of J.options.plugins||[])if(H.onRequest){let Z=await H.onRequest($,J);if(Z&&"response"in Z)return Z.response;if(Z&&"request"in Z){let z=await AA(Z.request,J);if(z)return z;return Z.request}}return AA($,J)},async onResponse($){for(let K of J.options.plugins||[])if(K.onResponse){let w=await K.onResponse($,J);if(w)return w.response}return $},onError($){if($ instanceof L&&$.status==="FOUND")return;if(W.onAPIError?.throw)throw $;if(W.onAPIError?.onError){W.onAPIError.onError($,J);return}let K=W.logger?.level,w=K==="error"||K==="warn"||K==="debug"?G6:void 0;if(W.logger?.disabled!==!0){if($&&typeof $==="object"&&"message"in $&&typeof $.message==="string"){if($.message.includes("no column")||$.message.includes("column")||$.message.includes("relation")||$.message.includes("table")||$.message.includes("does not exist")){J.logger?.error($.message);return}}if($ instanceof L){if($.status==="INTERNAL_SERVER_ERROR")J.logger.error($.status,$);w?.error($.message)}else J.logger?.error($&&typeof $==="object"&&"name"in $?$.name:"",$)}}})};DJ();i0();r4();i4();async function mA(J,W){let X=(await W.context.internalAdapter.findAccounts(J))?.find((Y)=>Y.providerId==="credential"),G=X?.password;if(!X||!G||!W.body.password)throw new L("BAD_REQUEST",{message:"No password credential found"});if(!await W.context.password.verify({hash:G,password:W.body.password}))throw new L("BAD_REQUEST",{message:"Invalid password"});return!0}MJ();t0();R4();t0();R0();eJ();IK();function cA(J,W){return{database:W?.database,adapter:W?.adapter,emailVerification:{sendVerificationEmail:!!J.emailVerification?.sendVerificationEmail,sendOnSignUp:!!J.emailVerification?.sendOnSignUp,sendOnSignIn:!!J.emailVerification?.sendOnSignIn,autoSignInAfterVerification:!!J.emailVerification?.autoSignInAfterVerification,expiresIn:J.emailVerification?.expiresIn,onEmailVerification:!!J.emailVerification?.onEmailVerification,afterEmailVerification:!!J.emailVerification?.afterEmailVerification},emailAndPassword:{enabled:!!J.emailAndPassword?.enabled,disableSignUp:!!J.emailAndPassword?.disableSignUp,requireEmailVerification:!!J.emailAndPassword?.requireEmailVerification,maxPasswordLength:J.emailAndPassword?.maxPasswordLength,minPasswordLength:J.emailAndPassword?.minPasswordLength,sendResetPassword:!!J.emailAndPassword?.sendResetPassword,resetPasswordTokenExpiresIn:J.emailAndPassword?.resetPasswordTokenExpiresIn,onPasswordReset:!!J.emailAndPassword?.onPasswordReset,password:{hash:!!J.emailAndPassword?.password?.hash,verify:!!J.emailAndPassword?.password?.verify},autoSignIn:!!J.emailAndPassword?.autoSignIn,revokeSessionsOnPasswordReset:!!J.emailAndPassword?.revokeSessionsOnPasswordReset},socialProviders:Object.keys(J.socialProviders||{}).map((X)=>{let G=J.socialProviders?.[X];if(!G)return{};return{id:X,mapProfileToUser:!!G.mapProfileToUser,disableDefaultScope:!!G.disableDefaultScope,disableIdTokenSignIn:!!G.disableIdTokenSignIn,disableImplicitSignUp:G.disableImplicitSignUp,disableSignUp:G.disableSignUp,getUserInfo:!!G.getUserInfo,overrideUserInfoOnSignIn:!!G.overrideUserInfoOnSignIn,prompt:G.prompt,verifyIdToken:!!G.verifyIdToken,scope:G.scope,refreshAccessToken:!!G.refreshAccessToken}}),plugins:J.plugins?.map((X)=>X.id.toString()),user:{modelName:J.user?.modelName,fields:J.user?.fields,additionalFields:J.user?.additionalFields,changeEmail:{enabled:J.user?.changeEmail?.enabled,sendChangeEmailVerification:!!J.user?.changeEmail?.sendChangeEmailVerification}},verification:{modelName:J.verification?.modelName,disableCleanup:J.verification?.disableCleanup,fields:J.verification?.fields},session:{modelName:J.session?.modelName,additionalFields:J.session?.additionalFields,cookieCache:{enabled:J.session?.cookieCache?.enabled,maxAge:J.session?.cookieCache?.maxAge,strategy:J.session?.cookieCache?.strategy},disableSessionRefresh:J.session?.disableSessionRefresh,expiresIn:J.session?.expiresIn,fields:J.session?.fields,freshAge:J.session?.freshAge,preserveSessionInDatabase:J.session?.preserveSessionInDatabase,storeSessionInDatabase:J.session?.storeSessionInDatabase,updateAge:J.session?.updateAge},account:{modelName:J.account?.modelName,fields:J.account?.fields,encryptOAuthTokens:J.account?.encryptOAuthTokens,updateAccountOnSignIn:J.account?.updateAccountOnSignIn,accountLinking:{enabled:J.account?.accountLinking?.enabled,trustedProviders:J.account?.accountLinking?.trustedProviders,updateUserInfoOnLink:J.account?.accountLinking?.updateUserInfoOnLink,allowUnlinkingAll:J.account?.accountLinking?.allowUnlinkingAll}},hooks:{after:!!J.hooks?.after,before:!!J.hooks?.before},secondaryStorage:!!J.secondaryStorage,advanced:{cookiePrefix:!!J.advanced?.cookiePrefix,cookies:!!J.advanced?.cookies,crossSubDomainCookies:{domain:!!J.advanced?.crossSubDomainCookies?.domain,enabled:J.advanced?.crossSubDomainCookies?.enabled,additionalCookies:J.advanced?.crossSubDomainCookies?.additionalCookies},database:{useNumberId:!!J.advanced?.database?.useNumberId||J.advanced?.database?.generateId==="serial",generateId:J.advanced?.database?.generateId,defaultFindManyLimit:J.advanced?.database?.defaultFindManyLimit},useSecureCookies:J.advanced?.useSecureCookies,ipAddress:{disableIpTracking:J.advanced?.ipAddress?.disableIpTracking,ipAddressHeaders:J.advanced?.ipAddress?.ipAddressHeaders},disableCSRFCheck:J.advanced?.disableCSRFCheck,cookieAttributes:{expires:J.advanced?.defaultCookieAttributes?.expires,secure:J.advanced?.defaultCookieAttributes?.secure,sameSite:J.advanced?.defaultCookieAttributes?.sameSite,domain:!!J.advanced?.defaultCookieAttributes?.domain,path:J.advanced?.defaultCookieAttributes?.path,httpOnly:J.advanced?.defaultCookieAttributes?.httpOnly}},trustedOrigins:J.trustedOrigins?.length,rateLimit:{storage:J.rateLimit?.storage,modelName:J.rateLimit?.modelName,window:J.rateLimit?.window,customStorage:!!J.rateLimit?.customStorage,enabled:J.rateLimit?.enabled,max:J.rateLimit?.max},onAPIError:{errorURL:J.onAPIError?.errorURL,onError:!!J.onAPIError?.onError,throw:J.onAPIError?.throw},logger:{disabled:J.logger?.disabled,level:J.logger?.level,log:!!J.logger?.log},databaseHooks:{user:{create:{after:!!J.databaseHooks?.user?.create?.after,before:!!J.databaseHooks?.user?.create?.before},update:{after:!!J.databaseHooks?.user?.update?.after,before:!!J.databaseHooks?.user?.update?.before}},session:{create:{after:!!J.databaseHooks?.session?.create?.after,before:!!J.databaseHooks?.session?.create?.before},update:{after:!!J.databaseHooks?.session?.update?.after,before:!!J.databaseHooks?.session?.update?.before}},account:{create:{after:!!J.databaseHooks?.account?.create?.after,before:!!J.databaseHooks?.account?.create?.before},update:{after:!!J.databaseHooks?.account?.update?.after,before:!!J.databaseHooks?.account?.update?.before}},verification:{create:{after:!!J.databaseHooks?.verification?.create?.after,before:!!J.databaseHooks?.verification?.create?.before},update:{after:!!J.databaseHooks?.verification?.update?.after,before:!!J.databaseHooks?.verification?.update?.before}}}}}var KX;async function pA(){if(KX)return KX;try{let J=typeof process<"u"&&typeof process.cwd==="function"?process.cwd():"";if(!J)return;let W=($)=>Function("mm","return import(mm)")($),[{default:X},{default:G}]=await Promise.all([W("fs/promises"),W("path")]),Y=await X.readFile(G.join(J,"package.json"),"utf-8");return KX=JSON.parse(Y),KX}catch{}}async function dA(J){if(KX)return KX.dependencies?.[J]||KX.devDependencies?.[J]||KX.peerDependencies?.[J];try{let W=typeof process<"u"&&typeof process.cwd==="function"?process.cwd():"";if(!W)throw Error("no-cwd");let X=(w)=>Function("mm","return import(mm)")(w),[{default:G},{default:Y}]=await Promise.all([X("fs/promises"),X("path")]),$=Y.join(W,"node_modules",J,"package.json"),K=await G.readFile($,"utf-8");return JSON.parse(K).version||await yA(J)||void 0}catch{}return await yA(J)}async function yA(J){let W=await pA();if(!W)return;return{...W.dependencies,...W.devDependencies,...W.peerDependencies}[J]}async function el(){return(await pA())?.name}var Jc={pg:"postgresql",mysql:"mysql",mariadb:"mariadb",sqlite3:"sqlite","better-sqlite3":"sqlite","@prisma/client":"prisma",mongoose:"mongodb",mongodb:"mongodb","drizzle-orm":"drizzle"};async function Wc(){for(let[J,W]of Object.entries(Jc)){let X=await dA(J);if(X)return{name:W,version:X}}}var Xc={next:"next",nuxt:"nuxt","@remix-run/server-runtime":"remix",astro:"astro","@sveltejs/kit":"sveltekit","solid-start":"solid-start","tanstack-start":"tanstack-start",hono:"hono",express:"express",elysia:"elysia",expo:"expo"};async function Yc(){for(let[J,W]of Object.entries(Xc)){let X=await dA(J);if(X)return{name:W,version:X}}}function Gc(){let J=R6.npm_config_user_agent;if(!J)return;let W=J.split(" ")[0],X=W.lastIndexOf("/"),G=W.substring(0,X);return{name:G==="npminstall"?"cnpm":G,version:W.substring(X+1)}}var QG=(J)=>{return Function("mm","return import(mm)")(J)};function K1(){let J=(...W)=>W.some((X)=>Boolean(R6[X]));if(J("CF_PAGES","CF_PAGES_URL","CF_ACCOUNT_ID")||typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers")return"cloudflare";if(J("VERCEL","VERCEL_URL","VERCEL_ENV"))return"vercel";if(J("NETLIFY","NETLIFY_URL"))return"netlify";if(J("RENDER","RENDER_URL","RENDER_INTERNAL_HOSTNAME","RENDER_SERVICE_ID"))return"render";if(J("AWS_LAMBDA_FUNCTION_NAME","AWS_EXECUTION_ENV","LAMBDA_TASK_ROOT"))return"aws";if(J("GOOGLE_CLOUD_FUNCTION_NAME","GOOGLE_CLOUD_PROJECT","GCP_PROJECT","K_SERVICE"))return"gcp";if(J("AZURE_FUNCTION_NAME","FUNCTIONS_WORKER_RUNTIME","WEBSITE_INSTANCE_ID","WEBSITE_SITE_NAME"))return"azure";if(J("DENO_DEPLOYMENT_ID","DENO_REGION"))return"deno-deploy";if(J("FLY_APP_NAME","FLY_REGION","FLY_ALLOC_ID"))return"fly-io";if(J("RAILWAY_STATIC_URL","RAILWAY_ENVIRONMENT_NAME"))return"railway";if(J("DYNO","HEROKU_APP_NAME"))return"heroku";if(J("DO_DEPLOYMENT_ID","DO_APP_NAME","DIGITALOCEAN"))return"digitalocean";if(J("KOYEB","KOYEB_DEPLOYMENT_ID","KOYEB_APP_NAME"))return"koyeb";return null}async function $c(){try{if(K1()==="cloudflare")return"cloudflare";let J=await QG("os"),W=J.cpus();return{deploymentVendor:K1(),systemPlatform:J.platform(),systemRelease:J.release(),systemArchitecture:J.arch(),cpuCount:W.length,cpuModel:W.length?W[0].model:null,cpuSpeed:W.length?W[0].speed:null,memory:J.totalmem(),isWSL:await Hc(),isDocker:await nA(),isTTY:typeof process<"u"&&process.stdout?process.stdout.isTTY:null}}catch(J){return{systemPlatform:null,systemRelease:null,systemArchitecture:null,cpuCount:null,cpuModel:null,cpuSpeed:null,memory:null,isWSL:null,isDocker:null,isTTY:null}}}var Xv;async function Kc(){if(K1()==="cloudflare")return!1;try{return(await QG("fs")).statSync("/.dockerenv"),!0}catch{return!1}}async function wc(){if(K1()==="cloudflare")return!1;try{return(await QG("fs")).readFileSync("/proc/self/cgroup","utf8").includes("docker")}catch{return!1}}async function nA(){if(K1()==="cloudflare")return!1;if(Xv===void 0)Xv=await Kc()||await wc();return Xv}async function Hc(){try{if(K1()==="cloudflare")return!1;if(typeof process>"u"||process?.platform!=="linux")return!1;let J=await QG("fs");if((await QG("os")).release().toLowerCase().includes("microsoft")){if(await xA())return!1;return!0}return J.readFileSync("/proc/version","utf8").toLowerCase().includes("microsoft")?!await xA():!1}catch{return!1}}var Yv,Zc=async()=>{if(K1()==="cloudflare")return!1;try{return(await QG("fs")).statSync("/run/.containerenv"),!0}catch{return!1}};async function xA(){if(Yv===void 0)Yv=await Zc()||await nA();return Yv}function zc(){return R6.CI!=="false"&&(("BUILD_ID"in R6)||("BUILD_NUMBER"in R6)||("CI"in R6)||("CI_APP_ID"in R6)||("CI_BUILD_ID"in R6)||("CI_BUILD_NUMBER"in R6)||("CI_NAME"in R6)||("CONTINUOUS_INTEGRATION"in R6)||("RUN_ID"in R6))}function Fc(){if(typeof Deno<"u")return{name:"deno",version:Deno?.version?.deno??null};if(typeof Bun<"u")return{name:"bun",version:Bun?.version??null};if(typeof process<"u"&&process?.versions?.node)return{name:"node",version:process.versions.node??null};return{name:"edge",version:null}}function Nc(){return u6("NODE_ENV")==="production"?"production":zc()?"ci":oW()?"test":"development"}async function uA(J){let W=await C0("SHA-256").digest(J);return C4.encode(W)}var Uc=(J)=>{return QY("a-z","A-Z","0-9")(J||32)},$X=null;async function lA(J){if($X)return $X;let W=await el();if(W)return $X=await uA(J?J+W:W),$X;if(J)return $X=await uA(J),$X;return $X=Uc(32),$X}async function Gv(J,W){let X=J.telemetry?.debug||d7("BETTER_AUTH_TELEMETRY_DEBUG",!1),G=tV.BETTER_AUTH_TELEMETRY_ENDPOINT,Y=async(H)=>{if(W?.customTrack)await W.customTrack(H).catch(G6.error);else if(X)G6.info("telemetry event",JSON.stringify(H,null,2));else await z6(G,{method:"POST",body:H}).catch(G6.error)},K=await(async()=>{let H=J.telemetry?.enabled!==void 0?J.telemetry.enabled:!1;return(d7("BETTER_AUTH_TELEMETRY",!1)||H)&&(W?.skipTestCheck||!oW())})(),w;if(K)w=await lA(J.baseURL),Y({type:"init",payload:{config:cA(J,W),runtime:Fc(),database:await Wc(),framework:await Yc(),environment:Nc(),systemInfo:await $c(),packageManager:Gc()},anonymousId:w});return{publish:async(H)=>{if(!K)return;if(!w)w=await lA(J.baseURL);await Y({type:H.type,payload:H.payload,anonymousId:w})}}}var rA="better-auth-secret-123456789";function iA(J){return!!J&&(typeof J==="object"||typeof J==="function")&&typeof J.then==="function"}async function Qc(J){let W=J.options,X=W.plugins||[],G=J,Y=[];for(let $ of X)if($.init){let K=$.init(G),w;if(iA(K))w=await K;else w=K;if(typeof w==="object"){if(w.options){let{databaseHooks:H,...Z}=w.options;if(H)Y.push(H);W=jH(W,Z)}if(w.context)G={...G,...w.context}}}return Y.push(W.databaseHooks),G.internalAdapter=DH(G.adapter,{options:W,logger:G.logger,hooks:Y.filter(($)=>$!==void 0),generateId:G.generateId}),G.options=W,{context:G}}function Lc(J){let W=[];if(J.advanced?.crossSubDomainCookies?.enabled);return W}function Vc(J){let W=HG(J.baseURL,J.basePath);if(!W)return[];let X=[new URL(W).origin];if(J.trustedOrigins&&Array.isArray(J.trustedOrigins))X.push(...J.trustedOrigins);let G=R6.BETTER_AUTH_TRUSTED_ORIGINS;if(G)X.push(...G.split(","));if(X.filter((Y)=>!Y).length)throw new W6("A provided trusted origin is invalid, make sure your trusted origins list is properly defined.");return X}async function aA(J,W,X){if(!W.database)W=jH(W,{session:{cookieCache:{enabled:!0,strategy:"jwe",refreshCache:!0}},account:{storeStateStrategy:"cookie",storeAccountCookie:!0}});let G=W.plugins||[],Y=Lc(W),$=sY(W.logger),K=HG(W.baseURL,W.basePath),w=W.secret||R6.BETTER_AUTH_SECRET||R6.AUTH_SECRET||rA;if(w===rA){if(FW)$.error("You are using the default secret. Please set `BETTER_AUTH_SECRET` in your environment variables or pass `secret` in your auth config.")}W={...W,secret:w,baseURL:K?new URL(K).origin:"",basePath:W.basePath||"/api/auth",plugins:G.concat(Y)},fA(W,$);let H=FA(W),Z=Z8(W),z=Object.entries(W.socialProviders||{}).map(([v,M])=>{if(M==null)return null;if(M.enabled===!1)return null;if(!M.clientId)$.warn(`Social provider ${v} is missing clientId or clientSecret`);let O=aD[v](M);return O.disableImplicitSignUp=M.disableImplicitSignUp,O}).filter((v)=>v!==null),N=({model:v,size:M})=>{if(typeof W.advanced?.generateId==="function")return W.advanced.generateId({model:v,size:M});if(typeof W?.advanced?.database?.generateId==="function")return W.advanced.database.generateId({model:v,size:M});return f4(M)},{publish:F}=await Gv(W,{adapter:J.id,database:typeof W.database==="function"?"adapter":X(W.database)}),Q=Qc({appName:W.appName||"Better Auth",socialProviders:z,options:W,oauthConfig:{storeStateStrategy:W.account?.storeStateStrategy||"database",skipStateCookieCheck:!!W.account?.skipStateCookieCheck},tables:Z,trustedOrigins:Vc(W),baseURL:K||"",sessionConfig:{updateAge:W.session?.updateAge!==void 0?W.session.updateAge:86400,expiresIn:W.session?.expiresIn||604800,freshAge:W.session?.freshAge===void 0?86400:W.session.freshAge,cookieRefreshCache:(()=>{let v=W.session?.cookieCache?.refreshCache,M=W.session?.cookieCache?.maxAge||300;if(v===!1||v===void 0)return!1;if(v===!0)return{enabled:!0,updateAge:Math.floor(M*0.2)};return{enabled:!0,updateAge:v.updateAge!==void 0?v.updateAge:Math.floor(M*0.2)}})()},secret:w,rateLimit:{...W.rateLimit,enabled:W.rateLimit?.enabled??FW,window:W.rateLimit?.window||10,max:W.rateLimit?.max||100,storage:W.rateLimit?.storage||(W.secondaryStorage?"secondary-storage":"memory")},authCookies:H,logger:$,generateId:N,session:null,secondaryStorage:W.secondaryStorage,password:{hash:W.emailAndPassword?.password?.hash||DS,verify:W.emailAndPassword?.password?.verify||vS,config:{minPasswordLength:W.emailAndPassword?.minPasswordLength||8,maxPasswordLength:W.emailAndPassword?.maxPasswordLength||128},checkPassword:mA},setNewSession(v){this.newSession=v},newSession:null,adapter:J,internalAdapter:DH(J,{options:W,logger:$,hooks:W.databaseHooks?[W.databaseHooks]:[],generateId:N}),createAuthCookie:rD(W),async runMigrations(){throw new W6("runMigrations will be set by the specific init implementation")},publishTelemetry:F,skipCSRFCheck:!!W.advanced?.disableCSRFCheck,skipOriginCheck:W.advanced?.disableOriginCheck!==void 0?W.advanced.disableOriginCheck:oW()?!0:!1}),V;if(iA(Q))({context:V}=await Q);else({context:V}=Q);return V}var tA=(J,W)=>{let X=W(J),{api:G}=UG(X,J);return{handler:async(Y)=>{let $=await X,K=$.options.basePath||"/api/auth";if(!$.options.baseURL){let H=HG(void 0,K,Y);if(H)$.baseURL=H,$.options.baseURL=hJ($.baseURL)||void 0;else throw new W6("Could not get base URL from request. Please provide a valid base URL.")}$.trustedOrigins=[...J.trustedOrigins?Array.isArray(J.trustedOrigins)?J.trustedOrigins:await J.trustedOrigins(Y):[],$.options.baseURL];let{handler:w}=gA($,J);return nF($.adapter,()=>w(Y))},api:G,options:J,$context:X,$ERROR_CODES:{...J.plugins?.reduce((Y,$)=>{if($.$ERROR_CODES)return{...Y,...$.$ERROR_CODES};return Y},{}),...o}}};RX();R4();var Dc=async(J)=>{let W=await mD(J),G=await aA(W,J,(Y)=>wY(Y)||"unknown");return G.runMigrations=async function(){if(!J.database||"updateMany"in J.database)throw new W6("Database is not provided or it's an adapter. Migrations are only supported with a database instance.");let{runMigrations:Y}=await A$(J);await Y()},G},$v=(J)=>{return tA(J,Dc)};MJ();t0();R4();v9();RX();DJ();i0();r4();UW();wG();O8();var vc={proto:/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,constructor:/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,protoShort:/"__proto__"\s*:/,constructorShort:/"constructor"\s*:/},Mc=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/,oA={true:!0,false:!1,null:null,undefined:void 0,nan:NaN,infinity:Number.POSITIVE_INFINITY,"-infinity":Number.NEGATIVE_INFINITY},Oc=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d{1,7}))?(?:Z|([+-])(\d{2}):(\d{2}))$/;function Pc(J){return J instanceof Date&&!isNaN(J.getTime())}function jc(J){let W=Oc.exec(J);if(!W)return null;let[,X,G,Y,$,K,w,H,Z,z,N]=W,F=new Date(Date.UTC(parseInt(X,10),parseInt(G,10)-1,parseInt(Y,10),parseInt($,10),parseInt(K,10),parseInt(w,10),H?parseInt(H.padEnd(3,"0"),10):0));if(Z){let Q=(parseInt(z,10)*60+parseInt(N,10))*(Z==="+"?-1:1);F.setUTCMinutes(F.getUTCMinutes()+Q)}return Pc(F)?F:null}function _c(J,W={}){let{strict:X=!1,warnings:G=!1,reviver:Y,parseDates:$=!0}=W;if(typeof J!=="string")return J;let K=J.trim();if(K.length>0&&K[0]==='"'&&K.endsWith('"')&&!K.slice(1,-1).includes('"'))return K.slice(1,-1);let w=K.toLowerCase();if(w.length<=9&&w in oA)return oA[w];if(!Mc.test(K)){if(X)throw SyntaxError("[better-json] Invalid JSON");return J}if(Object.entries(vc).some(([H,Z])=>{let z=Z.test(K);if(z&&G)console.warn(`[better-json] Detected potential prototype pollution attempt using ${H} pattern`);return z})&&X)throw Error("[better-json] Potential prototype pollution attempt detected");try{return JSON.parse(K,(Z,z)=>{if(Z==="__proto__"||Z==="constructor"&&z&&typeof z==="object"&&"prototype"in z){if(G)console.warn(`[better-json] Dropping "${Z}" key to prevent prototype pollution`);return}if($&&typeof z==="string"){let N=jc(z);if(N)return N}return Y?Y(Z,z):z})}catch(H){if(X)throw H;return J}}function sA(J,W={strict:!0}){return _c(J,W)}var _H=sA;R4();function g$(J){return{authorize(W,X="AND"){let G=!1;for(let[Y,$]of Object.entries(W)){let K=J[Y];if(!K)return{success:!1,error:`You are not allowed to access resource: ${Y}`};if(Array.isArray($))G=$.every((w)=>K.includes(w));else if(typeof $==="object"){let w=$;if(w.connector==="OR")G=w.actions.some((H)=>K.includes(H));else G=w.actions.every((H)=>K.includes(H))}else throw new W6("Invalid access control request");if(G&&X==="OR")return{success:G};if(!G&&X==="AND")return{success:!1,error:`unauthorized to access resource "${Y}"`}}if(G)return{success:G};return{success:!1,error:"Not authorized"}},statements:J}}function wX(J){return{newRole(W){return g$(W)},statements:J}}var Sc={user:["create","list","set-role","ban","impersonate","delete","set-password","get","update"],session:["list","revoke","delete"]},eA=wX(Sc),Tc=eA.newRole({user:["create","list","set-role","ban","impersonate","delete","set-password","get","update"],session:["list","revoke","delete"]}),qc=eA.newRole({user:[],session:[]}),JE={admin:Tc,user:qc};var g0=(J)=>{if(J.userId&&J.options?.adminUserIds?.includes(J.userId))return!0;if(!J.permissions&&!J.permission)return!1;let W=(J.role||J.options?.defaultRole||"user").split(","),X=J.options?.roles||JE;for(let G of W)if(X[G]?.authorize(J.permission??J.permissions)?.success)return!0;return!1};var SH={organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"],team:["create","update","delete"],ac:["create","read","update","delete"]},TH=wX(SH),LG=TH.newRole({organization:["update"],invitation:["create","cancel"],member:["create","update","delete"],team:["create","update","delete"],ac:["create","read","update","delete"]}),WE=TH.newRole({organization:["update","delete"],member:["create","update","delete"],invitation:["create","cancel"],team:["create","update","delete"],ac:["create","read","update","delete"]}),XE=TH.newRole({organization:[],member:[],invitation:[],team:[],ac:["read"]}),qH={admin:LG,owner:WE,member:XE};var YE=(J,W)=>{if(!J.permissions&&!J.permission)return!1;let X=J.role.split(","),G=J.options.creatorRole||"owner",Y=X.includes(G),$=J.allowCreatorAllPermissions||!1;if(Y&&$)return!0;for(let K of X)if(W[K]?.authorize(J.permissions??J.permission)?.success)return!0;return!1},Kv=new Map;i4();var BH=async(J)=>{let W=J.context.returned;if(!W)return null;if(W instanceof Response){if(W.status!==200)return null;return await W.clone().json()}if(W instanceof L)return null;return W};R4();O0();var h4=p6({FAILED_TO_CREATE_USER:"Failed to create user",USER_ALREADY_EXISTS:"User already exists.",USER_ALREADY_EXISTS_USE_ANOTHER_EMAIL:"User already exists. Use another email.",YOU_CANNOT_BAN_YOURSELF:"You cannot ban yourself",YOU_ARE_NOT_ALLOWED_TO_CHANGE_USERS_ROLE:"You are not allowed to change users role",YOU_ARE_NOT_ALLOWED_TO_CREATE_USERS:"You are not allowed to create users",YOU_ARE_NOT_ALLOWED_TO_LIST_USERS:"You are not allowed to list users",YOU_ARE_NOT_ALLOWED_TO_LIST_USERS_SESSIONS:"You are not allowed to list users sessions",YOU_ARE_NOT_ALLOWED_TO_BAN_USERS:"You are not allowed to ban users",YOU_ARE_NOT_ALLOWED_TO_IMPERSONATE_USERS:"You are not allowed to impersonate users",YOU_ARE_NOT_ALLOWED_TO_REVOKE_USERS_SESSIONS:"You are not allowed to revoke users sessions",YOU_ARE_NOT_ALLOWED_TO_DELETE_USERS:"You are not allowed to delete users",YOU_ARE_NOT_ALLOWED_TO_SET_USERS_PASSWORD:"You are not allowed to set users password",BANNED_USER:"You have been banned from this application",YOU_ARE_NOT_ALLOWED_TO_GET_USER:"You are not allowed to get user",NO_DATA_TO_UPDATE:"No data to update",YOU_ARE_NOT_ALLOWED_TO_UPDATE_USERS:"You are not allowed to update users",YOU_CANNOT_REMOVE_YOURSELF:"You cannot remove yourself",YOU_ARE_NOT_ALLOWED_TO_SET_NON_EXISTENT_VALUE:"You are not allowed to set a non-existent role value"}),Bc={user:{fields:{role:{type:"string",required:!1,input:!1},banned:{type:"boolean",defaultValue:!1,required:!1,input:!1},banReason:{type:"string",required:!1,input:!1},banExpires:{type:"date",required:!1,input:!1}}},session:{fields:{impersonatedBy:{type:"string",required:!1}}}};function wv(J){return Array.isArray(J)?J.join(","):J}var Hv=(J)=>{let W={defaultRole:J?.defaultRole??"user",adminRoles:J?.adminRoles??["admin"],bannedUserMessage:J?.bannedUserMessage??"You have been banned from this application. Please contact support if you believe this is an error.",...J},X=x6(async(G)=>{let Y=await P6(G);if(!Y)throw new L("UNAUTHORIZED");return{session:Y}});return{id:"admin",init(){return{options:{databaseHooks:{user:{create:{async before(G){return{data:{role:J?.defaultRole??"user",...G}}}}},session:{create:{async before(G,Y){if(!Y)return;let $=await Y.context.internalAdapter.findUserById(G.userId);if($.banned){if($.banExpires&&new Date($.banExpires).getTime()<Date.now()){await Y.context.internalAdapter.updateUser(G.userId,{banned:!1,banReason:null,banExpires:null});return}if(Y&&(Y.path.startsWith("/callback")||Y.path.startsWith("/oauth2/callback"))){let K=Y.context.options.onAPIError?.errorURL||`${Y.context.baseURL}/error`;throw Y.redirect(`${K}?error=banned&error_description=${W.bannedUserMessage}`)}throw new L("FORBIDDEN",{message:W.bannedUserMessage,code:"BANNED_USER"})}}}}}}}},hooks:{after:[{matcher(G){return G.path==="/list-sessions"},handler:x6(async(G)=>{let Y=await BH(G);if(!Y)return;let $=Y.filter((K)=>{return!K.impersonatedBy});return G.json($)})}]},endpoints:{setRole:y("/admin/set-role",{method:"POST",body:x({userId:m6.string().meta({description:"The user id"}),role:a4([P().meta({description:"The role to set. `admin` or `user` by default"}),v6(P().meta({description:"The roles to set. `admin` or `user` by default"}))]).meta({description:"The role to set, this can be a string or an array of strings. Eg: `admin` or `[admin, user]`"})}),requireHeaders:!0,use:[X],metadata:{openapi:{operationId:"setUserRole",summary:"Set the role of a user",description:"Set the role of a user",responses:{200:{description:"User role updated",content:{"application/json":{schema:{type:"object",properties:{user:{$ref:"#/components/schemas/User"}}}}}}}},$Infer:{body:{}}}},async(G)=>{if(!g0({userId:G.context.session.user.id,role:G.context.session.user.role,options:W,permissions:{user:["set-role"]}}))throw new L("FORBIDDEN",{message:h4.YOU_ARE_NOT_ALLOWED_TO_CHANGE_USERS_ROLE});let Y=W.roles;if(Y){let K=Array.isArray(G.body.role)?G.body.role:[G.body.role];for(let w of K)if(!Y[w])throw new L("BAD_REQUEST",{message:h4.YOU_ARE_NOT_ALLOWED_TO_SET_NON_EXISTENT_VALUE})}let $=await G.context.internalAdapter.updateUser(G.body.userId,{role:wv(G.body.role)});return G.json({user:$})}),getUser:y("/admin/get-user",{method:"GET",query:x({id:P().meta({description:"The id of the User"})}),use:[X],metadata:{openapi:{operationId:"getUser",summary:"Get an existing user",description:"Get an existing user",responses:{200:{description:"User",content:{"application/json":{schema:{type:"object",properties:{user:{$ref:"#/components/schemas/User"}}}}}}}}}},async(G)=>{let{id:Y}=G.query;if(!g0({userId:G.context.session.user.id,role:G.context.session.user.role,options:W,permissions:{user:["get"]}}))throw G.error("FORBIDDEN",{message:h4.YOU_ARE_NOT_ALLOWED_TO_GET_USER,code:"YOU_ARE_NOT_ALLOWED_TO_GET_USER"});let $=await G.context.internalAdapter.findUserById(Y);if(!$)throw new L("NOT_FOUND",{message:o.USER_NOT_FOUND});return v8(G.context.options,$)}),createUser:y("/admin/create-user",{method:"POST",body:x({email:P().meta({description:"The email of the user"}),password:P().meta({description:"The password of the user"}),name:P().meta({description:"The name of the user"}),role:a4([P().meta({description:"The role of the user"}),v6(P().meta({description:"The roles of user"}))]).optional().meta({description:'A string or array of strings representing the roles to apply to the new user. Eg: "user"'}),data:_6(P(),E6()).optional().meta({description:"Extra fields for the user. Including custom additional fields."})}),metadata:{openapi:{operationId:"createUser",summary:"Create a new user",description:"Create a new user",responses:{200:{description:"User created",content:{"application/json":{schema:{type:"object",properties:{user:{$ref:"#/components/schemas/User"}}}}}}}},$Infer:{body:{}}}},async(G)=>{let Y=await P6(G);if(!Y&&(G.request||G.headers))throw G.error("UNAUTHORIZED");if(Y){if(!g0({userId:Y.user.id,role:Y.user.role,options:W,permissions:{user:["create"]}}))throw new L("FORBIDDEN",{message:h4.YOU_ARE_NOT_ALLOWED_TO_CREATE_USERS})}let $=G.body.email.toLowerCase();if(!D8().safeParse($).success)throw new L("BAD_REQUEST",{message:o.INVALID_EMAIL});if(await G.context.internalAdapter.findUserByEmail($))throw new L("BAD_REQUEST",{message:h4.USER_ALREADY_EXISTS_USE_ANOTHER_EMAIL});let K=await G.context.internalAdapter.createUser({email:$,name:G.body.name,role:(G.body.role&&wv(G.body.role))??J?.defaultRole??"user",...G.body.data});if(!K)throw new L("INTERNAL_SERVER_ERROR",{message:h4.FAILED_TO_CREATE_USER});let w=await G.context.password.hash(G.body.password);return await G.context.internalAdapter.linkAccount({accountId:K.id,providerId:"credential",password:w,userId:K.id}),G.json({user:K})}),adminUpdateUser:y("/admin/update-user",{method:"POST",body:x({userId:m6.string().meta({description:"The user id"}),data:_6(E6(),E6()).meta({description:"The user data to update"})}),use:[X],metadata:{openapi:{operationId:"updateUser",summary:"Update a user",description:"Update a user's details",responses:{200:{description:"User updated",content:{"application/json":{schema:{type:"object",properties:{user:{$ref:"#/components/schemas/User"}}}}}}}}}},async(G)=>{if(!g0({userId:G.context.session.user.id,role:G.context.session.user.role,options:W,permissions:{user:["update"]}}))throw G.error("FORBIDDEN",{message:h4.YOU_ARE_NOT_ALLOWED_TO_UPDATE_USERS,code:"YOU_ARE_NOT_ALLOWED_TO_UPDATE_USERS"});if(Object.keys(G.body.data).length===0)throw new L("BAD_REQUEST",{message:h4.NO_DATA_TO_UPDATE});if(G.body.data?.role)G.body.data.role=wv(G.body.data.role);let Y=await G.context.internalAdapter.updateUser(G.body.userId,G.body.data);return G.json(Y)}),listUsers:y("/admin/list-users",{method:"GET",use:[X],query:x({searchValue:P().optional().meta({description:'The value to search for. Eg: "some name"'}),searchField:H4(["email","name"]).meta({description:'The field to search in, defaults to email. Can be `email` or `name`. Eg: "name"'}).optional(),searchOperator:H4(["contains","starts_with","ends_with"]).meta({description:'The operator to use for the search. Can be `contains`, `starts_with` or `ends_with`. Eg: "contains"'}).optional(),limit:P().meta({description:"The number of users to return"}).or(O6()).optional(),offset:P().meta({description:"The offset to start from"}).or(O6()).optional(),sortBy:P().meta({description:"The field to sort by"}).optional(),sortDirection:H4(["asc","desc"]).meta({description:"The direction to sort by"}).optional(),filterField:P().meta({description:"The field to filter by"}).optional(),filterValue:P().meta({description:"The value to filter by"}).or(O6()).or(d6()).optional(),filterOperator:H4(["eq","ne","lt","lte","gt","gte","contains"]).meta({description:"The operator to use for the filter"}).optional()}),metadata:{openapi:{operationId:"listUsers",summary:"List users",description:"List users",responses:{200:{description:"List of users",content:{"application/json":{schema:{type:"object",properties:{users:{type:"array",items:{$ref:"#/components/schemas/User"}},total:{type:"number"},limit:{type:"number"},offset:{type:"number"}},required:["users","total"]}}}}}}}},async(G)=>{let Y=G.context.session;if(!g0({userId:G.context.session.user.id,role:Y.user.role,options:W,permissions:{user:["list"]}}))throw new L("FORBIDDEN",{message:h4.YOU_ARE_NOT_ALLOWED_TO_LIST_USERS});let $=[];if(G.query?.searchValue)$.push({field:G.query.searchField||"email",operator:G.query.searchOperator||"contains",value:G.query.searchValue});if(G.query?.filterValue)$.push({field:G.query.filterField||"email",operator:G.query.filterOperator||"eq",value:G.query.filterValue});try{let K=await G.context.internalAdapter.listUsers(Number(G.query?.limit)||void 0,Number(G.query?.offset)||void 0,G.query?.sortBy?{field:G.query.sortBy,direction:G.query.sortDirection||"asc"}:void 0,$.length?$:void 0),w=await G.context.internalAdapter.countTotalUsers($.length?$:void 0);return G.json({users:K,total:w,limit:Number(G.query?.limit)||void 0,offset:Number(G.query?.offset)||void 0})}catch(K){return G.json({users:[],total:0})}}),listUserSessions:y("/admin/list-user-sessions",{method:"POST",use:[X],body:x({userId:m6.string().meta({description:"The user id"})}),metadata:{openapi:{operationId:"listUserSessions",summary:"List user sessions",description:"List user sessions",responses:{200:{description:"List of user sessions",content:{"application/json":{schema:{type:"object",properties:{sessions:{type:"array",items:{$ref:"#/components/schemas/Session"}}}}}}}}}}},async(G)=>{let Y=G.context.session;if(!g0({userId:G.context.session.user.id,role:Y.user.role,options:W,permissions:{session:["list"]}}))throw new L("FORBIDDEN",{message:h4.YOU_ARE_NOT_ALLOWED_TO_LIST_USERS_SESSIONS});return{sessions:await G.context.internalAdapter.listSessions(G.body.userId)}}),unbanUser:y("/admin/unban-user",{method:"POST",body:x({userId:m6.string().meta({description:"The user id"})}),use:[X],metadata:{openapi:{operationId:"unbanUser",summary:"Unban a user",description:"Unban a user",responses:{200:{description:"User unbanned",content:{"application/json":{schema:{type:"object",properties:{user:{$ref:"#/components/schemas/User"}}}}}}}}}},async(G)=>{let Y=G.context.session;if(!g0({userId:G.context.session.user.id,role:Y.user.role,options:W,permissions:{user:["ban"]}}))throw new L("FORBIDDEN",{message:h4.YOU_ARE_NOT_ALLOWED_TO_BAN_USERS});let $=await G.context.internalAdapter.updateUser(G.body.userId,{banned:!1,banExpires:null,banReason:null,updatedAt:new Date});return G.json({user:$})}),banUser:y("/admin/ban-user",{method:"POST",body:x({userId:m6.string().meta({description:"The user id"}),banReason:P().meta({description:"The reason for the ban"}).optional(),banExpiresIn:O6().meta({description:"The number of seconds until the ban expires"}).optional()}),use:[X],metadata:{openapi:{operationId:"banUser",summary:"Ban a user",description:"Ban a user",responses:{200:{description:"User banned",content:{"application/json":{schema:{type:"object",properties:{user:{$ref:"#/components/schemas/User"}}}}}}}}}},async(G)=>{let Y=G.context.session;if(!g0({userId:G.context.session.user.id,role:Y.user.role,options:W,permissions:{user:["ban"]}}))throw new L("FORBIDDEN",{message:h4.YOU_ARE_NOT_ALLOWED_TO_BAN_USERS});if(!await G.context.internalAdapter.findUserById(G.body.userId))throw new L("NOT_FOUND",{message:o.USER_NOT_FOUND});if(G.body.userId===G.context.session.user.id)throw new L("BAD_REQUEST",{message:h4.YOU_CANNOT_BAN_YOURSELF});let $=await G.context.internalAdapter.updateUser(G.body.userId,{banned:!0,banReason:G.body.banReason||J?.defaultBanReason||"No reason",banExpires:G.body.banExpiresIn?F4(G.body.banExpiresIn,"sec"):J?.defaultBanExpiresIn?F4(J.defaultBanExpiresIn,"sec"):void 0,updatedAt:new Date});return await G.context.internalAdapter.deleteSessions(G.body.userId),G.json({user:$})}),impersonateUser:y("/admin/impersonate-user",{method:"POST",body:x({userId:m6.string().meta({description:"The user id"})}),use:[X],metadata:{openapi:{operationId:"impersonateUser",summary:"Impersonate a user",description:"Impersonate a user",responses:{200:{description:"Impersonation session created",content:{"application/json":{schema:{type:"object",properties:{session:{$ref:"#/components/schemas/Session"},user:{$ref:"#/components/schemas/User"}}}}}}}}}},async(G)=>{if(!g0({userId:G.context.session.user.id,role:G.context.session.user.role,options:W,permissions:{user:["impersonate"]}}))throw new L("FORBIDDEN",{message:h4.YOU_ARE_NOT_ALLOWED_TO_IMPERSONATE_USERS});let Y=await G.context.internalAdapter.findUserById(G.body.userId);if(!Y)throw new L("NOT_FOUND",{message:"User not found"});let $=await G.context.internalAdapter.createSession(Y.id,!0,{impersonatedBy:G.context.session.user.id,expiresAt:J?.impersonationSessionDuration?F4(J.impersonationSessionDuration,"sec"):F4(3600,"sec")},!0);if(!$)throw new L("INTERNAL_SERVER_ERROR",{message:h4.FAILED_TO_CREATE_USER});let K=G.context.authCookies;KJ(G);let w=await G.getSignedCookie(G.context.authCookies.dontRememberToken.name,G.context.secret),H=G.context.createAuthCookie("admin_session");return await G.setSignedCookie(H.name,`${G.context.session.session.token}:${w||""}`,G.context.secret,K.sessionToken.options),await I6(G,{session:$,user:Y},!0),G.json({session:$,user:Y})}),stopImpersonating:y("/admin/stop-impersonating",{method:"POST",requireHeaders:!0},async(G)=>{let Y=await P6(G);if(!Y)throw new L("UNAUTHORIZED");if(!Y.session.impersonatedBy)throw new L("BAD_REQUEST",{message:"You are not impersonating anyone"});let $=await G.context.internalAdapter.findUserById(Y.session.impersonatedBy);if(!$)throw new L("INTERNAL_SERVER_ERROR",{message:"Failed to find user"});let K=G.context.createAuthCookie("admin_session").name,w=await G.getSignedCookie(K,G.context.secret);if(!w)throw new L("INTERNAL_SERVER_ERROR",{message:"Failed to find admin session"});let[H,Z]=w?.split(":"),z=await G.context.internalAdapter.findSession(H);if(!z||z.session.userId!==$.id)throw new L("INTERNAL_SERVER_ERROR",{message:"Failed to find admin session"});return await G.context.internalAdapter.deleteSession(Y.session.token),await I6(G,z,!!Z),G.json(z)}),revokeUserSession:y("/admin/revoke-user-session",{method:"POST",body:x({sessionToken:P().meta({description:"The session token"})}),use:[X],metadata:{openapi:{operationId:"revokeUserSession",summary:"Revoke a user session",description:"Revoke a user session",responses:{200:{description:"Session revoked",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean"}}}}}}}}}},async(G)=>{let Y=G.context.session;if(!g0({userId:G.context.session.user.id,role:Y.user.role,options:W,permissions:{session:["revoke"]}}))throw new L("FORBIDDEN",{message:h4.YOU_ARE_NOT_ALLOWED_TO_REVOKE_USERS_SESSIONS});return await G.context.internalAdapter.deleteSession(G.body.sessionToken),G.json({success:!0})}),revokeUserSessions:y("/admin/revoke-user-sessions",{method:"POST",body:x({userId:m6.string().meta({description:"The user id"})}),use:[X],metadata:{openapi:{operationId:"revokeUserSessions",summary:"Revoke all user sessions",description:"Revoke all user sessions",responses:{200:{description:"Sessions revoked",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean"}}}}}}}}}},async(G)=>{let Y=G.context.session;if(!g0({userId:G.context.session.user.id,role:Y.user.role,options:W,permissions:{session:["revoke"]}}))throw new L("FORBIDDEN",{message:h4.YOU_ARE_NOT_ALLOWED_TO_REVOKE_USERS_SESSIONS});return await G.context.internalAdapter.deleteSessions(G.body.userId),G.json({success:!0})}),removeUser:y("/admin/remove-user",{method:"POST",body:x({userId:m6.string().meta({description:"The user id"})}),use:[X],metadata:{openapi:{operationId:"removeUser",summary:"Remove a user",description:"Delete a user and all their sessions and accounts. Cannot be undone.",responses:{200:{description:"User removed",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean"}}}}}}}}}},async(G)=>{let Y=G.context.session;if(!g0({userId:G.context.session.user.id,role:Y.user.role,options:W,permissions:{user:["delete"]}}))throw new L("FORBIDDEN",{message:h4.YOU_ARE_NOT_ALLOWED_TO_DELETE_USERS});if(G.body.userId===G.context.session.user.id)throw new L("BAD_REQUEST",{message:h4.YOU_CANNOT_REMOVE_YOURSELF});if(!await G.context.internalAdapter.findUserById(G.body.userId))throw new L("NOT_FOUND",{message:"User not found"});return await G.context.internalAdapter.deleteUser(G.body.userId),G.json({success:!0})}),setUserPassword:y("/admin/set-user-password",{method:"POST",body:x({newPassword:P().nonempty("newPassword cannot be empty").meta({description:"The new password"}),userId:m6.string().nonempty("userId cannot be empty").meta({description:"The user id"})}),use:[X],metadata:{openapi:{operationId:"setUserPassword",summary:"Set a user's password",description:"Set a user's password",responses:{200:{description:"Password set",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean"}}}}}}}}}},async(G)=>{if(!g0({userId:G.context.session.user.id,role:G.context.session.user.role,options:W,permissions:{user:["set-password"]}}))throw new L("FORBIDDEN",{message:h4.YOU_ARE_NOT_ALLOWED_TO_SET_USERS_PASSWORD});let{newPassword:Y,userId:$}=G.body,K=G.context.password.config.minPasswordLength;if(Y.length<K)throw G.context.logger.error("Password is too short"),new L("BAD_REQUEST",{message:o.PASSWORD_TOO_SHORT});let w=G.context.password.config.maxPasswordLength;if(Y.length>w)throw G.context.logger.error("Password is too long"),new L("BAD_REQUEST",{message:o.PASSWORD_TOO_LONG});let H=await G.context.password.hash(Y);return await G.context.internalAdapter.updatePassword($,H),G.json({status:!0})}),userHasPermission:y("/admin/has-permission",{method:"POST",body:x({userId:m6.string().optional().meta({description:'The user id. Eg: "user-id"'}),role:P().optional().meta({description:'The role to check permission for. Eg: "admin"'})}).and(a4([x({permission:_6(P(),v6(P())),permissions:tW()}),x({permission:tW(),permissions:_6(P(),v6(P()))})])),metadata:{openapi:{description:"Check if the user has permission",requestBody:{content:{"application/json":{schema:{type:"object",properties:{permission:{type:"object",description:"The permission to check",deprecated:!0},permissions:{type:"object",description:"The permission to check"}},required:["permissions"]}}}},responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{error:{type:"string"},success:{type:"boolean"}},required:["success"]}}}}}},$Infer:{body:{}}}},async(G)=>{if(!G.body?.permission&&!G.body?.permissions)throw new L("BAD_REQUEST",{message:"invalid permission check. no permission(s) were passed."});let Y=await P6(G);if(!Y&&(G.request||G.headers))throw new L("UNAUTHORIZED");if(!Y&&!G.body.userId&&!G.body.role)throw new L("BAD_REQUEST",{message:"user id or role is required"});let $=Y?.user||(G.body.role?{id:G.body.userId||"",role:G.body.role}:null)||await G.context.internalAdapter.findUserById(G.body.userId);if(!$)throw new L("BAD_REQUEST",{message:"user not found"});let K=g0({userId:$.id,role:$.role,options:J,permissions:G.body.permissions??G.body.permission});return G.json({error:null,success:K})})},$ERROR_CODES:h4,schema:a0(Bc,W.schema),options:J}};i0();var xv6=p6({INVALID_EMAIL_FORMAT:"Email was not generated in a valid format",FAILED_TO_CREATE_USER:"Failed to create user",COULD_NOT_CREATE_SESSION:"Could not create session",ANONYMOUS_USERS_CANNOT_SIGN_IN_AGAIN_ANONYMOUSLY:"Anonymous users cannot sign in again anonymously"});i0();r4();O8();r4();r4();MJ();R4();eX();R0();IX();var Zv=(J,W)=>{return{getAllKeys:async(X)=>{if(W?.adapter?.getJwks)return await W.adapter.getJwks(X);return await J.findMany({model:"jwks"})},getLatestKey:async(X)=>{if(W?.adapter?.getJwks)return(await W.adapter.getJwks(X))?.sort((G,Y)=>Y.createdAt.getTime()-G.createdAt.getTime())[0];return(await J.findMany({model:"jwks"}))?.sort((G,Y)=>Y.createdAt.getTime()-G.createdAt.getTime())[0]},createJwk:async(X,G)=>{if(W?.adapter?.createJwk)return await W.adapter.createJwk(G,X);return await J.create({model:"jwks",data:{...G,createdAt:new Date}})}}};var GE=60,$E=GE*60,zv=$E*24,Ac=zv*7,Ec=zv*365.25,Rc=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i;function Cc(J){let W=Rc.exec(J);if(!W||W[4]&&W[1])throw TypeError("Invalid time period format");let X=parseFloat(W[2]),G=W[3].toLowerCase(),Y;switch(G){case"sec":case"secs":case"second":case"seconds":case"s":Y=Math.round(X);break;case"minute":case"minutes":case"min":case"mins":case"m":Y=Math.round(X*GE);break;case"hour":case"hours":case"hr":case"hrs":case"h":Y=Math.round(X*$E);break;case"day":case"days":case"d":Y=Math.round(X*zv);break;case"week":case"weeks":case"w":Y=Math.round(X*Ac);break;default:Y=Math.round(X*Ec);break}if(W[1]==="-"||W[4]==="ago")return-Y;return Y}function Ic(J,W){if(typeof J==="number")return J;else if(J instanceof Date)return Math.floor(J.getTime()/1000);else return W+Cc(J)}async function KE(J){let{alg:W,...X}=J?.jwks?.keyPairConfig??{alg:"EdDSA",crv:"Ed25519"},{publicKey:G,privateKey:Y}=await ID(W,{...X,extractable:!0});return{publicWebKey:await XX(G),privateWebKey:await XX(Y),alg:W,cfg:X}}async function wE(J,W){let{publicWebKey:X,privateWebKey:G,alg:Y,cfg:$}=await KE(W),K=JSON.stringify(G),w=!W?.jwks?.disablePrivateKeyEncryption,H={alg:Y,...$&&"crv"in $?{crv:$.crv}:{},publicKey:JSON.stringify(X),privateKey:w?JSON.stringify(await JJ({key:J.context.secret,data:K})):K,createdAt:new Date,...W?.jwks?.rotationInterval?{expiresAt:new Date(Date.now()+W.jwks.rotationInterval*1000)}:{}};return await Zv(J.context.adapter,W).createJwk(J,H)}async function bc(J,W){let{options:X,payload:G}=W,Y=Math.floor(Date.now()/1000),$=G.iat,K=G.exp,w=Ic(X?.jwt?.expirationTime??"15m",$??Y);K=K??w;let{nbf:H,iss:Z}=G,z=X?.jwt?.issuer??J.context.options.baseURL,N=G.aud,F=X?.jwt?.audience??J.context.options.baseURL;if(X?.jwt?.sign){let S={...G,iat:$,exp:K,nbf:H,iss:Z??z,aud:N??F};return X.jwt.sign(S)}let Q=await Zv(J.context.adapter,X).getLatestKey(J);if(!Q||Q.expiresAt&&Q.expiresAt<new Date)Q=await wE(J,X);let V=!X?.jwks?.disablePrivateKeyEncryption?await WJ({key:J.context.secret,data:JSON.parse(Q.privateKey)}).catch(()=>{throw new W6("Failed to decrypt private key. Make sure the secret currently in use is the same as the one used to encrypt the private key. If you are using a different secret, either clean up your JWKS or disable private key encryption.")}):Q.privateKey,v=Q.alg??X?.jwks?.keyPairConfig?.alg??"EdDSA",M=await GJ(JSON.parse(V),v),O=new bJ(G).setProtectedHeader({alg:v,kid:Q.id}).setExpirationTime(K).setIssuer(Z??z).setAudience(N??F);if($)O.setIssuedAt($);if(G.sub)O.setSubject(G.sub);if(G.nbf)O.setNotBefore(G.nbf);if(G.jti)O.setJti(G.jti);return await O.sign(M)}async function Fv(J,W){let X=!W?.jwt?.definePayload?J.context.session.user:await W?.jwt.definePayload(J.context.session);return await bc(J,{options:W,payload:{iat:Math.floor(Date.now()/1000),...X,sub:await W?.jwt?.getSubject?.(J.context.session)??J.context.session.user.id}})}async function Nv(J,W){let X=await F8();try{let G=J.split(".");if(G.length!==3)return null;let Y=new TextDecoder().decode(C4.decode(G[0])),$=JSON.parse(Y).kid;if(!$)return X.context.logger.debug("JWT missing kid in header"),null;let K=await Zv(X.context.adapter,W).getAllKeys(X);if(!K||K.length===0)return X.context.logger.debug("No JWKS keys available"),null;let w=K.find((Z)=>Z.id===$);if(!w)return X.context.logger.debug(`No JWKS key found for kid: ${$}`),null;let{payload:H}=await P8(J,await GJ(JSON.parse(w.publicKey),w.alg??W?.jwks?.keyPairConfig?.alg??"EdDSA"),{issuer:W?.jwt?.issuer??X.context.options.baseURL});if(!H.sub||!H.aud)return null;return H}catch(G){return X.context.logger.debug("JWT verification failed",G),null}}MJ();i4();O0();eJ();eX();R0();var kc=class extends L{},hc=class extends kc{constructor(J,W){super("BAD_REQUEST",{message:"invalid_request",error_description:J,error_detail:W})}};function y$(J){let W=J.split(" ").map((G)=>G.trim()),X=new Set;for(let G of W)if(G==="login"||G==="consent"||G==="select_account"||G==="none")X.add(G);if(X.has("none")&&X.size>1)throw new hc("prompt none must only be used alone");return new Set(X)}function w1(J,W,X){return`${J.includes("?")?"&":"?"}error=${W}&error_description=${X}`}function m$(J,W,X){return w1(J.context.options.onAPIError?.errorURL||`${J.context.baseURL}/error`,W,X)}async function HE(J,W){let X=(T)=>{if(J.request?.headers.get("sec-fetch-mode")==="cors")return J.json({redirect:!0,url:T});else throw J.redirect(T)},G={codeExpiresIn:600,defaultScope:"openid",...W,scopes:["openid","profile","email","offline_access",...W?.scopes||[]]};if(!J.request)throw new L("UNAUTHORIZED",{error_description:"request not found",error:"invalid_request"});let Y=await P6(J);if(!Y){let T=J.query;if(y$(T.prompt??"").has("none")&&T.redirect_uri)return X(w1(T.redirect_uri,"login_required","Authentication required but prompt is none"));await J.setSignedCookie("oidc_login_prompt",JSON.stringify(J.query),J.context.secret,{maxAge:600,path:"/",sameSite:"lax"});let j=J.request.url?.split("?")[1];return X(`${W.loginPage}?${j}`)}let $=J.query;if(!$.client_id){let T=m$(J,"invalid_client","client_id is required");throw J.redirect(T)}if(!$.response_type){let T=m$(J,"invalid_request","response_type is required");throw J.redirect(T)}let K=await HX(J.query.client_id,W.trustedClients||[]);if(!K){let T=m$(J,"invalid_client","client_id is required");throw J.redirect(T)}let w=K.redirectUrls.find((T)=>T===J.query.redirect_uri);if(!w||!$.redirect_uri)throw new L("BAD_REQUEST",{message:"Invalid redirect URI"});if(K.disabled){let T=m$(J,"client_disabled","client is disabled");throw J.redirect(T)}if($.response_type!=="code"){let T=m$(J,"unsupported_response_type","unsupported response type");throw J.redirect(T)}let H=$.scope?.split(" ").filter((T)=>T)||G.defaultScope.split(" "),Z=H.filter((T)=>{return!G.scopes.includes(T)});if(Z.length)return X(w1($.redirect_uri,"invalid_scope",`The following scopes are invalid: ${Z.join(", ")}`));if((!$.code_challenge||!$.code_challenge_method)&&W.requirePKCE)return X(w1($.redirect_uri,"invalid_request","pkce is required"));if(!$.code_challenge_method)$.code_challenge_method="plain";if(!["s256",W.allowPlainCodeChallengeMethod?"plain":"s256"].includes($.code_challenge_method?.toLowerCase()||""))return X(w1($.redirect_uri,"invalid_request","invalid code_challenge method"));let z=t6(32,"a-z","A-Z","0-9"),N=G.codeExpiresIn*1000,F=new Date(Date.now()+N),Q=K.skipConsent,V=await J.context.adapter.findOne({model:"oauthConsent",where:[{field:"clientId",value:K.clientId},{field:"userId",value:Y.user.id}]}).then((T)=>{if(!T?.consentGiven)return!1;let j=T.scopes?T.scopes.split(" "):[];return H.every((q)=>j.includes(q))}),v=y$($.prompt??"");if(v.has("none")){if(!Q&&!V)return X(w1($.redirect_uri,"consent_required","Consent required but prompt is none"))}let M=v.has("login");if($.max_age!==void 0){let T=Number($.max_age);if(Number.isInteger(T)&&T>=0){if((Date.now()-new Date(Y.session.createdAt).getTime())/1000>T)M=!0}}let O=!Q&&(!V||v.has("consent"));try{await J.context.internalAdapter.createVerificationValue({value:JSON.stringify({clientId:K.clientId,redirectURI:$.redirect_uri,scope:H,userId:Y.user.id,authTime:new Date(Y.session.createdAt).getTime(),requireConsent:O,state:O?$.state:null,codeChallenge:$.code_challenge,codeChallengeMethod:$.code_challenge_method,nonce:$.nonce}),identifier:z,expiresAt:F})}catch(T){return X(w1($.redirect_uri,"server_error","An error occurred while processing the request"))}if(M)return await J.setSignedCookie("oidc_login_prompt",JSON.stringify(J.query),J.context.secret,{maxAge:600,path:"/",sameSite:"lax"}),await J.setSignedCookie("oidc_consent_prompt",z,J.context.secret,{maxAge:600,path:"/",sameSite:"lax"}),X(`${W.loginPage}?${new URLSearchParams({client_id:K.clientId,code:z,state:$.state}).toString()}`);if(!O){let T=new URL(w);return T.searchParams.set("code",z),T.searchParams.set("state",J.query.state),X(T.toString())}if(W?.consentPage){await J.setSignedCookie("oidc_consent_prompt",z,J.context.secret,{maxAge:600,path:"/",sameSite:"lax"});let T=new URLSearchParams;return T.set("consent_code",z),T.set("client_id",K.clientId),T.set("scope",H.join(" ")),X(`${W.consentPage}?${T.toString()}`)}let S=W?.getConsentHTML;if(!S)throw new L("INTERNAL_SERVER_ERROR",{message:"No consent page provided"});return new Response(S({scopes:H,clientMetadata:K.metadata,clientIcon:K?.icon,clientId:K.clientId,clientName:K.name,code:z}),{headers:{"content-type":"text/html"}})}var FM6=x({clientId:P(),clientSecret:P().optional(),type:H4(["web","native","user-agent-based","public"]),name:P(),icon:P().optional(),metadata:P().optional(),disabled:d6().optional().default(!1),redirectUrls:P(),userId:P().optional(),createdAt:V4(),updatedAt:V4()}),Qv={oauthApplication:{modelName:"oauthApplication",fields:{name:{type:"string"},icon:{type:"string",required:!1},metadata:{type:"string",required:!1},clientId:{type:"string",unique:!0},clientSecret:{type:"string",required:!1},redirectUrls:{type:"string"},type:{type:"string"},disabled:{type:"boolean",required:!1,defaultValue:!1},userId:{type:"string",required:!1,references:{model:"user",field:"id",onDelete:"cascade"},index:!0},createdAt:{type:"date"},updatedAt:{type:"date"}}},oauthAccessToken:{modelName:"oauthAccessToken",fields:{accessToken:{type:"string",unique:!0},refreshToken:{type:"string",unique:!0},accessTokenExpiresAt:{type:"date"},refreshTokenExpiresAt:{type:"date"},clientId:{type:"string",references:{model:"oauthApplication",field:"clientId",onDelete:"cascade"},index:!0},userId:{type:"string",required:!1,references:{model:"user",field:"id",onDelete:"cascade"},index:!0},scopes:{type:"string"},createdAt:{type:"date"},updatedAt:{type:"date"}}},oauthConsent:{modelName:"oauthConsent",fields:{clientId:{type:"string",references:{model:"oauthApplication",field:"clientId",onDelete:"cascade"},index:!0},userId:{type:"string",references:{model:"user",field:"id",onDelete:"cascade"},index:!0},scopes:{type:"string"},createdAt:{type:"date"},updatedAt:{type:"date"},consentGiven:{type:"boolean"}}}},ZE=async(J)=>{let W=await C0("SHA-256").digest(new TextEncoder().encode(J));return $0.encode(new Uint8Array(W),{padding:!1})},Uv=(J)=>{return J.context.options.plugins?.find((W)=>W.id==="jwt")};async function HX(J,W=[]){let{context:{adapter:X}}=await F8(),G=W.find((Y)=>Y.clientId===J);if(G)return G;return X.findOne({model:"oauthApplication",where:[{field:"clientId",value:J}]}).then((Y)=>{if(!Y)return null;return{clientId:Y.clientId,clientSecret:Y.clientSecret,type:Y.type,name:Y.name,icon:Y.icon,disabled:Y.disabled,redirectUrls:(Y.redirectUrls??"").split(","),metadata:Y.metadata?JSON.parse(Y.metadata):{}}})}var zE=(J,W)=>{let X=Uv(J),G=X&&X.options?.jwt&&X.options.jwt.issuer?X.options.jwt.issuer:J.context.options.baseURL,Y=J.context.baseURL,$=W?.useJWTPlugin?["RS256","EdDSA","none"]:["HS256","none"];return{issuer:G,authorization_endpoint:`${Y}/oauth2/authorize`,token_endpoint:`${Y}/oauth2/token`,userinfo_endpoint:`${Y}/oauth2/userinfo`,jwks_uri:`${Y}/jwks`,registration_endpoint:`${Y}/oauth2/register`,end_session_endpoint:`${Y}/oauth2/endsession`,scopes_supported:["openid","profile","email","offline_access"],response_types_supported:["code"],response_modes_supported:["query"],grant_types_supported:["authorization_code","refresh_token"],acr_values_supported:["urn:mace:incommon:iap:silver","urn:mace:incommon:iap:bronze"],subject_types_supported:["public"],id_token_signing_alg_values_supported:$,token_endpoint_auth_methods_supported:["client_secret_basic","client_secret_post","none"],code_challenge_methods_supported:["S256"],claims_supported:["sub","iss","aud","exp","nbf","iat","jti","email","email_verified","name"],...W?.metadata}},Lv=(J)=>{let W={oauthClient:"oauthApplication",oauthAccessToken:"oauthAccessToken",oauthConsent:"oauthConsent"},X={codeExpiresIn:600,defaultScope:"openid",accessTokenExpiresIn:3600,refreshTokenExpiresIn:604800,allowPlainCodeChallengeMethod:!0,storeClientSecret:"plain",...J,scopes:["openid","profile","email","offline_access",...J?.scopes||[]]},G=J.trustedClients||[];async function Y(K,w){if(X.storeClientSecret==="encrypted")return await JJ({key:K.context.secret,data:w});if(X.storeClientSecret==="hashed")return await ZE(w);if(typeof X.storeClientSecret==="object"&&"hash"in X.storeClientSecret)return await X.storeClientSecret.hash(w);if(typeof X.storeClientSecret==="object"&&"encrypt"in X.storeClientSecret)return await X.storeClientSecret.encrypt(w);return w}async function $(K,w,H){if(X.storeClientSecret==="encrypted")return await WJ({key:K.context.secret,data:w})===H;if(X.storeClientSecret==="hashed")return await ZE(H)===w;if(typeof X.storeClientSecret==="object"&&"hash"in X.storeClientSecret)return await X.storeClientSecret.hash(H)===w;if(typeof X.storeClientSecret==="object"&&"decrypt"in X.storeClientSecret)return await X.storeClientSecret.decrypt(w)===H;return H===w}return{id:"oidc",hooks:{after:[{matcher(){return!0},handler:x6(async(K)=>{let w=await K.getSignedCookie("oidc_login_prompt",K.context.secret),H=K.context.authCookies.sessionToken.name,Z=YX(K.context.responseHeaders?.get("set-cookie")||""),z=Z.has(H);if(!w||!z)return;K.setCookie("oidc_login_prompt","",{maxAge:0});let N=Z.get(H)?.value?.split(".")[0];if(!N)return;let F=await K.context.internalAdapter.findSession(N)||K.context.newSession;if(!F)return;K.query=JSON.parse(w);let Q=y$(String(K.query?.prompt));if(Q.has("login")){let V=new Set(Q);V.delete("login"),K.query={...K.query,prompt:Array.from(V).join(" ")}}return K.context.session=F,await HE(K,X)})}]},endpoints:{getOpenIdConfig:y("/.well-known/openid-configuration",{method:"GET",operationId:"getOpenIdConfig",metadata:{isAction:!1}},async(K)=>{let w=zE(K,J);return K.json(w)}),oAuth2authorize:y("/oauth2/authorize",{method:"GET",operationId:"oauth2Authorize",query:_6(P(),E6()),metadata:{openapi:{description:"Authorize an OAuth2 request",responses:{"200":{description:"Authorization response generated successfully",content:{"application/json":{schema:{type:"object",additionalProperties:!0,description:"Authorization response, contents depend on the authorize function implementation"}}}}}}}},async(K)=>{return HE(K,X)}),oAuthConsent:y("/oauth2/consent",{method:"POST",operationId:"oauth2Consent",body:x({accept:d6(),consent_code:P().optional().nullish()}),use:[k4],metadata:{openapi:{description:"Handle OAuth2 consent. Supports both URL parameter-based flows (consent_code in body) and cookie-based flows (signed cookie).",requestBody:{required:!0,content:{"application/json":{schema:{type:"object",properties:{accept:{type:"boolean",description:"Whether the user accepts or denies the consent request"},consent_code:{type:"string",description:"The consent code from the authorization request. Optional if using cookie-based flow."}},required:["accept"]}}}},responses:{"200":{description:"Consent processed successfully",content:{"application/json":{schema:{type:"object",properties:{redirectURI:{type:"string",format:"uri",description:"The URI to redirect to, either with an authorization code or an error"}},required:["redirectURI"]}}}}}}}},async(K)=>{let w=K.body.consent_code||null;if(!w)w=await K.getSignedCookie("oidc_consent_prompt",K.context.secret);if(!w)throw new L("UNAUTHORIZED",{error_description:"consent_code is required (either in body or cookie)",error:"invalid_request"});let H=await K.context.internalAdapter.findVerificationValue(w);if(!H)throw new L("UNAUTHORIZED",{error_description:"Invalid code",error:"invalid_request"});if(H.expiresAt<new Date)throw new L("UNAUTHORIZED",{error_description:"Code expired",error:"invalid_request"});K.setCookie("oidc_consent_prompt","",{maxAge:0});let Z=JSON.parse(H.value);if(!Z.requireConsent)throw new L("UNAUTHORIZED",{error_description:"Consent not required",error:"invalid_request"});if(!K.body.accept)return await K.context.internalAdapter.deleteVerificationValue(H.id),K.json({redirectURI:`${Z.redirectURI}?error=access_denied&error_description=User denied access`});let z=t6(32,"a-z","A-Z","0-9"),N=X.codeExpiresIn*1000,F=new Date(Date.now()+N);await K.context.internalAdapter.updateVerificationValue(H.id,{value:JSON.stringify({...Z,requireConsent:!1}),identifier:z,expiresAt:F}),await K.context.adapter.create({model:W.oauthConsent,data:{clientId:Z.clientId,userId:Z.userId,scopes:Z.scope.join(" "),consentGiven:!0,createdAt:new Date,updatedAt:new Date}});let Q=new URL(Z.redirectURI);if(Q.searchParams.set("code",z),Z.state)Q.searchParams.set("state",Z.state);return K.json({redirectURI:Q.toString()})}),oAuth2token:y("/oauth2/token",{method:"POST",operationId:"oauth2Token",body:_6(E6(),E6()),metadata:{isAction:!1,allowedMediaTypes:["application/x-www-form-urlencoded","application/json"]}},async(K)=>{let{body:w}=K;if(!w)throw new L("BAD_REQUEST",{error_description:"request body not found",error:"invalid_request"});if(w instanceof FormData)w=Object.fromEntries(w.entries());if(!(w instanceof Object))throw new L("BAD_REQUEST",{error_description:"request body is not an object",error:"invalid_request"});let{client_id:H,client_secret:Z}=w,z=K.request?.headers.get("authorization")||null;if(z&&!H&&!Z&&z.startsWith("Basic "))try{let t=z.replace("Basic ",""),$6=new TextDecoder().decode(C4.decode(t));if(!$6.includes(":"))throw new L("UNAUTHORIZED",{error_description:"invalid authorization header format",error:"invalid_client"});let[D6,K6]=$6.split(":");if(!D6||!K6)throw new L("UNAUTHORIZED",{error_description:"invalid authorization header format",error:"invalid_client"});H=D6,Z=K6}catch(t){throw new L("UNAUTHORIZED",{error_description:"invalid authorization header format",error:"invalid_client"})}let N=Date.now(),F=Math.floor(N/1000),Q=F+(X.accessTokenExpiresIn??3600),V=new Date(Q*1000),v=new Date((F+(X.refreshTokenExpiresIn??604800))*1000),{grant_type:M,code:O,redirect_uri:S,refresh_token:T,code_verifier:j}=w;if(M==="refresh_token"){if(!T)throw new L("BAD_REQUEST",{error_description:"refresh_token is required",error:"invalid_request"});let t=await K.context.adapter.findOne({model:W.oauthAccessToken,where:[{field:"refreshToken",value:T.toString()}]});if(!t)throw new L("UNAUTHORIZED",{error_description:"invalid refresh token",error:"invalid_grant"});if(t.clientId!==H?.toString())throw new L("UNAUTHORIZED",{error_description:"invalid client_id",error:"invalid_client"});if(t.refreshTokenExpiresAt<new Date)throw new L("UNAUTHORIZED",{error_description:"refresh token expired",error:"invalid_grant"});let $6=t6(32,"a-z","A-Z"),D6=t6(32,"a-z","A-Z");return await K.context.adapter.create({model:W.oauthAccessToken,data:{accessToken:$6,refreshToken:D6,accessTokenExpiresAt:V,refreshTokenExpiresAt:v,clientId:H.toString(),userId:t.userId,scopes:t.scopes,createdAt:new Date(F*1000),updatedAt:new Date(F*1000)}}),K.json({access_token:$6,token_type:"Bearer",expires_in:X.accessTokenExpiresIn,refresh_token:D6,scope:t.scopes})}if(!O)throw new L("BAD_REQUEST",{error_description:"code is required",error:"invalid_request"});if(J.requirePKCE&&!j)throw new L("BAD_REQUEST",{error_description:"code verifier is missing",error:"invalid_request"});let q=await K.context.internalAdapter.findVerificationValue(O.toString());if(!q)throw new L("UNAUTHORIZED",{error_description:"invalid code",error:"invalid_grant"});if(q.expiresAt<new Date)throw new L("UNAUTHORIZED",{error_description:"code expired",error:"invalid_grant"});if(await K.context.internalAdapter.deleteVerificationValue(q.id),!H)throw new L("UNAUTHORIZED",{error_description:"client_id is required",error:"invalid_client"});if(!M)throw new L("BAD_REQUEST",{error_description:"grant_type is required",error:"invalid_request"});if(M!=="authorization_code")throw new L("BAD_REQUEST",{error_description:"grant_type must be 'authorization_code'",error:"unsupported_grant_type"});if(!S)throw new L("BAD_REQUEST",{error_description:"redirect_uri is required",error:"invalid_request"});let _=await HX(H.toString(),G);if(!_)throw new L("UNAUTHORIZED",{error_description:"invalid client_id",error:"invalid_client"});if(_.disabled)throw new L("UNAUTHORIZED",{error_description:"client is disabled",error:"invalid_client"});let B=JSON.parse(q.value);if(B.clientId!==H.toString())throw new L("UNAUTHORIZED",{error_description:"invalid client_id",error:"invalid_client"});if(B.redirectURI!==S.toString())throw new L("UNAUTHORIZED",{error_description:"invalid redirect_uri",error:"invalid_client"});if(B.codeChallenge&&!j)throw new L("BAD_REQUEST",{error_description:"code verifier is missing",error:"invalid_request"});if(_.type==="public"){if(!j)throw new L("BAD_REQUEST",{error_description:"code verifier is required for public clients",error:"invalid_request"})}else{if(!_.clientSecret||!Z)throw new L("UNAUTHORIZED",{error_description:"client_secret is required for confidential clients",error:"invalid_client"});if(!await $(K,_.clientSecret,Z.toString()))throw new L("UNAUTHORIZED",{error_description:"invalid client_secret",error:"invalid_client"})}if((B.codeChallengeMethod==="plain"?j:await C0("SHA-256","base64urlnopad").digest(j))!==B.codeChallenge)throw new L("UNAUTHORIZED",{error_description:"code verification failed",error:"invalid_request"});let A=B.scope;await K.context.internalAdapter.deleteVerificationValue(q.id);let E=t6(32,"a-z","A-Z"),R=t6(32,"A-Z","a-z");await K.context.adapter.create({model:W.oauthAccessToken,data:{accessToken:E,refreshToken:R,accessTokenExpiresAt:V,refreshTokenExpiresAt:v,clientId:H.toString(),userId:B.userId,scopes:A.join(" "),createdAt:new Date(F*1000),updatedAt:new Date(F*1000)}});let g=await K.context.internalAdapter.findUserById(B.userId);if(!g)throw new L("UNAUTHORIZED",{error_description:"user not found",error:"invalid_grant"});let u={given_name:g.name.split(" ")[0],family_name:g.name.split(" ")[1],name:g.name,profile:g.image,updated_at:new Date(g.updatedAt).toISOString()},b={email:g.email,email_verified:g.emailVerified},f={...A.includes("profile")?u:{},...A.includes("email")?b:{}},m=J.getAdditionalUserInfoClaim?await J.getAdditionalUserInfoClaim(g,A,_):{},c={sub:g.id,aud:H.toString(),iat:F,auth_time:K.context.session?new Date(K.context.session.session.createdAt).getTime():void 0,nonce:B.nonce,acr:"urn:mace:incommon:iap:silver",...f,...m},l=Math.floor(Date.now()/1000)+X.accessTokenExpiresIn,i;if(J.useJWTPlugin){let t=Uv(K);if(!t)throw K.context.logger.error("OIDC: `useJWTPlugin` is enabled but the JWT plugin is not available. Make sure you have the JWT Plugin in your plugins array or set `useJWTPlugin` to false."),new L("INTERNAL_SERVER_ERROR",{error_description:"JWT plugin is not enabled",error:"internal_server_error"});i=await Fv({...K,context:{...K.context,session:{session:{id:t6(32,"a-z","A-Z"),createdAt:new Date(F*1000),updatedAt:new Date(F*1000),userId:g.id,expiresAt:V,token:E,ipAddress:K.request?.headers.get("x-forwarded-for")},user:g}}},{...t.options,jwt:{...t.options?.jwt,getSubject:()=>g.id,audience:H.toString(),issuer:t.options?.jwt?.issuer??K.context.options.baseURL,expirationTime:l,definePayload:()=>c}})}else i=await new bJ(c).setProtectedHeader({alg:"HS256"}).setIssuedAt(F).setExpirationTime(V).sign(new TextEncoder().encode(_.clientSecret));return K.json({access_token:E,token_type:"Bearer",expires_in:X.accessTokenExpiresIn,refresh_token:A.includes("offline_access")?R:void 0,scope:A.join(" "),id_token:A.includes("openid")?i:void 0},{headers:{"Cache-Control":"no-store",Pragma:"no-cache"}})}),oAuth2userInfo:y("/oauth2/userinfo",{method:"GET",operationId:"oauth2Userinfo",use:[k4],metadata:{isAction:!1,openapi:{description:"Get OAuth2 user information",responses:{"200":{description:"User information retrieved successfully",content:{"application/json":{schema:{type:"object",properties:{sub:{type:"string",description:"Subject identifier (user ID)"},email:{type:"string",format:"email",nullable:!0,description:"User's email address, included if 'email' scope is granted"},name:{type:"string",nullable:!0,description:"User's full name, included if 'profile' scope is granted"},picture:{type:"string",format:"uri",nullable:!0,description:"User's profile picture URL, included if 'profile' scope is granted"},given_name:{type:"string",nullable:!0,description:"User's given name, included if 'profile' scope is granted"},family_name:{type:"string",nullable:!0,description:"User's family name, included if 'profile' scope is granted"},email_verified:{type:"boolean",nullable:!0,description:"Whether the email is verified, included if 'email' scope is granted"}},required:["sub"]}}}}}}}},async(K)=>{if(!K.request)throw new L("UNAUTHORIZED",{error_description:"request not found",error:"invalid_request"});let w=K.request.headers.get("authorization");if(!w)throw new L("UNAUTHORIZED",{error_description:"authorization header not found",error:"invalid_request"});let H=w.replace("Bearer ",""),Z=await K.context.adapter.findOne({model:W.oauthAccessToken,where:[{field:"accessToken",value:H}]});if(!Z)throw new L("UNAUTHORIZED",{error_description:"invalid access token",error:"invalid_token"});if(Z.accessTokenExpiresAt<new Date)throw new L("UNAUTHORIZED",{error_description:"The Access Token expired",error:"invalid_token"});let z=await HX(Z.clientId,G);if(!z)throw new L("UNAUTHORIZED",{error_description:"client not found",error:"invalid_token"});let N=await K.context.internalAdapter.findUserById(Z.userId);if(!N)throw new L("UNAUTHORIZED",{error_description:"user not found",error:"invalid_token"});let F=Z.scopes.split(" "),Q={sub:N.id,email:F.includes("email")?N.email:void 0,name:F.includes("profile")?N.name:void 0,picture:F.includes("profile")?N.image:void 0,given_name:F.includes("profile")?N.name.split(" ")[0]:void 0,family_name:F.includes("profile")?N.name.split(" ")[1]:void 0,email_verified:F.includes("email")?N.emailVerified:void 0},V=J.getAdditionalUserInfoClaim?await J.getAdditionalUserInfoClaim(N,F,z):Q;return K.json({...Q,...V})}),registerOAuthApplication:y("/oauth2/register",{method:"POST",body:x({redirect_uris:v6(P()).meta({description:'A list of redirect URIs. Eg: ["https://client.example.com/callback"]'}),token_endpoint_auth_method:H4(["none","client_secret_basic","client_secret_post"]).meta({description:'The authentication method for the token endpoint. Eg: "client_secret_basic"'}).default("client_secret_basic").optional(),grant_types:v6(H4(["authorization_code","implicit","password","client_credentials","refresh_token","urn:ietf:params:oauth:grant-type:jwt-bearer","urn:ietf:params:oauth:grant-type:saml2-bearer"])).meta({description:'The grant types supported by the application. Eg: ["authorization_code"]'}).default(["authorization_code"]).optional(),response_types:v6(H4(["code","token"])).meta({description:'The response types supported by the application. Eg: ["code"]'}).default(["code"]).optional(),client_name:P().meta({description:'The name of the application. Eg: "My App"'}).optional(),client_uri:P().meta({description:'The URI of the application. Eg: "https://client.example.com"'}).optional(),logo_uri:P().meta({description:'The URI of the application logo. Eg: "https://client.example.com/logo.png"'}).optional(),scope:P().meta({description:'The scopes supported by the application. Separated by spaces. Eg: "profile email"'}).optional(),contacts:v6(P()).meta({description:'The contact information for the application. Eg: ["admin@example.com"]'}).optional(),tos_uri:P().meta({description:'The URI of the application terms of service. Eg: "https://client.example.com/tos"'}).optional(),policy_uri:P().meta({description:'The URI of the application privacy policy. Eg: "https://client.example.com/policy"'}).optional(),jwks_uri:P().meta({description:'The URI of the application JWKS. Eg: "https://client.example.com/jwks"'}).optional(),jwks:_6(E6(),E6()).meta({description:'The JWKS of the application. Eg: {"keys": [{"kty": "RSA", "alg": "RS256", "use": "sig", "n": "...", "e": "..."}]}'}).optional(),metadata:_6(E6(),E6()).meta({description:'The metadata of the application. Eg: {"key": "value"}'}).optional(),software_id:P().meta({description:'The software ID of the application. Eg: "my-software"'}).optional(),software_version:P().meta({description:'The software version of the application. Eg: "1.0.0"'}).optional(),software_statement:P().meta({description:"The software statement of the application."}).optional()}),metadata:{openapi:{description:"Register an OAuth2 application",responses:{"200":{description:"OAuth2 application registered successfully",content:{"application/json":{schema:{type:"object",properties:{name:{type:"string",description:"Name of the OAuth2 application"},icon:{type:"string",nullable:!0,description:"Icon URL for the application"},metadata:{type:"object",additionalProperties:!0,nullable:!0,description:"Additional metadata for the application"},clientId:{type:"string",description:"Unique identifier for the client"},clientSecret:{type:"string",description:"Secret key for the client"},redirectURLs:{type:"array",items:{type:"string",format:"uri"},description:"List of allowed redirect URLs"},type:{type:"string",description:"Type of the client",enum:["web"]},authenticationScheme:{type:"string",description:"Authentication scheme used by the client",enum:["client_secret"]},disabled:{type:"boolean",description:"Whether the client is disabled",enum:[!1]},userId:{type:"string",nullable:!0,description:"ID of the user who registered the client, null if registered anonymously"},createdAt:{type:"string",format:"date-time",description:"Creation timestamp"},updatedAt:{type:"string",format:"date-time",description:"Last update timestamp"}},required:["name","clientId","clientSecret","redirectURLs","type","authenticationScheme","disabled","createdAt","updatedAt"]}}}}}}}},async(K)=>{let w=K.body,H=await P6(K);if(!H&&!J.allowDynamicClientRegistration)throw new L("UNAUTHORIZED",{error:"invalid_token",error_description:"Authentication required for client registration"});if((!w.grant_types||w.grant_types.includes("authorization_code")||w.grant_types.includes("implicit"))&&(!w.redirect_uris||w.redirect_uris.length===0))throw new L("BAD_REQUEST",{error:"invalid_redirect_uri",error_description:"Redirect URIs are required for authorization_code and implicit grant types"});if(w.grant_types&&w.response_types){if(w.grant_types.includes("authorization_code")&&!w.response_types.includes("code"))throw new L("BAD_REQUEST",{error:"invalid_client_metadata",error_description:"When 'authorization_code' grant type is used, 'code' response type must be included"});if(w.grant_types.includes("implicit")&&!w.response_types.includes("token"))throw new L("BAD_REQUEST",{error:"invalid_client_metadata",error_description:"When 'implicit' grant type is used, 'token' response type must be included"})}let Z=J.generateClientId?.()||t6(32,"a-z","A-Z"),z=J.generateClientSecret?.()||t6(32,"a-z","A-Z"),N=await Y(K,z),F=await K.context.adapter.create({model:W.oauthClient,data:{name:w.client_name,icon:w.logo_uri,metadata:w.metadata?JSON.stringify(w.metadata):null,clientId:Z,clientSecret:N,redirectUrls:w.redirect_uris.join(","),type:"web",authenticationScheme:w.token_endpoint_auth_method||"client_secret_basic",disabled:!1,userId:H?.session.userId,createdAt:new Date,updatedAt:new Date}});return K.json({client_id:Z,...F.type!=="public"?{client_secret:z,client_secret_expires_at:0}:{},client_id_issued_at:Math.floor(Date.now()/1000),client_secret_expires_at:0,redirect_uris:w.redirect_uris,token_endpoint_auth_method:w.token_endpoint_auth_method||"client_secret_basic",grant_types:w.grant_types||["authorization_code"],response_types:w.response_types||["code"],client_name:w.client_name,client_uri:w.client_uri,logo_uri:w.logo_uri,scope:w.scope,contacts:w.contacts,tos_uri:w.tos_uri,policy_uri:w.policy_uri,jwks_uri:w.jwks_uri,jwks:w.jwks,software_id:w.software_id,software_version:w.software_version,software_statement:w.software_statement,metadata:w.metadata},{status:201,headers:{"Cache-Control":"no-store",Pragma:"no-cache"}})}),getOAuthClient:y("/oauth2/client/:id",{method:"GET",use:[k4],metadata:{openapi:{description:"Get OAuth2 client details",responses:{"200":{description:"OAuth2 client retrieved successfully",content:{"application/json":{schema:{type:"object",properties:{clientId:{type:"string",description:"Unique identifier for the client"},name:{type:"string",description:"Name of the OAuth2 application"},icon:{type:"string",nullable:!0,description:"Icon URL for the application"}},required:["clientId","name"]}}}}}}}},async(K)=>{let w=await HX(K.params.id,G);if(!w)throw new L("NOT_FOUND",{error_description:"client not found",error:"not_found"});return K.json({clientId:w.clientId,name:w.name,icon:w.icon||null})}),endSession:y("/oauth2/endsession",{method:["GET","POST"],operationId:"oauth2EndSession",query:x({id_token_hint:P().optional(),logout_hint:P().optional(),client_id:P().optional(),post_logout_redirect_uri:P().optional(),state:P().optional(),ui_locales:P().optional()}).optional(),metadata:{isAction:!1,openapi:{description:"RP-Initiated Logout endpoint. Logs out the end-user and optionally redirects to a post-logout URI.",parameters:[{name:"id_token_hint",in:"query",description:"Previously issued ID Token passed as a hint about the End-User's current authenticated session",required:!1,schema:{type:"string"}},{name:"logout_hint",in:"query",description:"Hint to the Authorization Server about the End-User that is logging out",required:!1,schema:{type:"string"}},{name:"client_id",in:"query",description:"OAuth 2.0 Client Identifier. Required if post_logout_redirect_uri is used without id_token_hint",required:!1,schema:{type:"string"}},{name:"post_logout_redirect_uri",in:"query",description:"URL to which the RP is requesting that the End-User's User Agent be redirected after a logout has been performed",required:!1,schema:{type:"string",format:"uri"}},{name:"state",in:"query",description:"Opaque value used by the RP to maintain state between the logout request and the callback",required:!1,schema:{type:"string"}},{name:"ui_locales",in:"query",description:"End-User's preferred languages and scripts for the user interface",required:!1,schema:{type:"string"}}],responses:{"302":{description:"Redirect to post_logout_redirect_uri or logout confirmation page"},"200":{description:"Logout completed successfully"}}}}},async(K)=>{let{id_token_hint:w,logout_hint:H,client_id:Z,post_logout_redirect_uri:z,state:N,ui_locales:F}=K.query||{},Q=null,V=null;if(w)try{let M=Uv(K);if(M&&M.options&&J?.useJWTPlugin){let O=await Nv(w,M.options);if(O)V=O.sub,Q=O.aud?typeof O.aud==="string"?O.aud:O.aud[0]:null}else if(Z){let O=await HX(Z,G);if(O&&O.clientSecret)try{let{payload:S}=await P8(w,new TextEncoder().encode(O.clientSecret));V=S.sub,Q=S.aud}catch(S){}}}catch(M){K.context.logger.debug("Invalid id_token_hint provided to end_session endpoint")}if(Z){if(!await HX(Z,G))throw new L("BAD_REQUEST",{error:"invalid_client",error_description:"Invalid client_id"});if(Q&&Q!==Z)throw new L("BAD_REQUEST",{error:"invalid_request",error_description:"client_id does not match the ID Token's audience"});Q=Z}if(z){if(!Q)throw new L("BAD_REQUEST",{error:"invalid_request",error_description:"client_id is required when using post_logout_redirect_uri without a valid id_token_hint"});let M=await HX(Q,G);if(!M)throw new L("BAD_REQUEST",{error:"invalid_client",error_description:"Invalid client"});if(!M.redirectUrls.some((O)=>z===O))throw new L("BAD_REQUEST",{error:"invalid_request",error_description:"post_logout_redirect_uri is not registered for this client"})}let v=await P6(K);if(V||v){let M=V||v?.user.id;if(M)await K.context.adapter.deleteMany({model:W.oauthAccessToken,where:[{field:"userId",value:M}]})}if(v)await K.context.internalAdapter.deleteSession(v.session.token),K.setSignedCookie(K.context.authCookies.sessionToken.name,"",K.context.secret,{maxAge:0});if(z)try{let M=new URL(z);if(N)M.searchParams.set("state",N);return K.redirect(M.toString())}catch(M){throw new L("BAD_REQUEST",{error:"invalid_request",error_description:"Invalid post_logout_redirect_uri format"})}return K.json({success:!0,message:"Logout successful"})})},schema:a0(Qv,J?.schema),get options(){return X}}};t0();i4();O0();eJ();eX();R0();IX();function Dv(J){return`api-key:${J}`}function vv(J){return`api-key:by-id:${J}`}function AH(J){return`api-key:by-user:${J}`}function fc(J){return JSON.stringify({...J,createdAt:J.createdAt.toISOString(),updatedAt:J.updatedAt.toISOString(),expiresAt:J.expiresAt?.toISOString()??null,lastRefillAt:J.lastRefillAt?.toISOString()??null,lastRequest:J.lastRequest?.toISOString()??null})}function UE(J){if(!J||typeof J!=="string")return null;try{let W=JSON.parse(J);return{...W,createdAt:new Date(W.createdAt),updatedAt:new Date(W.updatedAt),expiresAt:W.expiresAt?new Date(W.expiresAt):null,lastRefillAt:W.lastRefillAt?new Date(W.lastRefillAt):null,lastRequest:W.lastRequest?new Date(W.lastRequest):null}}catch{return null}}function c$(J,W){if(W.customStorage)return W.customStorage;return J.context.secondaryStorage||null}function RH(J){if(J.expiresAt){let W=Date.now(),X=new Date(J.expiresAt).getTime(),G=Math.floor((X-W)/1000);if(G>0)return G}}async function FE(J,W,X){let G=Dv(W);return UE(await X.get(G))}async function EH(J,W,X){let G=vv(W);return UE(await X.get(G))}async function CH(J,W,X,G){let Y=fc(W),$=W.key,K=W.id;await X.set(Dv($),Y,G),await X.set(vv(K),Y,G);let w=AH(W.userId),H=await X.get(w),Z=[];if(H&&typeof H==="string")try{Z=JSON.parse(H)}catch{Z=[]}else if(Array.isArray(H))Z=H;if(!Z.includes(K))Z.push(K),await X.set(w,JSON.stringify(Z))}async function gc(J,W,X){let{key:G,id:Y,userId:$}=W;await X.delete(Dv(G)),await X.delete(vv(Y));let K=AH($),w=await X.get(K),H=[];if(w&&typeof w==="string")try{H=JSON.parse(w)}catch{H=[]}else if(Array.isArray(w))H=w;let Z=H.filter((z)=>z!==Y);if(Z.length===0)await X.delete(K);else await X.set(K,JSON.stringify(Z))}async function mc(J,W,X){let G=c$(J,X);if(X.storage==="database")return await J.context.adapter.findOne({model:"apikey",where:[{field:"key",value:W}]});if(X.storage==="secondary-storage"&&X.fallbackToDatabase){if(G){let $=await FE(J,W,G);if($)return $}let Y=await J.context.adapter.findOne({model:"apikey",where:[{field:"key",value:W}]});if(Y&&G)await CH(J,Y,G,RH(Y));return Y}if(X.storage==="secondary-storage"){if(!G)return null;return await FE(J,W,G)}return await J.context.adapter.findOne({model:"apikey",where:[{field:"key",value:W}]})}async function Mv(J,W,X){let G=c$(J,X);if(X.storage==="database")return await J.context.adapter.findOne({model:"apikey",where:[{field:"id",value:W}]});if(X.storage==="secondary-storage"&&X.fallbackToDatabase){if(G){let $=await EH(J,W,G);if($)return $}let Y=await J.context.adapter.findOne({model:"apikey",where:[{field:"id",value:W}]});if(Y&&G)await CH(J,Y,G,RH(Y));return Y}if(X.storage==="secondary-storage"){if(!G)return null;return await EH(J,W,G)}return await J.context.adapter.findOne({model:"apikey",where:[{field:"id",value:W}]})}async function l$(J,W,X){let G=c$(J,X),Y=RH(W);if(X.storage==="database")return;if(X.storage==="secondary-storage"){if(!G)throw Error("Secondary storage is required when storage mode is 'secondary-storage'");await CH(J,W,G,Y);return}}async function u$(J,W,X){let G=c$(J,X);if(X.storage==="database")return;if(X.storage==="secondary-storage"){if(!G)throw Error("Secondary storage is required when storage mode is 'secondary-storage'");await gc(J,W,G);return}}async function yc(J,W,X){let G=c$(J,X);if(X.storage==="database")return await J.context.adapter.findMany({model:"apikey",where:[{field:"userId",value:W}]});if(X.storage==="secondary-storage"&&X.fallbackToDatabase){let Y=AH(W);if(G){let K=await G.get(Y),w=[];if(K&&typeof K==="string")try{w=JSON.parse(K)}catch{w=[]}else if(Array.isArray(K))w=K;if(w.length>0){let H=[];for(let Z of w){let z=await EH(J,Z,G);if(z)H.push(z)}return H}}let $=await J.context.adapter.findMany({model:"apikey",where:[{field:"userId",value:W}]});if(G&&$.length>0){let K=[];for(let w of $)await CH(J,w,G,RH(w)),K.push(w.id);await G.set(Y,JSON.stringify(K))}return $}if(X.storage==="secondary-storage"){if(!G)return[];let Y=AH(W),$=await G.get(Y),K=[];if($&&typeof $==="string")try{K=JSON.parse($)}catch{return[]}else if(Array.isArray($))K=$;else return[];let w=[];for(let H of K){let Z=await EH(J,H,G);if(Z)w.push(Z)}return w}return await J.context.adapter.findMany({model:"apikey",where:[{field:"userId",value:W}]})}function xc({keyGenerator:J,opts:W,schema:X,deleteAllExpiredApiKeys:G}){return y("/api-key/create",{method:"POST",body:x({name:P().meta({description:"Name of the Api Key"}).optional(),expiresIn:O6().meta({description:"Expiration time of the Api Key in seconds"}).min(1).optional().nullable().default(null),userId:m6.string().meta({description:'User Id of the user that the Api Key belongs to. server-only. Eg: "user-id"'}).optional(),prefix:P().meta({description:"Prefix of the Api Key"}).regex(/^[a-zA-Z0-9_-]+$/,{message:"Invalid prefix format, must be alphanumeric and contain only underscores and hyphens."}).optional(),remaining:O6().meta({description:"Remaining number of requests. Server side only"}).min(0).optional().nullable().default(null),metadata:E6().optional(),refillAmount:O6().meta({description:"Amount to refill the remaining count of the Api Key. server-only. Eg: 100"}).min(1).optional(),refillInterval:O6().meta({description:"Interval to refill the Api Key in milliseconds. server-only. Eg: 1000"}).optional(),rateLimitTimeWindow:O6().meta({description:"The duration in milliseconds where each request is counted. Once the `maxRequests` is reached, the request will be rejected until the `timeWindow` has passed, at which point the `timeWindow` will be reset. server-only. Eg: 1000"}).optional(),rateLimitMax:O6().meta({description:"Maximum amount of requests allowed within a window. Once the `maxRequests` is reached, the request will be rejected until the `timeWindow` has passed, at which point the `timeWindow` will be reset. server-only. Eg: 100"}).optional(),rateLimitEnabled:d6().meta({description:"Whether the key has rate limiting enabled. server-only. Eg: true"}).optional(),permissions:_6(P(),v6(P())).meta({description:"Permissions of the Api Key."}).optional()}),metadata:{openapi:{description:"Create a new API key for a user",responses:{"200":{description:"API key created successfully",content:{"application/json":{schema:{type:"object",properties:{id:{type:"string",description:"Unique identifier of the API key"},createdAt:{type:"string",format:"date-time",description:"Creation timestamp"},updatedAt:{type:"string",format:"date-time",description:"Last update timestamp"},name:{type:"string",nullable:!0,description:"Name of the API key"},prefix:{type:"string",nullable:!0,description:"Prefix of the API key"},start:{type:"string",nullable:!0,description:"Starting characters of the key (if configured)"},key:{type:"string",description:"The full API key (only returned on creation)"},enabled:{type:"boolean",description:"Whether the key is enabled"},expiresAt:{type:"string",format:"date-time",nullable:!0,description:"Expiration timestamp"},userId:{type:"string",description:"ID of the user owning the key"},lastRefillAt:{type:"string",format:"date-time",nullable:!0,description:"Last refill timestamp"},lastRequest:{type:"string",format:"date-time",nullable:!0,description:"Last request timestamp"},metadata:{type:"object",nullable:!0,additionalProperties:!0,description:"Metadata associated with the key"},rateLimitMax:{type:"number",nullable:!0,description:"Maximum requests in time window"},rateLimitTimeWindow:{type:"number",nullable:!0,description:"Rate limit time window in milliseconds"},remaining:{type:"number",nullable:!0,description:"Remaining requests"},refillAmount:{type:"number",nullable:!0,description:"Amount to refill"},refillInterval:{type:"number",nullable:!0,description:"Refill interval in milliseconds"},rateLimitEnabled:{type:"boolean",description:"Whether rate limiting is enabled"},requestCount:{type:"number",description:"Current request count in window"},permissions:{type:"object",nullable:!0,additionalProperties:{type:"array",items:{type:"string"}},description:"Permissions associated with the key"}},required:["id","createdAt","updatedAt","key","enabled","userId","rateLimitEnabled","requestCount"]}}}}}}}},async(Y)=>{let{name:$,expiresIn:K,prefix:w,remaining:H,metadata:Z,refillAmount:z,refillInterval:N,permissions:F,rateLimitMax:Q,rateLimitTimeWindow:V,rateLimitEnabled:v}=Y.body,M=await P6(Y),O=Y.request||Y.headers,S=O&&!M?null:M?.user||{id:Y.body.userId};if(!S?.id)throw new L("UNAUTHORIZED",{message:H6.UNAUTHORIZED_SESSION});if(M&&Y.body.userId&&M?.user.id!==Y.body.userId)throw new L("UNAUTHORIZED",{message:H6.UNAUTHORIZED_SESSION});if(O){if(z!==void 0||N!==void 0||Q!==void 0||V!==void 0||v!==void 0||F!==void 0||H!==null)throw new L("BAD_REQUEST",{message:H6.SERVER_ONLY_PROPERTY})}if(Z){if(W.enableMetadata===!1)throw new L("BAD_REQUEST",{message:H6.METADATA_DISABLED});if(typeof Z!=="object")throw new L("BAD_REQUEST",{message:H6.INVALID_METADATA_TYPE})}if(z&&!N)throw new L("BAD_REQUEST",{message:H6.REFILL_AMOUNT_AND_INTERVAL_REQUIRED});if(N&&!z)throw new L("BAD_REQUEST",{message:H6.REFILL_INTERVAL_AND_AMOUNT_REQUIRED});if(K){if(W.keyExpiration.disableCustomExpiresTime===!0)throw new L("BAD_REQUEST",{message:H6.KEY_DISABLED_EXPIRATION});let R=K/86400;if(W.keyExpiration.minExpiresIn>R)throw new L("BAD_REQUEST",{message:H6.EXPIRES_IN_IS_TOO_SMALL});else if(W.keyExpiration.maxExpiresIn<R)throw new L("BAD_REQUEST",{message:H6.EXPIRES_IN_IS_TOO_LARGE})}if(w){if(w.length<W.minimumPrefixLength)throw new L("BAD_REQUEST",{message:H6.INVALID_PREFIX_LENGTH});if(w.length>W.maximumPrefixLength)throw new L("BAD_REQUEST",{message:H6.INVALID_PREFIX_LENGTH})}if($){if($.length<W.minimumNameLength)throw new L("BAD_REQUEST",{message:H6.INVALID_NAME_LENGTH});if($.length>W.maximumNameLength)throw new L("BAD_REQUEST",{message:H6.INVALID_NAME_LENGTH})}else if(W.requireName)throw new L("BAD_REQUEST",{message:H6.NAME_REQUIRED});G(Y.context);let T=await J({length:W.defaultKeyLength,prefix:w||W.defaultPrefix}),j=W.disableKeyHashing?T:await IH(T),q=null;if(W.startingCharactersConfig.shouldStore)q=T.substring(0,W.startingCharactersConfig.charactersLength);let _=W.permissions?.defaultPermissions?typeof W.permissions.defaultPermissions==="function"?await W.permissions.defaultPermissions(S.id,Y):W.permissions.defaultPermissions:void 0,B=F?JSON.stringify(F):_?JSON.stringify(_):void 0,A={createdAt:new Date,updatedAt:new Date,name:$??null,prefix:w??W.defaultPrefix??null,start:q,key:j,enabled:!0,expiresAt:K?F4(K,"sec"):W.keyExpiration.defaultExpiresIn?F4(W.keyExpiration.defaultExpiresIn,"sec"):null,userId:S.id,lastRefillAt:null,lastRequest:null,metadata:null,rateLimitMax:Q??W.rateLimit.maxRequests??null,rateLimitTimeWindow:V??W.rateLimit.timeWindow??null,remaining:H===null?H:H??z??null,refillAmount:z??null,refillInterval:N??null,rateLimitEnabled:v===void 0?W.rateLimit.enabled??!0:v,requestCount:0,permissions:B};if(Z)A.metadata=X.apikey.fields.metadata.transform.input(Z);let E;if(W.storage==="secondary-storage"&&W.fallbackToDatabase)E=await Y.context.adapter.create({model:j8,data:A}),await l$(Y,E,W);else if(W.storage==="secondary-storage"){let R=Y.context.generateId({model:j8})??f4();E={...A,id:R},await l$(Y,E,W)}else E=await Y.context.adapter.create({model:j8,data:A});return Y.json({...E,key:T,metadata:Z??null,permissions:E.permissions?l6(E.permissions):null})})}function uc({deleteAllExpiredApiKeys:J}){return y("/api-key/delete-all-expired-api-keys",{method:"POST",metadata:{SERVER_ONLY:!0,client:!1}},async(W)=>{try{await J(W.context,!0)}catch(X){return W.context.logger.error("[API KEY PLUGIN] Failed to delete expired API keys:",X),W.json({success:!1,error:X})}return W.json({success:!0,error:null})})}function lc({opts:J,schema:W,deleteAllExpiredApiKeys:X}){return y("/api-key/delete",{method:"POST",body:x({keyId:P().meta({description:"The id of the Api Key"})}),use:[k4],metadata:{openapi:{description:"Delete an existing API key",requestBody:{content:{"application/json":{schema:{type:"object",properties:{keyId:{type:"string",description:"The id of the API key to delete"}},required:["keyId"]}}}},responses:{"200":{description:"API key deleted successfully",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",description:"Indicates if the API key was successfully deleted"}},required:["success"]}}}}}}}},async(G)=>{let{keyId:Y}=G.body,$=G.context.session;if($.user.banned===!0)throw new L("UNAUTHORIZED",{message:H6.USER_BANNED});let K=null;if(K=await Mv(G,Y,J),!K||K.userId!==$.user.id)throw new L("NOT_FOUND",{message:H6.KEY_NOT_FOUND});try{if(J.storage==="secondary-storage"&&J.fallbackToDatabase)await u$(G,K,J),await G.context.adapter.delete({model:j8,where:[{field:"id",value:K.id}]});else if(J.storage==="database")await G.context.adapter.delete({model:j8,where:[{field:"id",value:K.id}]});else await u$(G,K,J)}catch(w){throw new L("INTERNAL_SERVER_ERROR",{message:w?.message})}return X(G.context),G.json({success:!0})})}function cc({opts:J,schema:W,deleteAllExpiredApiKeys:X}){return y("/api-key/get",{method:"GET",query:x({id:P().meta({description:"The id of the Api Key"})}),use:[k4],metadata:{openapi:{description:"Retrieve an existing API key by ID",responses:{"200":{description:"API key retrieved successfully",content:{"application/json":{schema:{type:"object",properties:{id:{type:"string",description:"ID"},name:{type:"string",nullable:!0,description:"The name of the key"},start:{type:"string",nullable:!0,description:"Shows the first few characters of the API key, including the prefix. This allows you to show those few characters in the UI to make it easier for users to identify the API key."},prefix:{type:"string",nullable:!0,description:"The API Key prefix. Stored as plain text."},userId:{type:"string",description:"The owner of the user id"},refillInterval:{type:"number",nullable:!0,description:"The interval in milliseconds between refills of the `remaining` count. Example: 3600000 // refill every hour (3600000ms = 1h)"},refillAmount:{type:"number",nullable:!0,description:"The amount to refill"},lastRefillAt:{type:"string",format:"date-time",nullable:!0,description:"The last refill date"},enabled:{type:"boolean",description:"Sets if key is enabled or disabled",default:!0},rateLimitEnabled:{type:"boolean",description:"Whether the key has rate limiting enabled"},rateLimitTimeWindow:{type:"number",nullable:!0,description:"The duration in milliseconds"},rateLimitMax:{type:"number",nullable:!0,description:"Maximum amount of requests allowed within a window"},requestCount:{type:"number",description:"The number of requests made within the rate limit time window"},remaining:{type:"number",nullable:!0,description:"Remaining requests (every time api key is used this should updated and should be updated on refill as well)"},lastRequest:{type:"string",format:"date-time",nullable:!0,description:"When last request occurred"},expiresAt:{type:"string",format:"date-time",nullable:!0,description:"Expiry date of a key"},createdAt:{type:"string",format:"date-time",description:"created at"},updatedAt:{type:"string",format:"date-time",description:"updated at"},metadata:{type:"object",nullable:!0,additionalProperties:!0,description:"Extra metadata about the apiKey"},permissions:{type:"string",nullable:!0,description:"Permissions for the api key (stored as JSON string)"}},required:["id","userId","enabled","rateLimitEnabled","requestCount","createdAt","updatedAt"]}}}}}}}},async(G)=>{let{id:Y}=G.query,$=G.context.session,K=null;if(K=await Mv(G,Y,J),K&&K.userId!==$.user.id)K=null;if(!K)throw new L("NOT_FOUND",{message:H6.KEY_NOT_FOUND});X(G.context),K.metadata=W.apikey.fields.metadata.transform.output(K.metadata);let{key:w,...H}=K;return G.json({...H,permissions:H.permissions?l6(H.permissions):null})})}function pc({opts:J,schema:W,deleteAllExpiredApiKeys:X}){return y("/api-key/list",{method:"GET",use:[k4],metadata:{openapi:{description:"List all API keys for the authenticated user",responses:{"200":{description:"API keys retrieved successfully",content:{"application/json":{schema:{type:"array",items:{type:"object",properties:{id:{type:"string",description:"ID"},name:{type:"string",nullable:!0,description:"The name of the key"},start:{type:"string",nullable:!0,description:"Shows the first few characters of the API key, including the prefix. This allows you to show those few characters in the UI to make it easier for users to identify the API key."},prefix:{type:"string",nullable:!0,description:"The API Key prefix. Stored as plain text."},userId:{type:"string",description:"The owner of the user id"},refillInterval:{type:"number",nullable:!0,description:"The interval in milliseconds between refills of the `remaining` count. Example: 3600000 // refill every hour (3600000ms = 1h)"},refillAmount:{type:"number",nullable:!0,description:"The amount to refill"},lastRefillAt:{type:"string",format:"date-time",nullable:!0,description:"The last refill date"},enabled:{type:"boolean",description:"Sets if key is enabled or disabled",default:!0},rateLimitEnabled:{type:"boolean",description:"Whether the key has rate limiting enabled"},rateLimitTimeWindow:{type:"number",nullable:!0,description:"The duration in milliseconds"},rateLimitMax:{type:"number",nullable:!0,description:"Maximum amount of requests allowed within a window"},requestCount:{type:"number",description:"The number of requests made within the rate limit time window"},remaining:{type:"number",nullable:!0,description:"Remaining requests (every time api key is used this should updated and should be updated on refill as well)"},lastRequest:{type:"string",format:"date-time",nullable:!0,description:"When last request occurred"},expiresAt:{type:"string",format:"date-time",nullable:!0,description:"Expiry date of a key"},createdAt:{type:"string",format:"date-time",description:"created at"},updatedAt:{type:"string",format:"date-time",description:"updated at"},metadata:{type:"object",nullable:!0,additionalProperties:!0,description:"Extra metadata about the apiKey"},permissions:{type:"string",nullable:!0,description:"Permissions for the api key (stored as JSON string)"}},required:["id","userId","enabled","rateLimitEnabled","requestCount","createdAt","updatedAt"]}}}}}}}}},async(G)=>{let Y=G.context.session,$;$=await yc(G,Y.user.id,J),X(G.context),$=$.map((w)=>{return{...w,metadata:W.apikey.fields.metadata.transform.output(w.metadata)}});let K=$.map((w)=>{let{key:H,...Z}=w;return{...Z,permissions:Z.permissions?l6(Z.permissions):null}});return G.json(K)})}function dc({opts:J,schema:W,deleteAllExpiredApiKeys:X}){return y("/api-key/update",{method:"POST",body:x({keyId:P().meta({description:"The id of the Api Key"}),userId:m6.string().meta({description:'The id of the user which the api key belongs to. server-only. Eg: "some-user-id"'}).optional(),name:P().meta({description:"The name of the key"}).optional(),enabled:d6().meta({description:"Whether the Api Key is enabled or not"}).optional(),remaining:O6().meta({description:"The number of remaining requests"}).min(1).optional(),refillAmount:O6().meta({description:"The refill amount"}).optional(),refillInterval:O6().meta({description:"The refill interval"}).optional(),metadata:E6().optional(),expiresIn:O6().meta({description:"Expiration time of the Api Key in seconds"}).min(1).optional().nullable(),rateLimitEnabled:d6().meta({description:"Whether the key has rate limiting enabled."}).optional(),rateLimitTimeWindow:O6().meta({description:"The duration in milliseconds where each request is counted. server-only. Eg: 1000"}).optional(),rateLimitMax:O6().meta({description:"Maximum amount of requests allowed within a window. Once the `maxRequests` is reached, the request will be rejected until the `timeWindow` has passed, at which point the `timeWindow` will be reset. server-only. Eg: 100"}).optional(),permissions:_6(P(),v6(P())).meta({description:"Update the permissions on the API Key. server-only."}).optional().nullable()}),metadata:{openapi:{description:"Update an existing API key by ID",responses:{"200":{description:"API key updated successfully",content:{"application/json":{schema:{type:"object",properties:{id:{type:"string",description:"ID"},name:{type:"string",nullable:!0,description:"The name of the key"},start:{type:"string",nullable:!0,description:"Shows the first few characters of the API key, including the prefix. This allows you to show those few characters in the UI to make it easier for users to identify the API key."},prefix:{type:"string",nullable:!0,description:"The API Key prefix. Stored as plain text."},userId:{type:"string",description:"The owner of the user id"},refillInterval:{type:"number",nullable:!0,description:"The interval in milliseconds between refills of the `remaining` count. Example: 3600000 // refill every hour (3600000ms = 1h)"},refillAmount:{type:"number",nullable:!0,description:"The amount to refill"},lastRefillAt:{type:"string",format:"date-time",nullable:!0,description:"The last refill date"},enabled:{type:"boolean",description:"Sets if key is enabled or disabled",default:!0},rateLimitEnabled:{type:"boolean",description:"Whether the key has rate limiting enabled"},rateLimitTimeWindow:{type:"number",nullable:!0,description:"The duration in milliseconds"},rateLimitMax:{type:"number",nullable:!0,description:"Maximum amount of requests allowed within a window"},requestCount:{type:"number",description:"The number of requests made within the rate limit time window"},remaining:{type:"number",nullable:!0,description:"Remaining requests (every time api key is used this should updated and should be updated on refill as well)"},lastRequest:{type:"string",format:"date-time",nullable:!0,description:"When last request occurred"},expiresAt:{type:"string",format:"date-time",nullable:!0,description:"Expiry date of a key"},createdAt:{type:"string",format:"date-time",description:"created at"},updatedAt:{type:"string",format:"date-time",description:"updated at"},metadata:{type:"object",nullable:!0,additionalProperties:!0,description:"Extra metadata about the apiKey"},permissions:{type:"string",nullable:!0,description:"Permissions for the api key (stored as JSON string)"}},required:["id","userId","enabled","rateLimitEnabled","requestCount","createdAt","updatedAt"]}}}}}}}},async(G)=>{let{keyId:Y,expiresIn:$,enabled:K,metadata:w,refillAmount:H,refillInterval:Z,remaining:z,name:N,permissions:F,rateLimitEnabled:Q,rateLimitTimeWindow:V,rateLimitMax:v}=G.body,M=await P6(G),O=G.request||G.headers,S=O&&!M?null:M?.user||{id:G.body.userId};if(!S?.id)throw new L("UNAUTHORIZED",{message:H6.UNAUTHORIZED_SESSION});if(M&&G.body.userId&&M?.user.id!==G.body.userId)throw new L("UNAUTHORIZED",{message:H6.UNAUTHORIZED_SESSION});if(O){if(H!==void 0||Z!==void 0||v!==void 0||V!==void 0||Q!==void 0||z!==void 0||F!==void 0)throw new L("BAD_REQUEST",{message:H6.SERVER_ONLY_PROPERTY})}let T=null;if(T=await Mv(G,Y,J),T&&T.userId!==S.id)T=null;if(!T)throw new L("NOT_FOUND",{message:H6.KEY_NOT_FOUND});let j={};if(N!==void 0){if(N.length<J.minimumNameLength)throw new L("BAD_REQUEST",{message:H6.INVALID_NAME_LENGTH});else if(N.length>J.maximumNameLength)throw new L("BAD_REQUEST",{message:H6.INVALID_NAME_LENGTH});j.name=N}if(K!==void 0)j.enabled=K;if($!==void 0){if(J.keyExpiration.disableCustomExpiresTime===!0)throw new L("BAD_REQUEST",{message:H6.KEY_DISABLED_EXPIRATION});if($!==null){let A=$/86400;if(A<J.keyExpiration.minExpiresIn)throw new L("BAD_REQUEST",{message:H6.EXPIRES_IN_IS_TOO_SMALL});else if(A>J.keyExpiration.maxExpiresIn)throw new L("BAD_REQUEST",{message:H6.EXPIRES_IN_IS_TOO_LARGE})}j.expiresAt=$?F4($,"sec"):null}if(w!==void 0){if(typeof w!=="object")throw new L("BAD_REQUEST",{message:H6.INVALID_METADATA_TYPE});j.metadata=W.apikey.fields.metadata.transform.input(w)}if(z!==void 0)j.remaining=z;if(H!==void 0||Z!==void 0){if(H!==void 0&&Z===void 0)throw new L("BAD_REQUEST",{message:H6.REFILL_AMOUNT_AND_INTERVAL_REQUIRED});else if(Z!==void 0&&H===void 0)throw new L("BAD_REQUEST",{message:H6.REFILL_INTERVAL_AND_AMOUNT_REQUIRED});j.refillAmount=H,j.refillInterval=Z}if(Q!==void 0)j.rateLimitEnabled=Q;if(V!==void 0)j.rateLimitTimeWindow=V;if(v!==void 0)j.rateLimitMax=v;if(F!==void 0)j.permissions=JSON.stringify(F);if(Object.keys(j).length===0)throw new L("BAD_REQUEST",{message:H6.NO_VALUES_TO_UPDATE});let q=T;try{if(J.storage==="secondary-storage"&&J.fallbackToDatabase){let A=await G.context.adapter.update({model:j8,where:[{field:"id",value:T.id}],update:j});if(A)await l$(G,A,J),q=A}else if(J.storage==="database"){let A=await G.context.adapter.update({model:j8,where:[{field:"id",value:T.id}],update:j});if(A)q=A}else{let A={...T,...j,updatedAt:new Date};await l$(G,A,J),q=A}}catch(A){throw new L("INTERNAL_SERVER_ERROR",{message:A?.message})}X(G.context),q.metadata=W.apikey.fields.metadata.transform.output(q.metadata);let{key:_,...B}=q;return G.json({...B,permissions:B.permissions?l6(B.permissions):null})})}function nc(J,W){let X=new Date,G=J.lastRequest,Y=J.rateLimitTimeWindow,$=J.rateLimitMax,K=J.requestCount;if(W.rateLimit.enabled===!1)return{success:!0,message:null,update:{lastRequest:X},tryAgainIn:null};if(J.rateLimitEnabled===!1)return{success:!0,message:null,update:{lastRequest:X},tryAgainIn:null};if(Y===null||$===null)return{success:!0,message:null,update:null,tryAgainIn:null};if(G===null)return{success:!0,message:null,update:{lastRequest:X,requestCount:1},tryAgainIn:null};let w=X.getTime()-new Date(G).getTime();if(w>Y)return{success:!0,message:null,update:{lastRequest:X,requestCount:1},tryAgainIn:null};if(K>=$)return{success:!1,message:H6.RATE_LIMIT_EXCEEDED,update:null,tryAgainIn:Math.ceil(Y-w)};return K++,{success:!0,message:null,tryAgainIn:null,update:{lastRequest:X,requestCount:K}}}async function QE({hashedKey:J,ctx:W,opts:X,schema:G,permissions:Y}){let $=await mc(W,J,X);if(!$)throw new L("UNAUTHORIZED",{message:H6.INVALID_API_KEY});if($.enabled===!1)throw new L("UNAUTHORIZED",{message:H6.KEY_DISABLED,code:"KEY_DISABLED"});if($.expiresAt){if(Date.now()>new Date($.expiresAt).getTime()){try{if(X.storage==="secondary-storage"&&X.fallbackToDatabase)await u$(W,$,X),await W.context.adapter.delete({model:j8,where:[{field:"id",value:$.id}]});else if(X.storage==="secondary-storage")await u$(W,$,X);else await W.context.adapter.delete({model:j8,where:[{field:"id",value:$.id}]})}catch(V){W.context.logger.error("Failed to delete expired API keys:",V)}throw new L("UNAUTHORIZED",{message:H6.KEY_EXPIRED,code:"KEY_EXPIRED"})}}if(Y){let V=$.permissions?l6($.permissions):null;if(!V)throw new L("UNAUTHORIZED",{message:H6.KEY_NOT_FOUND,code:"KEY_NOT_FOUND"});if(!g$(V).authorize(Y).success)throw new L("UNAUTHORIZED",{message:H6.KEY_NOT_FOUND,code:"KEY_NOT_FOUND"})}let{remaining:K,lastRefillAt:w}=$;if($.remaining===0&&$.refillAmount===null){try{if(X.storage==="secondary-storage")await u$(W,$,X);else await W.context.adapter.delete({model:j8,where:[{field:"id",value:$.id}]})}catch(V){W.context.logger.error("Failed to delete expired API keys:",V)}throw new L("TOO_MANY_REQUESTS",{message:H6.USAGE_EXCEEDED,code:"USAGE_EXCEEDED"})}else if(K!==null){let V=Date.now(),v=$.refillInterval,M=$.refillAmount,O=new Date(w??$.createdAt).getTime();if(v&&M){if(V-O>v)K=M,w=new Date}if(K===0)throw new L("TOO_MANY_REQUESTS",{message:H6.USAGE_EXCEEDED,code:"USAGE_EXCEEDED"});else K--}let{message:H,success:Z,update:z,tryAgainIn:N}=nc($,X),F=null,Q={...$,...z,remaining:K,lastRefillAt:w,updatedAt:new Date};if(X.storage==="database")F=await W.context.adapter.update({model:j8,where:[{field:"id",value:$.id}],update:Q});else await l$(W,Q,X),F=Q;if(!F)throw new L("INTERNAL_SERVER_ERROR",{message:H6.FAILED_TO_UPDATE_API_KEY,code:"INTERNAL_SERVER_ERROR"});if(Z===!1)throw new L("UNAUTHORIZED",{message:H??void 0,code:"RATE_LIMITED",details:{tryAgainIn:N}});return F}function rc({opts:J,schema:W,deleteAllExpiredApiKeys:X}){return y("/api-key/verify",{method:"POST",body:x({key:P().meta({description:"The key to verify"}),permissions:_6(P(),v6(P())).meta({description:"The permissions to verify."}).optional()}),metadata:{SERVER_ONLY:!0}},async(G)=>{let{key:Y}=G.body;if(Y.length<J.defaultKeyLength)return G.json({valid:!1,error:{message:H6.INVALID_API_KEY,code:"KEY_NOT_FOUND"},key:null});if(J.customAPIKeyValidator){if(!await J.customAPIKeyValidator({ctx:G,key:Y}))return G.json({valid:!1,error:{message:H6.INVALID_API_KEY,code:"KEY_NOT_FOUND"},key:null})}let $=J.disableKeyHashing?Y:await IH(Y),K=null;try{K=await QE({hashedKey:$,permissions:G.body.permissions,ctx:G,opts:J,schema:W}),await X(G.context)}catch(Z){if(Z instanceof L)return G.json({valid:!1,error:{message:Z.body?.message,code:Z.body?.code},key:null});return G.json({valid:!1,error:{message:H6.INVALID_API_KEY,code:"INVALID_API_KEY"},key:null})}let{key:w,...H}=K??{key:1,permissions:void 0};if("metadata"in H)H.metadata=W.apikey.fields.metadata.transform.output(H.metadata);return H.permissions=H.permissions?l6(H.permissions):null,G.json({valid:!0,error:null,key:K===null?null:H})})}var Vv=null;async function ZX(J,W=!1){if(Vv&&!W){if(new Date().getTime()-Vv.getTime()<1e4)return}Vv=new Date,await J.adapter.deleteMany({model:j8,where:[{field:"expiresAt",operator:"lt",value:new Date},{field:"expiresAt",operator:"ne",value:null}]}).catch((X)=>{J.logger.error("Failed to delete expired API keys:",X)})}function ic({keyGenerator:J,opts:W,schema:X}){return{createApiKey:xc({keyGenerator:J,opts:W,schema:X,deleteAllExpiredApiKeys:ZX}),verifyApiKey:rc({opts:W,schema:X,deleteAllExpiredApiKeys:ZX}),getApiKey:cc({opts:W,schema:X,deleteAllExpiredApiKeys:ZX}),updateApiKey:dc({opts:W,schema:X,deleteAllExpiredApiKeys:ZX}),deleteApiKey:lc({opts:W,schema:X,deleteAllExpiredApiKeys:ZX}),listApiKeys:pc({opts:W,schema:X,deleteAllExpiredApiKeys:ZX}),deleteAllExpiredApiKeys:uc({deleteAllExpiredApiKeys:ZX})}}var ac=({timeWindow:J,rateLimitMax:W})=>({apikey:{fields:{name:{type:"string",required:!1,input:!1},start:{type:"string",required:!1,input:!1},prefix:{type:"string",required:!1,input:!1},key:{type:"string",required:!0,input:!1,index:!0},userId:{type:"string",references:{model:"user",field:"id",onDelete:"cascade"},required:!0,input:!1,index:!0},refillInterval:{type:"number",required:!1,input:!1},refillAmount:{type:"number",required:!1,input:!1},lastRefillAt:{type:"date",required:!1,input:!1},enabled:{type:"boolean",required:!1,input:!1,defaultValue:!0},rateLimitEnabled:{type:"boolean",required:!1,input:!1,defaultValue:!0},rateLimitTimeWindow:{type:"number",required:!1,input:!1,defaultValue:J},rateLimitMax:{type:"number",required:!1,input:!1,defaultValue:W},requestCount:{type:"number",required:!1,input:!1,defaultValue:0},remaining:{type:"number",required:!1,input:!1},lastRequest:{type:"date",required:!1,input:!1},expiresAt:{type:"date",required:!1,input:!1},createdAt:{type:"date",required:!0,input:!1},updatedAt:{type:"date",required:!0,input:!1},permissions:{type:"string",required:!1,input:!1},metadata:{type:"string",required:!1,input:!0,transform:{input(X){return JSON.stringify(X)},output(X){if(!X)return null;return _H(X)}}}}}}),IH=async(J)=>{let W=await C0("SHA-256").digest(new TextEncoder().encode(J));return $0.encode(new Uint8Array(W),{padding:!1})},H6=p6({INVALID_METADATA_TYPE:"metadata must be an object or undefined",REFILL_AMOUNT_AND_INTERVAL_REQUIRED:"refillAmount is required when refillInterval is provided",REFILL_INTERVAL_AND_AMOUNT_REQUIRED:"refillInterval is required when refillAmount is provided",USER_BANNED:"User is banned",UNAUTHORIZED_SESSION:"Unauthorized or invalid session",KEY_NOT_FOUND:"API Key not found",KEY_DISABLED:"API Key is disabled",KEY_EXPIRED:"API Key has expired",USAGE_EXCEEDED:"API Key has reached its usage limit",KEY_NOT_RECOVERABLE:"API Key is not recoverable",EXPIRES_IN_IS_TOO_SMALL:"The expiresIn is smaller than the predefined minimum value.",EXPIRES_IN_IS_TOO_LARGE:"The expiresIn is larger than the predefined maximum value.",INVALID_REMAINING:"The remaining count is either too large or too small.",INVALID_PREFIX_LENGTH:"The prefix length is either too large or too small.",INVALID_NAME_LENGTH:"The name length is either too large or too small.",METADATA_DISABLED:"Metadata is disabled.",RATE_LIMIT_EXCEEDED:"Rate limit exceeded.",NO_VALUES_TO_UPDATE:"No values to update.",KEY_DISABLED_EXPIRATION:"Custom key expiration values are disabled.",INVALID_API_KEY:"Invalid API key.",INVALID_USER_ID_FROM_API_KEY:"The user id from the API key is invalid.",INVALID_API_KEY_GETTER_RETURN_TYPE:"API Key getter returned an invalid key type. Expected string.",SERVER_ONLY_PROPERTY:"The property you're trying to set can only be set from the server auth instance only.",FAILED_TO_UPDATE_API_KEY:"Failed to update API key",NAME_REQUIRED:"API Key name is required."}),j8="apikey",Ov=(J)=>{let W={...J,apiKeyHeaders:J?.apiKeyHeaders??"x-api-key",defaultKeyLength:J?.defaultKeyLength||64,maximumPrefixLength:J?.maximumPrefixLength??32,minimumPrefixLength:J?.minimumPrefixLength??1,maximumNameLength:J?.maximumNameLength??32,minimumNameLength:J?.minimumNameLength??1,enableMetadata:J?.enableMetadata??!1,disableKeyHashing:J?.disableKeyHashing??!1,requireName:J?.requireName??!1,storage:J?.storage??"database",rateLimit:{enabled:J?.rateLimit?.enabled===void 0?!0:J?.rateLimit?.enabled,timeWindow:J?.rateLimit?.timeWindow??86400000,maxRequests:J?.rateLimit?.maxRequests??10},keyExpiration:{defaultExpiresIn:J?.keyExpiration?.defaultExpiresIn??null,disableCustomExpiresTime:J?.keyExpiration?.disableCustomExpiresTime??!1,maxExpiresIn:J?.keyExpiration?.maxExpiresIn??365,minExpiresIn:J?.keyExpiration?.minExpiresIn??1},startingCharactersConfig:{shouldStore:J?.startingCharactersConfig?.shouldStore??!0,charactersLength:J?.startingCharactersConfig?.charactersLength??6},enableSessionForAPIKeys:J?.enableSessionForAPIKeys??!1,fallbackToDatabase:J?.fallbackToDatabase??!1,customStorage:J?.customStorage},X=a0(ac({rateLimitMax:W.rateLimit.maxRequests,timeWindow:W.rateLimit.timeWindow}),W.schema),G=W.customAPIKeyGetter||(($)=>{if(Array.isArray(W.apiKeyHeaders))for(let K of W.apiKeyHeaders){let w=$.headers?.get(K);if(w)return w}else return $.headers?.get(W.apiKeyHeaders)}),Y=ic({keyGenerator:W.customKeyGenerator||(async($)=>{let K=t6($.length,"a-z","A-Z");return`${$.prefix||""}${K}`}),opts:W,schema:X});return{id:"api-key",$ERROR_CODES:H6,hooks:{before:[{matcher:($)=>!!G($)&&W.enableSessionForAPIKeys,handler:x6(async($)=>{let K=G($);if(typeof K!=="string")throw new L("BAD_REQUEST",{message:H6.INVALID_API_KEY_GETTER_RETURN_TYPE});if(K.length<W.defaultKeyLength)throw new L("FORBIDDEN",{message:H6.INVALID_API_KEY});if(W.customAPIKeyValidator){if(!await W.customAPIKeyValidator({ctx:$,key:K}))throw new L("FORBIDDEN",{message:H6.INVALID_API_KEY})}let w=await QE({hashedKey:W.disableKeyHashing?K:await IH(K),ctx:$,opts:W,schema:X});ZX($.context).catch((z)=>{$.context.logger.error("Failed to delete expired API keys:",z)});let H=await $.context.internalAdapter.findUserById(w.userId);if(!H)throw new L("UNAUTHORIZED",{message:H6.INVALID_USER_ID_FROM_API_KEY});let Z={user:H,session:{id:w.id,token:K,userId:w.userId,userAgent:$.request?.headers.get("user-agent")??null,ipAddress:$.request?iX($.request,$.context.options):null,createdAt:new Date,updatedAt:new Date,expiresAt:w.expiresAt||F4($.context.options.session?.expiresIn||604800,"ms")}};if($.context.session=Z,$.path==="/get-session")return Z;else return{context:$}})}]},endpoints:{createApiKey:Y.createApiKey,verifyApiKey:Y.verifyApiKey,getApiKey:Y.getApiKey,updateApiKey:Y.updateApiKey,deleteApiKey:Y.deleteApiKey,listApiKeys:Y.listApiKeys,deleteAllExpiredApiKeys:Y.deleteAllExpiredApiKeys},schema:X}};function x$(J,W,X){return`${J.includes("?")?"&":"?"}error=${W}&error_description=${X}`}async function NE(J,W){J.setHeader("Access-Control-Allow-Origin","*"),J.setHeader("Access-Control-Allow-Methods","POST, OPTIONS"),J.setHeader("Access-Control-Allow-Headers","Content-Type, Authorization"),J.setHeader("Access-Control-Max-Age","86400");let X={codeExpiresIn:600,defaultScope:"openid",...W,scopes:["openid","profile","email","offline_access",...W?.scopes||[]]};if(!J.request)throw new L("UNAUTHORIZED",{error_description:"request not found",error:"invalid_request"});let G=await P6(J);if(!G){await J.setSignedCookie("oidc_login_prompt",JSON.stringify(J.query),J.context.secret,{maxAge:600,path:"/",sameSite:"lax"});let Q=J.request.url?.split("?")[1];throw J.redirect(`${W.loginPage}?${Q}`)}let Y=J.query;if(!Y.client_id)throw J.redirect(`${J.context.baseURL}/error?error=invalid_client`);if(!Y.response_type)throw J.redirect(x$(`${J.context.baseURL}/error`,"invalid_request","response_type is required"));let $=await J.context.adapter.findOne({model:"oauthApplication",where:[{field:"clientId",value:J.query.client_id}]}).then((Q)=>{if(!Q)return null;return{...Q,redirectUrls:Q.redirectUrls.split(","),metadata:Q.metadata?JSON.parse(Q.metadata):{}}});if(!$)throw J.redirect(`${J.context.baseURL}/error?error=invalid_client`);let K=$.redirectUrls.find((Q)=>Q===J.query.redirect_uri);if(!K||!Y.redirect_uri)throw new L("BAD_REQUEST",{message:"Invalid redirect URI"});if($.disabled)throw J.redirect(`${J.context.baseURL}/error?error=client_disabled`);if(Y.response_type!=="code")throw J.redirect(`${J.context.baseURL}/error?error=unsupported_response_type`);let w=Y.scope?.split(" ").filter((Q)=>Q)||X.defaultScope.split(" "),H=w.filter((Q)=>{return!X.scopes.includes(Q)});if(H.length)throw J.redirect(x$(Y.redirect_uri,"invalid_scope",`The following scopes are invalid: ${H.join(", ")}`));if((!Y.code_challenge||!Y.code_challenge_method)&&W.requirePKCE)throw J.redirect(x$(Y.redirect_uri,"invalid_request","pkce is required"));if(!Y.code_challenge_method)Y.code_challenge_method="plain";if(!["s256",W.allowPlainCodeChallengeMethod?"plain":"s256"].includes(Y.code_challenge_method?.toLowerCase()||""))throw J.redirect(x$(Y.redirect_uri,"invalid_request","invalid code_challenge method"));let Z=t6(32,"a-z","A-Z","0-9"),z=X.codeExpiresIn*1000,N=new Date(Date.now()+z);try{await J.context.internalAdapter.createVerificationValue({value:JSON.stringify({clientId:$.clientId,redirectURI:Y.redirect_uri,scope:w,userId:G.user.id,authTime:new Date(G.session.createdAt).getTime(),requireConsent:Y.prompt==="consent",state:Y.prompt==="consent"?Y.state:null,codeChallenge:Y.code_challenge,codeChallengeMethod:Y.code_challenge_method,nonce:Y.nonce}),identifier:Z,expiresAt:N})}catch(Q){throw J.redirect(x$(Y.redirect_uri,"server_error","An error occurred while processing the request"))}if(Y.prompt!=="consent"){let Q=new URL(K);throw Q.searchParams.set("code",Z),Q.searchParams.set("state",J.query.state),J.redirect(Q.toString())}if(W?.consentPage){await J.setSignedCookie("oidc_consent_prompt",Z,J.context.secret,{maxAge:600,path:"/",sameSite:"lax"});let Q=new URLSearchParams;Q.set("consent_code",Z),Q.set("client_id",$.clientId),Q.set("scope",w.join(" "));let V=`${W.consentPage}?${Q.toString()}`;throw J.redirect(V)}let F=new URL(K);throw F.searchParams.set("code",Z),F.searchParams.set("state",J.query.state),J.redirect(F.toString())}var LE=(J,W)=>{let X=J.context.options.baseURL,G=J.context.baseURL;if(!X||!G)throw new L("INTERNAL_SERVER_ERROR",{error:"invalid_issuer",error_description:"issuer or baseURL is not set. If you're the app developer, please make sure to set the `baseURL` in your auth config."});return{issuer:X,authorization_endpoint:`${G}/mcp/authorize`,token_endpoint:`${G}/mcp/token`,userinfo_endpoint:`${G}/mcp/userinfo`,jwks_uri:`${G}/mcp/jwks`,registration_endpoint:`${G}/mcp/register`,scopes_supported:["openid","profile","email","offline_access"],response_types_supported:["code"],response_modes_supported:["query"],grant_types_supported:["authorization_code","refresh_token"],acr_values_supported:["urn:mace:incommon:iap:silver","urn:mace:incommon:iap:bronze"],subject_types_supported:["public"],id_token_signing_alg_values_supported:["RS256","none"],token_endpoint_auth_methods_supported:["client_secret_basic","client_secret_post","none"],code_challenge_methods_supported:["S256"],claims_supported:["sub","iss","aud","exp","nbf","iat","jti","email","email_verified","name"],...W?.metadata}},VE=(J,W)=>{let X=J.context.baseURL;return{resource:W?.resource??new URL(X).origin,authorization_servers:[X],jwks_uri:W?.oidcConfig?.metadata?.jwks_uri??`${X}/mcp/jwks`,scopes_supported:W?.oidcConfig?.metadata?.scopes_supported??["openid","profile","email","offline_access"],bearer_methods_supported:["header"],resource_signing_alg_values_supported:["RS256","none"]}},Pv=(J)=>{let W={codeExpiresIn:600,defaultScope:"openid",accessTokenExpiresIn:3600,refreshTokenExpiresIn:604800,allowPlainCodeChallengeMethod:!0,...J.oidcConfig,loginPage:J.loginPage,scopes:["openid","profile","email","offline_access",...J.oidcConfig?.scopes||[]]},X={oauthClient:"oauthApplication",oauthAccessToken:"oauthAccessToken",oauthConsent:"oauthConsent"},G=Lv(W);return{id:"mcp",hooks:{after:[{matcher(){return!0},handler:x6(async(Y)=>{let $=await Y.getSignedCookie("oidc_login_prompt",Y.context.secret),K=Y.context.authCookies.sessionToken.name,w=YX(Y.context.responseHeaders?.get("set-cookie")||""),H=w.has(K);if(!$||!H)return;Y.setCookie("oidc_login_prompt","",{maxAge:0});let Z=w.get(K)?.value?.split(".")[0];if(!Z)return;let z=await Y.context.internalAdapter.findSession(Z)||Y.context.newSession;if(!z)return;let N=y$(String(Y.query?.prompt));if(N.has("login")){let F=new Set(N);F.delete("login"),Y.query={...Y.query,prompt:Array.from(F).join(" ")}}return Y.context.session=z,await NE(Y,W)})}]},endpoints:{oAuthConsent:G.endpoints.oAuthConsent,getMcpOAuthConfig:y("/.well-known/oauth-authorization-server",{method:"GET",metadata:{client:!1}},async(Y)=>{try{let $=LE(Y,J);return Y.json($)}catch($){return console.log($),Y.json(null)}}),getMCPProtectedResource:y("/.well-known/oauth-protected-resource",{method:"GET",metadata:{client:!1}},async(Y)=>{let $=VE(Y,J);return Y.json($)}),mcpOAuthAuthorize:y("/mcp/authorize",{method:"GET",query:_6(P(),E6()),metadata:{openapi:{description:"Authorize an OAuth2 request using MCP",responses:{"200":{description:"Authorization response generated successfully",content:{"application/json":{schema:{type:"object",additionalProperties:!0,description:"Authorization response, contents depend on the authorize function implementation"}}}}}}}},async(Y)=>{return NE(Y,W)}),mcpOAuthToken:y("/mcp/token",{method:"POST",body:_6(E6(),E6()),metadata:{isAction:!1,allowedMediaTypes:["application/x-www-form-urlencoded","application/json"]}},async(Y)=>{Y.setHeader("Access-Control-Allow-Origin","*"),Y.setHeader("Access-Control-Allow-Methods","POST, OPTIONS"),Y.setHeader("Access-Control-Allow-Headers","Content-Type, Authorization"),Y.setHeader("Access-Control-Max-Age","86400");let{body:$}=Y;if(!$)throw Y.error("BAD_REQUEST",{error_description:"request body not found",error:"invalid_request"});if($ instanceof FormData)$=Object.fromEntries($.entries());if(!($ instanceof Object))throw new L("BAD_REQUEST",{error_description:"request body is not an object",error:"invalid_request"});let{client_id:K,client_secret:w}=$,H=Y.request?.headers.get("authorization")||null;if(H&&!K&&!w&&H.startsWith("Basic "))try{let b=H.replace("Basic ",""),f=new TextDecoder().decode(C4.decode(b));if(!f.includes(":"))throw new L("UNAUTHORIZED",{error_description:"invalid authorization header format",error:"invalid_client"});let[m,c]=f.split(":");if(!m||!c)throw new L("UNAUTHORIZED",{error_description:"invalid authorization header format",error:"invalid_client"});K=m,w=c}catch(b){throw new L("UNAUTHORIZED",{error_description:"invalid authorization header format",error:"invalid_client"})}let{grant_type:Z,code:z,redirect_uri:N,refresh_token:F,code_verifier:Q}=$;if(Z==="refresh_token"){if(!F)throw new L("BAD_REQUEST",{error_description:"refresh_token is required",error:"invalid_request"});let b=await Y.context.adapter.findOne({model:"oauthAccessToken",where:[{field:"refreshToken",value:F.toString()}]});if(!b)throw new L("UNAUTHORIZED",{error_description:"invalid refresh token",error:"invalid_grant"});if(b.clientId!==K?.toString())throw new L("UNAUTHORIZED",{error_description:"invalid client_id",error:"invalid_client"});if(b.refreshTokenExpiresAt<new Date)throw new L("UNAUTHORIZED",{error_description:"refresh token expired",error:"invalid_grant"});let f=t6(32,"a-z","A-Z"),m=t6(32,"a-z","A-Z"),c=new Date(Date.now()+W.accessTokenExpiresIn*1000),l=new Date(Date.now()+W.refreshTokenExpiresIn*1000);return await Y.context.adapter.create({model:X.oauthAccessToken,data:{accessToken:f,refreshToken:m,accessTokenExpiresAt:c,refreshTokenExpiresAt:l,clientId:K.toString(),userId:b.userId,scopes:b.scopes,createdAt:new Date,updatedAt:new Date}}),Y.json({access_token:f,token_type:"bearer",expires_in:W.accessTokenExpiresIn,refresh_token:m,scope:b.scopes})}if(!z)throw new L("BAD_REQUEST",{error_description:"code is required",error:"invalid_request"});if(W.requirePKCE&&!Q)throw new L("BAD_REQUEST",{error_description:"code verifier is missing",error:"invalid_request"});let V=await Y.context.internalAdapter.findVerificationValue(z.toString());if(!V)throw new L("UNAUTHORIZED",{error_description:"invalid code",error:"invalid_grant"});if(V.expiresAt<new Date)throw new L("UNAUTHORIZED",{error_description:"code expired",error:"invalid_grant"});if(await Y.context.internalAdapter.deleteVerificationValue(V.id),!K)throw new L("UNAUTHORIZED",{error_description:"client_id is required",error:"invalid_client"});if(!Z)throw new L("BAD_REQUEST",{error_description:"grant_type is required",error:"invalid_request"});if(Z!=="authorization_code")throw new L("BAD_REQUEST",{error_description:"grant_type must be 'authorization_code'",error:"unsupported_grant_type"});if(!N)throw new L("BAD_REQUEST",{error_description:"redirect_uri is required",error:"invalid_request"});let v=await Y.context.adapter.findOne({model:X.oauthClient,where:[{field:"clientId",value:K.toString()}]}).then((b)=>{if(!b)return null;return{...b,redirectUrls:b.redirectUrls.split(","),metadata:b.metadata?JSON.parse(b.metadata):{}}});if(!v)throw new L("UNAUTHORIZED",{error_description:"invalid client_id",error:"invalid_client"});if(v.disabled)throw new L("UNAUTHORIZED",{error_description:"client is disabled",error:"invalid_client"});if(v.type==="public"){if(!Q)throw new L("BAD_REQUEST",{error_description:"code verifier is required for public clients",error:"invalid_request"})}else{if(!w)throw new L("UNAUTHORIZED",{error_description:"client_secret is required for confidential clients",error:"invalid_client"});if(v.clientSecret!==w.toString())throw new L("UNAUTHORIZED",{error_description:"invalid client_secret",error:"invalid_client"})}let M=JSON.parse(V.value);if(M.clientId!==K.toString())throw new L("UNAUTHORIZED",{error_description:"invalid client_id",error:"invalid_client"});if(M.redirectURI!==N.toString())throw new L("UNAUTHORIZED",{error_description:"invalid redirect_uri",error:"invalid_client"});if(M.codeChallenge&&!Q)throw new L("BAD_REQUEST",{error_description:"code verifier is missing",error:"invalid_request"});if((M.codeChallengeMethod==="plain"?Q:await C0("SHA-256","base64urlnopad").digest(Q))!==M.codeChallenge)throw new L("UNAUTHORIZED",{error_description:"code verification failed",error:"invalid_request"});let O=M.scope;await Y.context.internalAdapter.deleteVerificationValue(V.id);let S=t6(32,"a-z","A-Z"),T=t6(32,"A-Z","a-z"),j=new Date(Date.now()+W.accessTokenExpiresIn*1000),q=new Date(Date.now()+W.refreshTokenExpiresIn*1000);await Y.context.adapter.create({model:X.oauthAccessToken,data:{accessToken:S,refreshToken:T,accessTokenExpiresAt:j,refreshTokenExpiresAt:q,clientId:K.toString(),userId:M.userId,scopes:O.join(" "),createdAt:new Date,updatedAt:new Date}});let _=await Y.context.internalAdapter.findUserById(M.userId);if(!_)throw new L("UNAUTHORIZED",{error_description:"user not found",error:"invalid_grant"});let B={alg:"HS256",key:await z8().generateKey({name:"HMAC",hash:"SHA-256"},!0,["sign","verify"])},A={given_name:_.name.split(" ")[0],family_name:_.name.split(" ")[1],name:_.name,profile:_.image,updated_at:Math.floor(new Date(_.updatedAt).getTime()/1000)},E={email:_.email,email_verified:_.emailVerified},R={...O.includes("profile")?A:{},...O.includes("email")?E:{}},g=W.getAdditionalUserInfoClaim?await W.getAdditionalUserInfoClaim(_,O,v):{},u=await new bJ({sub:_.id,aud:K.toString(),iat:Date.now(),auth_time:Y.context.session?new Date(Y.context.session.session.createdAt).getTime():void 0,nonce:M.nonce,acr:"urn:mace:incommon:iap:silver",...R,...g}).setProtectedHeader({alg:B.alg}).setIssuedAt().setExpirationTime(Math.floor(Date.now()/1000)+W.accessTokenExpiresIn).sign(B.key);return Y.json({access_token:S,token_type:"Bearer",expires_in:W.accessTokenExpiresIn,refresh_token:O.includes("offline_access")?T:void 0,scope:O.join(" "),id_token:O.includes("openid")?u:void 0},{headers:{"Cache-Control":"no-store",Pragma:"no-cache"}})}),registerMcpClient:y("/mcp/register",{method:"POST",body:x({redirect_uris:v6(P()),token_endpoint_auth_method:H4(["none","client_secret_basic","client_secret_post"]).default("client_secret_basic").optional(),grant_types:v6(H4(["authorization_code","implicit","password","client_credentials","refresh_token","urn:ietf:params:oauth:grant-type:jwt-bearer","urn:ietf:params:oauth:grant-type:saml2-bearer"])).default(["authorization_code"]).optional(),response_types:v6(H4(["code","token"])).default(["code"]).optional(),client_name:P().optional(),client_uri:P().optional(),logo_uri:P().optional(),scope:P().optional(),contacts:v6(P()).optional(),tos_uri:P().optional(),policy_uri:P().optional(),jwks_uri:P().optional(),jwks:_6(P(),E6()).optional(),metadata:_6(E6(),E6()).optional(),software_id:P().optional(),software_version:P().optional(),software_statement:P().optional()}),metadata:{openapi:{description:"Register an OAuth2 application",responses:{"200":{description:"OAuth2 application registered successfully",content:{"application/json":{schema:{type:"object",properties:{name:{type:"string",description:"Name of the OAuth2 application"},icon:{type:"string",nullable:!0,description:"Icon URL for the application"},metadata:{type:"object",additionalProperties:!0,nullable:!0,description:"Additional metadata for the application"},clientId:{type:"string",description:"Unique identifier for the client"},clientSecret:{type:"string",description:"Secret key for the client. Not included for public clients."},redirectUrls:{type:"array",items:{type:"string",format:"uri"},description:"List of allowed redirect URLs"},type:{type:"string",description:"Type of the client",enum:["web","public"]},authenticationScheme:{type:"string",description:"Authentication scheme used by the client",enum:["client_secret","none"]},disabled:{type:"boolean",description:"Whether the client is disabled",enum:[!1]},userId:{type:"string",nullable:!0,description:"ID of the user who registered the client, null if registered anonymously"},createdAt:{type:"string",format:"date-time",description:"Creation timestamp"},updatedAt:{type:"string",format:"date-time",description:"Last update timestamp"}},required:["name","clientId","redirectUrls","type","authenticationScheme","disabled","createdAt","updatedAt"]}}}}}}}},async(Y)=>{let $=Y.body,K=await P6(Y);if(Y.setHeader("Access-Control-Allow-Origin","*"),Y.setHeader("Access-Control-Allow-Methods","POST, OPTIONS"),Y.setHeader("Access-Control-Allow-Headers","Content-Type, Authorization"),Y.setHeader("Access-Control-Max-Age","86400"),Y.headers?.set("Access-Control-Max-Age","86400"),(!$.grant_types||$.grant_types.includes("authorization_code")||$.grant_types.includes("implicit"))&&(!$.redirect_uris||$.redirect_uris.length===0))throw new L("BAD_REQUEST",{error:"invalid_redirect_uri",error_description:"Redirect URIs are required for authorization_code and implicit grant types"});if($.grant_types&&$.response_types){if($.grant_types.includes("authorization_code")&&!$.response_types.includes("code"))throw new L("BAD_REQUEST",{error:"invalid_client_metadata",error_description:"When 'authorization_code' grant type is used, 'code' response type must be included"});if($.grant_types.includes("implicit")&&!$.response_types.includes("token"))throw new L("BAD_REQUEST",{error:"invalid_client_metadata",error_description:"When 'implicit' grant type is used, 'token' response type must be included"})}let w=W.generateClientId?.()||t6(32,"a-z","A-Z"),H=W.generateClientSecret?.()||t6(32,"a-z","A-Z"),Z=$.token_endpoint_auth_method==="none"?"public":"web",z=Z==="public"?"":H;await Y.context.adapter.create({model:X.oauthClient,data:{name:$.client_name,icon:$.logo_uri,metadata:$.metadata?JSON.stringify($.metadata):null,clientId:w,clientSecret:z,redirectUrls:$.redirect_uris.join(","),type:Z,authenticationScheme:$.token_endpoint_auth_method||"client_secret_basic",disabled:!1,userId:K?.session.userId,createdAt:new Date,updatedAt:new Date}});let N={client_id:w,client_id_issued_at:Math.floor(Date.now()/1000),redirect_uris:$.redirect_uris,token_endpoint_auth_method:$.token_endpoint_auth_method||"client_secret_basic",grant_types:$.grant_types||["authorization_code"],response_types:$.response_types||["code"],client_name:$.client_name,client_uri:$.client_uri,logo_uri:$.logo_uri,scope:$.scope,contacts:$.contacts,tos_uri:$.tos_uri,policy_uri:$.policy_uri,jwks_uri:$.jwks_uri,jwks:$.jwks,software_id:$.software_id,software_version:$.software_version,software_statement:$.software_statement,metadata:$.metadata,...Z!=="public"?{client_secret:z,client_secret_expires_at:0}:{}};return new Response(JSON.stringify(N),{status:201,headers:{"Content-Type":"application/json","Cache-Control":"no-store",Pragma:"no-cache"}})}),getMcpSession:y("/mcp/get-session",{method:"GET",requireHeaders:!0},async(Y)=>{let $=Y.headers?.get("Authorization")?.replace("Bearer ","");if(!$)return Y.headers?.set("WWW-Authenticate","Bearer"),Y.json(null);let K=await Y.context.adapter.findOne({model:X.oauthAccessToken,where:[{field:"accessToken",value:$}]});if(!K)return Y.json(null);return Y.json(K)})},schema:Qv}};i4();var bH={CLOUDFLARE_TURNSTILE:"cloudflare-turnstile",GOOGLE_RECAPTCHA:"google-recaptcha",HCAPTCHA:"hcaptcha",CAPTCHAFOX:"captchafox"},pM6={[bH.CLOUDFLARE_TURNSTILE]:"https://challenges.cloudflare.com/turnstile/v0/siteverify",[bH.GOOGLE_RECAPTCHA]:"https://www.google.com/recaptcha/api/siteverify",[bH.HCAPTCHA]:"https://api.hcaptcha.com/siteverify",[bH.CAPTCHAFOX]:"https://api.captchafox.com/siteverify"},dM6=p6({VERIFICATION_FAILED:"Captcha verification failed",MISSING_RESPONSE:"Missing CAPTCHA response",UNKNOWN_ERROR:"Something went wrong"}),nM6=p6({MISSING_SECRET_KEY:"Missing secret key",SERVICE_UNAVAILABLE:"CAPTCHA service unavailable"});O0();var oM6=M0(x({disableCookieCache:d6().meta({description:"Disable cookie cache and fetch session from database"}).or(P().transform((J)=>J==="true")).optional(),disableRefresh:d6().meta({description:"Disable session refresh. Useful for checking session status, without updating the session"}).optional()}));r4();i4();O0();var KO6=p6({INVALID_DEVICE_CODE:"Invalid device code",EXPIRED_DEVICE_CODE:"Device code has expired",EXPIRED_USER_CODE:"User code has expired",AUTHORIZATION_PENDING:"Authorization pending",ACCESS_DENIED:"Access denied",INVALID_USER_CODE:"Invalid user code",DEVICE_CODE_ALREADY_PROCESSED:"Device code already processed",POLLING_TOO_FREQUENTLY:"Polling too frequently",USER_NOT_FOUND:"User not found",FAILED_TO_CREATE_SESSION:"Failed to create session",INVALID_DEVICE_CODE_STATUS:"Invalid device code status",AUTHENTICATION_REQUIRED:"Authentication required"});var wO6=x({id:P(),deviceCode:P(),userCode:P(),userId:P().optional(),expiresAt:V4(),status:P(),lastPolledAt:V4().optional(),pollingInterval:O6().optional(),clientId:P().optional(),scope:P().optional()}),DE=zW((J)=>{try{nD(J)}catch(W){return!1}return!0},{message:"Invalid time string format. Use formats like '30m', '5s', '1h', etc."}),tc=x({expiresIn:DE.default("30m").describe("Time in seconds until the device code expires. Use formats like '30m', '5s', '1h', etc."),interval:DE.default("5s").describe("Time in seconds between polling attempts. Use formats like '30m', '5s', '1h', etc."),deviceCodeLength:O6().int().positive().default(40).describe("Length of the device code to be generated. Default is 40 characters."),userCodeLength:O6().int().positive().default(8).describe("Length of the user code to be generated. Default is 8 characters."),generateDeviceCode:zW((J)=>typeof J==="function",{message:"generateDeviceCode must be a function that returns a string or a promise that resolves to a string."}).optional().describe("Function to generate a device code. If not provided, a default random string generator will be used."),generateUserCode:zW((J)=>typeof J==="function",{message:"generateUserCode must be a function that returns a string or a promise that resolves to a string."}).optional().describe("Function to generate a user code. If not provided, a default random string generator will be used."),validateClient:zW((J)=>typeof J==="function",{message:"validateClient must be a function that returns a boolean or a promise that resolves to a boolean."}).optional().describe("Function to validate the client ID. If not provided, no validation will be performed."),onDeviceAuthRequest:zW((J)=>typeof J==="function",{message:"onDeviceAuthRequest must be a function that returns void or a promise that resolves to void."}).optional().describe("Function to handle device authorization requests. If not provided, no additional actions will be taken."),verificationUri:P().optional().describe("The URI where users verify their device code. Can be an absolute URL (https://example.com/device) or relative path (/custom-path). This will be returned as verification_uri in the device code response. If not provided, defaults to /device."),schema:zW(()=>!0)});r4();R4();eJ();R0();var OO6=p6({OTP_EXPIRED:"OTP expired",INVALID_OTP:"Invalid OTP",TOO_MANY_ATTEMPTS:"Too many attempts"});i0();R4();i4();var IO6=p6({INVALID_OAUTH_CONFIGURATION:"Invalid OAuth configuration",TOKEN_URL_NOT_FOUND:"Invalid OAuth configuration. Token URL not found.",PROVIDER_CONFIG_NOT_FOUND:"No config found for provider",PROVIDER_ID_REQUIRED:"Provider ID is required",INVALID_OAUTH_CONFIG:"Invalid OAuth configuration.",SESSION_REQUIRED:"Session is required"});MJ();eJ();var yO6=p6({PASSWORD_COMPROMISED:"The password you entered has been compromised. Please choose a different password."});r4();eJ();R0();var JP6=p6({INVALID_SESSION_TOKEN:"Invalid session token"});r4();t0();DJ();O0();var oc=new Set(["string","number","boolean","array","object"]);function sc(J){let W=J.type;return oc.has(W)?W:"string"}function ec(J){let W={type:J.type==="date"?"string":J.type};if(J.defaultValue!==void 0)W.default=typeof J.defaultValue==="function"?"Generated at runtime":J.defaultValue;if(J.input===!1)W.readOnly=!0;return W}function kH(J){let W=[];if(J.metadata?.openapi?.parameters)return W.push(...J.metadata.openapi.parameters),W;if(J.query instanceof ZW)Object.entries(J.query.shape).forEach(([X,G])=>{if(G instanceof Q6)W.push({name:X,in:"query",schema:{...fH(G),..."minLength"in G&&G.minLength?{minLength:G.minLength}:{}}})});return W}function vE(J){if(J.metadata?.openapi?.requestBody)return J.metadata.openapi.requestBody;if(!J.body)return;if(J.body instanceof ZW||J.body instanceof BJ){let W=J.body.shape;if(!W)return;let X={},G=[];return Object.entries(W).forEach(([Y,$])=>{if($ instanceof Q6){if(X[Y]=fH($),!($ instanceof BJ))G.push(Y)}}),{required:J.body instanceof BJ?!1:J.body?!0:!1,content:{"application/json":{schema:{type:"object",properties:X,required:G}}}}}}function fH(J){if(J instanceof BJ){let W=J._def.innerType;return{...fH(W),nullable:!0}}if(J instanceof ZW){let W=J.shape;if(W){let X={},G=[];return Object.entries(W).forEach(([Y,$])=>{if($ instanceof Q6){if(X[Y]=fH($),!($ instanceof BJ))G.push(Y)}}),{type:"object",properties:X,...G.length>0?{required:G}:{},description:J.description}}}return{type:sc(J),description:J.description}}function hH(J){return{"400":{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}},required:["message"]}}},description:"Bad Request. Usually due to missing parameters, or invalid parameters."},"401":{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}},required:["message"]}}},description:"Unauthorized. Due to missing or invalid authentication."},"403":{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}}}}},description:"Forbidden. You do not have permission to access this resource or to perform this action."},"404":{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}}}}},description:"Not Found. The requested resource was not found."},"429":{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}}}}},description:"Too Many Requests. You have exceeded the rate limit. Try again later."},"500":{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}}}}},description:"Internal Server Error. This is a problem with the server that you cannot fix."},...J}}function ME(J){return J.split("/").map((W)=>W.startsWith(":")?`{${W.slice(1)}}`:W).join("/")}async function OE(J,W){let X=UG(J,{...W,plugins:[]}),G=Z8({...W,session:{...W.session,storeSessionInDatabase:!0}}),Y={schemas:{...Object.entries(G).reduce((K,[w,H])=>{let Z=w.charAt(0).toUpperCase()+w.slice(1),z=H.fields,N=[],F={id:{type:"string"}};return Object.entries(z).forEach(([Q,V])=>{if(!V)return;if(F[Q]=ec(V),V.required&&V.input!==!1)N.push(Q)}),Object.entries(F).forEach(([Q,V])=>{let v=H.fields[Q];if(v&&v.type==="date"&&V.type==="string")V.format="date-time"}),K[Z]={type:"object",properties:F,required:N},K},{})}},$={};Object.entries(X.api).forEach(([K,w])=>{if(J.options.disabledPaths?.includes(w.path))return;let H=w.options;if(H.metadata?.SERVER_ONLY)return;let Z=ME(w.path);if(H.method==="GET"||H.method==="DELETE")$[Z]={...$[Z],[H.method.toLowerCase()]:{tags:["Default",...H.metadata?.openapi?.tags||[]],description:H.metadata?.openapi?.description,operationId:H.metadata?.openapi?.operationId,security:[{bearerAuth:[]}],parameters:kH(H),responses:hH(H.metadata?.openapi?.responses)}};if(H.method==="POST"||H.method==="PATCH"||H.method==="PUT"){let z=vE(H);$[Z]={...$[Z],[H.method.toLowerCase()]:{tags:["Default",...H.metadata?.openapi?.tags||[]],description:H.metadata?.openapi?.description,operationId:H.metadata?.openapi?.operationId,security:[{bearerAuth:[]}],parameters:kH(H),...z?{requestBody:z}:{requestBody:{content:{"application/json":{schema:{type:"object",properties:{}}}}}},responses:hH(H.metadata?.openapi?.responses)}}}});for(let K of W.plugins||[]){if(K.id==="open-api")continue;let w=UG(J,{...W,plugins:[K]}),H=Object.keys(w.api).map((Z)=>{if(X.api[Z]===void 0)return w.api[Z];return null}).filter((Z)=>Z!==null);Object.entries(H).forEach(([Z,z])=>{if(J.options.disabledPaths?.includes(z.path))return;let N=z.options;if(N.metadata?.SERVER_ONLY)return;let F=ME(z.path);if(N.method==="GET"||N.method==="DELETE")$[F]={...$[F],[N.method.toLowerCase()]:{tags:N.metadata?.openapi?.tags||[K.id.charAt(0).toUpperCase()+K.id.slice(1)],description:N.metadata?.openapi?.description,operationId:N.metadata?.openapi?.operationId,security:[{bearerAuth:[]}],parameters:kH(N),responses:hH(N.metadata?.openapi?.responses)}};if(N.method==="POST"||N.method==="PATCH"||N.method==="PUT")$[F]={...$[F],[N.method.toLowerCase()]:{tags:N.metadata?.openapi?.tags||[K.id.charAt(0).toUpperCase()+K.id.slice(1)],description:N.metadata?.openapi?.description,operationId:N.metadata?.openapi?.operationId,security:[{bearerAuth:[]}],parameters:kH(N),requestBody:vE(N),responses:hH(N.metadata?.openapi?.responses)}}})}return{openapi:"3.1.1",info:{title:"Better Auth",description:"API Reference for your Better Auth Instance",version:"1.1.0"},components:{...Y,securitySchemes:{apiKeyCookie:{type:"apiKey",in:"cookie",name:"apiKeyCookie",description:"API Key authentication via cookie"},bearerAuth:{type:"http",scheme:"bearer",description:"Bearer token authentication"}}},security:[{apiKeyCookie:[],bearerAuth:[]}],servers:[{url:J.baseURL}],tags:[{name:"Default",description:"Default endpoints that are included with Better Auth by default. These endpoints are not part of any plugin."}],paths:$}}var Jp=`<svg width="75" height="75" viewBox="0 0 75 75" fill="none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<rect width="75" height="75" fill="url(#pattern0_21_12)"/>
<defs>
<pattern id="pattern0_21_12" patternContentUnits="objectBoundingBox" width="1" height="1">
<use xlink:href="#image0_21_12" transform="scale(0.00094697)"/>
</pattern>
<image id="image0_21_12" width="1056" height="1056" xlink:href="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAASABIAAD/4QBARXhpZgAATU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAEIKADAAQAAAABAAAEIAAAAAD/7QA4UGhvdG9zaG9wIDMuMAA4QklNBAQAAAAAAAA4QklNBCUAAAAAABDUHYzZjwCyBOmACZjs+EJ+/+ICKElDQ19QUk9GSUxFAAEBAAACGGFwcGwEAAAAbW50clJHQiBYWVogB+YAAQABAAAAAAAAYWNzcEFQUEwAAAAAQVBQTAAAAAAAAAAAAAAAAAAAAAAAAPbWAAEAAAAA0y1hcHBs7P2jjjiFR8NttL1PetoYLwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKZGVzYwAAAPwAAAAwY3BydAAAASwAAABQd3RwdAAAAXwAAAAUclhZWgAAAZAAAAAUZ1hZWgAAAaQAAAAUYlhZWgAAAbgAAAAUclRSQwAAAcwAAAAgY2hhZAAAAewAAAAsYlRSQwAAAcwAAAAgZ1RSQwAAAcwAAAAgbWx1YwAAAAAAAAABAAAADGVuVVMAAAAUAAAAHABEAGkAcwBwAGwAYQB5ACAAUAAzbWx1YwAAAAAAAAABAAAADGVuVVMAAAA0AAAAHABDAG8AcAB5AHIAaQBnAGgAdAAgAEEAcABwAGwAZQAgAEkAbgBjAC4ALAAgADIAMAAyADJYWVogAAAAAAAA9tUAAQAAAADTLFhZWiAAAAAAAACD3wAAPb////+7WFlaIAAAAAAAAEq/AACxNwAACrlYWVogAAAAAAAAKDgAABELAADIuXBhcmEAAAAAAAMAAAACZmYAAPKnAAANWQAAE9AAAApbc2YzMgAAAAAAAQxCAAAF3v//8yYAAAeTAAD9kP//+6L///2jAAAD3AAAwG7/wAARCAQgBCADASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9sAQwACAgICAgIDAgIDBAMDAwQFBAQEBAUHBQUFBQUHCAcHBwcHBwgICAgICAgICgoKCgoKCwsLCwsNDQ0NDQ0NDQ0N/9sAQwECAgIDAwMGAwMGDQkHCQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0N/90ABABC/9oADAMBAAIRAxEAPwD9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//Q/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0f38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9L9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//T/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1P38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9X9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//W/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1/38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9D9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//R/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0v38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9P9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//U/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1f38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9b9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//X/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0P38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9H9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//S/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0/38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9T9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//V/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1v38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK/Ln/gq38a/in8Dvgp4T8R/CfxFdeG9SvvFMdlcXFoELyW5srqQxnzEcY3op4Gciv1Gr8Z/+C2X/JvXgj/sc4v/AE33lAH4z/8ADwv9tD/oq2tf9823/wAZo/4eF/tof9FW1r/vm2/+M18Z0UAfZn/Dwv8AbQ/6KtrX/fNt/wDGaP8Ah4X+2h/0VbWv++bb/wCM18Z0UAfZn/Dwv9tD/oq2tf8AfNt/8Zo/4eF/tof9FW1r/vm2/wDjNfGdFAH2Z/w8L/bQ/wCira1/3zbf/GaP+Hhf7aH/AEVbWv8Avm2/+M18Z0UAfZn/AA8L/bQ/6KtrX/fNt/8AGaP+Hhf7aH/RVta/75tv/jNfGdFAH2Z/w8L/AG0P+ira1/3zbf8Axmj/AIeF/tof9FW1r/vm2/8AjNfGdFAH63/sVftq/tTfEb9qb4deCfG3xF1TVtD1bVGgvbKdYBHPGIJW2ttiVsblB4I6V/UbX8Z//BPT/k9D4U/9hpv/AEmmr+zCgAooooAKKKKACiiigAooooAKKKKACiiigD+M/wD4eF/tof8ARVta/wC+bb/4zR/w8L/bQ/6KtrX/AHzbf/Ga+M6KAPsz/h4X+2h/0VbWv++bb/4zR/w8L/bQ/wCira1/3zbf/Ga+M6KAPsz/AIeF/tof9FW1r/vm2/8AjNH/AA8L/bQ/6KtrX/fNt/8AGa+M6KAPsz/h4X+2h/0VbWv++bb/AOM0f8PC/wBtD/oq2tf9823/AMZr4zooA+zP+Hhf7aH/AEVbWv8Avm2/+M0f8PC/20P+ira1/wB823/xmvjOigD7M/4eF/tof9FW1r/vm2/+M0f8PC/20P8Aoq2tf9823/xmvjOigD7M/wCHhf7aH/RVta/75tv/AIzR/wAPC/20P+ira1/3zbf/ABmvjOigD7M/4eF/tof9FW1r/vm2/wDjNH/Dwv8AbQ/6KtrX/fNt/wDGa+M6KAPsz/h4X+2h/wBFW1r/AL5tv/jNH/Dwv9tD/oq2tf8AfNt/8Zr4zooA+zP+Hhf7aH/RVta/75tv/jNH/Dwv9tD/AKKtrX/fNt/8Zr4zooA+zP8Ah4X+2h/0VbWv++bb/wCM0f8ADwv9tD/oq2tf9823/wAZr4zooA+zP+Hhf7aH/RVta/75tv8A4zR/w8L/AG0P+ira1/3zbf8AxmvjOigD7M/4eF/tof8ARVta/wC+bb/4zR/w8L/bQ/6KtrX/AHzbf/Ga+M6KAP6tv+CUnxr+Kfxx+CnizxH8WPEV14k1Kx8UyWVvcXYQPHbiytZBGPLRBje7HkZya/Uavxn/AOCJv/JvXjf/ALHOX/032dfsxQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAf//X/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAr8Z/+C2X/JvXgj/sc4v/AE33lfsxX4z/APBbL/k3rwR/2OcX/pvvKAP5m6KKKACiiigAooooAKKKKACiiigAooooA+zP+Cen/J6Hwp/7DTf+k01f2YV/Gf8A8E9P+T0PhT/2Gm/9Jpq/swoAKKKKACiiigAooooAKKKKACiiigAooooA/gDooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/pk/4Im/8m9eN/8Asc5f/TfZ1+zFfjP/AMETf+TevG//AGOcv/pvs6/ZigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/9D9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACvxn/4LZf8m9eCP+xzi/8ATfeV+zFfjP8A8Fsv+TevBH/Y5xf+m+8oA/mbooooAKKKKACiiigAooooAKKKKACiiigD7M/4J6f8nofCn/sNN/6TTV/ZhX8Z/wDwT0/5PQ+FP/Yab/0mmr+zCgAooooAKKKKACiiigAooooAKKKKACiiigD+AOiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD+mT/gib/yb143/wCxzl/9N9nX7MV+M/8AwRN/5N68b/8AY5y/+m+zr9mKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/0f38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK/Gf/gtl/yb14I/7HOL/wBN95X7MV+M/wDwWy/5N68Ef9jnF/6b7ygD+ZuiiigAooooAKKKKACiiigAooooAKKKKAPsz/gnp/yeh8Kf+w03/pNNX9mFfxn/APBPT/k9D4U/9hpv/Saav7MKACiiigAooooAKKKKACiiigAooooAKKKKAP4A6KKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP6ZP+CJv/JvXjf/ALHOX/032dfsxX4z/wDBE3/k3rxv/wBjnL/6b7Ov2YoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/S/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAr8Z/+C2X/JvXgj/sc4v/AE33lfsxX4z/APBbL/k3rwR/2OcX/pvvKAP5m6KKKACiiigAooooAKKKKACiiigAooooA+zP+Cen/J6Hwp/7DTf+k01f2YV/Gf8A8E9P+T0PhT/2Gm/9Jpq/swoAKKKKACiiigAooooAKKKKACiiigAooooA/gDooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/pk/4Im/8m9eN/8Asc5f/TfZ1+zFfjP/AMETf+TevG//AGOcv/pvs6/ZigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/9P9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACvxn/4LZf8m9eCP+xzi/8ATfeV+zFfjP8A8Fsv+TevBH/Y5xf+m+8oA/mbooooAKKKKACiiigAooooAKKKKACiiigD7M/4J6f8nofCn/sNN/6TTV/ZhX8Z/wDwT0/5PQ+FP/Yab/0mmr+zCgAooooAKKKKACiiigAooooAKKKKACiiigD+AOiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD+mT/gib/yb143/wCxzl/9N9nX7MV+M/8AwRN/5N68b/8AY5y/+m+zr9mKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/1P38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK/Gf/gtl/yb14I/7HOL/wBN95X7MV+M/wDwWy/5N68Ef9jnF/6b7ygD+ZuiiigAooooAKKKKACiiigAooooAKKKKAPsz/gnp/yeh8Kf+w03/pNNX9mFfwq/BT4r638Dvin4d+LHhy0tb7UvDd0bu3t70ObeRzG0eJBGyPjDnowOa/Ub/h9l+0L/ANCR4M/79ah/8m0Af0yUV/M3/wAPsv2hf+hI8Gf9+tQ/+TaP+H2X7Qv/AEJHgz/v1qH/AMm0Af0yUV/M3/w+y/aF/wChI8Gf9+tQ/wDk2j/h9l+0L/0JHgz/AL9ah/8AJtAH9MlFfzN/8Psv2hf+hI8Gf9+tQ/8Ak2j/AIfZftC/9CR4M/79ah/8m0Af0yUV/M3/AMPsv2hf+hI8Gf8AfrUP/k2j/h9l+0L/ANCR4M/79ah/8m0Af0yUV/M3/wAPsv2hf+hI8Gf9+tQ/+TaP+H2X7Qv/AEJHgz/v1qH/AMm0Af0yUV/M3/w+y/aF/wChI8Gf9+tQ/wDk2j/h9l+0L/0JHgz/AL9ah/8AJtAH4z0V/TJ/w5N/Z6/6Hfxn/wB/dP8A/kKj/hyb+z1/0O/jP/v7p/8A8hUAfzN0V/TJ/wAOTf2ev+h38Z/9/dP/APkKj/hyb+z1/wBDv4z/AO/un/8AyFQB/M3RX9Mn/Dk39nr/AKHfxn/390//AOQqP+HJv7PX/Q7+M/8Av7p//wAhUAfzN0V/TJ/w5N/Z6/6Hfxn/AN/dP/8AkKj/AIcm/s9f9Dv4z/7+6f8A/IVAH8zdFf0yf8OTf2ev+h38Z/8Af3T/AP5Co/4cm/s9f9Dv4z/7+6f/APIVAH8zdFf0yf8ADk39nr/od/Gf/f3T/wD5Co/4cm/s9f8AQ7+M/wDv7p//AMhUAfzN0V/TJ/w5N/Z6/wCh38Z/9/dP/wDkKvwV/ag+FGifA74++M/hP4cu7q+03w3fi0t7i9KG4kQxRyZkMaomcueigYoA8FooooAKKKKACiiigAooooAKKKKACiiigD+mT/gib/yb143/AOxzl/8ATfZ1+zFfjP8A8ETf+TevG/8A2Ocv/pvs6/ZigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//9X9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACvxn/4LZf8m9eCP+xzi/8ATfeV+zFfjP8A8Fsv+TevBH/Y5xf+m+8oA/mbooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/v8ooooAKKKKACiiigAooooAKKKKACiiigAr+M//goX/wAnofFb/sNL/wCk0Nf2YV/Gf/wUL/5PQ+K3/YaX/wBJoaAPjOiiigAooooAKKKKACiiigAooooAKKKKAP6ZP+CJv/JvXjf/ALHOX/032dfsxX4z/wDBE3/k3rxv/wBjnL/6b7Ov2YoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/W/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAr8Z/+C2X/JvXgj/sc4v/AE33lfsxX4z/APBbL/k3rwR/2OcX/pvvKAP5m6KKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP7/KKKKACiiigAooooAKKKKACiiigAooooAK/jP/4KF/8AJ6HxW/7DS/8ApNDX9mFfxn/8FC/+T0Pit/2Gl/8ASaGgD4zooooAKKKKACiiigAooooAKKKKACiiigD+mT/gib/yb143/wCxzl/9N9nX7MV+M/8AwRN/5N68b/8AY5y/+m+zr9mKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/1/38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK/Gf/gtl/yb14I/7HOL/wBN95X7MV+M/wDwWy/5N68Ef9jnF/6b7ygD+ZuiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD+/yiiigAooooAKKKKACiiigAooooAKKKKACv4z/+Chf/ACeh8Vv+w0v/AKTQ1/ZhX8Z//BQv/k9D4rf9hpf/AEmhoA+M6KKKACiiigAooooAKKKKACiiigAooooA/pk/4Im/8m9eN/8Asc5f/TfZ1+zFfjP/AMETf+TevG//AGOcv/pvs6/ZigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/9D9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACvxn/4LZf8m9eCP+xzi/8ATfeV+zFfjP8A8Fsv+TevBH/Y5xf+m+8oA/mbooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/v8ooooAKKKKACiiigAooooAKKKKACiiigAr+M//goX/wAnofFb/sNL/wCk0Nf2YV/Gf/wUL/5PQ+K3/YaX/wBJoaAPjOiiigAooooAKKKKACiiigAooooAKKKKAP6ZP+CJv/JvXjf/ALHOX/032dfsxX4z/wDBE3/k3rxv/wBjnL/6b7Ov2YoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/R/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAr8Z/+C2X/JvXgj/sc4v/AE33lfsxX4z/APBbL/k3rwR/2OcX/pvvKAP5m6KKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP7/KKKKACiiigAooooAKKKKACiiigAooooAK/jP/4KF/8AJ6HxW/7DS/8ApNDX9mFfxn/8FC/+T0Pit/2Gl/8ASaGgD4zooooAKKKKACiiigAooooAKKKKACiiigD+mT/gib/yb143/wCxzl/9N9nX7MV+M/8AwRN/5N68b/8AY5y/+m+zr9mKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/0v38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK/Gf/gtl/yb14I/7HOL/wBN95X7MV+M/wDwWy/5N68Ef9jnF/6b7ygD+ZuiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD+/yiiigAooooAKKKKACiiigAooooAKKKKACv4z/+Chf/ACeh8Vv+w0v/AKTQ1/ZhX8Z//BQv/k9D4rf9hpf/AEmhoA+M6KKKACiiigAooooAKKKKACiiigAooooA/pk/4Im/8m9eN/8Asc5f/TfZ1+zFfjP/AMETf+TevG//AGOcv/pvs6/ZigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/9P9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACvxn/4LZf8m9eCP+xzi/8ATfeV+zFfjP8A8Fsv+TevBH/Y5xf+m+8oA/mbooooAKKKKACiiigAooooAKKKKACiiigD1L4KfCjW/jj8U/Dvwn8OXdrY6l4kujaW9xelxbxuI2kzIY1d8YQ9FJzX6jf8OTf2hf8Aod/Bn/f3UP8A5Cr4z/4J6f8AJ6Hwp/7DTf8ApNNX9mFAH8zf/Dk39oX/AKHfwZ/391D/AOQqP+HJv7Qv/Q7+DP8Av7qH/wAhV/TJRQB/M3/w5N/aF/6HfwZ/391D/wCQqP8Ahyb+0L/0O/gz/v7qH/yFX9MlFAH8zf8Aw5N/aF/6HfwZ/wB/dQ/+QqP+HJv7Qv8A0O/gz/v7qH/yFX9MlFAH8zf/AA5N/aF/6HfwZ/391D/5Co/4cm/tC/8AQ7+DP+/uof8AyFX9MlFAH8zf/Dk39oX/AKHfwZ/391D/AOQqP+HJv7Qv/Q7+DP8Av7qH/wAhV/TJRQB/M3/w5N/aF/6HfwZ/391D/wCQqP8Ahyb+0L/0O/gz/v7qH/yFX9MlFAH4z/8AD7L9nr/oSPGf/frT/wD5No/4fZfs9f8AQkeM/wDv1p//AMm1/M3RQB/TJ/w+y/Z6/wChI8Z/9+tP/wDk2j/h9l+z1/0JHjP/AL9af/8AJtfzN0UAf0yf8Psv2ev+hI8Z/wDfrT//AJNo/wCH2X7PX/QkeM/+/Wn/APybX8zdFAH9Mn/D7L9nr/oSPGf/AH60/wD+TaP+H2X7PX/QkeM/+/Wn/wDybX8zdFAH9Mn/AA+y/Z6/6Ejxn/360/8A+TaP+H2X7PX/AEJHjP8A79af/wDJtfzN0UAf0yf8Psv2ev8AoSPGf/frT/8A5No/4fZfs9f9CR4z/wC/Wn//ACbX8zdFAH9Mn/D7L9nr/oSPGf8A360//wCTa/BX9qD4r6J8cfj74z+LHhy0urHTfEl+Lu3t70ILiNBFHHiQRs6Zyh6MRivBaKACiiigAooooAKKKKACiiigAooooAKKKKAP6ZP+CJv/ACb143/7HOX/ANN9nX7MV+M//BE3/k3rxv8A9jnL/wCm+zr9mKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD//U/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAr8Z/+C2X/JvXgj/sc4v/AE33lfsxX4z/APBbL/k3rwR/2OcX/pvvKAP5m6KKKACiiigAooooAKKKKACiiigAooooA+zP+Cen/J6Hwp/7DTf+k01f2YV/Gf8A8E9P+T0PhT/2Gm/9Jpq/swoAKKKKACiiigAooooAKKKKACiiigAooooA/gDooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/pk/4Im/8m9eN/8Asc5f/TfZ1+zFfjP/AMETf+TevG//AGOcv/pvs6/ZigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/9X9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACvxn/4LZf8m9eCP+xzi/8ATfeV+zFfjP8A8Fsv+TevBH/Y5xf+m+8oA/mbooooAKKKKACiiigAooooAKKKKACiiigD7M/4J6f8nofCn/sNN/6TTV/ZhX8Z/wDwT0/5PQ+FP/Yab/0mmr+zCgAooooAKKKKACiiigAooooAKKKKACiiigD+AOiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD+mT/gib/yb143/wCxzl/9N9nX7MV+M/8AwRN/5N68b/8AY5y/+m+zr9mKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/1v38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK/Gf/gtl/yb14I/7HOL/wBN95X7MV+M/wDwWy/5N68Ef9jnF/6b7ygD+ZuiiigAooooAKKKKACiiigAooooAKKKKAPsz/gnp/yeh8Kf+w03/pNNX9mFfxn/APBPT/k9D4U/9hpv/Saav7MKACiiigAooooAKKKKACiiigAooooAKKKKAP4A6KKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP6ZP+CJv/JvXjf/ALHOX/032dfsxX4z/wDBE3/k3rxv/wBjnL/6b7Ov2YoAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/X/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAr8Z/+C2X/JvXgj/sc4v/AE33lfsxX4z/APBbL/k3rwR/2OcX/pvvKAP5m6KKKACiiigAooooAKKKKACiiigAooooA+zP+Cen/J6Hwp/7DTf+k01f2YV/Gf8A8E9P+T0PhT/2Gm/9Jpq/swoAKKKKACiiigAooooAKKKKACiiigAooooA/gDooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/pk/4Im/8m9eN/8Asc5f/TfZ1+zFfjP/AMETf+TevG//AGOcv/pvs6/ZigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA/9D9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACvxn/4LZf8m9eCP+xzi/8ATfeV+zFfjP8A8Fsv+TevBH/Y5xf+m+8oA/mbooooAKKKKACiiigAooooAKKKKACiiigD7M/4J6f8nofCn/sNN/6TTV/ZhX8Z/wDwT0/5PQ+FP/Yab/0mmr+zCgAooooAKKKKACiiigAooooAKKKKACiiigD+AOiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD+mT/gib/yb143/wCxzl/9N9nX7MV+M/8AwRN/5N68b/8AY5y/+m+zr9mKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/0f38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAK/Gf/gtl/yb14I/7HOL/wBN95X7MV+XP/BVv4KfFP44/BTwn4c+E/h268SalY+KY724t7QoHjtxZXUZkPmOgxvdRwc5NAH8pNFfZn/DvT9tD/olOtf99W3/AMeo/wCHen7aH/RKda/76tv/AI9QB8Z0V9mf8O9P20P+iU61/wB9W3/x6j/h3p+2h/0SnWv++rb/AOPUAfGdFfZn/DvT9tD/AKJTrX/fVt/8eo/4d6ftof8ARKda/wC+rb/49QB8Z0V9mf8ADvT9tD/olOtf99W3/wAeo/4d6ftof9Ep1r/vq2/+PUAfGdFfZn/DvT9tD/olOtf99W3/AMeo/wCHen7aH/RKda/76tv/AI9QB8Z0V9mf8O9P20P+iU61/wB9W3/x6j/h3p+2h/0SnWv++rb/AOPUAH/BPT/k9D4U/wDYab/0mmr+zCv5cv2Kv2Kv2pvhz+1N8OvG3jb4dappOh6TqjT3t7O0BjgjMEq7m2ys2NzAcA9a/qNoAKKKKACiiigAooooAKKKKACiiigAooooA/gDor7M/wCHen7aH/RKda/76tv/AI9R/wAO9P20P+iU61/31bf/AB6gD4zor7M/4d6ftof9Ep1r/vq2/wDj1H/DvT9tD/olOtf99W3/AMeoA+M6K+zP+Hen7aH/AESnWv8Avq2/+PUf8O9P20P+iU61/wB9W3/x6gD4zor7M/4d6ftof9Ep1r/vq2/+PUf8O9P20P8AolOtf99W3/x6gD4zor7M/wCHen7aH/RKda/76tv/AI9R/wAO9P20P+iU61/31bf/AB6gD4zor7M/4d6ftof9Ep1r/vq2/wDj1H/DvT9tD/olOtf99W3/AMeoA+M6K+zP+Hen7aH/AESnWv8Avq2/+PUf8O9P20P+iU61/wB9W3/x6gD4zor7M/4d6ftof9Ep1r/vq2/+PUf8O9P20P8AolOtf99W3/x6gD4zor7M/wCHen7aH/RKda/76tv/AI9R/wAO9P20P+iU61/31bf/AB6gD4zor7M/4d6ftof9Ep1r/vq2/wDj1H/DvT9tD/olOtf99W3/AMeoA+M6K+zP+Hen7aH/AESnWv8Avq2/+PUf8O9P20P+iU61/wB9W3/x6gD4zor7M/4d6ftof9Ep1r/vq2/+PUf8O9P20P8AolOtf99W3/x6gD4zor7M/wCHen7aH/RKda/76tv/AI9R/wAO9P20P+iU61/31bf/AB6gD9mP+CJv/JvXjf8A7HOX/wBN9nX7MV+XP/BKT4KfFP4HfBTxZ4c+LHh268N6lfeKZL23t7soXktzZWsYkHlu4xvRhyc5FfqNQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAf/9L9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//T/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1P38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9X9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//W/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1/38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9D9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//R/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0v38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9P9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//U/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1f38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9b9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//X/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0P38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9H9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//S/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/0/38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9T9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//V/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/1v38ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD/9f9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//Q/fyiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/2Q=="/>
</defs>
</svg>
`,Wp=(J,W,X)=>{let G=X?`nonce="${X}"`:"";return`<!doctype html>
<html>
  <head>
    <title>Scalar API Reference</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1" />
  </head>
  <body>
    <script
      id="api-reference"
      type="application/json">
    ${JSON.stringify(J)}
    </script>
	 <script ${G}>
      var configuration = {
	  	favicon: "data:image/svg+xml;utf8,${encodeURIComponent(Jp)}",
	   	theme: "${W||"default"}",
        metaData: {
			title: "Better Auth API",
			description: "API Reference for your Better Auth Instance",
		}
      }

      document.getElementById('api-reference').dataset.configuration =
        JSON.stringify(configuration)
    </script>
	  <script src="https://cdn.jsdelivr.net/npm/@scalar/api-reference" ${G}></script>
  </body>
</html>`},jv=(J)=>{let W=J?.path??"/reference";return{id:"open-api",endpoints:{generateOpenAPISchema:y("/open-api/generate-schema",{method:"GET"},async(X)=>{let G=await OE(X.context,X.context.options);return X.json(G)}),openAPIReference:y(W,{method:"GET",metadata:{isAction:!1}},async(X)=>{if(J?.disableDefaultReference)throw new L("NOT_FOUND");let G=await OE(X.context,X.context.options);return new Response(Wp(G,J?.theme,J?.nonce),{headers:{"Content-Type":"text/html"}})})}}};i0();MJ();R4();i4();O0();var Xp=(J,W)=>{let X={};for(let[G,Y]of Object.entries(J))X[G]=($)=>{return Y({...$,context:{...W,...$.context}})},X[G].path=Y.path,X[G].method=Y.method,X[G].options=Y.options,X[G].headers=Y.headers;return X},c6=(J,W)=>{let X=J.adapter;return{findOrganizationBySlug:async(G)=>{return await(await s(X)).findOne({model:"organization",where:[{field:"slug",value:G}]})},createOrganization:async(G)=>{let Y=await(await s(X)).create({model:"organization",data:{...G.organization,metadata:G.organization.metadata?JSON.stringify(G.organization.metadata):void 0},forceAllowId:!0});return{...Y,metadata:Y.metadata&&typeof Y.metadata==="string"?JSON.parse(Y.metadata):void 0}},findMemberByEmail:async(G)=>{let Y=await s(X),$=await Y.findOne({model:"user",where:[{field:"email",value:G.email.toLowerCase()}]});if(!$)return null;let K=await Y.findOne({model:"member",where:[{field:"organizationId",value:G.organizationId},{field:"userId",value:$.id}]});if(!K)return null;return{...K,user:{id:$.id,name:$.name,email:$.email,image:$.image}}},listMembers:async(G)=>{let Y=await s(X),$=await Promise.all([Y.findMany({model:"member",where:[{field:"organizationId",value:G.organizationId},...G.filter?.field?[{field:G.filter?.field,value:G.filter?.value}]:[]],limit:G.limit||W?.membershipLimit||100,offset:G.offset||0,sortBy:G.sortBy?{field:G.sortBy,direction:G.sortOrder||"asc"}:void 0}),Y.count({model:"member",where:[{field:"organizationId",value:G.organizationId},...G.filter?.field?[{field:G.filter?.field,value:G.filter?.value}]:[]]})]),K=await Y.findMany({model:"user",where:[{field:"id",value:$[0].map((w)=>w.userId),operator:"in"}]});return{members:$[0].map((w)=>{let H=K.find((Z)=>Z.id===w.userId);if(!H)throw new W6("Unexpected error: User not found for member");return{...w,user:{id:H.id,name:H.name,email:H.email,image:H.image}}}),total:$[1]}},findMemberByOrgId:async(G)=>{let Y=await(await s(X)).findOne({model:"member",where:[{field:"userId",value:G.userId},{field:"organizationId",value:G.organizationId}],join:{user:!0}});if(!Y||!Y.user)return null;let{user:$,...K}=Y;return{...K,user:{id:$.id,name:$.name,email:$.email,image:$.image}}},findMemberById:async(G)=>{let Y=await(await s(X)).findOne({model:"member",where:[{field:"id",value:G}],join:{user:!0}});if(!Y)return null;let{user:$,...K}=Y;return{...K,user:{id:$.id,name:$.name,email:$.email,image:$.image}}},createMember:async(G)=>{return await(await s(X)).create({model:"member",data:{...G,createdAt:new Date}})},updateMember:async(G,Y)=>{return await(await s(X)).update({model:"member",where:[{field:"id",value:G}],update:{role:Y}})},deleteMember:async({memberId:G,organizationId:Y,userId:$})=>{let K=await s(X),w;if(!$){let Z=await K.findOne({model:"member",where:[{field:"id",value:G}]});if(!Z)throw new W6("Member not found");w=Z.userId}else w=$;let H=await K.delete({model:"member",where:[{field:"id",value:G}]});if(W?.teams?.enabled){let Z=await K.findMany({model:"team",where:[{field:"organizationId",value:Y}]});await Promise.all(Z.map((z)=>K.deleteMany({model:"teamMember",where:[{field:"teamId",value:z.id},{field:"userId",value:w}]})))}return H},updateOrganization:async(G,Y)=>{let $=await(await s(X)).update({model:"organization",where:[{field:"id",value:G}],update:{...Y,metadata:typeof Y.metadata==="object"?JSON.stringify(Y.metadata):Y.metadata}});if(!$)return null;return{...$,metadata:$.metadata?_H($.metadata):void 0}},deleteOrganization:async(G)=>{let Y=await s(X);return await Y.delete({model:"member",where:[{field:"organizationId",value:G}]}),await Y.delete({model:"invitation",where:[{field:"organizationId",value:G}]}),await Y.delete({model:"organization",where:[{field:"id",value:G}]}),G},setActiveOrganization:async(G,Y,$)=>{return await J.internalAdapter.updateSession(G,{activeOrganizationId:Y})},findOrganizationById:async(G)=>{return await(await s(X)).findOne({model:"organization",where:[{field:"id",value:G}]})},checkMembership:async({userId:G,organizationId:Y})=>{return await(await s(X)).findOne({model:"member",where:[{field:"userId",value:G},{field:"organizationId",value:Y}]})},findFullOrganization:async({organizationId:G,isSlug:Y,includeTeams:$,membersLimit:K})=>{let w=await s(X),H=await w.findOne({model:"organization",where:[{field:Y?"slug":"id",value:G}],join:{invitation:!0,member:K?{limit:K}:!0,...$?{team:!0}:{}}});if(!H)return null;let{invitation:Z,member:z,team:N,...F}=H,Q=z.map((O)=>O.userId),V=Q.length>0?await w.findMany({model:"user",where:[{field:"id",value:Q,operator:"in"}],limit:W?.membershipLimit||100}):[],v=new Map(V.map((O)=>[O.id,O])),M=z.map((O)=>{let S=v.get(O.userId);if(!S)throw new W6("Unexpected error: User not found for member");return{...O,user:{id:S.id,name:S.name,email:S.email,image:S.image}}});return{...F,invitations:Z,members:M,teams:N}},listOrganizations:async(G)=>{let Y=await(await s(X)).findMany({model:"member",where:[{field:"userId",value:G}],join:{organization:!0}});if(!Y||Y.length===0)return[];return Y.map(($)=>$.organization)},createTeam:async(G)=>{return await(await s(X)).create({model:"team",data:G})},findTeamById:async({teamId:G,organizationId:Y,includeTeamMembers:$})=>{let K=await(await s(X)).findOne({model:"team",where:[{field:"id",value:G},...Y?[{field:"organizationId",value:Y}]:[]],join:{...$?{teamMember:!0}:{}}});if(!K)return null;let{teamMember:w,...H}=K;return{...H,...$?{members:w}:{}}},updateTeam:async(G,Y)=>{let $=await s(X);if("id"in Y)Y.id=void 0;return await $.update({model:"team",where:[{field:"id",value:G}],update:{...Y}})},deleteTeam:async(G)=>{let Y=await s(X);return await Y.deleteMany({model:"teamMember",where:[{field:"teamId",value:G}]}),await Y.delete({model:"team",where:[{field:"id",value:G}]})},listTeams:async(G)=>{return await(await s(X)).findMany({model:"team",where:[{field:"organizationId",value:G}]})},createTeamInvitation:async({email:G,role:Y,teamId:$,organizationId:K,inviterId:w,expiresIn:H=172800000})=>{let Z=await s(X),z=F4(H);return await Z.create({model:"invitation",data:{email:G,role:Y,organizationId:K,teamId:$,inviterId:w,status:"pending",expiresAt:z}})},setActiveTeam:async(G,Y,$)=>{return await J.internalAdapter.updateSession(G,{activeTeamId:Y})},listTeamMembers:async(G)=>{return await(await s(X)).findMany({model:"teamMember",where:[{field:"teamId",value:G.teamId}]})},countTeamMembers:async(G)=>{return await(await s(X)).count({model:"teamMember",where:[{field:"teamId",value:G.teamId}]})},countMembers:async(G)=>{return await(await s(X)).count({model:"member",where:[{field:"organizationId",value:G.organizationId}]})},listTeamsByUser:async(G)=>{return(await(await s(X)).findMany({model:"teamMember",where:[{field:"userId",value:G.userId}],join:{team:!0}})).map((Y)=>Y.team)},findTeamMember:async(G)=>{return await(await s(X)).findOne({model:"teamMember",where:[{field:"teamId",value:G.teamId},{field:"userId",value:G.userId}]})},findOrCreateTeamMember:async(G)=>{let Y=await s(X),$=await Y.findOne({model:"teamMember",where:[{field:"teamId",value:G.teamId},{field:"userId",value:G.userId}]});if($)return $;return await Y.create({model:"teamMember",data:{teamId:G.teamId,userId:G.userId,createdAt:new Date}})},removeTeamMember:async(G)=>{await(await s(X)).deleteMany({model:"teamMember",where:[{field:"teamId",value:G.teamId},{field:"userId",value:G.userId}]})},findInvitationsByTeamId:async(G)=>{return await(await s(X)).findMany({model:"invitation",where:[{field:"teamId",value:G}]})},listUserInvitations:async(G)=>{return await(await s(X)).findMany({model:"invitation",where:[{field:"email",value:G.toLowerCase()}]})},createInvitation:async({invitation:G,user:Y})=>{let $=await s(X),K=F4(W?.invitationExpiresIn||172800,"sec");return await $.create({model:"invitation",data:{status:"pending",expiresAt:K,createdAt:new Date,inviterId:Y.id,...G,teamId:G.teamIds.length>0?G.teamIds.join(","):null}})},findInvitationById:async(G)=>{return await(await s(X)).findOne({model:"invitation",where:[{field:"id",value:G}]})},findPendingInvitation:async(G)=>{return(await(await s(X)).findMany({model:"invitation",where:[{field:"email",value:G.email.toLowerCase()},{field:"organizationId",value:G.organizationId},{field:"status",value:"pending"}]})).filter((Y)=>new Date(Y.expiresAt)>new Date)},findPendingInvitations:async(G)=>{return(await(await s(X)).findMany({model:"invitation",where:[{field:"organizationId",value:G.organizationId},{field:"status",value:"pending"}]})).filter((Y)=>new Date(Y.expiresAt)>new Date)},listInvitations:async(G)=>{return await(await s(X)).findMany({model:"invitation",where:[{field:"organizationId",value:G.organizationId}]})},updateInvitation:async(G)=>{return await(await s(X)).update({model:"invitation",where:[{field:"id",value:G.invitationId}],update:{status:G.status}})}}},r6=x6(async()=>{return{}}),U4=x6({use:[k4]},async(J)=>{return{session:J.context.session}}),k=p6({YOU_ARE_NOT_ALLOWED_TO_CREATE_A_NEW_ORGANIZATION:"You are not allowed to create a new organization",YOU_HAVE_REACHED_THE_MAXIMUM_NUMBER_OF_ORGANIZATIONS:"You have reached the maximum number of organizations",ORGANIZATION_ALREADY_EXISTS:"Organization already exists",ORGANIZATION_SLUG_ALREADY_TAKEN:"Organization slug already taken",ORGANIZATION_NOT_FOUND:"Organization not found",USER_IS_NOT_A_MEMBER_OF_THE_ORGANIZATION:"User is not a member of the organization",YOU_ARE_NOT_ALLOWED_TO_UPDATE_THIS_ORGANIZATION:"You are not allowed to update this organization",YOU_ARE_NOT_ALLOWED_TO_DELETE_THIS_ORGANIZATION:"You are not allowed to delete this organization",NO_ACTIVE_ORGANIZATION:"No active organization",USER_IS_ALREADY_A_MEMBER_OF_THIS_ORGANIZATION:"User is already a member of this organization",MEMBER_NOT_FOUND:"Member not found",ROLE_NOT_FOUND:"Role not found",YOU_ARE_NOT_ALLOWED_TO_CREATE_A_NEW_TEAM:"You are not allowed to create a new team",TEAM_ALREADY_EXISTS:"Team already exists",TEAM_NOT_FOUND:"Team not found",YOU_CANNOT_LEAVE_THE_ORGANIZATION_AS_THE_ONLY_OWNER:"You cannot leave the organization as the only owner",YOU_CANNOT_LEAVE_THE_ORGANIZATION_WITHOUT_AN_OWNER:"You cannot leave the organization without an owner",YOU_ARE_NOT_ALLOWED_TO_DELETE_THIS_MEMBER:"You are not allowed to delete this member",YOU_ARE_NOT_ALLOWED_TO_INVITE_USERS_TO_THIS_ORGANIZATION:"You are not allowed to invite users to this organization",USER_IS_ALREADY_INVITED_TO_THIS_ORGANIZATION:"User is already invited to this organization",INVITATION_NOT_FOUND:"Invitation not found",YOU_ARE_NOT_THE_RECIPIENT_OF_THE_INVITATION:"You are not the recipient of the invitation",EMAIL_VERIFICATION_REQUIRED_BEFORE_ACCEPTING_OR_REJECTING_INVITATION:"Email verification required before accepting or rejecting invitation",YOU_ARE_NOT_ALLOWED_TO_CANCEL_THIS_INVITATION:"You are not allowed to cancel this invitation",INVITER_IS_NO_LONGER_A_MEMBER_OF_THE_ORGANIZATION:"Inviter is no longer a member of the organization",YOU_ARE_NOT_ALLOWED_TO_INVITE_USER_WITH_THIS_ROLE:"You are not allowed to invite a user with this role",FAILED_TO_RETRIEVE_INVITATION:"Failed to retrieve invitation",YOU_HAVE_REACHED_THE_MAXIMUM_NUMBER_OF_TEAMS:"You have reached the maximum number of teams",UNABLE_TO_REMOVE_LAST_TEAM:"Unable to remove last team",YOU_ARE_NOT_ALLOWED_TO_UPDATE_THIS_MEMBER:"You are not allowed to update this member",ORGANIZATION_MEMBERSHIP_LIMIT_REACHED:"Organization membership limit reached",YOU_ARE_NOT_ALLOWED_TO_CREATE_TEAMS_IN_THIS_ORGANIZATION:"You are not allowed to create teams in this organization",YOU_ARE_NOT_ALLOWED_TO_DELETE_TEAMS_IN_THIS_ORGANIZATION:"You are not allowed to delete teams in this organization",YOU_ARE_NOT_ALLOWED_TO_UPDATE_THIS_TEAM:"You are not allowed to update this team",YOU_ARE_NOT_ALLOWED_TO_DELETE_THIS_TEAM:"You are not allowed to delete this team",INVITATION_LIMIT_REACHED:"Invitation limit reached",TEAM_MEMBER_LIMIT_REACHED:"Team member limit reached",USER_IS_NOT_A_MEMBER_OF_THE_TEAM:"User is not a member of the team",YOU_CAN_NOT_ACCESS_THE_MEMBERS_OF_THIS_TEAM:"You are not allowed to list the members of this team",YOU_DO_NOT_HAVE_AN_ACTIVE_TEAM:"You do not have an active team",YOU_ARE_NOT_ALLOWED_TO_CREATE_A_NEW_TEAM_MEMBER:"You are not allowed to create a new member",YOU_ARE_NOT_ALLOWED_TO_REMOVE_A_TEAM_MEMBER:"You are not allowed to remove a team member",YOU_ARE_NOT_ALLOWED_TO_ACCESS_THIS_ORGANIZATION:"You are not allowed to access this organization as an owner",YOU_ARE_NOT_A_MEMBER_OF_THIS_ORGANIZATION:"You are not a member of this organization",MISSING_AC_INSTANCE:"Dynamic Access Control requires a pre-defined ac instance on the server auth plugin. Read server logs for more information",YOU_MUST_BE_IN_AN_ORGANIZATION_TO_CREATE_A_ROLE:"You must be in an organization to create a role",YOU_ARE_NOT_ALLOWED_TO_CREATE_A_ROLE:"You are not allowed to create a role",YOU_ARE_NOT_ALLOWED_TO_UPDATE_A_ROLE:"You are not allowed to update a role",YOU_ARE_NOT_ALLOWED_TO_DELETE_A_ROLE:"You are not allowed to delete a role",YOU_ARE_NOT_ALLOWED_TO_READ_A_ROLE:"You are not allowed to read a role",YOU_ARE_NOT_ALLOWED_TO_LIST_A_ROLE:"You are not allowed to list a role",YOU_ARE_NOT_ALLOWED_TO_GET_A_ROLE:"You are not allowed to get a role",TOO_MANY_ROLES:"This organization has too many roles",INVALID_RESOURCE:"The provided permission includes an invalid resource",ROLE_NAME_IS_ALREADY_TAKEN:"That role name is already taken",CANNOT_DELETE_A_PRE_DEFINED_ROLE:"Cannot delete a pre-defined role"}),J0=async(J,W)=>{let X={...J.options.roles||qH};if(W&&J.organizationId&&J.options.dynamicAccessControl?.enabled&&J.options.ac&&!J.useMemoryCache){let G=await W.context.adapter.findMany({model:"organizationRole",where:[{field:"organizationId",value:J.organizationId}]});for(let{role:Y,permission:$}of G){if(Y in X)continue;let K=_6(P(),v6(P())).safeParse(JSON.parse($));if(!K.success)throw W.context.logger.error("[hasPermission] Invalid permissions for role "+Y,{permissions:JSON.parse($)}),new L("INTERNAL_SERVER_ERROR",{message:"Invalid permissions for role "+Y});X[Y]=J.options.ac.newRole(K.data)}}if(J.useMemoryCache)X=Kv.get(J.organizationId)||X;return Kv.set(J.organizationId,X),YE(J,X)},jE=(J)=>J.toLowerCase(),Yp=Number.POSITIVE_INFINITY,gH=(J,W=!1)=>{let X=J?.schema?.organizationRole?.additionalFields||{};if(W)for(let G in X)X[G].required=!1;return{additionalFieldsSchema:QW({fields:X,isClientSide:!0}),$AdditionalFields:{},$ReturnAdditionalFields:{}}},Gp=(J)=>{let{additionalFieldsSchema:W,$AdditionalFields:X,$ReturnAdditionalFields:G}=gH(J,!1);return y("/organization/create-role",{method:"POST",body:x({organizationId:P().optional().meta({description:"The id of the organization to create the role in. If not provided, the user's active organization will be used."}),role:P().meta({description:"The name of the role to create"}),permission:_6(P(),v6(P())).meta({description:"The permission to assign to the role"}),additionalFields:x({...W.shape}).optional()}),metadata:{$Infer:{body:{}}},requireHeaders:!0,use:[U4]},async(Y)=>{let{session:$,user:K}=Y.context.session,w=Y.body.role,H=Y.body.permission,Z=Y.body.additionalFields,z=J.ac;if(!z)throw Y.context.logger.error("[Dynamic Access Control] The organization plugin is missing a pre-defined ac instance.",`
Please refer to the documentation here: https://better-auth.com/docs/plugins/organization#dynamic-access-control`),new L("NOT_IMPLEMENTED",{message:k.MISSING_AC_INSTANCE});let N=Y.body.organizationId??$.activeOrganizationId;if(!N)throw Y.context.logger.error("[Dynamic Access Control] The session is missing an active organization id to create a role. Either set an active org id, or pass an organizationId in the request body."),new L("BAD_REQUEST",{message:k.YOU_MUST_BE_IN_AN_ORGANIZATION_TO_CREATE_A_ROLE});w=jE(w),await TE({role:w,organizationId:N,options:J,ctx:Y});let F=await Y.context.adapter.findOne({model:"member",where:[{field:"organizationId",value:N,operator:"eq",connector:"AND"},{field:"userId",value:K.id,operator:"eq",connector:"AND"}]});if(!F)throw Y.context.logger.error("[Dynamic Access Control] The user is not a member of the organization to create a role.",{userId:K.id,organizationId:N}),new L("FORBIDDEN",{message:k.YOU_ARE_NOT_A_MEMBER_OF_THIS_ORGANIZATION});if(!await J0({options:J,organizationId:N,permissions:{ac:["create"]},role:F.role},Y))throw Y.context.logger.error('[Dynamic Access Control] The user is not permitted to create a role. If this is unexpected, please make sure the role associated to that member has the "ac" resource with the "create" permission.',{userId:K.id,organizationId:N,role:F.role}),new L("FORBIDDEN",{message:k.YOU_ARE_NOT_ALLOWED_TO_CREATE_A_ROLE});let Q=typeof J.dynamicAccessControl?.maximumRolesPerOrganization==="function"?await J.dynamicAccessControl.maximumRolesPerOrganization(N):J.dynamicAccessControl?.maximumRolesPerOrganization??Yp,V=await Y.context.adapter.count({model:"organizationRole",where:[{field:"organizationId",value:N,operator:"eq",connector:"AND"}]});if(V>=Q)throw Y.context.logger.error(`[Dynamic Access Control] Failed to create a new role, the organization has too many roles. Maximum allowed roles is ${Q}.`,{organizationId:N,maximumRolesPerOrganization:Q,rolesInDB:V}),new L("BAD_REQUEST",{message:k.TOO_MANY_ROLES});await _E({ac:z,ctx:Y,permission:H}),await SE({ctx:Y,member:F,options:J,organizationId:N,permissionRequired:H,user:K,action:"create"}),await qE({ctx:Y,organizationId:N,role:w});let v=z.newRole(H),M={...await Y.context.adapter.create({model:"organizationRole",data:{createdAt:new Date,organizationId:N,permission:JSON.stringify(H),role:w,...Z}}),permission:H};return Y.json({success:!0,roleData:M,statements:v.statements})})},$p=(J)=>{return y("/organization/delete-role",{method:"POST",body:x({organizationId:P().optional().meta({description:"The id of the organization to create the role in. If not provided, the user's active organization will be used."})}).and(a4([x({roleName:P().nonempty().meta({description:"The name of the role to delete"})}),x({roleId:P().nonempty().meta({description:"The id of the role to delete"})})])),requireHeaders:!0,use:[U4],metadata:{$Infer:{body:{}}}},async(W)=>{let{session:X,user:G}=W.context.session,Y=W.body.organizationId??X.activeOrganizationId;if(!Y)throw W.context.logger.error("[Dynamic Access Control] The session is missing an active organization id to delete a role. Either set an active org id, or pass an organizationId in the request body."),new L("BAD_REQUEST",{message:k.NO_ACTIVE_ORGANIZATION});let $=await W.context.adapter.findOne({model:"member",where:[{field:"organizationId",value:Y,operator:"eq",connector:"AND"},{field:"userId",value:G.id,operator:"eq",connector:"AND"}]});if(!$)throw W.context.logger.error("[Dynamic Access Control] The user is not a member of the organization to delete a role.",{userId:G.id,organizationId:Y}),new L("FORBIDDEN",{message:k.YOU_ARE_NOT_A_MEMBER_OF_THIS_ORGANIZATION});if(!await J0({options:J,organizationId:Y,permissions:{ac:["delete"]},role:$.role},W))throw W.context.logger.error('[Dynamic Access Control] The user is not permitted to delete a role. If this is unexpected, please make sure the role associated to that member has the "ac" resource with the "delete" permission.',{userId:G.id,organizationId:Y,role:$.role}),new L("FORBIDDEN",{message:k.YOU_ARE_NOT_ALLOWED_TO_DELETE_A_ROLE});if(W.body.roleName){let H=W.body.roleName,Z=J.roles?Object.keys(J.roles):["owner","admin","member"];if(Z.includes(H))throw W.context.logger.error("[Dynamic Access Control] Cannot delete a pre-defined role.",{roleName:H,organizationId:Y,defaultRoles:Z}),new L("BAD_REQUEST",{message:k.CANNOT_DELETE_A_PRE_DEFINED_ROLE})}let K;if(W.body.roleName)K={field:"role",value:W.body.roleName,operator:"eq",connector:"AND"};else if(W.body.roleId)K={field:"id",value:W.body.roleId,operator:"eq",connector:"AND"};else throw W.context.logger.error("[Dynamic Access Control] The role name/id is not provided in the request body."),new L("BAD_REQUEST",{message:k.ROLE_NOT_FOUND});let w=await W.context.adapter.findOne({model:"organizationRole",where:[{field:"organizationId",value:Y,operator:"eq",connector:"AND"},K]});if(!w)throw W.context.logger.error("[Dynamic Access Control] The role name/id does not exist in the database.",{..."roleName"in W.body?{roleName:W.body.roleName}:{roleId:W.body.roleId},organizationId:Y}),new L("BAD_REQUEST",{message:k.ROLE_NOT_FOUND});return w.permission=JSON.parse(w.permission),await W.context.adapter.delete({model:"organizationRole",where:[{field:"organizationId",value:Y,operator:"eq",connector:"AND"},K]}),W.json({success:!0})})},Kp=(J)=>{let{$ReturnAdditionalFields:W}=gH(J,!1);return y("/organization/list-roles",{method:"GET",use:[U4],query:x({organizationId:P().optional().meta({description:"The id of the organization to list roles for. If not provided, the user's active organization will be used."})}).optional()},async(X)=>{let{session:G,user:Y}=X.context.session,$=X.query?.organizationId??G.activeOrganizationId;if(!$)throw X.context.logger.error("[Dynamic Access Control] The session is missing an active organization id to list roles. Either set an active org id, or pass an organizationId in the request query."),new L("BAD_REQUEST",{message:k.NO_ACTIVE_ORGANIZATION});let K=await X.context.adapter.findOne({model:"member",where:[{field:"organizationId",value:$,operator:"eq",connector:"AND"},{field:"userId",value:Y.id,operator:"eq",connector:"AND"}]});if(!K)throw X.context.logger.error("[Dynamic Access Control] The user is not a member of the organization to list roles.",{userId:Y.id,organizationId:$}),new L("FORBIDDEN",{message:k.YOU_ARE_NOT_A_MEMBER_OF_THIS_ORGANIZATION});if(!await J0({options:J,organizationId:$,permissions:{ac:["read"]},role:K.role},X))throw X.context.logger.error("[Dynamic Access Control] The user is not permitted to list roles.",{userId:Y.id,organizationId:$,role:K.role}),new L("FORBIDDEN",{message:k.YOU_ARE_NOT_ALLOWED_TO_LIST_A_ROLE});let w=await X.context.adapter.findMany({model:"organizationRole",where:[{field:"organizationId",value:$,operator:"eq",connector:"AND"}]});return w=w.map((H)=>({...H,permission:JSON.parse(H.permission)})),X.json(w)})},wp=(J)=>{let{$ReturnAdditionalFields:W}=gH(J,!1);return y("/organization/get-role",{method:"GET",use:[U4],query:x({organizationId:P().optional().meta({description:"The id of the organization to read a role for. If not provided, the user's active organization will be used."})}).and(a4([x({roleName:P().nonempty().meta({description:"The name of the role to read"})}),x({roleId:P().nonempty().meta({description:"The id of the role to read"})})])).optional(),metadata:{$Infer:{query:{}}}},async(X)=>{let{session:G,user:Y}=X.context.session,$=X.query?.organizationId??G.activeOrganizationId;if(!$)throw X.context.logger.error("[Dynamic Access Control] The session is missing an active organization id to read a role. Either set an active org id, or pass an organizationId in the request query."),new L("BAD_REQUEST",{message:k.NO_ACTIVE_ORGANIZATION});let K=await X.context.adapter.findOne({model:"member",where:[{field:"organizationId",value:$,operator:"eq",connector:"AND"},{field:"userId",value:Y.id,operator:"eq",connector:"AND"}]});if(!K)throw X.context.logger.error("[Dynamic Access Control] The user is not a member of the organization to read a role.",{userId:Y.id,organizationId:$}),new L("FORBIDDEN",{message:k.YOU_ARE_NOT_A_MEMBER_OF_THIS_ORGANIZATION});if(!await J0({options:J,organizationId:$,permissions:{ac:["read"]},role:K.role},X))throw X.context.logger.error("[Dynamic Access Control] The user is not permitted to read a role.",{userId:Y.id,organizationId:$,role:K.role}),new L("FORBIDDEN",{message:k.YOU_ARE_NOT_ALLOWED_TO_READ_A_ROLE});let w;if(X.query.roleName)w={field:"role",value:X.query.roleName,operator:"eq",connector:"AND"};else if(X.query.roleId)w={field:"id",value:X.query.roleId,operator:"eq",connector:"AND"};else throw X.context.logger.error("[Dynamic Access Control] The role name/id is not provided in the request query."),new L("BAD_REQUEST",{message:k.ROLE_NOT_FOUND});let H=await X.context.adapter.findOne({model:"organizationRole",where:[{field:"organizationId",value:$,operator:"eq",connector:"AND"},w]});if(!H)throw X.context.logger.error("[Dynamic Access Control] The role name/id does not exist in the database.",{..."roleName"in X.query?{roleName:X.query.roleName}:{roleId:X.query.roleId},organizationId:$}),new L("BAD_REQUEST",{message:k.ROLE_NOT_FOUND});return H.permission=JSON.parse(H.permission),X.json(H)})},Hp=(J)=>{let{additionalFieldsSchema:W,$AdditionalFields:X,$ReturnAdditionalFields:G}=gH(J,!0);return y("/organization/update-role",{method:"POST",body:x({organizationId:P().optional().meta({description:"The id of the organization to update the role in. If not provided, the user's active organization will be used."}),data:x({permission:_6(P(),v6(P())).optional().meta({description:"The permission to update the role with"}),roleName:P().optional().meta({description:"The name of the role to update"}),...W.shape})}).and(a4([x({roleName:P().nonempty().meta({description:"The name of the role to update"})}),x({roleId:P().nonempty().meta({description:"The id of the role to update"})})])),metadata:{$Infer:{body:{}}},use:[U4]},async(Y)=>{let{session:$,user:K}=Y.context.session,w=J.ac;if(!w)throw Y.context.logger.error("[Dynamic Access Control] The organization plugin is missing a pre-defined ac instance.",`
Please refer to the documentation here: https://better-auth.com/docs/plugins/organization#dynamic-access-control`),new L("NOT_IMPLEMENTED",{message:k.MISSING_AC_INSTANCE});let H=Y.body.organizationId??$.activeOrganizationId;if(!H)throw Y.context.logger.error("[Dynamic Access Control] The session is missing an active organization id to update a role. Either set an active org id, or pass an organizationId in the request body."),new L("BAD_REQUEST",{message:k.NO_ACTIVE_ORGANIZATION});let Z=await Y.context.adapter.findOne({model:"member",where:[{field:"organizationId",value:H,operator:"eq",connector:"AND"},{field:"userId",value:K.id,operator:"eq",connector:"AND"}]});if(!Z)throw Y.context.logger.error("[Dynamic Access Control] The user is not a member of the organization to update a role.",{userId:K.id,organizationId:H}),new L("FORBIDDEN",{message:k.YOU_ARE_NOT_A_MEMBER_OF_THIS_ORGANIZATION});if(!await J0({options:J,organizationId:H,role:Z.role,permissions:{ac:["update"]}},Y))throw Y.context.logger.error("[Dynamic Access Control] The user is not permitted to update a role."),new L("FORBIDDEN",{message:k.YOU_ARE_NOT_ALLOWED_TO_UPDATE_A_ROLE});let z;if(Y.body.roleName)z={field:"role",value:Y.body.roleName,operator:"eq",connector:"AND"};else if(Y.body.roleId)z={field:"id",value:Y.body.roleId,operator:"eq",connector:"AND"};else throw Y.context.logger.error("[Dynamic Access Control] The role name/id is not provided in the request body."),new L("BAD_REQUEST",{message:k.ROLE_NOT_FOUND});let N=await Y.context.adapter.findOne({model:"organizationRole",where:[{field:"organizationId",value:H,operator:"eq",connector:"AND"},z]});if(!N)throw Y.context.logger.error("[Dynamic Access Control] The role name/id does not exist in the database.",{..."roleName"in Y.body?{roleName:Y.body.roleName}:{roleId:Y.body.roleId},organizationId:H}),new L("BAD_REQUEST",{message:k.ROLE_NOT_FOUND});N.permission=N.permission?JSON.parse(N.permission):void 0;let{permission:F,roleName:Q,...V}=Y.body.data,v={...V};if(Y.body.data.permission){let O=Y.body.data.permission;await _E({ac:w,ctx:Y,permission:O}),await SE({ctx:Y,member:Z,options:J,organizationId:H,permissionRequired:O,user:K,action:"update"}),v.permission=O}if(Y.body.data.roleName){let O=Y.body.data.roleName;O=jE(O),await TE({role:O,organizationId:H,options:J,ctx:Y}),await qE({role:O,organizationId:H,ctx:Y}),v.role=O}let M={...v,...v.permission?{permission:JSON.stringify(v.permission)}:{}};return await Y.context.adapter.update({model:"organizationRole",where:[{field:"organizationId",value:H,operator:"eq",connector:"AND"},z],update:M}),Y.json({success:!0,roleData:{...N,...M,permission:v.permission||N.permission||null}})})};async function _E({ac:J,ctx:W,permission:X}){let G=Object.keys(J.statements),Y=Object.keys(X);if(Y.some(($)=>!G.includes($)))throw W.context.logger.error("[Dynamic Access Control] The provided permission includes an invalid resource.",{providedResources:Y,validResources:G}),new L("BAD_REQUEST",{message:k.INVALID_RESOURCE})}async function SE({ctx:J,permissionRequired:W,options:X,organizationId:G,member:Y,user:$,action:K}){let w=[],H=Object.entries(W);for await(let[z,N]of H)for await(let F of N)w.push({resource:{[z]:[F]},hasPermission:await J0({options:X,organizationId:G,permissions:{[z]:[F]},useMemoryCache:!0,role:Y.role},J)});let Z=w.filter((z)=>z.hasPermission===!1).map((z)=>{let N=Object.keys(z.resource)[0];return`${N}:${z.resource[N][0]}`});if(Z.length>0){J.context.logger.error(`[Dynamic Access Control] The user is missing permissions nessesary to ${K} a role with those set of permissions.
`,{userId:$.id,organizationId:G,role:Y.role,missingPermissions:Z});let z;if(K==="create")z=k.YOU_ARE_NOT_ALLOWED_TO_CREATE_A_ROLE;else if(K==="update")z=k.YOU_ARE_NOT_ALLOWED_TO_UPDATE_A_ROLE;else if(K==="delete")z=k.YOU_ARE_NOT_ALLOWED_TO_DELETE_A_ROLE;else if(K==="read")z=k.YOU_ARE_NOT_ALLOWED_TO_READ_A_ROLE;else if(K==="list")z=k.YOU_ARE_NOT_ALLOWED_TO_LIST_A_ROLE;else z=k.YOU_ARE_NOT_ALLOWED_TO_GET_A_ROLE;throw new L("FORBIDDEN",{message:z,missingPermissions:Z})}}async function TE({options:J,organizationId:W,role:X,ctx:G}){let Y=J.roles?Object.keys(J.roles):["owner","admin","member"];if(Y.includes(X))throw G.context.logger.error(`[Dynamic Access Control] The role name "${X}" is already taken by a pre-defined role.`,{role:X,organizationId:W,defaultRoles:Y}),new L("BAD_REQUEST",{message:k.ROLE_NAME_IS_ALREADY_TAKEN})}async function qE({organizationId:J,role:W,ctx:X}){if(await X.context.adapter.findOne({model:"organizationRole",where:[{field:"organizationId",value:J,operator:"eq",connector:"AND"},{field:"role",value:W,operator:"eq",connector:"AND"}]}))throw X.context.logger.error(`[Dynamic Access Control] The role name "${W}" is already taken by a role in the database.`,{role:W,organizationId:J}),new L("BAD_REQUEST",{message:k.ROLE_NAME_IS_ALREADY_TAKEN})}var Zp=(J)=>{let W=QW({fields:J?.schema?.invitation?.additionalFields||{},isClientSide:!0}),X=x({email:P().meta({description:"The email address of the user to invite"}),role:a4([P().meta({description:"The role to assign to the user"}),v6(P().meta({description:"The roles to assign to the user"}))]).meta({description:'The role(s) to assign to the user. It can be `admin`, `member`, owner. Eg: "member"'}),organizationId:P().meta({description:"The organization ID to invite the user to"}).optional(),resend:d6().meta({description:"Resend the invitation email, if the user is already invited. Eg: true"}).optional(),teamId:a4([P().meta({description:"The team ID to invite the user to"}).optional(),v6(P()).meta({description:"The team IDs to invite the user to"}).optional()])});return y("/organization/invite-member",{method:"POST",use:[r6,U4],body:x({...X.shape,...W.shape}),metadata:{$Infer:{body:{}},openapi:{operationId:"createOrganizationInvitation",description:"Create an invitation to an organization",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{id:{type:"string"},email:{type:"string"},role:{type:"string"},organizationId:{type:"string"},inviterId:{type:"string"},status:{type:"string"},expiresAt:{type:"string"},createdAt:{type:"string"}},required:["id","email","role","organizationId","inviterId","status","expiresAt","createdAt"]}}}}}}}},async(G)=>{let Y=G.context.session,$=G.body.organizationId||Y.session.activeOrganizationId;if(!$)throw new L("BAD_REQUEST",{message:k.ORGANIZATION_NOT_FOUND});let K=G.body.email.toLowerCase();if(!D8().safeParse(K).success)throw new L("BAD_REQUEST",{message:o.INVALID_EMAIL});let w=c6(G.context,J),H=await w.findMemberByOrgId({userId:Y.user.id,organizationId:$});if(!H)throw new L("BAD_REQUEST",{message:k.MEMBER_NOT_FOUND});if(!await J0({role:H.role,options:G.context.orgOptions,permissions:{invitation:["create"]},organizationId:$},G))throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_ALLOWED_TO_INVITE_USERS_TO_THIS_ORGANIZATION});let Z=G.context.orgOptions.creatorRole||"owner",z=p$(G.body.role);if(H.role!==Z&&z.split(",").includes(Z))throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_ALLOWED_TO_INVITE_USER_WITH_THIS_ROLE});if(await w.findMemberByEmail({email:K,organizationId:$}))throw new L("BAD_REQUEST",{message:k.USER_IS_ALREADY_A_MEMBER_OF_THIS_ORGANIZATION});let N=await w.findPendingInvitation({email:K,organizationId:$});if(N.length&&!G.body.resend)throw new L("BAD_REQUEST",{message:k.USER_IS_ALREADY_INVITED_TO_THIS_ORGANIZATION});let F=await w.findOrganizationById($);if(!F)throw new L("BAD_REQUEST",{message:k.ORGANIZATION_NOT_FOUND});if(N.length&&G.body.resend){let _=N[0],B=F4(G.context.orgOptions.invitationExpiresIn||172800,"sec");await G.context.adapter.update({model:"invitation",where:[{field:"id",value:_.id}],update:{expiresAt:B}});let A={..._,expiresAt:B};return await G.context.orgOptions.sendInvitationEmail?.({id:A.id,role:A.role,email:A.email.toLowerCase(),organization:F,inviter:{...H,user:Y.user},invitation:A},G.request),G.json(A)}if(N.length&&G.context.orgOptions.cancelPendingInvitationsOnReInvite)await w.updateInvitation({invitationId:N[0].id,status:"canceled"});let Q=typeof G.context.orgOptions.invitationLimit==="function"?await G.context.orgOptions.invitationLimit({user:Y.user,organization:F,member:H},G.context):G.context.orgOptions.invitationLimit??100;if((await w.findPendingInvitations({organizationId:$})).length>=Q)throw new L("FORBIDDEN",{message:k.INVITATION_LIMIT_REACHED});if(G.context.orgOptions.teams&&G.context.orgOptions.teams.enabled&&typeof G.context.orgOptions.teams.maximumMembersPerTeam<"u"&&"teamId"in G.body&&G.body.teamId){let _=typeof G.body.teamId==="string"?[G.body.teamId]:G.body.teamId;for(let B of _){let A=await w.findTeamById({teamId:B,organizationId:$,includeTeamMembers:!0});if(!A)throw new L("BAD_REQUEST",{message:k.TEAM_NOT_FOUND});let E=typeof G.context.orgOptions.teams.maximumMembersPerTeam==="function"?await G.context.orgOptions.teams.maximumMembersPerTeam({teamId:B,session:Y,organizationId:$}):G.context.orgOptions.teams.maximumMembersPerTeam;if(A.members.length>=E)throw new L("FORBIDDEN",{message:k.TEAM_MEMBER_LIMIT_REACHED})}}let V="teamId"in G.body?typeof G.body.teamId==="string"?[G.body.teamId]:G.body.teamId??[]:[],{email:v,role:M,organizationId:O,resend:S,...T}=G.body,j={role:z,email:K,organizationId:$,teamIds:V,...T?T:{}};if(J?.organizationHooks?.beforeCreateInvitation){let _=await J?.organizationHooks.beforeCreateInvitation({invitation:{...j,inviterId:Y.user.id,teamId:V.length>0?V[0]:void 0},inviter:Y.user,organization:F});if(_&&typeof _==="object"&&"data"in _)j={...j,..._.data}}let q=await w.createInvitation({invitation:j,user:Y.user});if(await G.context.orgOptions.sendInvitationEmail?.({id:q.id,role:q.role,email:q.email.toLowerCase(),organization:F,inviter:{...H,user:Y.user},invitation:q},G.request),J?.organizationHooks?.afterCreateInvitation)await J?.organizationHooks.afterCreateInvitation({invitation:q,inviter:Y.user,organization:F});return G.json(q)})},zp=(J)=>y("/organization/accept-invitation",{method:"POST",body:x({invitationId:P().meta({description:"The ID of the invitation to accept"})}),use:[r6,U4],metadata:{openapi:{description:"Accept an invitation to an organization",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{invitation:{type:"object"},member:{type:"object"}}}}}}}}}},async(W)=>{let X=W.context.session,G=c6(W.context,J),Y=await G.findInvitationById(W.body.invitationId);if(!Y||Y.expiresAt<new Date||Y.status!=="pending")throw new L("BAD_REQUEST",{message:k.INVITATION_NOT_FOUND});if(Y.email.toLowerCase()!==X.user.email.toLowerCase())throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_THE_RECIPIENT_OF_THE_INVITATION});if(W.context.orgOptions.requireEmailVerificationOnInvitation&&!X.user.emailVerified)throw new L("FORBIDDEN",{message:k.EMAIL_VERIFICATION_REQUIRED_BEFORE_ACCEPTING_OR_REJECTING_INVITATION});let $=W.context.orgOptions?.membershipLimit||100;if(await G.countMembers({organizationId:Y.organizationId})>=$)throw new L("FORBIDDEN",{message:k.ORGANIZATION_MEMBERSHIP_LIMIT_REACHED});let K=await G.findOrganizationById(Y.organizationId);if(!K)throw new L("BAD_REQUEST",{message:k.ORGANIZATION_NOT_FOUND});if(J?.organizationHooks?.beforeAcceptInvitation)await J?.organizationHooks.beforeAcceptInvitation({invitation:Y,user:X.user,organization:K});let w=await G.updateInvitation({invitationId:W.body.invitationId,status:"accepted"});if(!w)throw new L("BAD_REQUEST",{message:k.FAILED_TO_RETRIEVE_INVITATION});if(W.context.orgOptions.teams&&W.context.orgOptions.teams.enabled&&"teamId"in w&&w.teamId){let Z=w.teamId.split(","),z=Z.length===1;for(let N of Z)if(await G.findOrCreateTeamMember({teamId:N,userId:X.user.id}),typeof W.context.orgOptions.teams.maximumMembersPerTeam<"u"){if(await G.countTeamMembers({teamId:N})>=(typeof W.context.orgOptions.teams.maximumMembersPerTeam==="function"?await W.context.orgOptions.teams.maximumMembersPerTeam({teamId:N,session:X,organizationId:Y.organizationId}):W.context.orgOptions.teams.maximumMembersPerTeam))throw new L("FORBIDDEN",{message:k.TEAM_MEMBER_LIMIT_REACHED})}if(z){let N=Z[0];await I6(W,{session:await G.setActiveTeam(X.session.token,N,W),user:X.user})}}let H=await G.createMember({organizationId:Y.organizationId,userId:X.user.id,role:Y.role,createdAt:new Date});if(await G.setActiveOrganization(X.session.token,Y.organizationId,W),!w)return W.json(null,{status:400,body:{message:k.INVITATION_NOT_FOUND}});if(J?.organizationHooks?.afterAcceptInvitation)await J?.organizationHooks.afterAcceptInvitation({invitation:w,member:H,user:X.user,organization:K});return W.json({invitation:w,member:H})}),Fp=(J)=>y("/organization/reject-invitation",{method:"POST",body:x({invitationId:P().meta({description:"The ID of the invitation to reject"})}),use:[r6,U4],metadata:{openapi:{description:"Reject an invitation to an organization",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{invitation:{type:"object"},member:{type:"null"}}}}}}}}}},async(W)=>{let X=W.context.session,G=c6(W.context,W.context.orgOptions),Y=await G.findInvitationById(W.body.invitationId);if(!Y||Y.expiresAt<new Date||Y.status!=="pending")throw new L("BAD_REQUEST",{message:"Invitation not found!"});if(Y.email.toLowerCase()!==X.user.email.toLowerCase())throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_THE_RECIPIENT_OF_THE_INVITATION});if(W.context.orgOptions.requireEmailVerificationOnInvitation&&!X.user.emailVerified)throw new L("FORBIDDEN",{message:k.EMAIL_VERIFICATION_REQUIRED_BEFORE_ACCEPTING_OR_REJECTING_INVITATION});let $=await G.findOrganizationById(Y.organizationId);if(!$)throw new L("BAD_REQUEST",{message:k.ORGANIZATION_NOT_FOUND});if(J?.organizationHooks?.beforeRejectInvitation)await J?.organizationHooks.beforeRejectInvitation({invitation:Y,user:X.user,organization:$});let K=await G.updateInvitation({invitationId:W.body.invitationId,status:"rejected"});if(J?.organizationHooks?.afterRejectInvitation)await J?.organizationHooks.afterRejectInvitation({invitation:K||Y,user:X.user,organization:$});return W.json({invitation:K,member:null})}),Np=(J)=>y("/organization/cancel-invitation",{method:"POST",body:x({invitationId:P().meta({description:"The ID of the invitation to cancel"})}),use:[r6,U4],openapi:{operationId:"cancelOrganizationInvitation",description:"Cancel an invitation to an organization",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{invitation:{type:"object"}}}}}}}}},async(W)=>{let X=W.context.session,G=c6(W.context,J),Y=await G.findInvitationById(W.body.invitationId);if(!Y)throw new L("BAD_REQUEST",{message:k.INVITATION_NOT_FOUND});let $=await G.findMemberByOrgId({userId:X.user.id,organizationId:Y.organizationId});if(!$)throw new L("BAD_REQUEST",{message:k.MEMBER_NOT_FOUND});if(!await J0({role:$.role,options:W.context.orgOptions,permissions:{invitation:["cancel"]},organizationId:Y.organizationId},W))throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_ALLOWED_TO_CANCEL_THIS_INVITATION});let K=await G.findOrganizationById(Y.organizationId);if(!K)throw new L("BAD_REQUEST",{message:k.ORGANIZATION_NOT_FOUND});if(J?.organizationHooks?.beforeCancelInvitation)await J?.organizationHooks.beforeCancelInvitation({invitation:Y,cancelledBy:X.user,organization:K});let w=await G.updateInvitation({invitationId:W.body.invitationId,status:"canceled"});if(J?.organizationHooks?.afterCancelInvitation)await J?.organizationHooks.afterCancelInvitation({invitation:w||Y,cancelledBy:X.user,organization:K});return W.json(w)}),Up=(J)=>y("/organization/get-invitation",{method:"GET",use:[r6],requireHeaders:!0,query:x({id:P().meta({description:"The ID of the invitation to get"})}),metadata:{openapi:{description:"Get an invitation by ID",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{id:{type:"string"},email:{type:"string"},role:{type:"string"},organizationId:{type:"string"},inviterId:{type:"string"},status:{type:"string"},expiresAt:{type:"string"},organizationName:{type:"string"},organizationSlug:{type:"string"},inviterEmail:{type:"string"}},required:["id","email","role","organizationId","inviterId","status","expiresAt","organizationName","organizationSlug","inviterEmail"]}}}}}}}},async(W)=>{let X=await P6(W);if(!X)throw new L("UNAUTHORIZED",{message:"Not authenticated"});let G=c6(W.context,J),Y=await G.findInvitationById(W.query.id);if(!Y||Y.status!=="pending"||Y.expiresAt<new Date)throw new L("BAD_REQUEST",{message:"Invitation not found!"});if(Y.email.toLowerCase()!==X.user.email.toLowerCase())throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_THE_RECIPIENT_OF_THE_INVITATION});let $=await G.findOrganizationById(Y.organizationId);if(!$)throw new L("BAD_REQUEST",{message:k.ORGANIZATION_NOT_FOUND});let K=await G.findMemberByOrgId({userId:Y.inviterId,organizationId:Y.organizationId});if(!K)throw new L("BAD_REQUEST",{message:k.INVITER_IS_NO_LONGER_A_MEMBER_OF_THE_ORGANIZATION});return W.json({...Y,organizationName:$.name,organizationSlug:$.slug,inviterEmail:K.user.email})}),Qp=(J)=>y("/organization/list-invitations",{method:"GET",use:[r6,U4],query:x({organizationId:P().meta({description:"The ID of the organization to list invitations for"}).optional()}).optional()},async(W)=>{let X=await P6(W);if(!X)throw new L("UNAUTHORIZED",{message:"Not authenticated"});let G=W.query?.organizationId||X.session.activeOrganizationId;if(!G)throw new L("BAD_REQUEST",{message:"Organization ID is required"});let Y=c6(W.context,J);if(!await Y.findMemberByOrgId({userId:X.user.id,organizationId:G}))throw new L("FORBIDDEN",{message:"You are not a member of this organization"});let $=await Y.listInvitations({organizationId:G});return W.json($)}),Lp=(J)=>y("/organization/list-user-invitations",{method:"GET",use:[r6],query:x({email:P().meta({description:"The email of the user to list invitations for. This only works for server side API calls."}).optional()}).optional()},async(W)=>{let X=await P6(W);if(W.request&&W.query?.email)throw new L("BAD_REQUEST",{message:"User email cannot be passed for client side API calls."});let G=X?.user.email||W.query?.email;if(!G)throw new L("BAD_REQUEST",{message:"Missing session headers, or email query parameter."});let Y=await c6(W.context,J).listUserInvitations(G);return W.json(Y)}),Vp=(J)=>{let W=QW({fields:J?.schema?.member?.additionalFields||{},isClientSide:!0}),X=x({userId:m6.string().meta({description:'The user Id which represents the user to be added as a member. If `null` is provided, then it\'s expected to provide session headers. Eg: "user-id"'}),role:a4([P(),v6(P())]).meta({description:'The role(s) to assign to the new member. Eg: ["admin", "sale"]'}),organizationId:P().meta({description:`An optional organization ID to pass. If not provided, will default to the user's active organization. Eg: "org-id"`}).optional(),teamId:P().meta({description:'An optional team ID to add the member to. Eg: "team-id"'}).optional()});return y("/organization/add-member",{method:"POST",body:x({...X.shape,...W.shape}),use:[r6],metadata:{SERVER_ONLY:!0,$Infer:{body:{}},openapi:{operationId:"addOrganizationMember",description:"Add a member to an organization"}}},async(G)=>{let Y=G.body.userId?await P6(G).catch((O)=>null):null,$=G.body.organizationId||Y?.session.activeOrganizationId;if(!$)return G.json(null,{status:400,body:{message:k.NO_ACTIVE_ORGANIZATION}});let K="teamId"in G.body?G.body.teamId:void 0;if(K&&!G.context.orgOptions.teams?.enabled)throw G.context.logger.error("Teams are not enabled"),new L("BAD_REQUEST",{message:"Teams are not enabled"});let w=c6(G.context,J),H=await G.context.internalAdapter.findUserById(G.body.userId);if(!H)throw new L("BAD_REQUEST",{message:o.USER_NOT_FOUND});if(await w.findMemberByEmail({email:H.email,organizationId:$}))throw new L("BAD_REQUEST",{message:k.USER_IS_ALREADY_A_MEMBER_OF_THIS_ORGANIZATION});if(K){let O=await w.findTeamById({teamId:K,organizationId:$});if(!O||O.organizationId!==$)throw new L("BAD_REQUEST",{message:k.TEAM_NOT_FOUND})}let Z=G.context.orgOptions?.membershipLimit||100;if(await w.countMembers({organizationId:$})>=Z)throw new L("FORBIDDEN",{message:k.ORGANIZATION_MEMBERSHIP_LIMIT_REACHED});let{role:z,userId:N,organizationId:F,...Q}=G.body,V=await w.findOrganizationById($);if(!V)throw new L("BAD_REQUEST",{message:k.ORGANIZATION_NOT_FOUND});let v={organizationId:$,userId:H.id,role:p$(G.body.role),createdAt:new Date,...Q?Q:{}};if(J?.organizationHooks?.beforeAddMember){let O=await J?.organizationHooks.beforeAddMember({member:{userId:H.id,organizationId:$,role:p$(G.body.role),...Q},user:H,organization:V});if(O&&typeof O==="object"&&"data"in O)v={...v,...O.data}}let M=await w.createMember(v);if(K)await w.findOrCreateTeamMember({userId:H.id,teamId:K});if(J?.organizationHooks?.afterAddMember)await J?.organizationHooks.afterAddMember({member:M,user:H,organization:V});return G.json(M)})},Dp=(J)=>y("/organization/remove-member",{method:"POST",body:x({memberIdOrEmail:P().meta({description:"The ID or email of the member to remove"}),organizationId:P().meta({description:'The ID of the organization to remove the member from. If not provided, the active organization will be used. Eg: "org-id"'}).optional()}),use:[r6,U4],metadata:{openapi:{description:"Remove a member from an organization",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{member:{type:"object",properties:{id:{type:"string"},userId:{type:"string"},organizationId:{type:"string"},role:{type:"string"}},required:["id","userId","organizationId","role"]}},required:["member"]}}}}}}}},async(W)=>{let X=W.context.session,G=W.body.organizationId||X.session.activeOrganizationId;if(!G)return W.json(null,{status:400,body:{message:k.NO_ACTIVE_ORGANIZATION}});let Y=c6(W.context,J),$=await Y.findMemberByOrgId({userId:X.user.id,organizationId:G});if(!$)throw new L("BAD_REQUEST",{message:k.MEMBER_NOT_FOUND});let K=null;if(W.body.memberIdOrEmail.includes("@"))K=await Y.findMemberByEmail({email:W.body.memberIdOrEmail,organizationId:G});else{let N=await Y.findMemberById(W.body.memberIdOrEmail);if(!N)K=null;else{let{user:F,...Q}=N;K=Q}}if(!K)throw new L("BAD_REQUEST",{message:k.MEMBER_NOT_FOUND});let w=K.role.split(","),H=W.context.orgOptions?.creatorRole||"owner";if(w.includes(H)){if($.role!==H)throw new L("BAD_REQUEST",{message:k.YOU_CANNOT_LEAVE_THE_ORGANIZATION_AS_THE_ONLY_OWNER});let{members:N}=await Y.listMembers({organizationId:G});if(N.filter((F)=>{return F.role.split(",").includes(H)}).length<=1)throw new L("BAD_REQUEST",{message:k.YOU_CANNOT_LEAVE_THE_ORGANIZATION_AS_THE_ONLY_OWNER})}if(!await J0({role:$.role,options:W.context.orgOptions,permissions:{member:["delete"]},organizationId:G},W))throw new L("UNAUTHORIZED",{message:k.YOU_ARE_NOT_ALLOWED_TO_DELETE_THIS_MEMBER});if(K?.organizationId!==G)throw new L("BAD_REQUEST",{message:k.MEMBER_NOT_FOUND});let Z=await Y.findOrganizationById(G);if(!Z)throw new L("BAD_REQUEST",{message:k.ORGANIZATION_NOT_FOUND});let z=await W.context.internalAdapter.findUserById(K.userId);if(!z)throw new L("BAD_REQUEST",{message:"User not found"});if(J?.organizationHooks?.beforeRemoveMember)await J?.organizationHooks.beforeRemoveMember({member:K,user:z,organization:Z});if(await Y.deleteMember({memberId:K.id,organizationId:G,userId:K.userId}),X.user.id===K.userId&&X.session.activeOrganizationId===K.organizationId)await Y.setActiveOrganization(X.session.token,null,W);if(J?.organizationHooks?.afterRemoveMember)await J?.organizationHooks.afterRemoveMember({member:K,user:z,organization:Z});return W.json({member:K})}),vp=(J)=>y("/organization/update-member-role",{method:"POST",body:x({role:a4([P(),v6(P())]).meta({description:'The new role to be applied. This can be a string or array of strings representing the roles. Eg: ["admin", "sale"]'}),memberId:P().meta({description:'The member id to apply the role update to. Eg: "member-id"'}),organizationId:P().meta({description:'An optional organization ID which the member is a part of to apply the role update. If not provided, you must provide session headers to get the active organization. Eg: "organization-id"'}).optional()}),use:[r6,U4],metadata:{$Infer:{body:{}},openapi:{operationId:"updateOrganizationMemberRole",description:"Update the role of a member in an organization",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{member:{type:"object",properties:{id:{type:"string"},userId:{type:"string"},organizationId:{type:"string"},role:{type:"string"}},required:["id","userId","organizationId","role"]}},required:["member"]}}}}}}}},async(W)=>{let X=W.context.session;if(!W.body.role)throw new L("BAD_REQUEST");let G=W.body.organizationId||X.session.activeOrganizationId;if(!G)throw new L("BAD_REQUEST",{message:k.NO_ACTIVE_ORGANIZATION});let Y=c6(W.context,W.context.orgOptions),$=Array.isArray(W.body.role)?W.body.role:W.body.role?[W.body.role]:[],K=await Y.findMemberByOrgId({userId:X.user.id,organizationId:G});if(!K)throw new L("BAD_REQUEST",{message:k.MEMBER_NOT_FOUND});let w=K.id!==W.body.memberId?await Y.findMemberById(W.body.memberId):K;if(!w)throw new L("BAD_REQUEST",{message:k.MEMBER_NOT_FOUND});if(w.organizationId!==G)throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_ALLOWED_TO_UPDATE_THIS_MEMBER});let H=W.context.orgOptions?.creatorRole||"owner",Z=K.role.split(","),z=w.role.split(",").includes(H),N=Z.includes(H),F=$.includes(H),Q=K.id===w.id;if(z&&!N||F&&!N)throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_ALLOWED_TO_UPDATE_THIS_MEMBER});if(N&&Q){if((await W.context.adapter.findMany({model:"member",where:[{field:"organizationId",value:G}]})).filter((T)=>{return T.role.split(",").includes(H)}).length<=1&&!F)throw new L("BAD_REQUEST",{message:k.YOU_CANNOT_LEAVE_THE_ORGANIZATION_WITHOUT_AN_OWNER})}if(!await J0({role:K.role,options:W.context.orgOptions,permissions:{member:["update"]},allowCreatorAllPermissions:!0,organizationId:G},W))throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_ALLOWED_TO_UPDATE_THIS_MEMBER});let V=await Y.findOrganizationById(G);if(!V)throw new L("BAD_REQUEST",{message:k.ORGANIZATION_NOT_FOUND});let v=await W.context.internalAdapter.findUserById(w.userId);if(!v)throw new L("BAD_REQUEST",{message:"User not found"});let M=w.role,O=p$(W.body.role);if(J?.organizationHooks?.beforeUpdateMemberRole){let T=await J?.organizationHooks.beforeUpdateMemberRole({member:w,newRole:O,user:v,organization:V});if(T&&typeof T==="object"&&"data"in T){let j=await Y.updateMember(W.body.memberId,T.data.role||O);if(!j)throw new L("BAD_REQUEST",{message:k.MEMBER_NOT_FOUND});if(J?.organizationHooks?.afterUpdateMemberRole)await J?.organizationHooks.afterUpdateMemberRole({member:j,previousRole:M,user:v,organization:V});return W.json(j)}}let S=await Y.updateMember(W.body.memberId,O);if(!S)throw new L("BAD_REQUEST",{message:k.MEMBER_NOT_FOUND});if(J?.organizationHooks?.afterUpdateMemberRole)await J?.organizationHooks.afterUpdateMemberRole({member:S,previousRole:M,user:v,organization:V});return W.json(S)}),Mp=(J)=>y("/organization/get-active-member",{method:"GET",use:[r6,U4],requireHeaders:!0,metadata:{openapi:{description:"Get the member details of the active organization",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{id:{type:"string"},userId:{type:"string"},organizationId:{type:"string"},role:{type:"string"}},required:["id","userId","organizationId","role"]}}}}}}}},async(W)=>{let X=W.context.session,G=X.session.activeOrganizationId;if(!G)return W.json(null,{status:400,body:{message:k.NO_ACTIVE_ORGANIZATION}});let Y=await c6(W.context,J).findMemberByOrgId({userId:X.user.id,organizationId:G});if(!Y)return W.json(null,{status:400,body:{message:k.MEMBER_NOT_FOUND}});return W.json(Y)}),Op=(J)=>y("/organization/leave",{method:"POST",body:x({organizationId:P().meta({description:'The organization Id for the member to leave. Eg: "organization-id"'})}),requireHeaders:!0,use:[k4,r6]},async(W)=>{let X=W.context.session,G=c6(W.context,J),Y=await G.findMemberByOrgId({userId:X.user.id,organizationId:W.body.organizationId});if(!Y)throw new L("BAD_REQUEST",{message:k.MEMBER_NOT_FOUND});let $=W.context.orgOptions?.creatorRole||"owner";if(Y.role.split(",").includes($)){if((await W.context.adapter.findMany({model:"member",where:[{field:"organizationId",value:W.body.organizationId}]})).filter((K)=>K.role.split(",").includes($)).length<=1)throw new L("BAD_REQUEST",{message:k.YOU_CANNOT_LEAVE_THE_ORGANIZATION_AS_THE_ONLY_OWNER})}if(await G.deleteMember({memberId:Y.id,organizationId:W.body.organizationId,userId:X.user.id}),X.session.activeOrganizationId===W.body.organizationId)await G.setActiveOrganization(X.session.token,null,W);return W.json(Y)}),Pp=(J)=>y("/organization/list-members",{method:"GET",query:x({limit:P().meta({description:"The number of users to return"}).or(O6()).optional(),offset:P().meta({description:"The offset to start from"}).or(O6()).optional(),sortBy:P().meta({description:"The field to sort by"}).optional(),sortDirection:H4(["asc","desc"]).meta({description:"The direction to sort by"}).optional(),filterField:P().meta({description:"The field to filter by"}).optional(),filterValue:P().meta({description:"The value to filter by"}).or(O6()).or(d6()).optional(),filterOperator:H4(["eq","ne","lt","lte","gt","gte","contains"]).meta({description:"The operator to use for the filter"}).optional(),organizationId:P().meta({description:`The organization ID to list members for. If not provided, will default to the user's active organization. Eg: "organization-id"`}).optional(),organizationSlug:P().meta({description:`The organization slug to list members for. If not provided, will default to the user's active organization. Eg: "organization-slug"`}).optional()}).optional(),use:[r6,U4]},async(W)=>{let X=W.context.session,G=W.query?.organizationId||X.session.activeOrganizationId,Y=c6(W.context,J);if(W.query?.organizationSlug){let w=await Y.findOrganizationBySlug(W.query?.organizationSlug);if(!w)throw new L("BAD_REQUEST",{message:k.ORGANIZATION_NOT_FOUND});G=w.id}if(!G)throw new L("BAD_REQUEST",{message:k.NO_ACTIVE_ORGANIZATION});if(!await Y.findMemberByOrgId({userId:X.user.id,organizationId:G}))throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_A_MEMBER_OF_THIS_ORGANIZATION});let{members:$,total:K}=await Y.listMembers({organizationId:G,limit:W.query?.limit?Number(W.query.limit):void 0,offset:W.query?.offset?Number(W.query.offset):void 0,sortBy:W.query?.sortBy,sortOrder:W.query?.sortDirection,filter:W.query?.filterField?{field:W.query?.filterField,operator:W.query.filterOperator,value:W.query.filterValue}:void 0});return W.json({members:$,total:K})}),jp=(J)=>y("/organization/get-active-member-role",{method:"GET",query:x({userId:P().meta({description:"The user ID to get the role for. If not provided, will default to the current user's"}).optional(),organizationId:P().meta({description:`The organization ID to list members for. If not provided, will default to the user's active organization. Eg: "organization-id"`}).optional(),organizationSlug:P().meta({description:`The organization slug to list members for. If not provided, will default to the user's active organization. Eg: "organization-slug"`}).optional()}).optional(),use:[r6,U4]},async(W)=>{let X=W.context.session,G=W.query?.organizationId||X.session.activeOrganizationId,Y=c6(W.context,J);if(W.query?.organizationSlug){let H=await Y.findOrganizationBySlug(W.query?.organizationSlug);if(!H)throw new L("BAD_REQUEST",{message:k.ORGANIZATION_NOT_FOUND});G=H.id}if(!G)throw new L("BAD_REQUEST",{message:k.NO_ACTIVE_ORGANIZATION});let $=await Y.findMemberByOrgId({userId:X.user.id,organizationId:G});if(!$)throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_A_MEMBER_OF_THIS_ORGANIZATION});if(!W.query?.userId)return W.json({role:$.role});let K=W.query?.userId,w=await Y.findMemberByOrgId({userId:K,organizationId:G});if(!w)throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_A_MEMBER_OF_THIS_ORGANIZATION});return W.json({role:w?.role})}),_p=(J)=>{let W=QW({fields:J?.schema?.organization?.additionalFields||{},isClientSide:!0}),X=x({name:P().min(1).meta({description:"The name of the organization"}),slug:P().min(1).meta({description:"The slug of the organization"}),userId:m6.string().meta({description:'The user id of the organization creator. If not provided, the current user will be used. Should only be used by admins or when called by the server. server-only. Eg: "user-id"'}).optional(),logo:P().meta({description:"The logo of the organization"}).optional(),metadata:_6(P(),E6()).meta({description:"The metadata of the organization"}).optional(),keepCurrentActiveOrganization:d6().meta({description:"Whether to keep the current active organization active after creating a new one. Eg: true"}).optional()});return y("/organization/create",{method:"POST",body:x({...X.shape,...W.shape}),use:[r6],metadata:{$Infer:{body:{}},openapi:{description:"Create an organization",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",description:"The organization that was created",$ref:"#/components/schemas/Organization"}}}}}}}},async(G)=>{let Y=await P6(G);if(!Y&&(G.request||G.headers))throw new L("UNAUTHORIZED");let $=Y?.user||null;if(!$){if(!G.body.userId)throw new L("UNAUTHORIZED");$=await G.context.internalAdapter.findUserById(G.body.userId)}if(!$)return G.json(null,{status:401});let K=G.context.orgOptions;if(!(typeof K?.allowUserToCreateOrganization==="function"?await K.allowUserToCreateOrganization($):K?.allowUserToCreateOrganization===void 0?!0:K.allowUserToCreateOrganization))throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_ALLOWED_TO_CREATE_A_NEW_ORGANIZATION});let w=c6(G.context,K),H=await w.listOrganizations($.id);if(typeof K.organizationLimit==="number"?H.length>=K.organizationLimit:typeof K.organizationLimit==="function"?await K.organizationLimit($):!1)throw new L("FORBIDDEN",{message:k.YOU_HAVE_REACHED_THE_MAXIMUM_NUMBER_OF_ORGANIZATIONS});if(await w.findOrganizationBySlug(G.body.slug))throw new L("BAD_REQUEST",{message:k.ORGANIZATION_ALREADY_EXISTS});let{keepCurrentActiveOrganization:Z,userId:z,...N}=G.body;if(K.organizationCreation?.beforeCreate){let M=await K.organizationCreation.beforeCreate({organization:{...N,createdAt:new Date},user:$},G.request);if(M&&typeof M==="object"&&"data"in M)N={...G.body,...M.data}}if(K?.organizationHooks?.beforeCreateOrganization){let M=await K?.organizationHooks.beforeCreateOrganization({organization:N,user:$});if(M&&typeof M==="object"&&"data"in M)N={...G.body,...M.data}}let F=await w.createOrganization({organization:{...N,createdAt:new Date}}),Q,V=null,v={userId:$.id,organizationId:F.id,role:G.context.orgOptions.creatorRole||"owner"};if(K?.organizationHooks?.beforeAddMember){let M=await K?.organizationHooks.beforeAddMember({member:{userId:$.id,organizationId:F.id,role:G.context.orgOptions.creatorRole||"owner"},user:$,organization:F});if(M&&typeof M==="object"&&"data"in M)v={...v,...M.data}}if(Q=await w.createMember(v),K?.organizationHooks?.afterAddMember)await K?.organizationHooks.afterAddMember({member:Q,user:$,organization:F});if(K?.teams?.enabled&&K.teams.defaultTeam?.enabled!==!1){let M={organizationId:F.id,name:`${F.name}`,createdAt:new Date};if(K?.organizationHooks?.beforeCreateTeam){let S=await K?.organizationHooks.beforeCreateTeam({team:{organizationId:F.id,name:`${F.name}`},user:$,organization:F});if(S&&typeof S==="object"&&"data"in S)M={...M,...S.data}}let O=await K.teams.defaultTeam?.customCreateDefaultTeam?.(F,G)||await w.createTeam(M);if(V=await w.findOrCreateTeamMember({teamId:O.id,userId:$.id}),K?.organizationHooks?.afterCreateTeam)await K?.organizationHooks.afterCreateTeam({team:O,user:$,organization:F})}if(K.organizationCreation?.afterCreate)await K.organizationCreation.afterCreate({organization:F,user:$,member:Q},G.request);if(K?.organizationHooks?.afterCreateOrganization)await K?.organizationHooks.afterCreateOrganization({organization:F,user:$,member:Q});if(G.context.session&&!G.body.keepCurrentActiveOrganization)await w.setActiveOrganization(G.context.session.session.token,F.id,G);if(V&&G.context.session&&!G.body.keepCurrentActiveOrganization)await w.setActiveTeam(G.context.session.session.token,V.teamId,G);return G.json({...F,metadata:F.metadata&&typeof F.metadata==="string"?JSON.parse(F.metadata):F.metadata,members:[Q]})})},Sp=(J)=>y("/organization/check-slug",{method:"POST",body:x({slug:P().meta({description:'The organization slug to check. Eg: "my-org"'})}),use:[NA,r6]},async(W)=>{if(!await c6(W.context,J).findOrganizationBySlug(W.body.slug))return W.json({status:!0});throw new L("BAD_REQUEST",{message:"slug is taken"})}),Tp=(J)=>{let W=QW({fields:J?.schema?.organization?.additionalFields||{},isClientSide:!0});return y("/organization/update",{method:"POST",body:x({data:x({...W.shape,name:P().min(1).meta({description:"The name of the organization"}).optional(),slug:P().min(1).meta({description:"The slug of the organization"}).optional(),logo:P().meta({description:"The logo of the organization"}).optional(),metadata:_6(P(),E6()).meta({description:"The metadata of the organization"}).optional()}).partial(),organizationId:P().meta({description:'The organization ID. Eg: "org-id"'}).optional()}),requireHeaders:!0,use:[r6],metadata:{$Infer:{body:{}},openapi:{description:"Update an organization",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",description:"The updated organization",$ref:"#/components/schemas/Organization"}}}}}}}},async(X)=>{let G=await X.context.getSession(X);if(!G)throw new L("UNAUTHORIZED",{message:"User not found"});let Y=X.body.organizationId||G.session.activeOrganizationId;if(!Y)throw new L("BAD_REQUEST",{message:k.ORGANIZATION_NOT_FOUND});let $=c6(X.context,J),K=await $.findMemberByOrgId({userId:G.user.id,organizationId:Y});if(!K)throw new L("BAD_REQUEST",{message:k.USER_IS_NOT_A_MEMBER_OF_THE_ORGANIZATION});if(!await J0({permissions:{organization:["update"]},role:K.role,options:X.context.orgOptions,organizationId:Y},X))throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_ALLOWED_TO_UPDATE_THIS_ORGANIZATION});if(typeof X.body.data.slug==="string"){let H=await $.findOrganizationBySlug(X.body.data.slug);if(H&&H.id!==Y)throw new L("BAD_REQUEST",{message:k.ORGANIZATION_SLUG_ALREADY_TAKEN})}if(J?.organizationHooks?.beforeUpdateOrganization){let H=await J.organizationHooks.beforeUpdateOrganization({organization:X.body.data,user:G.user,member:K});if(H&&typeof H==="object"&&"data"in H)X.body.data={...X.body.data,...H.data}}let w=await $.updateOrganization(Y,X.body.data);if(J?.organizationHooks?.afterUpdateOrganization)await J.organizationHooks.afterUpdateOrganization({organization:w,user:G.user,member:K});return X.json(w)})},qp=(J)=>{return y("/organization/delete",{method:"POST",body:x({organizationId:P().meta({description:"The organization id to delete"})}),requireHeaders:!0,use:[r6],metadata:{openapi:{description:"Delete an organization",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"string",description:"The organization id that was deleted"}}}}}}}},async(W)=>{if(W.context.orgOptions.organizationDeletion?.disabled||W.context.orgOptions.disableOrganizationDeletion){if(W.context.orgOptions.organizationDeletion?.disabled)W.context.logger.info("`organizationDeletion.disabled` is deprecated. Use `disableOrganizationDeletion` instead");throw new L("NOT_FOUND",{message:"Organization deletion is disabled"})}let X=await W.context.getSession(W);if(!X)throw new L("UNAUTHORIZED",{status:401});let G=W.body.organizationId;if(!G)return W.json(null,{status:400,body:{message:k.ORGANIZATION_NOT_FOUND}});let Y=c6(W.context,J),$=await Y.findMemberByOrgId({userId:X.user.id,organizationId:G});if(!$)throw new L("BAD_REQUEST",{message:k.USER_IS_NOT_A_MEMBER_OF_THE_ORGANIZATION});if(!await J0({role:$.role,permissions:{organization:["delete"]},organizationId:G,options:W.context.orgOptions},W))throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_ALLOWED_TO_DELETE_THIS_ORGANIZATION});if(G===X.session.activeOrganizationId)await Y.setActiveOrganization(X.session.token,null,W);let K=await Y.findOrganizationById(G);if(!K)throw new L("BAD_REQUEST");if(J?.organizationHooks?.beforeDeleteOrganization)await J.organizationHooks.beforeDeleteOrganization({organization:K,user:X.user});if(await Y.deleteOrganization(G),J?.organizationHooks?.afterDeleteOrganization)await J.organizationHooks.afterDeleteOrganization({organization:K,user:X.user});return W.json(K)})},Bp=(J)=>y("/organization/get-full-organization",{method:"GET",query:M0(x({organizationId:P().meta({description:"The organization id to get"}).optional(),organizationSlug:P().meta({description:"The organization slug to get"}).optional(),membersLimit:O6().or(P().transform((W)=>parseInt(W))).meta({description:"The limit of members to get. By default, it uses the membershipLimit option which defaults to 100."}).optional()})),requireHeaders:!0,use:[r6,U4],metadata:{openapi:{operationId:"getOrganization",description:"Get the full organization",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",description:"The organization",$ref:"#/components/schemas/Organization"}}}}}}}},async(W)=>{let X=W.context.session,G=W.query?.organizationSlug||W.query?.organizationId||X.session.activeOrganizationId;if(!G)return W.json(null,{status:200});let Y=c6(W.context,J),$=await Y.findFullOrganization({organizationId:G,isSlug:!!W.query?.organizationSlug,includeTeams:W.context.orgOptions.teams?.enabled,membersLimit:W.query?.membersLimit});if(!$)throw new L("BAD_REQUEST",{message:k.ORGANIZATION_NOT_FOUND});if(!await Y.checkMembership({userId:X.user.id,organizationId:$.id}))throw await Y.setActiveOrganization(X.session.token,null,W),new L("FORBIDDEN",{message:k.USER_IS_NOT_A_MEMBER_OF_THE_ORGANIZATION});return W.json($)}),Ap=(J)=>{return y("/organization/set-active",{method:"POST",body:x({organizationId:P().meta({description:'The organization id to set as active. It can be null to unset the active organization. Eg: "org-id"'}).nullable().optional(),organizationSlug:P().meta({description:'The organization slug to set as active. It can be null to unset the active organization if organizationId is not provided. Eg: "org-slug"'}).optional()}),use:[U4,r6],metadata:{openapi:{operationId:"setActiveOrganization",description:"Set the active organization",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",description:"The organization",$ref:"#/components/schemas/Organization"}}}}}}}},async(W)=>{let X=c6(W.context,J),G=W.context.session,Y=W.body.organizationId,$=W.body.organizationSlug;if(Y===null){if(!G.session.activeOrganizationId)return W.json(null);return await I6(W,{session:await X.setActiveOrganization(G.session.token,null,W),user:G.user}),W.json(null)}if(!Y&&!$){let w=G.session.activeOrganizationId;if(!w)return W.json(null);Y=w}if($&&!Y){let w=await X.findOrganizationBySlug($);if(!w)throw new L("BAD_REQUEST",{message:k.ORGANIZATION_NOT_FOUND});Y=w.id}if(!Y)throw new L("BAD_REQUEST",{message:k.ORGANIZATION_NOT_FOUND});if(!await X.checkMembership({userId:G.user.id,organizationId:Y}))throw await X.setActiveOrganization(G.session.token,null,W),new L("FORBIDDEN",{message:k.USER_IS_NOT_A_MEMBER_OF_THE_ORGANIZATION});let K=await X.findOrganizationById(Y);if(!K)throw new L("BAD_REQUEST",{message:k.ORGANIZATION_NOT_FOUND});return await I6(W,{session:await X.setActiveOrganization(G.session.token,K.id,W),user:G.user}),W.json(K)})},Ep=(J)=>y("/organization/list",{method:"GET",use:[r6,U4],metadata:{openapi:{description:"List all organizations",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"array",items:{$ref:"#/components/schemas/Organization"}}}}}}}}},async(W)=>{let X=await c6(W.context,J).listOrganizations(W.context.session.user.id);return W.json(X)}),BE=P(),Rp=H4(["pending","accepted","rejected","canceled"]).default("pending"),IP6=x({id:P().default(f4),name:P(),slug:P(),logo:P().nullish().optional(),metadata:_6(P(),HW()).or(P().transform((J)=>JSON.parse(J))).optional(),createdAt:V4()}),bP6=x({id:P().default(f4),organizationId:P(),userId:m6.string(),role:BE,createdAt:V4().default(()=>new Date)}),kP6=x({id:P().default(f4),organizationId:P(),email:P(),role:BE,status:Rp,teamId:P().nullish(),inviterId:P(),expiresAt:V4(),createdAt:V4().default(()=>new Date)}),Cp=x({id:P().default(f4),name:P().min(1),organizationId:P(),createdAt:V4(),updatedAt:V4().optional()}),hP6=x({id:P().default(f4),teamId:P(),userId:P(),createdAt:V4().default(()=>new Date)}),fP6=x({id:P().default(f4),organizationId:P(),role:P(),permission:_6(P(),v6(P())),createdAt:V4().default(()=>new Date),updatedAt:V4().optional()}),PE=["admin","member","owner"],gP6=a4([H4(PE),v6(H4(PE))]),Ip=(J)=>{let W=QW({fields:J?.schema?.team?.additionalFields??{},isClientSide:!0}),X=x({name:P().meta({description:'The name of the team. Eg: "my-team"'}),organizationId:P().meta({description:'The organization ID which the team will be created in. Defaults to the active organization. Eg: "organization-id"'}).optional()});return y("/organization/create-team",{method:"POST",body:x({...X.shape,...W.shape}),use:[r6],metadata:{$Infer:{body:{}},openapi:{description:"Create a new team within an organization",responses:{"200":{description:"Team created successfully",content:{"application/json":{schema:{type:"object",properties:{id:{type:"string",description:"Unique identifier of the created team"},name:{type:"string",description:"Name of the team"},organizationId:{type:"string",description:"ID of the organization the team belongs to"},createdAt:{type:"string",format:"date-time",description:"Timestamp when the team was created"},updatedAt:{type:"string",format:"date-time",description:"Timestamp when the team was last updated"}},required:["id","name","organizationId","createdAt","updatedAt"]}}}}}}}},async(G)=>{let Y=await P6(G),$=G.body.organizationId||Y?.session.activeOrganizationId;if(!Y&&(G.request||G.headers))throw new L("UNAUTHORIZED");if(!$)throw new L("BAD_REQUEST",{message:k.NO_ACTIVE_ORGANIZATION});let K=c6(G.context,J);if(Y){let v=await K.findMemberByOrgId({userId:Y.user.id,organizationId:$});if(!v)throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_ALLOWED_TO_INVITE_USERS_TO_THIS_ORGANIZATION});if(!await J0({role:v.role,options:G.context.orgOptions,permissions:{team:["create"]},organizationId:$},G))throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_ALLOWED_TO_CREATE_TEAMS_IN_THIS_ORGANIZATION})}let w=await K.listTeams($),H=typeof G.context.orgOptions.teams?.maximumTeams==="function"?await G.context.orgOptions.teams?.maximumTeams({organizationId:$,session:Y},G):G.context.orgOptions.teams?.maximumTeams;if(H?w.length>=H:!1)throw new L("BAD_REQUEST",{message:k.YOU_HAVE_REACHED_THE_MAXIMUM_NUMBER_OF_TEAMS});let{name:Z,organizationId:z,...N}=G.body,F=await K.findOrganizationById($);if(!F)throw new L("BAD_REQUEST",{message:k.ORGANIZATION_NOT_FOUND});let Q={name:Z,organizationId:$,createdAt:new Date,updatedAt:new Date,...N};if(J?.organizationHooks?.beforeCreateTeam){let v=await J?.organizationHooks.beforeCreateTeam({team:{name:Z,organizationId:$,...N},user:Y?.user,organization:F});if(v&&typeof v==="object"&&"data"in v)Q={...Q,...v.data}}let V=await K.createTeam(Q);if(J?.organizationHooks?.afterCreateTeam)await J?.organizationHooks.afterCreateTeam({team:V,user:Y?.user,organization:F});return G.json(V)})},bp=(J)=>y("/organization/remove-team",{method:"POST",body:x({teamId:P().meta({description:'The team ID of the team to remove. Eg: "team-id"'}),organizationId:P().meta({description:`The organization ID which the team falls under. If not provided, it will default to the user's active organization. Eg: "organization-id"`}).optional()}),use:[r6],metadata:{openapi:{description:"Remove a team from an organization",responses:{"200":{description:"Team removed successfully",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",description:"Confirmation message indicating successful removal",enum:["Team removed successfully."]}},required:["message"]}}}}}}}},async(W)=>{let X=await P6(W),G=W.body.organizationId||X?.session.activeOrganizationId;if(!G)return W.json(null,{status:400,body:{message:k.NO_ACTIVE_ORGANIZATION}});if(!X&&(W.request||W.headers))throw new L("UNAUTHORIZED");let Y=c6(W.context,J);if(X){let w=await Y.findMemberByOrgId({userId:X.user.id,organizationId:G});if(!w||X.session?.activeTeamId===W.body.teamId)throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_ALLOWED_TO_DELETE_THIS_TEAM});if(!await J0({role:w.role,options:W.context.orgOptions,permissions:{team:["delete"]},organizationId:G},W))throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_ALLOWED_TO_DELETE_TEAMS_IN_THIS_ORGANIZATION})}let $=await Y.findTeamById({teamId:W.body.teamId,organizationId:G});if(!$||$.organizationId!==G)throw new L("BAD_REQUEST",{message:k.TEAM_NOT_FOUND});if(!W.context.orgOptions.teams?.allowRemovingAllTeams){if((await Y.listTeams(G)).length<=1)throw new L("BAD_REQUEST",{message:k.UNABLE_TO_REMOVE_LAST_TEAM})}let K=await Y.findOrganizationById(G);if(!K)throw new L("BAD_REQUEST",{message:k.ORGANIZATION_NOT_FOUND});if(J?.organizationHooks?.beforeDeleteTeam)await J?.organizationHooks.beforeDeleteTeam({team:$,user:X?.user,organization:K});if(await Y.deleteTeam($.id),J?.organizationHooks?.afterDeleteTeam)await J?.organizationHooks.afterDeleteTeam({team:$,user:X?.user,organization:K});return W.json({message:"Team removed successfully."})}),kp=(J)=>{let W=QW({fields:J?.schema?.team?.additionalFields??{},isClientSide:!0});return y("/organization/update-team",{method:"POST",body:x({teamId:P().meta({description:'The ID of the team to be updated. Eg: "team-id"'}),data:x({...Cp.shape,...W.shape}).partial()}),requireHeaders:!0,use:[r6,U4],metadata:{$Infer:{body:{}},openapi:{description:"Update an existing team in an organization",responses:{"200":{description:"Team updated successfully",content:{"application/json":{schema:{type:"object",properties:{id:{type:"string",description:"Unique identifier of the updated team"},name:{type:"string",description:"Updated name of the team"},organizationId:{type:"string",description:"ID of the organization the team belongs to"},createdAt:{type:"string",format:"date-time",description:"Timestamp when the team was created"},updatedAt:{type:"string",format:"date-time",description:"Timestamp when the team was last updated"}},required:["id","name","organizationId","createdAt","updatedAt"]}}}}}}}},async(X)=>{let G=X.context.session,Y=X.body.data.organizationId||G.session.activeOrganizationId;if(!Y)return X.json(null,{status:400,body:{message:k.NO_ACTIVE_ORGANIZATION}});let $=c6(X.context,J),K=await $.findMemberByOrgId({userId:G.user.id,organizationId:Y});if(!K)throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_ALLOWED_TO_UPDATE_THIS_TEAM});if(!await J0({role:K.role,options:X.context.orgOptions,permissions:{team:["update"]},organizationId:Y},X))throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_ALLOWED_TO_UPDATE_THIS_TEAM});let w=await $.findTeamById({teamId:X.body.teamId,organizationId:Y});if(!w||w.organizationId!==Y)throw new L("BAD_REQUEST",{message:k.TEAM_NOT_FOUND});let{name:H,organizationId:Z,...z}=X.body.data,N=await $.findOrganizationById(Y);if(!N)throw new L("BAD_REQUEST",{message:k.ORGANIZATION_NOT_FOUND});let F={name:H,...z};if(J?.organizationHooks?.beforeUpdateTeam){let V=await J?.organizationHooks.beforeUpdateTeam({team:w,updates:F,user:G.user,organization:N});if(V&&typeof V==="object"&&"data"in V){let v=V.data,M=await $.updateTeam(w.id,v);if(J?.organizationHooks?.afterUpdateTeam)await J?.organizationHooks.afterUpdateTeam({team:M,user:G.user,organization:N});return X.json(M)}}let Q=await $.updateTeam(w.id,F);if(J?.organizationHooks?.afterUpdateTeam)await J?.organizationHooks.afterUpdateTeam({team:Q,user:G.user,organization:N});return X.json(Q)})},hp=(J)=>y("/organization/list-teams",{method:"GET",query:M0(x({organizationId:P().meta({description:'The organization ID which the teams are under to list. Defaults to the users active organization. Eg: "organziation-id"'}).optional()})),requireHeaders:!0,metadata:{openapi:{description:"List all teams in an organization",responses:{"200":{description:"Teams retrieved successfully",content:{"application/json":{schema:{type:"array",items:{type:"object",properties:{id:{type:"string",description:"Unique identifier of the team"},name:{type:"string",description:"Name of the team"},organizationId:{type:"string",description:"ID of the organization the team belongs to"},createdAt:{type:"string",format:"date-time",description:"Timestamp when the team was created"},updatedAt:{type:"string",format:"date-time",description:"Timestamp when the team was last updated"}},required:["id","name","organizationId","createdAt","updatedAt"]},description:"Array of team objects within the organization"}}}}}}},use:[r6,U4]},async(W)=>{let X=W.context.session,G=W.query?.organizationId||X?.session.activeOrganizationId;if(!G)throw W.error("BAD_REQUEST",{message:k.NO_ACTIVE_ORGANIZATION});let Y=c6(W.context,J);if(!await Y.findMemberByOrgId({userId:X.user.id,organizationId:G||""}))throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_ALLOWED_TO_ACCESS_THIS_ORGANIZATION});let $=await Y.listTeams(G);return W.json($)}),fp=(J)=>y("/organization/set-active-team",{method:"POST",body:x({teamId:P().meta({description:"The team id to set as active. It can be null to unset the active team"}).nullable().optional()}),use:[U4,r6],metadata:{openapi:{description:"Set the active team",responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",description:"The team",$ref:"#/components/schemas/Team"}}}}}}}},async(W)=>{let X=c6(W.context,W.context.orgOptions),G=W.context.session;if(W.body.teamId===null){if(!G.session.activeTeamId)return W.json(null);return await I6(W,{session:await X.setActiveTeam(G.session.token,null,W),user:G.user}),W.json(null)}let Y;if(!W.body.teamId){let K=G.session.activeTeamId;if(!K)return W.json(null);else Y=K}else Y=W.body.teamId;let $=await X.findTeamById({teamId:Y});if(!$)throw new L("BAD_REQUEST",{message:k.TEAM_NOT_FOUND});if(!await X.findTeamMember({teamId:Y,userId:G.user.id}))throw new L("FORBIDDEN",{message:k.USER_IS_NOT_A_MEMBER_OF_THE_TEAM});return await I6(W,{session:await X.setActiveTeam(G.session.token,$.id,W),user:G.user}),W.json($)}),gp=(J)=>y("/organization/list-user-teams",{method:"GET",metadata:{openapi:{description:"List all teams that the current user is a part of.",responses:{"200":{description:"Teams retrieved successfully",content:{"application/json":{schema:{type:"array",items:{type:"object",description:"The team",$ref:"#/components/schemas/Team"},description:"Array of team objects within the organization"}}}}}}},use:[r6,U4]},async(W)=>{let X=W.context.session,G=await c6(W.context,W.context.orgOptions).listTeamsByUser({userId:X.user.id});return W.json(G)}),mp=(J)=>y("/organization/list-team-members",{method:"GET",query:M0(x({teamId:P().optional().meta({description:"The team whose members we should return. If this is not provided the members of the current active team get returned."})})),metadata:{openapi:{description:"List the members of the given team.",responses:{"200":{description:"Teams retrieved successfully",content:{"application/json":{schema:{type:"array",items:{type:"object",description:"The team member",properties:{id:{type:"string",description:"Unique identifier of the team member"},userId:{type:"string",description:"The user ID of the team member"},teamId:{type:"string",description:"The team ID of the team the team member is in"},createdAt:{type:"string",format:"date-time",description:"Timestamp when the team member was created"}},required:["id","userId","teamId","createdAt"]},description:"Array of team member objects within the team"}}}}}}},use:[r6,U4]},async(W)=>{let X=W.context.session,G=c6(W.context,W.context.orgOptions),Y=W.query?.teamId||X?.session.activeTeamId;if(!Y)throw new L("BAD_REQUEST",{message:k.YOU_DO_NOT_HAVE_AN_ACTIVE_TEAM});if(!await G.findTeamMember({userId:X.user.id,teamId:Y}))throw new L("BAD_REQUEST",{message:k.USER_IS_NOT_A_MEMBER_OF_THE_TEAM});let $=await G.listTeamMembers({teamId:Y});return W.json($)}),yp=(J)=>y("/organization/add-team-member",{method:"POST",body:x({teamId:P().meta({description:"The team the user should be a member of."}),userId:m6.string().meta({description:"The user Id which represents the user to be added as a member."})}),metadata:{openapi:{description:"The newly created member",responses:{"200":{description:"Team member created successfully",content:{"application/json":{schema:{type:"object",description:"The team member",properties:{id:{type:"string",description:"Unique identifier of the team member"},userId:{type:"string",description:"The user ID of the team member"},teamId:{type:"string",description:"The team ID of the team the team member is in"},createdAt:{type:"string",format:"date-time",description:"Timestamp when the team member was created"}},required:["id","userId","teamId","createdAt"]}}}}}}},use:[r6,U4]},async(W)=>{let X=W.context.session,G=c6(W.context,W.context.orgOptions);if(!X.session.activeOrganizationId)throw new L("BAD_REQUEST",{message:k.NO_ACTIVE_ORGANIZATION});let Y=await G.findMemberByOrgId({userId:X.user.id,organizationId:X.session.activeOrganizationId});if(!Y)throw new L("BAD_REQUEST",{message:k.USER_IS_NOT_A_MEMBER_OF_THE_ORGANIZATION});if(!await J0({role:Y.role,options:W.context.orgOptions,permissions:{member:["update"]},organizationId:X.session.activeOrganizationId},W))throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_ALLOWED_TO_CREATE_A_NEW_TEAM_MEMBER});if(!await G.findMemberByOrgId({userId:W.body.userId,organizationId:X.session.activeOrganizationId}))throw new L("BAD_REQUEST",{message:k.USER_IS_NOT_A_MEMBER_OF_THE_ORGANIZATION});let $=await G.findTeamById({teamId:W.body.teamId,organizationId:X.session.activeOrganizationId});if(!$)throw new L("BAD_REQUEST",{message:k.TEAM_NOT_FOUND});let K=await G.findOrganizationById(X.session.activeOrganizationId);if(!K)throw new L("BAD_REQUEST",{message:k.ORGANIZATION_NOT_FOUND});let w=await W.context.internalAdapter.findUserById(W.body.userId);if(!w)throw new L("BAD_REQUEST",{message:"User not found"});if(J?.organizationHooks?.beforeAddTeamMember){let Z=await J?.organizationHooks.beforeAddTeamMember({teamMember:{teamId:W.body.teamId,userId:W.body.userId},team:$,user:w,organization:K});if(Z&&typeof Z==="object"&&"data"in Z);}let H=await G.findOrCreateTeamMember({teamId:W.body.teamId,userId:W.body.userId});if(J?.organizationHooks?.afterAddTeamMember)await J?.organizationHooks.afterAddTeamMember({teamMember:H,team:$,user:w,organization:K});return W.json(H)}),xp=(J)=>y("/organization/remove-team-member",{method:"POST",body:x({teamId:P().meta({description:"The team the user should be removed from."}),userId:m6.string().meta({description:"The user which should be removed from the team."})}),metadata:{openapi:{description:"Remove a member from a team",responses:{"200":{description:"Team member removed successfully",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",description:"Confirmation message indicating successful removal",enum:["Team member removed successfully."]}},required:["message"]}}}}}}},use:[r6,U4]},async(W)=>{let X=W.context.session,G=c6(W.context,W.context.orgOptions);if(!X.session.activeOrganizationId)throw new L("BAD_REQUEST",{message:k.NO_ACTIVE_ORGANIZATION});let Y=await G.findMemberByOrgId({userId:X.user.id,organizationId:X.session.activeOrganizationId});if(!Y)throw new L("BAD_REQUEST",{message:k.USER_IS_NOT_A_MEMBER_OF_THE_ORGANIZATION});if(!await J0({role:Y.role,options:W.context.orgOptions,permissions:{member:["delete"]},organizationId:X.session.activeOrganizationId},W))throw new L("FORBIDDEN",{message:k.YOU_ARE_NOT_ALLOWED_TO_REMOVE_A_TEAM_MEMBER});if(!await G.findMemberByOrgId({userId:W.body.userId,organizationId:X.session.activeOrganizationId}))throw new L("BAD_REQUEST",{message:k.USER_IS_NOT_A_MEMBER_OF_THE_ORGANIZATION});let $=await G.findTeamById({teamId:W.body.teamId,organizationId:X.session.activeOrganizationId});if(!$)throw new L("BAD_REQUEST",{message:k.TEAM_NOT_FOUND});let K=await G.findOrganizationById(X.session.activeOrganizationId);if(!K)throw new L("BAD_REQUEST",{message:k.ORGANIZATION_NOT_FOUND});let w=await W.context.internalAdapter.findUserById(W.body.userId);if(!w)throw new L("BAD_REQUEST",{message:"User not found"});let H=await G.findTeamMember({teamId:W.body.teamId,userId:W.body.userId});if(!H)throw new L("BAD_REQUEST",{message:k.USER_IS_NOT_A_MEMBER_OF_THE_TEAM});if(J?.organizationHooks?.beforeRemoveTeamMember)await J?.organizationHooks.beforeRemoveTeamMember({teamMember:H,team:$,user:w,organization:K});if(await G.removeTeamMember({teamId:W.body.teamId,userId:W.body.userId}),J?.organizationHooks?.afterRemoveTeamMember)await J?.organizationHooks.afterRemoveTeamMember({teamMember:H,team:$,user:w,organization:K});return W.json({message:"Team member removed successfully."})});function p$(J){return Array.isArray(J)?J.join(","):J}var up=(J)=>{return y("/organization/has-permission",{method:"POST",requireHeaders:!0,body:x({organizationId:P().optional()}).and(a4([x({permission:_6(P(),v6(P())),permissions:tW()}),x({permission:tW(),permissions:_6(P(),v6(P()))})])),use:[U4],metadata:{$Infer:{body:{}},openapi:{description:"Check if the user has permission",requestBody:{content:{"application/json":{schema:{type:"object",properties:{permission:{type:"object",description:"The permission to check",deprecated:!0},permissions:{type:"object",description:"The permission to check"}},required:["permissions"]}}}},responses:{"200":{description:"Success",content:{"application/json":{schema:{type:"object",properties:{error:{type:"string"},success:{type:"boolean"}},required:["success"]}}}}}}}},async(W)=>{let X=W.body.organizationId||W.context.session.session.activeOrganizationId;if(!X)throw new L("BAD_REQUEST",{message:k.NO_ACTIVE_ORGANIZATION});let G=await c6(W.context,J).findMemberByOrgId({userId:W.context.session.user.id,organizationId:X});if(!G)throw new L("UNAUTHORIZED",{message:k.USER_IS_NOT_A_MEMBER_OF_THE_ORGANIZATION});let Y=await J0({role:G.role,options:J||{},permissions:W.body.permissions??W.body.permission,organizationId:X},W);return W.json({error:null,success:Y})})};function _v(J){let W={createOrganization:_p(J),updateOrganization:Tp(J),deleteOrganization:qp(J),setActiveOrganization:Ap(J),getFullOrganization:Bp(J),listOrganizations:Ep(J),createInvitation:Zp(J),cancelInvitation:Np(J),acceptInvitation:zp(J),getInvitation:Up(J),rejectInvitation:Fp(J),listInvitations:Qp(J),getActiveMember:Mp(J),checkOrganizationSlug:Sp(J),addMember:Vp(J),removeMember:Dp(J),updateMemberRole:vp(J),leaveOrganization:Op(J),listUserInvitations:Lp(J),listMembers:Pp(J),getActiveMemberRole:jp(J)},X=J?.teams?.enabled,G={createTeam:Ip(J),listOrganizationTeams:hp(J),removeTeam:bp(J),updateTeam:kp(J),setActiveTeam:fp(J),listUserTeams:gp(J),listTeamMembers:mp(J),addTeamMember:yp(J),removeTeamMember:xp(J)};if(X)W={...W,...G};let Y={createOrgRole:Gp(J),deleteOrgRole:$p(J),listOrgRoles:Kp(J),getOrgRole:wp(J),updateOrgRole:Hp(J)};if(J?.dynamicAccessControl?.enabled)W={...W,...Y};let $={...qH,...J?.roles},K=X?{team:{modelName:J?.schema?.team?.modelName,fields:{name:{type:"string",required:!0,fieldName:J?.schema?.team?.fields?.name},organizationId:{type:"string",required:!0,references:{model:"organization",field:"id"},fieldName:J?.schema?.team?.fields?.organizationId,index:!0},createdAt:{type:"date",required:!0,fieldName:J?.schema?.team?.fields?.createdAt},updatedAt:{type:"date",required:!1,fieldName:J?.schema?.team?.fields?.updatedAt,onUpdate:()=>new Date},...J?.schema?.team?.additionalFields||{}}},teamMember:{modelName:J?.schema?.teamMember?.modelName,fields:{teamId:{type:"string",required:!0,references:{model:"team",field:"id"},fieldName:J?.schema?.teamMember?.fields?.teamId,index:!0},userId:{type:"string",required:!0,references:{model:"user",field:"id"},fieldName:J?.schema?.teamMember?.fields?.userId,index:!0},createdAt:{type:"date",required:!1,fieldName:J?.schema?.teamMember?.fields?.createdAt}}}}:{},w=J?.dynamicAccessControl?.enabled?{organizationRole:{fields:{organizationId:{type:"string",required:!0,references:{model:"organization",field:"id"},fieldName:J?.schema?.organizationRole?.fields?.organizationId,index:!0},role:{type:"string",required:!0,fieldName:J?.schema?.organizationRole?.fields?.role,index:!0},permission:{type:"string",required:!0,fieldName:J?.schema?.organizationRole?.fields?.permission},createdAt:{type:"date",required:!0,defaultValue:()=>new Date,fieldName:J?.schema?.organizationRole?.fields?.createdAt},updatedAt:{type:"date",required:!1,fieldName:J?.schema?.organizationRole?.fields?.updatedAt,onUpdate:()=>new Date},...J?.schema?.organizationRole?.additionalFields||{}},modelName:J?.schema?.organizationRole?.modelName}}:{},H={organization:{modelName:J?.schema?.organization?.modelName,fields:{name:{type:"string",required:!0,sortable:!0,fieldName:J?.schema?.organization?.fields?.name},slug:{type:"string",required:!0,unique:!0,sortable:!0,fieldName:J?.schema?.organization?.fields?.slug},logo:{type:"string",required:!1,fieldName:J?.schema?.organization?.fields?.logo},createdAt:{type:"date",required:!0,fieldName:J?.schema?.organization?.fields?.createdAt},metadata:{type:"string",required:!1,fieldName:J?.schema?.organization?.fields?.metadata},...J?.schema?.organization?.additionalFields||{}}},...w,...K,member:{modelName:J?.schema?.member?.modelName,fields:{organizationId:{type:"string",required:!0,references:{model:"organization",field:"id"},fieldName:J?.schema?.member?.fields?.organizationId,index:!0},userId:{type:"string",required:!0,fieldName:J?.schema?.member?.fields?.userId,references:{model:"user",field:"id"},index:!0},role:{type:"string",required:!0,sortable:!0,defaultValue:"member",fieldName:J?.schema?.member?.fields?.role},createdAt:{type:"date",required:!0,fieldName:J?.schema?.member?.fields?.createdAt},...J?.schema?.member?.additionalFields||{}}},invitation:{modelName:J?.schema?.invitation?.modelName,fields:{organizationId:{type:"string",required:!0,references:{model:"organization",field:"id"},fieldName:J?.schema?.invitation?.fields?.organizationId,index:!0},email:{type:"string",required:!0,sortable:!0,fieldName:J?.schema?.invitation?.fields?.email,index:!0},role:{type:"string",required:!1,sortable:!0,fieldName:J?.schema?.invitation?.fields?.role},...X?{teamId:{type:"string",required:!1,sortable:!0,fieldName:J?.schema?.invitation?.fields?.teamId}}:{},status:{type:"string",required:!0,sortable:!0,defaultValue:"pending",fieldName:J?.schema?.invitation?.fields?.status},expiresAt:{type:"date",required:!0,fieldName:J?.schema?.invitation?.fields?.expiresAt},createdAt:{type:"date",required:!0,fieldName:J?.schema?.invitation?.fields?.createdAt,defaultValue:()=>new Date},inviterId:{type:"string",references:{model:"user",field:"id"},fieldName:J?.schema?.invitation?.fields?.inviterId,required:!0},...J?.schema?.invitation?.additionalFields||{}}}};return{id:"organization",endpoints:{...Xp(W,{orgOptions:J||{},roles:$,getSession:async(Z)=>{return await P6(Z)}}),hasPermission:up(J)},schema:{...H,session:{fields:{activeOrganizationId:{type:"string",required:!1,fieldName:J?.schema?.session?.fields?.activeOrganizationId},...X?{activeTeamId:{type:"string",required:!1,fieldName:J?.schema?.session?.fields?.activeTeamId}}:{}}}},$Infer:{Organization:{},Invitation:{},Member:{},Team:X?{}:{},TeamMember:X?{}:{},ActiveOrganization:{}},$ERROR_CODES:k,options:J}}r4();R4();i4();var rP6=p6({INVALID_PHONE_NUMBER:"Invalid phone number",PHONE_NUMBER_EXIST:"Phone number already exists",PHONE_NUMBER_NOT_EXIST:"phone number isn't registered",INVALID_PHONE_NUMBER_OR_PASSWORD:"Invalid phone number or password",UNEXPECTED_ERROR:"Unexpected error",OTP_NOT_FOUND:"OTP not found",OTP_EXPIRED:"OTP expired",INVALID_OTP:"Invalid OTP",PHONE_NUMBER_NOT_VERIFIED:"Phone number not verified",PHONE_NUMBER_CANNOT_BE_UPDATED:"Phone number cannot be updated",SEND_OTP_NOT_IMPLEMENTED:"sendOTP not implemented",TOO_MANY_ATTEMPTS:"Too many attempts"});r4();O8();R4();i4();eJ();R0();qK();R0();IX();var lp=p6({OTP_NOT_ENABLED:"OTP not enabled",OTP_HAS_EXPIRED:"OTP has expired",TOTP_NOT_ENABLED:"TOTP not enabled",TWO_FACTOR_NOT_ENABLED:"Two factor isn't enabled",BACKUP_CODES_NOT_ENABLED:"Backup codes aren't enabled",INVALID_BACKUP_CODE:"Invalid backup code",INVALID_CODE:"Invalid code",TOO_MANY_ATTEMPTS_REQUEST_NEW_CODE:"Too many attempts. Please request a new code.",INVALID_TWO_FACTOR_COOKIE:"Invalid two factor cookie"});R4();i4();var cp=p6({INVALID_USERNAME_OR_PASSWORD:"Invalid username or password",EMAIL_NOT_VERIFIED:"Email not verified",UNEXPECTED_ERROR:"Unexpected error",USERNAME_IS_ALREADY_TAKEN:"Username is already taken. Please try another.",USERNAME_TOO_SHORT:"Username is too short",USERNAME_TOO_LONG:"Username is too long",INVALID_USERNAME:"Username is invalid",INVALID_DISPLAY_USERNAME:"Display username is invalid"});import pp from"path";function dp(){let J=process.env.DATABASE_URL||`file:${pp.join(process.cwd(),"data/mesh.db")}`;return console.log(`[Auth] Initializing Better Auth with database: ${J} at ${process.cwd()}`),J}function np(){let J=wX(SH),W=J.newRole(LG.statements),X=J.newRole(LG.statements),G=J.newRole(LG.statements);return $v({baseURL:process.env.BASE_URL||"http://localhost:3000",database:new wK({url:dp()}),emailAndPassword:{enabled:!0},plugins:[_v({ac:J,creatorRole:"owner",allowUserToCreateOrganization:!0,roles:{user:W,admin:X,owner:G}}),Pv({loginPage:"/auth/sign-in"}),Ov(),Hv(),jv()]})}async function AE(){console.log("\uD83D\uDD10 Running Better Auth migrations...");try{let J=np(),{toBeAdded:W,toBeCreated:X,runMigrations:G}=await A$(J.options);if(!W.length&&!X.length){console.log("\u2705 Better Auth schema is up to date (no migrations needed)");return}console.log("\uD83D\uDCCB Better Auth will create/update the following tables:");for(let Y of[...X,...W])console.log(`   - ${Y.table}`);await G(),console.log("\u2705 Better Auth migrations completed successfully")}catch(J){console.warn("\u26A0\uFE0F  Better Auth migration failed (tables may be created on first use):",J)}}var __dirname="/Users/marcoscandeia/workspace/cms/apps/mesh/src/database";async function EE(){console.log("\uD83D\uDCCA Getting database instance...");let J=D_();console.log("\u2705 Database instance obtained"),console.log("\uD83D\uDD27 Creating migrator...");let W=Sv.join(process.cwd(),"migrations");console.log(`\uD83D\uDCC2 Looking for migrations in: ${W}`);let X=new Yz({db:J,provider:new Cz({fs:rp,path:Sv,migrationFolder:W})});console.log("\u2705 Migrator created"),console.log("\u25B6\uFE0F  Running migrations...");let{error:G,results:Y}=await X.migrateToLatest();if(console.log("\u2705 Migrations executed"),Y?.forEach(($)=>{if($.status==="Success")console.log(`\u2705 Migration "${$.migrationName}" executed successfully`);else if($.status==="Error")console.error(`\u274C Failed to execute migration "${$.migrationName}"`)}),G)throw console.error("Failed to migrate"),console.error(G),await J.destroy().catch(()=>{}),G;console.log("\uD83C\uDF89 All Kysely migrations completed successfully"),await AE(),console.log("\uD83D\uDD12 Closing database connection..."),await J.destroy().catch(($)=>{console.warn("Warning: Error closing database:",$)})}console.log("\uD83D\uDE80 Migration script starting...");console.log("\uD83D\uDCE6 Imported migrateToLatest function");(async()=>{console.log("\uD83C\uDFC3 Executing migration function...");try{await EE(),console.log("\u2705 All migrations completed. Exiting..."),process.exit(0)}catch(J){console.error("\u274C Migration failed:",J),process.exit(1)}})();
